{"version":3,"sources":["../node_modules/component-emitter/index.js","../node_modules/engine.io-parser/lib/browser.js","components/dialog/edit-filetag-dialog.js","components/context-menu/globalEventListener.js","components/context-menu/context-menu.js","components/dialog/create-folder-dialog.js","components/dialog/zip-download-dialog.js","components/dropdown-menu/item-dropdown-menu.js","../node_modules/parseqs/index.js","../node_modules/component-inherit/index.js","components/dialog/image-dialog.js","components/system-notification.js","models/group.js","components/main-side-nav.js","components/dialog/about-dialog.js","components/side-nav-footer.js","components/side-panel.js","components/main-panel.js","pages/drafts/drafts-view.js","components/draft-list-view/draft-list-item.js","components/draft-list-view/draft-list-view.js","pages/drafts/draft-content.js","models/activity.js","components/dialog/list-created-files-dialog.js","pages/dashboard/files-activities.js","pages/starred/starred.js","components/dialog/confirm-unlink-device.js","pages/linked-devices/linked-devices.js","models/shared-repo-info.js","components/dialog/perm-select.js","pages/share-admin/libraries.js","models/shared-folder-info.js","pages/share-admin/folders.js","components/dialog/share-link-permission-select.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","components/dialog/sort-options.js","pages/share-admin/share-links.js","pages/share-admin/upload-links.js","models/repo.js","components/libs-mobile-thead.js","pages/shared-libs/shared-libs.js","pages/share-with-ocm/shared-with-ocm.js","pages/ocm-via-webdav/ocm-via-webdav.js","pages/share-with-ocm/remote-dir-topbar.js","pages/share-with-ocm/remote-dir-path.js","pages/share-with-ocm/remote-dir-content.js","pages/share-with-ocm/remote-dir-view.js","components/dialog/create-repo-dialog.js","components/toolbar/repo-view-toobar.js","components/dirent-detail/lib-details.js","components/dialog/lib-history-setting-dialog.js","components/dialog/change-repo-password-dialog.js","components/dialog/reset-encrypted-repo-password-dialog.js","components/dialog/label-repo-state-dialog.js","components/dialog/lib-sub-folder-set-user-permission-dialog.js","components/dialog/lib-sub-folder-set-group-permission-dialog.js","components/dialog/lib-sub-folder-permission-dialog.js","components/rename.js","pages/my-libs/mylib-repo-menu.js","components/select-editor/repo-api-token-permission-editor.js","components/dialog/repo-api-token-dialog.js","components/dialog/repo-share-upload-links-dialog.js","components/dialog/lib-old-files-auto-del-dialog.js","pages/my-libs/mylib-repo-list-item.js","pages/my-libs/mylib-repo-list-view.js","components/dialog/guide-for-new-dialog.js","pages/my-libs/my-libs.js","pages/my-libs/my-libs-deleted.js","components/dialog/share-repo-dialog.js","components/shared-repo-list-view/shared-repo-list-item.js","components/shared-repo-list-view/shared-repo-list-view.js","pages/shared-with-all/public-shared-view.js","utils/collab-server.js","components/dialog/lib-decrypt-dialog.js","components/toolbar/view-mode-toolbar.js","components/dialog/create-file-dialog.js","components/toolbar/dir-operation-toolbar.js","components/dialog/move-dirent-dialog.js","components/dialog/copy-dirent-dialog.js","components/dialog/rename-dirent.js","components/toolbar/multiple-dir-operation-toolbar.js","components/toolbar/view-file-toolbar.js","pages/lib-content-view/lib-content-toolbar.js","components/cur-dir-path/dir-path.js","components/dialog/tag-color.js","components/dialog/tag-name.js","components/dialog/list-tag-dialog.js","components/cur-dir-path/dir-tool.js","components/cur-dir-path/index.js","components/dirent-detail/detail-comments-list.js","components/dirent-detail/detail-list-view.js","components/dirent-detail/dirent-details.js","components/dirent-list-view/dirent-none-view.js","components/dirent-list-view/dirent-list-item.js","components/draggable/dirents-dragged-preview.js","components/dirent-list-view/dirent-list-view.js","components/dir-view-mode/dir-list-view.js","components/dirent-grid-view/dirent-grid-item.js","components/dirent-grid-view/dirent-grid-view.js","components/dir-view-mode/dir-grid-view.js","components/dialog/rename-dialog.js","components/dir-view-mode/dir-column-nav.js","components/dir-view-mode/dir-column-file.js","components/dir-view-mode/dir-column-view.js","pages/lib-content-view/lib-content-container.js","components/file-uploader/upload-list-item.js","components/file-uploader/forbid-upload-list-item.js","components/file-uploader/upload-progress-dialog.js","components/dialog/upload-remind-dialog.js","components/file-uploader/file-uploader.js","components/dialog/delete-folder-dialog.js","pages/lib-content-view/lib-content-view.js","components/dialog/dismiss-group-dialog.js","components/dialog/create-department-repo-dialog.js","components/dialog/rename-group-dialog.js","components/dialog/transfer-group-dialog.js","components/dialog/import-members-dialog.js","components/group-members.js","components/list-and-add-group-members.js","components/search-group-members.js","components/dialog/manage-members-dialog.js","components/dialog/leave-group-dialog.js","pages/groups/group-view.js","components/toolbar/groups-toolbar.js","components/dialog/create-group-dialog.js","pages/groups/groups-view.js","components/toolbar/invitations-toolbar.js","components/dialog/invite-people-dialog.js","components/dialog/invitation-revoke-dialog.js","pages/invitations/invitations-view.js","components/dialog/new-wiki-dialog.js","components/dialog/wiki-select-dialog.js","components/dialog/wiki-delete-dialog.js","components/wiki-list-view/wiki-list-item.js","components/wiki-list-view/wiki-list-view.js","pages/wikis/wikis.js","components/toolbar/general-toolbar.js","components/main-content-wrapper.js","app.js","../node_modules/socket.io-parser/index.js","../node_modules/engine.io-client/lib/xmlhttprequest.js","../node_modules/engine.io-client/lib/globalThis.browser.js","../node_modules/engine.io-client/lib/transport.js","components/dialog/create-tag-dialog.js","components/dialog/share-admin-link.js","components/dialog/list-taggedfiles-dialog.js","models/draft.js","components/dialog/list-repo-drafts-dialog.js","components/dialog/readme-dialog.js","components/repo-info-bar.js","../node_modules/parseuri/index.js","../node_modules/socket.io-parser/node_modules/isarray/index.js","../node_modules/socket.io-parser/is-buffer.js","../node_modules/socket.io-client/lib/manager.js","../node_modules/engine.io-client/lib/transports/index.js","../node_modules/engine.io-client/lib/transports/polling.js","../node_modules/has-binary2/index.js","../node_modules/yeast/index.js","../node_modules/indexof/index.js","../node_modules/socket.io-client/lib/socket.js","../node_modules/socket.io-client/lib/on.js","../node_modules/component-bind/index.js","../node_modules/socket.io-client/lib/index.js","components/wiki-markdown-viewer.js","../node_modules/@seafile/react-image-lightbox/dist/index.es.js","components/dialog/copy-move-dirent-progress-dialog.js","components/tree-view/tree-node-view.js","components/tree-view/tree-view.js","../node_modules/socket.io-client/lib/url.js","../node_modules/debug/src/debug.js","../node_modules/ms/index.js","../node_modules/socket.io-parser/binary.js","../node_modules/engine.io-client/lib/index.js","../node_modules/engine.io-client/lib/socket.js","../node_modules/has-cors/index.js","../node_modules/engine.io-client/lib/transports/polling-xhr.js","../node_modules/engine.io-parser/lib/keys.js","../node_modules/has-binary2/node_modules/isarray/index.js","../node_modules/arraybuffer.slice/index.js","../node_modules/after/index.js","../node_modules/engine.io-parser/lib/utf8.js","../node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","../node_modules/blob/index.js","../node_modules/engine.io-client/lib/transports/polling-jsonp.js","../node_modules/engine.io-client/lib/transports/websocket.js","../node_modules/to-array/index.js","../node_modules/backo2/index.js","components/context-menu/actions.js","components/context-menu/helpers.js","../node_modules/debug/src/browser.js"],"names":["Emitter","obj","key","prototype","mixin","module","exports","on","addEventListener","event","fn","this","_callbacks","push","once","off","apply","arguments","removeListener","removeAllListeners","removeEventListener","length","cb","callbacks","i","splice","emit","args","Array","len","slice","listeners","hasListeners","base64encoder","keys","require","hasBinary","sliceBuffer","after","utf8","ArrayBuffer","isAndroid","navigator","test","userAgent","isPhantomJS","dontSendBlobs","protocol","packets","open","close","ping","pong","message","upgrade","noop","packetslist","err","type","data","Blob","map","ary","each","done","result","next","eachWithIndex","el","error","msg","encodePacket","packet","supportsBinary","utf8encode","callback","undefined","buffer","encodeBase64Packet","contentArray","Uint8Array","resultBuffer","byteLength","encodeArrayBuffer","fr","FileReader","onload","readAsArrayBuffer","encodeBlobAsArrayBuffer","blob","encodeBlob","base64","encodeBase64Object","encoded","encode","String","strict","b64data","b64","split","readAsDataURL","fromCharCode","e","typed","basic","btoa","decodePacket","binaryType","utf8decode","charAt","decodeBase64Packet","substr","decode","tryDecode","Number","substring","rest","encodePayload","isBinary","encodePayloadAsBlob","encodePayloadAsArrayBuffer","doneCallback","setLengthHeader","results","join","decodePayload","decodePayloadAsBinary","n","l","chr","encodedPackets","totalLength","reduce","acc","p","toString","resultArray","bufferIndex","forEach","isString","ab","view","charCodeAt","lenStr","parseInt","binaryIdentifier","size","lengthAry","bufferTail","buffers","tailArray","msgLength","total","TagItem","props","onMouseEnter","setState","isTagHighlighted","onMouseLeave","getRepoTagIdList","fileTagList","fileTag","repo_tag_id","onEditFileTag","repoID","repoTag","filePath","repoTagIdList","indexOf","id","seafileAPI","addFileTag","then","onFileTagChanged","catch","errMessage","Utils","getErrorMsg","toaster","danger","deleteFileTag","state","isTagSelected","className","onClick","style","backgroundColor","color","name","React","Component","TagList","getRepoTagList","listRepoTags","res","repotagList","repo_tags","item","RepoTag","toggle","toggleCancel","gettext","href","createNewTag","EditFileTagDialog","isCreateRepoTagShow","isListRepoTagShow","onRepoTagCreated","repoTagID","isOpen","onClose","handleShowEvent","hasOwnProp","show","handleHideEvent","hide","register","showCallback","hideCallback","uniqueId","unregister","canUseDOM","window","MENU_SHOW","MENU_HIDE","ContextMenu","registerHandlers","document","handleOutsideClick","handleHide","handleKeyNavigation","unregisterHandlers","handleShow","detail","isVisible","position","x","y","currentObject","menuList","callIfExists","onShowMenu","onHideMenu","menu","contains","target","hideMenu","handleMouseLeave","preventDefault","hideOnLeave","handleContextMenu","keyCode","getMenuPosition","menuStyles","top","left","innerWidth","innerHeight","rect","getBoundingClientRect","height","width","getRTLMenuPosition","onMenuItemClick","stopPropagation","operation","getEventData","onContextMenu","listenId","listener","wrapper","requestAnimationFrame","setTimeout","rtl","opacity","pointerEvents","role","display","ref","menuItem","index","data-operation","value","CreateForder","handleChange","trim","isSubmitBtnActive","childName","handleSubmit","newName","checkDuplicatedName","replace","HTMLescape","path","parentPath","onAddFolder","handleKeyPress","addFolderCancel","newInput","createRef","focus","setSelectionRange","for","innerRef","input","onKeyPress","onChange","disabled","interval","ZipDownloadDialog","queryZipProgress","zipToken","failed","clearInterval","isLoading","errorMsg","failed_reason","zipProgress","zipped","toFixed","toggleDialog","location","fileServerRoot","cancelZipTask","token","getShareLinkDirentsZipTask","getShareLinkZipTask","zipDownload","setInterval","Content","ItemDropdownMenu","isItemMenuShow","unfreezeItem","onDropdownToggleKeyDown","onDropdownToggleClick","toggleOperationMenu","freezeItem","onMenuItemKeyDown","isHandleContextMenuEvent","listenerId","getMenuList","nextProps","toggleClass","tagName","data-toggle","title","aria-label","aria-expanded","onKeyDown","divider","tag","tabIndex","defaultProps","str","hasOwnProperty","encodeURIComponent","qs","qry","pairs","pair","decodeURIComponent","a","b","constructor","ImageDialog","imageItems","imageIndex","imageItemsLength","imageCaption","url","mainSrc","src","imageTitle","nextSrc","prevSrc","onCloseRequest","closeImagePopup","onMovePrevRequest","moveToPrevImage","onMoveNextRequest","moveToNextImage","imagePadding","imageLoadErrorMessage","prevLabel","nextLabel","closeLabel","zoomInLabel","zoomOutLabel","SystemNotification","isClosed","cookieEnabled","date","Date","cookies","cookie","infoIDExist","newInfoID","curNoteID","setTime","getTime","toGMTString","siteRoot","curNoteMsg","dangerouslySetInnerHTML","__html","Group","object","owner","admins","avatar_url","created_at","parent_group_id","wiki_enabled","repos","group_quota","group_quota_usage","MainSideNav","grpsExtend","groupsExtended","loadGroups","shExtend","sharedExtended","_this","listGroups","groupList","groupsHeight","listHeight","groupItems","sort","toLowerCase","tabItemClick","param","uploader","isUploadProgressDialogShow","totalProgress","confirm","onDTableClick","dtableWebServer","getActiveClass","tab","currentTab","closeSideBar","adminHeight","to","aria-hidden","linksNavItem","canGenerateShareLink","canGenerateUploadLink","canAddRepo","customNavItems","idx","link","desc","icon","showActivity","isDocs","isPro","canViewOrg","renderSharedGroups","enableOCM","enableOCMViaWebdav","canPublishRepo","draftCounts","canInvitePeople","renderSharedAdmin","renderCustomNavItems","AboutDialog","renderExternalAboutLinks","additionalAboutDialogLinks","Object","lang","onCloseAboutDialog","aboutDialogCustomHtml","mediaUrl","logoPath","logoHeight","logoWidth","siteTitle","alt","seafileVersion","getFullYear","SideNavFooter","onAboutDialogToggle","isAboutDialogShow","renderExternalAppLinks","additionalAppBottomLinks","sideNavFooterCustomHtml","rel","enableTC","SidePanel","isSidePanelClosed","onCloseSidePanel","MainPanel","children","DraftsView","moment","locale","DraftListItem","isItemFreezed","isMenuIconShow","highlight","onFreezedItem","onUnfreezedItem","onDeleteHandler","draft","onPublishHandler","origin_repo_id","draft_file_path","fileName","getFileName","draftUrl","libraryUrl","repo_name","localTime","utc","updated_at","toDate","fromNow","iconUrl","getFileIconUrl","status","DraftListView","drafts","draftList","DraftContent","draft_name","editUtilities","deleteDraft","updateDraftsList","msg_s","success","publishDraft","getDrafts","isLoadingDraft","Acticity","json","repo_id","obj_type","commit_id","author_email","author_name","author_contact_email","time","op_type","createdFilesCount","createdFilesList","days","old_repo_name","includes","old_path","old_name","endsWith","draft_id","ListCreatedFileDialog","activity","fileURL","encodePath","serviceURL","fileLink","bind","app","config","FileActivitiesContent","isDesktop","items","isLoadingMore","desktopThead","mobileThead","ActivityItem","onListCreatedFilesToggle","isListCreatedFiles","op","details","moreDetails","userProfileURL","libURL","libLink","smallLibLink","fileCount","firstLine","isDraft","filePathLink","dirURL","dirLink","dirPathLink","isShowDate","lastEventTime","isSame","colSpan","format","datetime","is","FilesActivities","mergePublishEvents","events","curPathList","oldPathList","actuallyEvents","mergeFileCreateEvents","multiFilesActivity","isFulfilCondition","Activity","handleScroll","hasMore","clientHeight","scrollHeight","scrollTop","getMore","isFirstLoading","currentPage","avatarSize","listActivities","onScroll","loading","emptyTip","TableBody","getThumbnails","filter","imageCheck","obj_name","enableVideoThumbnail","videoCheck","repo_encrypted","getThumbnail","curItem","createThumbnail","encoded_thumbnail_src","listItems","item_icon_url","getDefaultLibIconUrl","is_dir","getFolderIconUrl","encoded_path","thumbnail_url","dirent_view_url","mtime_relative","mtime","Item","toggleOpMenu","isOpMenuOpen","handleMouseOver","showOpIcon","handleMouseOut","unstar","unstarItem","unstarred","visitItem","navigate","opClasses","desktopItem","onMouseOver","onMouseOut","onFocus","mobileItem","Starred","listStarredItems","starred_item_list","ConfirmUnlinkDevice","executeOperation","isChecked","onInputChange","checked","check","isOpIconShown","isConfirmUnlinkDialogOpen","handleClick","is_desktop_client","unlinkDevice","wipeDevice","platform","device_id","unlinked","device_name","last_login_ip","last_accessed","Fragment","LinkedDevices","listLinkedDevices","SharedRepoInfo","share_type","share_permission","modifier_name","modifier_email","modifier_contact_email","encrypted","is_admin","user_name","user_email","contact_email","group_id","group_name","PermSelect","listCustomPermissions","customPermissions","permission_list","CustomPermission","switchOption","currentOption","changePerm","translatePermission","permission","sharePerms","find","translateExplanation","explanation","sharePermsExplanation","description","getPermissions","newPermissions","permissions","currentPerm","maxHeight","overflow","htmlFor","sortByName","sortOrder","sortItems","sortBy","sortIcon","table","togglePermSelectDialog","isPermSelectDialogOpen","options","user","updateRepoSharePerm","unshare","unshareRepo","unshared","showAdmin","assign","shareTo","getLibIconUrl","iconTitle","getLibIconTitle","repoUrl","shareType","startsWith","isTextMode","isEditIconShow","currentPermission","onPermissionChanged","ShareAdminLibraries","sortRepos","listSharedRepos","SharedFolderInfo","folder_name","unshareFolder","postData","updateFolderSharePerm","is_readonly","getFolderIconTitle","folderUrl","ShareAdminFolders","_sortItems","comparator","compareTwoWord","listSharedFolders","ShareLinkPermissionSelect","getShareLinkPermissionObject","text","_slicedToArray","arr","isArray","Symbol","iterator","_arr","_n","_d","_e","_s","_i","unsupportedIterableToArray","TypeError","SortOptions","sortOptions","sortByTime","columnWidths","onRemoveLink","updatePermissionOptions","itemType","repo_folder_permission","permissionOptions","getShareLinkPermissionList","can_edit","getShareLinkPermissionStr","toggleLinkDialog","isLinkDialogOpen","viewLink","removeLink","renderExpiration","expire_date","expire_time","is_expired","permissionDetails","updateShareLink","JSON","stringify","objUrl","view_cnt","ShareAdminShareLinks","deleteShareLink","uploadItem","toggleSortOptionsDialog","isSortOptionsDialogOpen","listUserShareLinks","ShareLink","ShareAdminUploadLinks","deleteUploadLink","listUserUploadLinks","UploadLink","Repo","size_original","bytesToSize","owner_name","owner_email","owner_contact_email","last_modified","starred","storage_name","LibsMobileThead","sortBySize","share","isShowSharedDialog","leaveShare","request","leaveShareRepo","leaveShareGroupOwnedRepo","toggleShareDialog","onToggleStarRepo","repoName","isStarred","starItem","visitRepo","repoURL","icon_url","icon_title","iconVisibility","shareIconClassName","leaveShareIconClassName","shareRepoUrl","itemName","itemPath","repoEncrypted","enableDirPrivateShare","userPerm","isAdmin","SharedLibraries","save","load","listRepos","repoList","provider_id","from_user","from_server_url","ctime","SharedWithOCM","deleteOCMShareReceived","listOCMSharesReceived","ocm_share_received_list","OCMViaWebdav","getAllReceivedShares","server","req","get","shareID","received_share_list","delete","openFolder","parent_dir","onPathClick","currentPath","downloadFile","downloadUrl","shared_by","DirPath","turnPathToLink","pathList","nodePath","data-path","pathElem","MainPanelTopbar","isAdminPanel","onTabNavClick","DirentItem","dirent","downloadDirent","getDirentIcon","is_file","DirContent","direntList","deleteDirent","fromSystemRepo","Dirent","DirView","loadDirentList","direntPath","joinPath","providerID","listOCMRepoDir","dirent_list","user_perm","history","replaceState","getOCMRepoDownloadURL","openFileInput","fileInput","current","click","onFileInputChange","files","file","getOCMRepoUploadURL","formData","FormData","append","post","fileObj","newDirent","dirs","isNewFolderDialogOpen","CreateRepoDialog","handleRepoNameChange","handlePassword1Change","password1","handlePassword2Change","password2","validateInputParams","repoData","prepareRepoData","libraryType","onCreateRepo","onCreateToggle","onPermissionChange","handleStorageInputChange","selectedItem","storage_id","handlelibraryTemplatesInputChange","library_template","onEncrypted","encrypt","password","repo","passwd","storages","libraryTemplates","repoPasswordMinLength","defaultValue","label","enableEncryptedLibrary","autoComplete","RepoViewToolbar","isCreateRepoDialogShow","toggleMore","visitDeletedviaKey","onShowSidePanel","LibDetail","getFileCounts","getRepoInfo","file_count","currentRepo","smallIconUrl","bigIconUrl","closeDetails","LibHistorySetting","submit","keepDays","autoHistory","expireDays","setRepoHistoryLimit","keep_days","errorInfo","num","setLimitDays","allHistory","noHistory","getRepoHistoryLimit","enableRepoHistorySetting","ChangeRepoPasswordDialog","handleOldPasswordInputChange","oldPassword","handleNewPasswordInputChange","newPassword","handleNewPasswordAgainInputChange","newPasswordAgain","formSubmit","submitBtnDisabled","changeEncryptedRepoPassword","centered","generateDialogTitle","action","method","ResetEncryptedRepoPasswordDialog","showLoading","showSuccess","showError","resetAndSendEncryptedRepoPassword","response","error_msg","contactEmail","LabelRepoStateDialog","handleInputChange","inputValue","labels","addNewRepoLabels","formErrorMsg","existingLabels","getAllRepoSnapshotLabels","isMulti","placeholder","UserItem","isOperationShow","deleteUserFolderPermission","onChangeUserFolderPerm","folder_path","showPath","LibSubFolderSetUserPermissionDialog","handleUserSelectChange","option","selectedUsers","setPermission","addUserFolderPerm","folderPath","users","email","isDepartmentRepo","addDepartmentRepoUserFolderPerm","userFolderPermItems","concat","refs","userSelect","clearSelect","deleteUserFolderPermItem","deleteDepartmentRepoUserFolderPerm","deleteUserFolderPerm","deletedItem","userEmail","updateDepartmentRepoUserFolderPerm","updateUserFolderPerm","onSetSubFolder","toggleFileChooser","showFileChooser","toggleSubFolder","handleFileChooserSubmit","onRepoItemClick","listDepartmentRepoUserFolderPerm","listUserFolderPerm","mode","onDirentItemClick","thead","onSelectChange","addonType","GroupItem","deleteGroupPermissionItem","onChangeGroupPermission","NoOptionsMessage","innerProps","margin","textAlign","LibSubFolderSerGroupPermissionDialog","handleSelectChange","selectedOption","loadOptions","shareableGroups","listGroupPermissionItems","listDepartmentRepoGroupFolderPerm","listGroupFolderPerm","groupPermissionItems","addGroupFolderPerm","addDepartmentRepoGroupFolderPerm","deleteDepartmentRepoGroupFolderPerm","deleteGroupFolderPerm","updateDepartmentRepoGroupFolderPerm","updateGroupFolderPerm","updateGroupPermission","groupID","sharedItem","sharedItemGroupID","maxMenuHeight","inputId","components","LibSubFolderPermissionDialog","activeTab","renderContent","pills","aria-selected","aria-controls","tabId","folderName","maxWidth","Rename","nativeEvent","stopImmediatePropagation","onRenameConfirm","validateInput","isValid","onRenameCancel","renameInput","hasSuffix","endIndex","lastIndexOf","MylibRepoMenu","dataset","generatorOperations","showResetPasswordMenuItem","enableResetEncryptedRepoPassword","isEmailConfigured","operations","folderPermEnabled","isPC","enableRepoSnapshotLabel","enableRepoAutoDel","translateOperations","translateResult","unshift","RepoAPITokenPermissionEditor","onHideSelect","isEditing","onEditPermission","onSelectHandler","optionTranslation","captureMenuScroll","APITokenItem","onDeleteAPIToken","deleteAPIToken","app_name","onUpdateAPIToken","updateAPIToken","onCopyAPIToken","api_token","copy","RepoAPITokenDialog","listAPITokens","listRepoAPITokens","apiTokenList","repo_api_tokens","handleError","appName","addAPIToken","addRepoAPIToken","deleteRepoAPIToken","updateRepoAPIToken","duration","renderAPITokenList","minHeight","onRepoAPITokenToggle","RepoShareUploadLinkItem","onDeleteLink","deleteItem","creator_name","RepoShareUploadLinksDialog","getItems","listRepoShareLinks","listRepoUploadLinks","repoShareUploadLinkList","deleteRepoShareLink","deleteRepoUploadLink","forDialog","LibOldFilesAutoDelDialog","daysNeedTobeSet","isAutoDel","autoDelDays","setRepoOldFilesAutoDelDays","updateRadioCheck","getRepoOldFilesAutoDelDays","auto_delete_days","MylibRepoListItem","isOpIconShow","onShareToggle","onDeleteToggle","onRenameToggle","onTransferToggle","onHistorySettingToggle","onChangePasswordToggle","onResetPasswordToggle","onFolderPermissionToggle","onLabelToggle","onAPITokenToggle","toggleRepoShareUploadLinksDialog","toggleOldFilesAutoDelDialog","isRenaming","onRepoClick","isShareDialogShow","isDeleteDialogShow","isTransferDialogShow","isHistorySettingDialogShow","isChangePasswordDialogShow","isResetPasswordDialogShow","isLabelRepoStateDialogOpen","isFolderPermissionDialogShow","isAPITokenDialogShow","isRepoShareUploadLinksDialogOpen","isOldFilesAutoDelDialogOpen","renameRepo","onRenameRepo","onTransferRepo","transferRepo","onDeleteRepo","deleteRepo","isRepoDeleted","renderPCUI","renderMobileUI","query","MylibRepoListView","sortRepoList","renderRepoListView","showStorageBackend","GuideForNewDialog","siteName","MyLibraries","createMineRepo","newRepo","repo_size","isShowDetails","onRepoDetails","toggleGuideForNewDialog","pageOptions","guideEnabled","isGuideForNewDialogOpen","onSearchedClick","MyLibsDeleted","refreshDeletedRepoList","deletedRepoList","listDeletedRepo","trashReposExpireDays","DeletedRepoTable","deletedRepos","DeletedRepoItem","hideRestoreMenu","restoreDeletedRepo","del_time","ShareRepoListItem","onRepoSelect","padding","sharePermission","ShareRepoDialog","selectedRepoList","onRepoSelectedHandler","onCloseDialog","onShareRepoDialogClose","SharedRepoListItem","clickOperationMenuToggle","getRepoComputeParams","libPath","onItemRenameToggle","onItemFolderPermissionToggle","onItemDetails","onItemShare","onItemUnshare","onItemRename","isFolderPermissionDialogOpen","onItemDeleteToggle","onItemDelete","currentGroup","deleteGroupOwnedLibrary","translateMenuItem","isStaff","username","isRepoOwner","isDeparementOnwerGroupMember","generatorMobileMenu","isSystemStaff","generatorPCMenu","shareOperation","unshareOperation","deleteOperation","aria-haspopup","isGroupOwnedRepo","SharedRepoListView","getSortMetaData","some","isShowTableThread","hasNextPage","PublicSharedView","createPublicRepo","addRepoItem","onCreateRepoToggle","selectOwnedRepoToPublic","isExist","repoIndex","newRepoList","onAddRepoToggle","isCreateMenuShow","onSelectRepoToggle","isSelectRepoDialpgShow","canAddPublicRepo","socket","seafileCollabServer","io","collabServer","LibDecryptDialog","setRepoDecryptPassword","onLibDecryptDialog","ViewModeToolbar","switchViewMode","currentMode","baseClass","isCustomPermission","CreateFile","isDuplicated","onAddFile","handleCheck","pos","fileType","isdraft","addFileCancel","DirOperationToolbar","toggleMobileOpMenu","isMobileOpMenuOpen","hideOperationMenu","isUploadMenuShow","targetRect","bottom","operationMenuStyle","onUploadClick","onUploadFile","onUploadFolder","onCreateClick","onShareClick","onCreateFolderToggle","isCreateFolderDialogShow","onCreateFileToggle","isCreateFileDialogShow","onCreateMarkdownToggle","onCreateExcelToggle","onCreatePPTToggle","onCreateWordToggle","dirPath","getFolderName","getUserPermission","customPermission","canUpload","canCreate","upload","create","content","showShareBtn","isSupportUploadFolder","MoveDirent","isMutipleOperation","moveItems","moveItem","selectedPath","selectedDirentList","direntPaths","moveDirentPath","flag","onItemsMove","onItemMove","onCancelMove","nextState","CopyDirent","copyItems","copyItem","copyDirentPath","onItemsCopy","onItemCopy","onCancelCopy","onRename","changeState","MultipleDirOperationToolbar","onMoveToggle","isMoveDialogShow","onCopyToggle","isCopyDialogShow","onItemsDelete","onItemsDownload","isDir","URLDecorator","getUrl","useGoFileserver","isZipDialogOpen","closeZipDialog","checkDuplicatedNameInList","onPermissionItem","showLibContentViewDialogs","isPermissionDialogOpen","onCommentItem","showDirentDetail","getDirentMenuList","currentRepoInfo","opList","getDirentOperationList","list","showShareDialog","isRenameDialogOpen","listFileTags","lockFile","unlockFile","onHistory","onAccessLog","onOpenViaClient","getDirentPath","lockfile","is_locked","updateDirent","unSelectDirent","unlockfile","showEditFileTagDialog","file_tags","file_tag_id","onMenuFileTagChanged","onFilesTagChanged","multiFileTagList","canDelete","canDownload","canCopy","canModify","download","modify","ViewFileToolbar","onEditClick","onNewDraft","createDraft","onDraftHover","isDraftMessageShow","isMoreMenuShow","onEditFileTagToggle","isEditTagDialogShow","onHistoryClick","historyUrl","filePermission","hasDraft","placement","fileTags","LibContentToolbar","isViewFile","onSideNavMenuClick","isLibView","searchPlaceholder","isDirentSelected","tabName","tagTitle","pathPrefix","showName","zIndex","TagColor","togglePopover","isPopoverOpen","selectTagColor","newColor","updateRepoTag","tagColor","colorList","defaultChecked","TagName","toggleMode","updateTagName","onInputKeyDown","onInputBlur","onBlur","TagListItem","deleteTag","onDeleteTag","ListTagDialog","onListTagCancel","onCreateRepoTag","targetTagID","deleteRepoTag","repo_tag","DirTool","onShowListRepoTag","isRepoTagDialogShow","isListTaggedFileShow","onCloseRepoTagDialog","onCreateRepoTagToggle","onListTaggedFileToggle","currentTag","isFile","isMarkdownFile","trashUrl","updateUsedRepoTags","CurDirPath","onDeleteRepoTag","DetailCommentList","handleCommentChange","comment","listComments","commentsList","comments","addComment","postComment","onSubmit","addParticipant","toBeAddedParticipant","addFileParticipants","onParticipantsChange","resolveComment","updateComment","deleteComment","editComment","commentID","newComment","listRepoRelatedUsers","user_list","relatedUsers","checkParticipant","fileParticipantList","participant","renderUserSuggestion","entry","search","highlightedDisplay","focused","oldTime","participants","showIconTip","defaultStyle","trigger","displayTransform","renderSuggestion","defaultMentionStyle","onAdd","appendSpaceOnAdd","CommentItem","convertComment","mdFile","processor","process","html","toggleDropDownMenu","dropdownOpen","toggleEditComment","editable","onCommentClick","nodeName","preNode","previousSibling","nodeType","nodeValue","renderInfo","clos","rows","warp","resolved","DetailListView","getDirentPostion","repoInfo","isEditFileTagShow","direntType","direntDetail","DirentDetail","loadDirentInfo","updateDetailView","getDirName","listDir","folderDirent","getFileInfo","listParticipants","getDirInfo","listFileParticipants","participant_list","renderNavItem","showTab","classnames","active","renderHeader","direntName","onItemDetailsClose","renderDetailBody","direntDetailPanelTab","isImg","isVideo","tabs","DirentNodeView","onCreateNewFile","isDirentListLoading","DirentListItem","canDrag","isDragTipShow","onItemSelected","onItemStarred","onDirentClick","onItemClick","isRenameing","canPreview","showImagePopup","closeSharedDialog","onMobileMenuItemClick","getAttribute","onItemDownload","onItemMoveToggle","onItemCopyToggle","onUnlockItem","onLockItem","onConvertWithONLYOFFICE","lockName","onlyofficeConvert","onTagTooltipToggle","isShowTagTooltip","destRepo","onItemDragStart","isIEBrower","dataTransfer","effectAllowed","onShowDirentsDraggablePreview","setDragImage","empty_content","selectedList","nodeRootPath","nodeDirent","nodeParentPath","setData","drag_icon","dragStartItemData","onItemDragEnter","isDropTipshow","onItemDragOver","dropEffect","onItemDragLeave","onItemDragDrop","getData","parse","draggedItem","dropItemData","onItemMouseDown","onItemContextMenu","renderItemOperation","isHasPermissionToShare","isSelected","getDirentItemMenuList","preview","activeDirent","dirHref","fileHref","toolTipID","MD5","trClass","lockedInfo","lock_owner_name","draggable","onDragStart","onDragEnter","onDragOver","onDragLeave","onDrop","onMouseDown","unix","data-op","DirentsDraggedPreview","handleDragEnd","element","onHideDirentsDraggablePreview","handleDragOver","clientY","clientX","handleDrop","inlineStyle","documentElement","DirentListView","prepareImageItem","useThumbnail","isGIF","thumbnailSizeForOriginal","fullDirentList","isImagePopupOpen","prevState","selectedDirentNames","isProgressDialogShow","downloadItems","onCloseZipDownloadDialog","button","handleContextClick","touches","pageX","pageY","posX","posY","showMenuConfig","showMenu","onContainerClick","onContainerMouseDown","onContainerContextMenu","TextTranslation","NEW_FOLDER","NEW_FILE","persist","MOVE","COPY","DOWNLOAD","DELETE","onContainerMenuItemClick","onDirentsMenuItemClick","onThreadMouseDown","onThreadContextMenu","setDirentItemRef","direntItems","getDirentIndex","isContextmenu","onTableDragEnter","canDrop","enteredCounter","isListDropTipShow","onTableDragOver","onTableDragLeave","tableDrop","isShowDirentsDraggablePreview","clickedDirent","currentItemRef","onAllItemSelected","isAllItemSelected","dragStartPosition","DirListView","isRepoInfoBarShow","readmeMarkdown","usedRepoTags","DirentGridItem","isGridSelected","onGridItemClick","onItemLinkClick","onGridItemDragStart","onGridItemDragEnter","isGridDropTipShow","onGridItemDragOver","onGridItemDragLeave","onGridItemDragDrop","onGridItemMouseDown","getFileUrl","fileUrlArr","onGridItemContextMenu","fileUrl","gridClass","gridIcon","DirentGridView","isRenameDialogShow","onGridContainerMouseDown","gridContainerClick","isDirentDetailShow","onGridContainerContextMenu","isGridItemFreezed","DirGridView","onRenameNode","currentNode","DirColumnNav","onNodeClick","node","opNode","showNodeImagePopup","onAddFolderToggle","onAddFileToggle","onDeleteNode","onOpenFile","root","treeData","isAddFileDialogShow","isAddFolderDialogShow","onAddFolderNode","onAddFileNode","newUrl","parentNode","imageNames","isNodeImagePopupOpen","imageNodeItems","prepareImageItems","prepareItem","closeNodeImagePopup","stopTreeScrollPropagation","isNodeMenuShow","flex","navRate","select","inResizing","isTreeDataLoading","onNodeExpanded","onNodeCollapse","onUnFreezedItem","DirColumnFile","goDraftPage","hash","isFileLoadedErr","isTOCShow","isFileLoading","markdownContent","lastModified","latestContributor","onLinkClick","DirColumnView","onResizeMouseUp","setCookie","onResizeMouseDown","containerWidth","viewModeContainer","clientWidth","onResizeMouseMove","sizeNavWidth","rate","getCookie","cookiename","c","onResizeMove","mainFlex","onMouseMove","onMouseUp","LibContentContainer","onMainNavBarClick","closeDirentDetail","currentDirent","checkCurrentDirent","deletedDirent","onItemsScroll","onListContainerScroll","updateDetail","pathExist","isAllDirentSelected","onAllDirentSelected","UPLOAD_UPLOADING","UPLOAD_ERROR","UPLOAD_ISSAVING","UPLOAD_UPLOADED","UploadListItem","onUploadCancel","resumableFile","onUploadRetry","formatFileSize","uploadState","remainingTime","isSaved","progress","Math","round","newFileName","isUploading","aria-valuenow","aria-valuemin","aria-valuemax","formatTime","ForbidUploadListItem","maxUploadFileSize","UploadProgressDialog","onCancelAllUploading","onMinimizeUpload","isMinimized","onCloseUpload","onCloseUploadDialog","uploadBitrate","formatBitRate","uploadedMessage","uploadingMessage","uploadingOptions","uploadedOptions","allFilesUploaded","retryFileList","onUploadRetryAll","forbidUploadFileList","uploadFileList","UploadRemindDialog","cancelFileUpload","replaceRepetitionFile","uploadFile","currentResumableFile","FileUploader","componentWillUnmount","onbeforeunload","dragAndDrop","resumable","disableDropOnDocument","bindCallbackHandler","minFileSizeErrorCallback","fileTypeErrorCallback","maxFilesErrorCallback","opts","maxFileSizeErrorCallback","bindEventHandler","onChunkingComplete","onFileAdded","filesAddedComplete","onFileProgress","onFileUploadSuccess","onProgress","onComplete","onPause","onFileRetry","onFileError","onError","onBeforeCancel","onCancel","errorCount","maxFiles","maxNumberOfFilesForFileupload","relativePath","relative_path","hasRepetition","isUploadRemindDialogShow","setUploadFileList","getFileServerUploadLink","resumableUpload","isUploadLinkLoaded","getFileUploadedBytes","uploadedBytes","blockSize","resumableUploadFileBlockSize","offset","floor","markChunksCompleted","registerGlobalVariable","getBitrate","uniqueIdentifier","lastSize","loaded","now","timestamp","timeDiff","bitrateInterval","currentTime","dir_name","notifiedFolders","getFileServerErrorMessage","errorMessage","setHeaders","chunkSize","getOpt","fileSize","startByte","endByte","min","encodeURI","setQuery","generateUniqueIdentifier","webkitRelativePath","onFileUpload","uploadInput","removeAttribute","onFolderUpload","setAttribute","uploadingItem","cancel","retryUploadFile","bootstrap","firedRetry","resumableObj","getUpdateLink","pop","Resumablejs","filetypes","maxFileSize","testMethod","testChunks","headers","withCredentials","simultaneousUploads","fileParameterName","forceChunkSize","maxChunkRetries","minFileSize","assignBrowse","enableDropOnDocument","DeleteFolderDialog","deleteFolder","sharedToUserCount","sharedToGroupCount","getRepoFolderShareInfo","opTarget","alert_message","LibContentView","toggleDirentDetail","onpopstate","showFile","onRepoUpdateEvent","parseFloat","lastModifyTime","dirID","updateColumnMarkdownData","dirMetaData","usedRepoTag","updateReadmeMarkdown","last_modifier_name","is_draft","has_draft","getFileDownloadLink","getFileContent","draftID","loadDirData","watchRepo","getRepoDraftCounts","draft_counts","loadSidePanel","showDir","tree","addResponseListToNode","loadNodeAndParentsByPath","isSessionExpired","resetShowLength","isNeedUpdateHistoryState","pushState","FileTag","errMsg","markdownItem","sortDirents","dir_id","itemsShowLength","curItemPath","updateMoveCopyTreeNode","nodeChildrenNames","clone","getNodeByPath","addNodeToTree","cancelCopyMoveDirent","taskId","asyncCopyMoveTaskId","cancelCopyMoveOperation","currentMoveItemName","currentMoveItemPath","onMoveProgressDialogToggle","asyncOperationProgress","isCopyMoveProgressDialogShow","onMoveItems","destDirentPath","asyncOperatedFilesLength","asyncOperationType","dirNames","getSelectedDirentNames","getSelectedDirentPaths","moveDir","task_id","getAsyncCopyMoveProgress","deleteTreeNodes","moveDirents","getMoveSuccessMessage","getMoveFailedMessage","onCopyItems","copyDir","getCopySuccessfulMessage","getCopyFailedMessage","onDeleteItems","deleteMutipleDirents","deleteDirents","createDir","addDirent","createFile","paths","getPaths","isWeChat","resetSelected","expandNode","isInternalMarkdownLink","getPathFromInternalMarkdownLink","isInternalDirLink","getPathFromInternalDirLink","onMainPanelItemRename","renameItem","onMainPanelItemDelete","onRenameTreeNode","onDeleteTreeNode","renameDir","renameItemAjaxCallback","renameFile","toggleDeleteFolderDialog","isDeleteFolderDialogOpen","folderToDelete","deleteDir","deleteItemAjaxCallback","onMoveItem","moveToDirentPath","dirName","deleteTreeNode","moveDirent","onCopyItem","copyToDirentPath","loadTreeNodeByPath","showColumnMarkdownFile","onDirentSelected","direntObject","createDirent","renameDirent","newDirentPath","isChildPath","oldName","isAncestorPath","newPath","renameAncestorPath","direntNames","recaculateSelectedStateAfterDirentDeleted","paramKey","paramValue","newDirentList","isLoaded","isExpanded","with_parents","parentDir","isLoadFailed","onTreeNodeClick","collapseNode","treeHelper","w","onTreeNodeCollapse","onTreeNodeExpanded","createTreeNode","addNodeToParentByPath","renameTreeNode","renameNodeByPath","deleteNodeByPath","deleteNodeListByPaths","moveTreeNode","moveToPath","moveToRepo","moveNodeByPath","copyTreeNode","copyToPath","copyNodeByPath","nodeList","TreeNode","addChildren","selectedDirent","names","libNeedDecrypt","onToolbarFileTagChanged","deletedTagID","buildTree","oldonpopstate","repoRes","RepoInfo","permissionID","getCustomPermission","permissionRes","custom_permission","lib_need_decrypt","unwatchRepo","queryAsyncOperationProgress","successful","deleteFile","isVirtual","is_virtual","direntItemsList","onMenuClick","DismissGroupDialog","dismissGroup","that","deleteGroup","onGroupChanged","showDismissGroupDialog","toggleDismissGroupDialog","RenameGroupDialog","handleGroupNameChange","newGroupName","renameGroup","loadGroup","toggleRenameGroupDialog","handleKeyDown","currentGroupName","showRenameGroupDialog","TransferGroupDialog","transferGroup","toggleTransferGroupDialog","ImportMembersDialog","toggleImportMembersDialog","fileInputRef","importMembersInBatch","groupImportMembersExtraMsg","GroupMembers","groupMembers","changeMember","deleteMember","isOwner","toggleItemFreezed","Member","onChangeUserRole","setGroupAdmin","deleteGroupMember","translateRole","roles","deleteAuthority","scope","currentRole","onRoleChanged","PureComponent","ManageMembersDialog","listGroupMembers","page","perPage","members","addGroupMember","emails","addGroupMembers","newMembers","isFreezed","targetMember","changeMode","SearchGroupMembers","q","searchGroupMember","isInit","MANAGEMENT_MODE","toggleManageMembersDialog","LeaveGroupDialog","leaveGroup","quitGroup","toggleLeaveGroupDialog","GroupView","getGroup","getEmptyTip","isDepartmentGroup","loadRepos","listGroupRepos","groupOwnerType","groupId","createGroupOwnedLibrary","createGroupRepo","group","unshareRepoToGroup","renameGroupOwnedLibrary","toggleGroupDropdown","showGroupDropdown","showTransferGroupDialog","showImportMembersDialog","notify","importGroupMembersViaFile","showManageMembersDialog","isLeaveGroupDialogOpen","toggleGroupMembersPopover","showGroupMembersPopover","isShowSettingIcon","useRate","GroupsToolbar","canAddGroup","toggleAddGroupModal","CreateGroupDialog","handleGroupChange","groupName","handleSubmitGroup","createGroup","onCreateGroup","showAddGroupModal","RepoListViewPanel","isShowRepoOwner","GroupsView","InvitationsToolbar","toggleInvitePeopleDialog","InvitePeopleDialog","handleSubmitInvite","emailsArray","isSubmitting","invitePeople","successMsg","accepter","onInvitePeople","failedMsg","InvitationRevokeDialog","onRevokeInvitation","revokeInvitation","invitation","deleteInvitation","deleted","revokeItem","toggleRevokeDialog","isRevokeDialogOpen","invite_time","accept_time","invitationsList","InvitationsView","invitationsArray","isInvitePeopleDialogOpen","listInvitations","NewWikiDialog","inputNewName","addWiki","WikiSelectDialog","WikiDeleteDialog","WikiListItem","isShowDeleteDialog","onDeleteCancel","deleteWiki","wiki","fileIconUrl","deleteIcon","owner_nickname","WikiListView","wikis","renameWiki","Wikis","getWikis","listWikis","clickMenuToggle","onMenuToggle","isShowAddWikiMenu","onSelectToggle","isShowSelectDialog","isShowCreateDialog","slug","GeneralToolbar","MainContentWrapper","WrapperedComponent","FilesActivitiesWrapper","DraftsViewWrapper","StarredWrapper","LinkedDevicesWrapper","SharedLibrariesWrapper","SharedWithOCMWrapper","ShareWithOCM","OCMViaWebdavWrapper","ShareAdminLibrariesWrapper","ShareAdminFoldersWrapper","ShareAdminShareLinksWrapper","ShareAdminUploadLinksWrapper","App","navigateClientUrlToLib","splitUrlArray","repalce","listDrafts","dirViewPanels","generatorPrefix","navTab1","navTab2","navTab","getTabShowName","toggleSidePanel","home","contentClassName","ReactDOM","render","getElementById","debug","binary","isBuf","Encoder","types","CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK","Decoder","ERROR_PACKET","encodeAsString","attachments","nsp","payload","tryStringify","reconstructor","BinaryReconstructor","reconPack","writeEncoding","bloblessData","deconstruction","deconstructPacket","pack","removeBlobs","encodeAsBinary","add","start","buf","Error","tryParse","decodeString","takeBinaryData","destroy","finishedReconstruction","binData","reconstructPacket","hasCORS","globalThis","xdomain","xscheme","enablesXDR","XMLHttpRequest","XDomainRequest","self","Function","parser","Transport","hostname","port","secure","timestampParam","timestampRequests","readyState","agent","pfx","passphrase","cert","ca","ciphers","rejectUnauthorized","forceNode","isReactNative","extraHeaders","localAddress","doOpen","doClose","send","write","onOpen","writable","onData","onPacket","CreateTagDialog","selectTagcolor","createTag","createRepoTag","newTag","canSave","ShareAdminLink","copyToClipboard","ListTaggedFilesDialog","TaggedFile","parent_path","filename","onDeleteTaggedFile","taggedFile","fileTagID","getTaggedFiles","file_deleted","shareLinkToken","getShareLinkTaggedFiles","listTaggedFiles","taggedFileList","tagged_files","enableFileDownload","Draft","created","createdStr","ownerNickname","originRepoID","draftFilePath","ListRepoDraftsDialog","onDeleteDraftItem","editorUtilities","listRepoDrafts","draftItem","DraftItem","ReadmeDialog","readmeContent","showTOC","scriptSource","RepoInfoBar","onListTaggedFiles","toggleDrafts","showRepoDrafts","toggleReadme","showReadmeDialog","re","parts","m","exec","uri","source","host","authority","ipv6uri","pathNames","regx","queryKey","$0","$1","$2","call","withNativeBuffer","Buffer","isBuffer","withNativeArrayBuffer","isView","eio","Socket","Backoff","has","Manager","nsps","subs","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","max","jitter","timeout","connecting","lastPing","encoding","packetBuffer","_parser","encoder","decoder","autoConnect","emitAll","updateSocketIds","generateId","engine","v","_reconnection","_reconnectionAttempts","_reconnectionDelay","setMin","_randomizationFactor","setJitter","_reconnectionDelayMax","setMax","_timeout","maybeReconnectOnOpen","reconnecting","attempts","reconnect","connect","skipReconnect","openSub","onopen","errorSub","cleanup","timer","clearTimeout","onping","onpong","ondata","ondecoded","onerror","onConnecting","processPacketQueue","shift","subsLength","disconnect","reset","onclose","reason","delay","onreconnect","attempt","XHR","JSONP","websocket","polling","xd","xs","jsonp","isSSL","forceJSONP","parseqs","inherit","yeast","Polling","hasXHR2","responseType","forceBase64","poll","pause","doPoll","callbackfn","doWrite","schema","sid","withNativeBlob","withNativeFile","File","toJSON","prev","alphabet","seed","decoded","toArray","hasBin","connect_error","connect_timeout","reconnect_attempt","reconnect_failed","reconnect_error","ids","acks","receiveBuffer","sendBuffer","connected","disconnected","flags","subEvents","ev","compress","onpacket","sameNamespace","rootNamespaceError","onconnect","onevent","onack","ondisconnect","ack","sent","emitBuffered","lookup","cache","managers","parsed","forceNew","multiplex","contentClass","WikiMarkdownViewer","getTitlesInfo","titlesInfo","titleDom","querySelectorAll","updateTabTitle","headingList","offsetTop","onScrollHandler","activeTitleIndex","contentScrollTop","markdownContainer","titlesLength","changeInlineNode","imagePath","isPublicWiki","RegExp","index2","originalPath","pathNormalize","isInternalFileLink","match","p1","p2","p3","sharedToken","modifyValueBeforeRender","changeMarkdownNodes","renderMarkdown","isWiki","links","MarkdownViewer","_defineProperties","descriptor","enumerable","configurable","defineProperty","_createClass","Constructor","protoProps","staticProps","_defineProperty","_extends","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","_assertThisInitialized","ReferenceError","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_toConsumableArray","arr2","_arrayWithoutHoles","iter","from","_iterableToArray","_nonIterableSpread","translate","replaceStrings","translated","getWindowWidth","global","getHighestSafeWindowContext","referrer","getOrigin","parent","MAX_ZOOM_LEVEL","KEYS","ReactImageLightbox","_Component","instance","_classCallCheck","_possibleConstructorReturn","isClosing","animationDisabled","shouldAnimate","zoomLevel","offsetX","offsetY","loadErrorStatus","outerEl","zoomInBtn","zoomOutBtn","caption","closeIfClickInner","handleImageDoubleClick","handleImageMouseWheel","handleKeyInput","handleMouseUp","handleMouseDown","handleMouseMove","handleOuterMousewheel","handleTouchStart","handleTouchMove","handleTouchEnd","handlePointerEvent","handleCaptionMousewheel","handleWindowResize","handleZoomInButtonClick","handleZoomOutButtonClick","requestClose","requestMoveNext","requestMovePrev","subClass","superClass","_inherits","mouseEvent","touchPointer","identifier","pointerEvent","pointerId","_ref","_ref$x","_ref$y","_ref$zoom","zoom","targetWidth","nextX","windowWidth","scaleFactor","transform","timeouts","currentAction","eventsSource","pointerList","preventInnerClose","preventInnerCloseTimeout","keyPressed","imageCache","lastKeyDownTime","resizeTimeout","wheelActionTimeout","resetScrollTimeout","scrollX","scrollY","moveStartX","moveStartY","moveStartOffsetX","moveStartOffsetY","swipeStartX","swipeStartY","swipeEndX","swipeEndY","pinchTouchList","pinchDistance","keyCounter","moveRequested","_this2","windowContext","resize","mouseup","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel","handleWheel","passive","loadAllImages","_this3","sourcesChanged","prevSrcDict","nextSrcDict","getSrcTypes","srcType","_this4","didUnmount","tid","_setTimeout","_x","_x2","func","_this5","_this6","imageSrc","fitSizes","isImageLoaded","getFitSizes","targetHeight","stretch","boxSize","getLightboxRect","currentImageInfo","getBestImageForType","maxX","minX","maxY","minY","zoomMultiplier","getZoomMultiplier","keyEnding","pow","right","_clearTimeout","_x3","enableZoom","nextZoomLevel","imageBaseSize","currentZoomMultiplier","nextZoomMultiplier","boxRect","pointerX","pointerY","currentImageOffsetX","currentImageOffsetY","nextImageRealOffsetX","nextImageRealOffsetY","nextOffsetX","nextOffsetY","maxOffsets","getMaxOffsets","isAnimating","which","keyRepeatLimit","keyRepeatKeyupBonus","_this7","deltaY","abs","deltaX","changeZoom","newOffsetY","newOffsetX","filterPointersBySource","pointer","_ref2","_this8","_ref3","shouldHandleEvent","isTargetMatchImage","addPointer","parseMouseEvent","multiPointerStart","multiPointerMove","removePointer","multiPointerEnd","parsePointerEvent","_this9","changedTouches","eventTouch","parseTouchPointer","_this10","touch","handleSwipeStart","handleMoveStart","handleEnd","decideMoveOrSwipe","handlePinchStart","handleMove","handleSwipe","handlePinch","setPreventInnerClose","handleMoveEnd","handleSwipeEnd","handlePinchEnd","_ref4","_ref5","_this11","animationDuration","_ref6","_ref7","xDiff","xDiffAbs","yDiffAbs","_ref8","_ref9","sqrt","_ref10","_ref11","_ref12","calculatePinchDistance","oldPointer","newDistance","_this$calculatePinchC","calculatePinchCenter","forceUpdate","_this$caption$current2","_this12","inMemoryImage","Image","imageCrossOrigin","crossOrigin","errorEvent","onImageLoadError","onImageLoad","_this13","generateLoadDoneCallback","loadImage","_this14","closeLightbox","animationOnKeyInput","direction","_this15","requestMove","_this16","_this$props","clickOutsideToClose","discourageDownloads","toolbarButtons","reactModalStyle","_onAfterOpen","onAfterOpen","reactModalProps","_this$state","transitionStyle","transition","keyEndings","_ref13","images","addImage","imageClass","transforms","bestImageInfo","imageStyle","getTransform","cursor","createElement","backgroundImage","onDoubleClick","onWheel","loadingIcon","_","modalStyle","overlay","border","borderRadius","Modal","onRequestClose","contentLabel","appElement","body","wrapperClassName","animationDirection","onTouchStart","onTouchMove","onKeyUp","propTypes","PropTypes","string","isRequired","mainSrcThumbnail","prevSrcThumbnail","nextSrcThumbnail","bool","number","arrayOf","shape","CopyMoveDirentProgressDialog","progressStyle","lineHeight","TreeNodeView","isShowOperationMenu","isHighlight","onLoadToggle","onNodeDragStart","onNodeDragEnter","isNodeDropShow","onNodeDragMove","onNodeDragLeave","onNodeDrop","getNodeTypeAndIcon","suffix","calculateMenuList","RENAME","OPEN_VIA_CLIENT","renderChildren","paddingLeft","hasChildren","hlClass","TreeView","dragStartNodeData","isTreeViewDropTipShow","dropNodeData","parseuri","loc","createDebug","namespace","prevTime","enabled","curr","ms","diff","coerce","formatter","formatters","val","formatArgs","logFn","log","console","useColors","colors","selectColor","init","instances","stack","disable","enable","namespaces","skips","humanize","s","h","d","plural","ceil","isNaN","long","fmtShort","_deconstructPacket","_placeholder","newData","_reconstructPacket","packetData","pendingBlobs","_removeBlobs","curKey","containingObject","fileReader","transports","transportOptions","writeBuffer","prevBufferLen","policyPort","rememberUpgrade","onlyBinaryUpgrades","perMessageDeflate","threshold","product","upgrades","pingInterval","pingTimeout","pingIntervalTimer","pingTimeoutTimer","priorWebsocketSuccess","createTransport","EIO","transport","requestTimeout","protocols","setTransport","onDrain","probe","onTransportOpen","upgradeLosesBinary","upgrading","flush","freezeTransport","onTransportClose","onupgrade","onHandshake","setPing","code","filterUpgrades","onHeartbeat","sendPacket","waitForUpgrade","cleanupAndClose","filteredUpgrades","j","empty","Request","async","sendXhr","pollXhr","xhr","setDisableHeaderCheck","setRequestHeader","hasXDR","onLoad","responseText","onreadystatechange","contentType","getResponseHeader","requestsCount","requests","onSuccess","fromError","abort","attachEvent","unloadHandler","arraybuffer","end","bytes","abv","ii","count","err_cb","bail","proxy","byteArray","byteCount","byteIndex","stringFromCharCode","ucs2decode","extra","output","counter","checkScalarValue","codePoint","toUpperCase","createByte","encodeCodePoint","symbol","readContinuationByte","continuationByte","decodeSymbol","byte1","version","codePoints","byteString","tmp","array","ucs2encode","chars","encoded1","encoded2","encoded3","encoded4","bufferLength","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","getBlob","mapArrayBufferViews","chunk","set","byteOffset","BlobBuilderConstructor","bb","part","BlobConstructor","JSONPPolling","rNewline","rEscapedNewline","___eio","script","removeChild","form","iframe","insertAt","getElementsByTagName","insertBefore","head","appendChild","area","iframeId","complete","initIframe","BrowserWebSocket","NodeWebSocket","WebSocket","MozWebSocket","WebSocketImpl","WS","usingBrowserWebSocket","ws","supports","addEventListeners","onmessage","factor","rand","random","deviation","dispatchGlobalEvent","eventName","CustomEvent","createEvent","initCustomEvent","dispatchEvent","store","prop","Boolean","r","storage","DEBUG","lastC","removeItem","WebkitAppearance","firebug","exception","chrome","local","localStorage","localstorage"],"mappings":"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","file":"static/js/app.chunk.js","sourcesContent":["\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Remove event specific arrays for event types that no\r\n  // one is subscribed for to avoid memory leak.\r\n  if (callbacks.length === 0) {\r\n    delete this._callbacks['$' + event];\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  var args = new Array(arguments.length - 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args[i - 1] = arguments[i];\r\n  }\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","/**\n * Module dependencies.\n */\n\nvar keys = require('./keys');\nvar hasBinary = require('has-binary2');\nvar sliceBuffer = require('arraybuffer.slice');\nvar after = require('after');\nvar utf8 = require('./utf8');\n\nvar base64encoder;\nif (typeof ArrayBuffer !== 'undefined') {\n  base64encoder = require('base64-arraybuffer');\n}\n\n/**\n * Check if we are running an android browser. That requires us to use\n * ArrayBuffer with polling transports...\n *\n * http://ghinda.net/jpeg-blob-ajax-android/\n */\n\nvar isAndroid = typeof navigator !== 'undefined' && /Android/i.test(navigator.userAgent);\n\n/**\n * Check if we are running in PhantomJS.\n * Uploading a Blob with PhantomJS does not work correctly, as reported here:\n * https://github.com/ariya/phantomjs/issues/11395\n * @type boolean\n */\nvar isPhantomJS = typeof navigator !== 'undefined' && /PhantomJS/i.test(navigator.userAgent);\n\n/**\n * When true, avoids using Blobs to encode payloads.\n * @type boolean\n */\nvar dontSendBlobs = isAndroid || isPhantomJS;\n\n/**\n * Current protocol version.\n */\n\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Create a blob api even for blob builder when vendor prefixes exist\n */\n\nvar Blob = require('blob');\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = false;\n  }\n\n  if (typeof utf8encode === 'function') {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  var data = (packet.data === undefined)\n    ? undefined\n    : packet.data.buffer || packet.data;\n\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  } else if (typeof Blob !== 'undefined' && data instanceof Blob) {\n    return encodeBlob(packet, supportsBinary, callback);\n  }\n\n  // might be an object with { base64: true, data: dataAsBase64String }\n  if (data && data.base64) {\n    return encodeBase64Object(packet, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data), { strict: false }) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n\n};\n\nfunction encodeBase64Object(packet, callback) {\n  // packet data is an object { base64: true, data: dataAsBase64String }\n  var message = 'b' + exports.packets[packet.type] + packet.data.data;\n  return callback(message);\n}\n\n/**\n * Encode packet helpers for binary types\n */\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var data = packet.data;\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Uint8Array(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++) {\n    resultBuffer[i+1] = contentArray[i];\n  }\n\n  return callback(resultBuffer.buffer);\n}\n\nfunction encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var fr = new FileReader();\n  fr.onload = function() {\n    exports.encodePacket({ type: packet.type, data: fr.result }, supportsBinary, true, callback);\n  };\n  return fr.readAsArrayBuffer(packet.data);\n}\n\nfunction encodeBlob(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  if (dontSendBlobs) {\n    return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  var length = new Uint8Array(1);\n  length[0] = packets[packet.type];\n  var blob = new Blob([length.buffer, packet.data]);\n\n  return callback(blob);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback) {\n  var message = 'b' + exports.packets[packet.type];\n  if (typeof Blob !== 'undefined' && packet.data instanceof Blob) {\n    var fr = new FileReader();\n    fr.onload = function() {\n      var b64 = fr.result.split(',')[1];\n      callback(message + b64);\n    };\n    return fr.readAsDataURL(packet.data);\n  }\n\n  var b64data;\n  try {\n    b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));\n  } catch (e) {\n    // iPhone Safari doesn't let you apply with typed arrays\n    var typed = new Uint8Array(packet.data);\n    var basic = new Array(typed.length);\n    for (var i = 0; i < typed.length; i++) {\n      basic[i] = typed[i];\n    }\n    b64data = String.fromCharCode.apply(null, basic);\n  }\n  message += btoa(b64data);\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Changes format to Blob if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  if (data === undefined) {\n    return err;\n  }\n  // String data\n  if (typeof data === 'string') {\n    if (data.charAt(0) === 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    if (utf8decode) {\n      data = tryDecode(data);\n      if (data === false) {\n        return err;\n      }\n    }\n    var type = data.charAt(0);\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  var asArray = new Uint8Array(data);\n  var type = asArray[0];\n  var rest = sliceBuffer(data, 1);\n  if (Blob && binaryType === 'blob') {\n    rest = new Blob([rest]);\n  }\n  return { type: packetslist[type], data: rest };\n};\n\nfunction tryDecode(data) {\n  try {\n    data = utf8.decode(data, { strict: false });\n  } catch (e) {\n    return false;\n  }\n  return data;\n}\n\n/**\n * Decodes a packet encoded in a base64 string\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  if (!base64encoder) {\n    return { type: type, data: { base64: true, data: msg.substr(1) } };\n  }\n\n  var data = base64encoder.decode(msg.substr(1));\n\n  if (binaryType === 'blob' && Blob) {\n    data = new Blob([data]);\n  }\n\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  var isBinary = hasBinary(packets);\n\n  if (supportsBinary && isBinary) {\n    if (Blob && !dontSendBlobs) {\n      return exports.encodePayloadAsBlob(packets, callback);\n    }\n\n    return exports.encodePayloadAsArrayBuffer(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, !isBinary ? false : supportsBinary, false, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if (typeof data !== 'string') {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data === '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = '', n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (chr !== ':') {\n      length += chr;\n      continue;\n    }\n\n    if (length === '' || (length != (n = Number(length)))) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    msg = data.substr(i + 1, n);\n\n    if (length != msg.length) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    if (msg.length) {\n      packet = exports.decodePacket(msg, binaryType, false);\n\n      if (err.type === packet.type && err.data === packet.data) {\n        // parser error in individual packet - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      var ret = callback(packet, i + n, l);\n      if (false === ret) return;\n    }\n\n    // advance cursor\n    i += n;\n    length = '';\n  }\n\n  if (length !== '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {ArrayBuffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsArrayBuffer = function(packets, callback) {\n  if (!packets.length) {\n    return callback(new ArrayBuffer(0));\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(data) {\n      return doneCallback(null, data);\n    });\n  }\n\n  map(packets, encodeOne, function(err, encodedPackets) {\n    var totalLength = encodedPackets.reduce(function(acc, p) {\n      var len;\n      if (typeof p === 'string'){\n        len = p.length;\n      } else {\n        len = p.byteLength;\n      }\n      return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2\n    }, 0);\n\n    var resultArray = new Uint8Array(totalLength);\n\n    var bufferIndex = 0;\n    encodedPackets.forEach(function(p) {\n      var isString = typeof p === 'string';\n      var ab = p;\n      if (isString) {\n        var view = new Uint8Array(p.length);\n        for (var i = 0; i < p.length; i++) {\n          view[i] = p.charCodeAt(i);\n        }\n        ab = view.buffer;\n      }\n\n      if (isString) { // not true binary\n        resultArray[bufferIndex++] = 0;\n      } else { // true binary\n        resultArray[bufferIndex++] = 1;\n      }\n\n      var lenStr = ab.byteLength.toString();\n      for (var i = 0; i < lenStr.length; i++) {\n        resultArray[bufferIndex++] = parseInt(lenStr[i]);\n      }\n      resultArray[bufferIndex++] = 255;\n\n      var view = new Uint8Array(ab);\n      for (var i = 0; i < view.length; i++) {\n        resultArray[bufferIndex++] = view[i];\n      }\n    });\n\n    return callback(resultArray.buffer);\n  });\n};\n\n/**\n * Encode as Blob\n */\n\nexports.encodePayloadAsBlob = function(packets, callback) {\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(encoded) {\n      var binaryIdentifier = new Uint8Array(1);\n      binaryIdentifier[0] = 1;\n      if (typeof encoded === 'string') {\n        var view = new Uint8Array(encoded.length);\n        for (var i = 0; i < encoded.length; i++) {\n          view[i] = encoded.charCodeAt(i);\n        }\n        encoded = view.buffer;\n        binaryIdentifier[0] = 0;\n      }\n\n      var len = (encoded instanceof ArrayBuffer)\n        ? encoded.byteLength\n        : encoded.size;\n\n      var lenStr = len.toString();\n      var lengthAry = new Uint8Array(lenStr.length + 1);\n      for (var i = 0; i < lenStr.length; i++) {\n        lengthAry[i] = parseInt(lenStr[i]);\n      }\n      lengthAry[lenStr.length] = 255;\n\n      if (Blob) {\n        var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);\n        doneCallback(null, blob);\n      }\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(new Blob(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n *\n * @param {ArrayBuffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  while (bufferTail.byteLength > 0) {\n    var tailArray = new Uint8Array(bufferTail);\n    var isString = tailArray[0] === 0;\n    var msgLength = '';\n\n    for (var i = 1; ; i++) {\n      if (tailArray[i] === 255) break;\n\n      // 310 = char length of Number.MAX_VALUE\n      if (msgLength.length > 310) {\n        return callback(err, 0, 1);\n      }\n\n      msgLength += tailArray[i];\n    }\n\n    bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);\n    msgLength = parseInt(msgLength);\n\n    var msg = sliceBuffer(bufferTail, 0, msgLength);\n    if (isString) {\n      try {\n        msg = String.fromCharCode.apply(null, new Uint8Array(msg));\n      } catch (e) {\n        // iPhone Safari doesn't let you apply to typed arrays\n        var typed = new Uint8Array(msg);\n        msg = '';\n        for (var i = 0; i < typed.length; i++) {\n          msg += String.fromCharCode(typed[i]);\n        }\n      }\n    }\n\n    buffers.push(msg);\n    bufferTail = sliceBuffer(bufferTail, msgLength);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport RepoTag from '../../models/repo-tag';\nimport CreateTagDialog from './create-tag-dialog';\nimport toaster from '../toast';\nrequire('../../css/repo-tag.css');\n\nconst TagItemPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoTag: PropTypes.object.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass TagItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isTagHighlighted: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      isTagHighlighted: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      isTagHighlighted: false\n    });\n  }\n\n  getRepoTagIdList = () => {\n    let repoTagIdList = [];\n    let fileTagList = this.props.fileTagList;\n    repoTagIdList = fileTagList.map((fileTag) => fileTag.repo_tag_id);\n    return repoTagIdList;\n  }\n\n  onEditFileTag = () => {\n    let { repoID, repoTag, filePath } = this.props;\n    let repoTagIdList = this.getRepoTagIdList();\n    if (repoTagIdList.indexOf(repoTag.id) === -1) {\n      let id = repoTag.id;\n      seafileAPI.addFileTag(repoID, filePath, id).then(() => {\n        repoTagIdList = this.getRepoTagIdList();\n        this.props.onFileTagChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      let fileTag = null;\n      let fileTagList = this.props.fileTagList;\n      for(let i = 0; i < fileTagList.length; i++) {\n        if (fileTagList[i].repo_tag_id === repoTag.id) {\n          fileTag = fileTagList[i];\n          break;\n        }\n      }\n      seafileAPI.deleteFileTag(repoID, fileTag.id).then(() => {\n        repoTagIdList = this.getRepoTagIdList();\n        this.props.onFileTagChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  render() {\n    const { isTagHighlighted } = this.state;\n    const { repoTag } = this.props;\n    const repoTagIdList = this.getRepoTagIdList();\n    const isTagSelected = repoTagIdList.indexOf(repoTag.id) != -1;\n    return (\n      <li\n        className={`tag-list-item cursor-pointer px-4 d-flex justify-content-between align-items-center ${isTagHighlighted ? 'hl' : ''}`}\n        onClick={this.onEditFileTag}\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n      >\n        <div className=\"d-flex align-items-center\">\n          <span className=\"tag-color w-4 h-4 rounded-circle\" style={{backgroundColor: repoTag.color}}></span>\n          <span className=\"tag-name mx-2\">{repoTag.name}</span>\n        </div>\n        {isTagSelected && <i className=\"fas fa-check tag-selected-icon\"></i>}\n      </li>\n    );\n  }\n\n}\n\nTagItem.propTypes = TagItemPropTypes;\n\nconst TagListPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  createNewTag: PropTypes.func.isRequired,\n};\n\nclass TagList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repotagList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.getRepoTagList();\n  }\n\n  getRepoTagList = () => {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let repotagList = [];\n      res.data.repo_tags.forEach(item => {\n        let repoTag = new RepoTag(item);\n        repotagList.push(repoTag);\n      });\n      this.setState({repotagList: repotagList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.toggleCancel}>{gettext('Select Tags')}</ModalHeader>\n        <ModalBody className=\"px-0\">\n          <ul className=\"tag-list tag-list-container\">\n            {this.state.repotagList.map((repoTag) => {\n              return (\n                <TagItem\n                  key={repoTag.id}\n                  repoTag={repoTag}\n                  repoID={this.props.repoID}\n                  filePath={this.props.filePath}\n                  fileTagList={this.props.fileTagList}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                />\n              );\n            })}\n          </ul>\n          <a\n            href=\"#\"\n            className=\"add-tag-link px-4 py-2 d-flex align-items-center\"\n            onClick={this.props.createNewTag}\n          >\n            <span className=\"sf2-icon-plus mr-2\"></span>\n            {gettext('Create a new tag')}\n          </a>\n        </ModalBody>\n        <ModalFooter>\n          <Button onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nTagList.propTypes = TagListPropTypes;\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass EditFileTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCreateRepoTagShow: false,\n      isListRepoTagShow: true,\n    };\n  }\n\n  createNewTag = () => {\n    this.setState({\n      isCreateRepoTagShow: !this.state.isCreateRepoTagShow,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n    });\n  }\n\n  onRepoTagCreated = (repoTagID) => {\n    let {repoID, filePath} = this.props;\n    seafileAPI.addFileTag(repoID, filePath, repoTagID).then(() => {\n      this.props.onFileTagChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleCancel}>\n        {this.state.isListRepoTagShow &&\n          <TagList\n            repoID={this.props.repoID}\n            filePath={this.props.filePath}\n            fileTagList={this.props.fileTagList}\n            onFileTagChanged={this.props.onFileTagChanged}\n            toggleCancel={this.props.toggleCancel}\n            createNewTag={this.createNewTag}\n          />\n        }\n        {this.state.isCreateRepoTagShow &&\n          <CreateTagDialog\n            repoID={this.props.repoID}\n            onClose={this.props.toggleCancel}\n            toggleCancel={this.createNewTag}\n            onRepoTagCreated={this.onRepoTagCreated}\n          />\n        }\n      </Modal>\n    );\n  }\n}\n\nEditFileTagDialog.propTypes = propTypes;\n\nexport default EditFileTagDialog;\n","import { MENU_SHOW, MENU_HIDE } from './actions';\nimport { uniqueId, hasOwnProp, canUseDOM } from './helpers';\n\nclass GlobalEventListener {\n\n  constructor() {\n    this.callbacks = {};\n\n    if (canUseDOM) {\n      window.addEventListener(MENU_SHOW, this.handleShowEvent);\n      window.addEventListener(MENU_HIDE, this.handleHideEvent);\n    }\n  }\n\n  handleShowEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].show(event);\n    }\n  }\n\n  handleHideEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].hide(event);\n    }\n  }\n\n  register = (showCallback, hideCallback) => {\n    const id = uniqueId();\n\n    this.callbacks[id] = {\n      show: showCallback,\n      hide: hideCallback\n    };\n\n    return id;\n  }\n\n  unregister = (id) => {\n    if (id && this.callbacks[id]) {\n      delete this.callbacks[id];\n    }\n  }\n}\n\nexport default new GlobalEventListener();\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from './globalEventListener';\nimport { hideMenu } from './actions';\nimport { callIfExists } from './helpers';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  rtl: PropTypes.bool,\n  onMenuItemClick: PropTypes.func.isRequired,\n  onShowMenu: PropTypes.func,\n  onHideMenu: PropTypes.func,\n};\n\nclass ContextMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      x: 0,\n      y: 0,\n      isVisible: false,\n      currentObject: null,\n      menuList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.listenId = listener.register(this.handleShow, this.handleHide);\n  }\n\n  componentDidUpdate () {\n    if (this.state.isVisible) {\n      const wrapper = window.requestAnimationFrame || setTimeout;\n\n      wrapper(() => {\n        const { x, y } = this.state;\n        const { top, left } = this.props.rtl ? this.getRTLMenuPosition(x, y) : this.getMenuPosition(x, y);\n\n        wrapper(() => {\n          if (!this.menu) return;\n          this.menu.style.top = `${top}px`;\n          this.menu.style.left = `${left}px`;\n          this.menu.style.opacity = 1;\n          this.menu.style.pointerEvents = 'auto';\n        });\n      });\n    } else {\n      if (!this.menu) return;\n      this.menu.style.opacity = 0;\n      this.menu.style.pointerEvents = 'none';\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.listenId) {\n      listener.unregister(this.listenId);\n    }\n\n    this.unregisterHandlers();\n  }\n\n  registerHandlers = () => {\n    document.addEventListener('mousedown', this.handleOutsideClick);\n    document.addEventListener('touchstart', this.handleOutsideClick);\n    document.addEventListener('scroll', this.handleHide);\n    document.addEventListener('contextmenu', this.handleHide);\n    document.addEventListener('keydown', this.handleKeyNavigation);\n    window.addEventListener('resize', this.handleHide);\n  }\n\n  unregisterHandlers = () => {\n    document.removeEventListener('mousedown', this.handleOutsideClick);\n    document.removeEventListener('touchstart', this.handleOutsideClick);\n    document.removeEventListener('scroll', this.handleHide);\n    document.removeEventListener('contextmenu', this.handleHide);\n    document.removeEventListener('keydown', this.handleKeyNavigation);\n    window.removeEventListener('resize', this.handleHide);\n  }\n\n  handleShow = (e) => {\n    if (e.detail.id !== this.props.id || this.state.isVisible) return;\n\n    const { x, y } = e.detail.position;\n    const { currentObject, menuList} = e.detail;\n\n    this.setState({ isVisible: true, x, y, currentObject, menuList });\n    this.registerHandlers();\n    callIfExists(this.props.onShowMenu, e);\n  }\n\n  handleHide = (e) => {\n    if (this.state.isVisible && (!e.detail || !e.detail.id || e.detail.id === this.props.id)) {\n      this.unregisterHandlers();\n      this.setState({ isVisible: false});\n      callIfExists(this.props.onHideMenu, e);\n    }\n  }\n\n  handleOutsideClick = (e) => {\n    if (!this.menu.contains(e.target)) hideMenu();\n  }\n\n  handleMouseLeave = (event) => {\n    event.preventDefault();\n\n    if (this.props.hideOnLeave) hideMenu();\n  }\n\n  handleContextMenu = (e) => {\n    this.handleHide(e);\n  }\n\n  handleKeyNavigation = (e) => {\n    if (this.state.isVisible === false) {\n      return;\n    }\n    e.preventDefault();\n    this.hideMenu(e);\n  }\n\n  hideMenu = (e) => {\n    if (e.keyCode === 27 || e.keyCode === 13) { // ECS or enter\n      hideMenu();\n    }\n  }\n\n  getMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (x + rect.width > innerWidth) {\n      menuStyles.left -= rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n  getRTLMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    // Try to position the menu on the left side of the cursor\n    menuStyles.left = x - rect.width;\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left += rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left + rect.width > innerWidth) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n\n  onMenuItemClick = (event) => {\n    event.stopPropagation();\n    let operation = Utils.getEventData(event, 'operation');\n    let currentObject = this.state.currentObject;\n    this.props.onMenuItemClick(operation, currentObject, event);\n  }\n\n  onContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  render() {\n    const inlineStyle = { position: 'fixed', opacity: 0, pointerEvents: 'none', display: 'block' };\n    return (\n      <div role=\"menu\" className=\"seafile-contextmenu dropdown-menu\" style={inlineStyle} ref={menu => { this.menu = menu; }}>\n        {this.state.menuList.map((menuItem, index) => {\n          if (menuItem === 'Divider') {\n            return <div key={index} className=\"seafile-divider dropdown-divider\"></div>;\n          } else {\n            return (\n              <button\n                key={index}\n                className=\"seafile-contextmenu-item dropdown-item\"\n                data-operation={menuItem.key}\n                onClick={this.onMenuItemClick}\n                onContextMenu={this.onContextMenu}\n              >\n                {menuItem.value}\n              </button>\n            );\n          }\n        })}\n      </div>\n    );\n  }\n}\n\nContextMenu.propTypes = propTypes;\n\nexport default ContextMenu;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  addFolderCancel: PropTypes.func.isRequired,\n};\n\nclass CreateForder extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      parentPath: '',\n      childName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0,0);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({childName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n\n    let newName = this.state.childName;\n    let isDuplicated = this.checkDuplicatedName();\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      this.props.onAddFolder(path);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.addFolderCancel();\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Folder')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"folderName\">{gettext('Name')}</Label>\n              <Input\n                id=\"folderName\"\n                value={this.state.childName}\n                innerRef={input => {this.newInput = input;}}\n                onKeyPress={this.handleKeyPress}\n                onChange={this.handleChange}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateForder.propTypes = propTypes;\n\nexport default CreateForder;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext, fileServerRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\n\nconst propTypes = {\n  token: PropTypes.string,\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string,\n  target: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.array\n  ]),\n  toggleDialog: PropTypes.func.isRequired\n};\n\nlet interval;\n\nclass ZipDownloadDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      zipProgress: null\n    };\n  }\n\n  componentDidMount() {\n    const { token, path, repoID, target } = this.props;\n    let getZipTask;\n    if (token) {\n      getZipTask = target.length ?\n        seafileAPI.getShareLinkDirentsZipTask(token, path, target) :\n        seafileAPI.getShareLinkZipTask(token, path);\n    } else {\n      getZipTask = seafileAPI.zipDownload(repoID, path, target);\n    }\n    getZipTask.then((res) => {\n      const zipToken = res.data['zip_token'];\n      this.setState({\n        isLoading: false,\n        errorMsg: '',\n        zipToken: zipToken\n      });\n      this.queryZipProgress();\n      interval = setInterval(this.queryZipProgress, 1000);\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  queryZipProgress = () => {\n    const zipToken = this.state.zipToken;\n    seafileAPI.queryZipProgress(zipToken).then((res) => {\n      const data = res.data;\n      if (data.failed == 1) {\n        clearInterval(interval);\n        this.setState({\n          isLoading: false,\n          errorMsg: data.failed_reason\n        });\n      } else {\n        this.setState({\n          zipProgress: data.total == 0 ? '100%' : (data.zipped/data.total*100).toFixed(2) + '%'\n        });\n        if (data['total'] == data['zipped']) {\n          clearInterval(interval);\n          this.props.toggleDialog();\n          location.href = `${fileServerRoot}zip/${zipToken}`;\n        }\n      }\n    }).catch((error) => {\n      clearInterval(interval);\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  cancelZipTask = () => {\n    const zipToken = this.state.zipToken;\n    seafileAPI.cancelZipTask(zipToken).then((res) => {\n    // do nothing\n    }).catch((error) => {\n    // do nothing\n    });\n  }\n\n  toggleDialog = () => {\n    const zipProgress = this.state.zipProgress;\n    if (zipProgress && zipProgress != '100%') {\n      clearInterval(interval);\n      this.cancelZipTask();\n    }\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggleDialog}>\n        <ModalHeader toggle={this.toggleDialog}>{gettext('Download')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} />\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const {isLoading, errorMsg, zipProgress} = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return <p className=\"mt-4 text-center\">{`${gettext('Packaging...')} ${zipProgress}`}</p>;\n  }\n}\n\nZipDownloadDialog.propTypes = propTypes;\n\nexport default ZipDownloadDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from '../context-menu/globalEventListener';\nimport { Dropdown, ButtonDropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  tagName: PropTypes.string,\n  item: PropTypes.object.isRequired,\n  toggleClass: PropTypes.string,\n  isHandleContextMenuEvent: PropTypes.bool,\n  getMenuList: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func,\n  unfreezeItem: PropTypes.func,\n};\n\nclass ItemDropdownMenu extends React.Component {\n\n  static defaultProps = {\n    isHandleContextMenuEvent: true,\n    toggleClass: 'sf2-icon-caret-down'\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      menuList: [],\n      isItemMenuShow: false,\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.isHandleContextMenuEvent) {\n      this.listenerId = listener.register(this.onShowMenu, this.onHideMenu);\n    }\n    let { item } = this.props;\n    let menuList = this.props.getMenuList(item);\n    this.setState({menuList: menuList});\n  }\n\n  componentWillReceiveProps(nextProps) {  // for toolbar item operation\n    let { item } = nextProps;\n    if (item.name !== this.props.item.name) {\n      let menuList = this.props.getMenuList(item);\n      this.setState({menuList: menuList});\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.isHandleContextMenuEvent && this.listenerId) {\n      listener.unregister(this.listenerId);\n    }\n  }\n\n  onShowMenu = () => {\n    // nothing todo\n  }\n\n  onHideMenu = () => {\n    if (this.state.isItemMenuShow) {\n      this.setState({isItemMenuShow: false});\n      if (typeof(this.props.unfreezeItem) === 'function') {\n        this.props.unfreezeItem();\n      }\n    }\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onDropdownToggleClick(e);\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.toggleOperationMenu();\n  }\n\n  toggleOperationMenu = () => {\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow && typeof(this.props.freezeItem) === 'function') {\n          this.props.freezeItem();\n        } else if (!this.state.isItemMenuShow && typeof(this.props.unfreezeItem) === 'function') {\n          this.props.unfreezeItem();\n        }\n      }\n    );\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onMenuItemClick = (event) => {\n    let operation = Utils.getEventData(event, 'toggle');\n    let item = this.props.item;\n    this.props.onMenuItemClick(operation, event, item);\n  }\n\n  render() {\n    let menuList = this.state.menuList;\n    let { toggleClass, tagName } = this.props;\n    toggleClass = 'sf-dropdown-toggle ' + toggleClass;\n\n    if (!menuList.length) {\n      return '';\n    }\n\n    if (tagName && tagName === 'button') {\n      return (\n        <ButtonDropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick}>\n          <DropdownToggle\n            className={toggleClass}\n            data-toggle=\"dropdown\"\n            title={gettext('More Operations')}\n            aria-label={gettext('More Operations')}\n            aria-expanded={this.state.isItemMenuShow}\n            onKeyDown={this.onDropdownToggleKeyDown}\n            // onClick={this.onDropdownToggleClick}\n          >\n          </DropdownToggle>\n          <DropdownMenu>\n            {menuList.map((menuItem, index) => {\n              if (menuItem === 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (\n                  <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{menuItem.value}</DropdownItem>\n                );\n              }\n            })}\n          </DropdownMenu>\n        </ButtonDropdown>\n      );\n    }\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick} className=\"vam\">\n        <DropdownToggle\n          tag={tagName || 'i'}\n          role=\"button\"\n          tabIndex=\"0\"\n          className={toggleClass}\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          aria-label={gettext('More Operations')}\n          onKeyDown={this.onDropdownToggleKeyDown}\n          // onClick={this.onDropdownToggleClick}\n        />\n        <DropdownMenu>\n          {menuList.map((menuItem, index) => {\n            if (menuItem === 'Divider') {\n              return <DropdownItem key={index} divider />;\n            } else {\n              return (\n                <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{menuItem.value}</DropdownItem>\n              );\n            }\n          })}\n        </DropdownMenu>\n      </Dropdown>\n    );\n  }\n}\n\nItemDropdownMenu.propTypes = propTypes;\n\nexport default ItemDropdownMenu;\n","/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\n\nexports.encode = function (obj) {\n  var str = '';\n\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (str.length) str += '&';\n      str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n    }\n  }\n\n  return str;\n};\n\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\n\nexports.decode = function(qs){\n  var qry = {};\n  var pairs = qs.split('&');\n  for (var i = 0, l = pairs.length; i < l; i++) {\n    var pair = pairs[i].split('=');\n    qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n  }\n  return qry;\n};\n","\nmodule.exports = function(a, b){\n  var fn = function(){};\n  fn.prototype = b.prototype;\n  a.prototype = new fn;\n  a.prototype.constructor = a;\n};","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nimport Lightbox from '@seafile/react-image-lightbox';\nimport '@seafile/react-image-lightbox/style.css';\n\nconst propTypes = {\n  imageItems: PropTypes.array.isRequired,\n  imageIndex: PropTypes.number.isRequired,\n  closeImagePopup: PropTypes.func.isRequired,\n  moveToPrevImage: PropTypes.func.isRequired,\n  moveToNextImage: PropTypes.func.isRequired\n};\n\nclass ImageDialog extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const imageItems = this.props.imageItems;\n    const imageIndex = this.props.imageIndex;\n    const imageItemsLength = imageItems.length;\n    const imageCaption = imageItemsLength && (\n      <Fragment>\n        <span>{gettext('%curr% of %total%').replace('%curr%', imageIndex + 1).replace('%total%', imageItemsLength)}</span>\n        <br />\n        <a href={imageItems[imageIndex].url} target=\"_blank\">{gettext('Open in New Tab')}</a>\n      </Fragment>\n    );\n\n    return (\n      <Lightbox\n        mainSrc={imageItems[imageIndex].src}\n        imageTitle={imageItems[imageIndex].name}\n        imageCaption={imageCaption}\n        nextSrc={imageItems[(imageIndex + 1) % imageItemsLength].src}\n        prevSrc={imageItems[(imageIndex + imageItemsLength - 1) % imageItemsLength].src}\n        onCloseRequest={this.props.closeImagePopup}\n        onMovePrevRequest={this.props.moveToPrevImage}\n        onMoveNextRequest={this.props.moveToNextImage}\n        imagePadding={70}\n        imageLoadErrorMessage={gettext('The image could not be loaded.')}\n        prevLabel={gettext('Previous (Left arrow key)')}\n        nextLabel={gettext('Next (Right arrow key)')}\n        closeLabel={gettext('Close (Esc)')}\n        zoomInLabel={gettext('Zoom in')}\n        zoomOutLabel={gettext('Zoom out')}\n      />\n    );\n  }\n}\n\nImageDialog.propTypes = propTypes;\n\nexport default ImageDialog;\n","import React from 'react';\nimport { curNoteMsg, curNoteID, siteRoot, gettext } from '../utils/constants';\n\nimport '../css/system-notification.css';\n\nclass SystemNotification extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isClosed: false\n    };\n  }\n\n  close = () => {\n    this.setState({isClosed: true});\n\n    if (navigator.cookieEnabled) {\n      let date = new Date(),\n        cookies = document.cookie.split('; '),\n        infoIDExist = false,\n        newInfoID = curNoteID + '_';\n      date.setTime(date.getTime() + 14*24*60*60*1000);\n      newInfoID += '; expires=' + date.toGMTString() + '; path=' + siteRoot;\n      for (var i = 0, len = cookies.length; i < len; i++) {\n        if (cookies[i].split('=')[0] == 'info_id') {\n          infoIDExist = true;\n          document.cookie = 'info_id=' + cookies[i].split('=')[1] + newInfoID;\n          break;\n        }\n      }\n      if (!infoIDExist) {\n        document.cookie = 'info_id=' + newInfoID;\n      }\n    }\n  }\n\n  render() {\n    if (!curNoteMsg || this.state.isClosed) {\n      return null;\n    }\n\n    return (\n      <div id=\"info-bar\" className=\"d-flex justify-content-between\">\n        <p id=\"info-bar-info\" className=\"m-0\" dangerouslySetInnerHTML={{__html: curNoteMsg}}></p>\n        <button className=\"close sf2-icon-x1\" title={gettext('Close')} aria-label={gettext('Close')} onClick={this.close}></button>\n      </div>\n    );\n  }\n}\n\nexport default SystemNotification;\n","class Group {\n  constructor(object) {\n    this.id= object.id;\n    this.name = object.name;\n    this.owner = object.owner;\n    this.admins = object.admins || [];\n    this.avatar_url = object.avatar_url;\n    this.created_at = object.created_at;\n    this.parent_group_id = object.parent_group_id;\n    this.wiki_enabled = object.wiki_enabled;\n    this.repos = object.repos || [];\n    this.group_quota = object.group_quota;\n    this.group_quota_usage = object.group_quota_usage;\n  }\n}\n\nexport default Group;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport { Badge } from 'reactstrap';\nimport { gettext, siteRoot, canPublishRepo, canAddRepo, canGenerateShareLink, canGenerateUploadLink, canInvitePeople, dtableWebServer, enableOCM, enableOCMViaWebdav } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\nimport Group from '../models/group';\n\nimport { canViewOrg, isDocs, isPro, customNavItems } from '../utils/constants';\n\nconst propTypes = {\n  currentTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  tabItemClick: PropTypes.func.isRequired,\n  draftCounts: PropTypes.number,\n};\n\nclass MainSideNav extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      groupsExtended: false,\n      sharedExtended: false,\n      closeSideBar:false,\n      groupItems: [],\n    };\n\n    this.listHeight = 24; //for caculate tabheight\n    this.groupsHeight = 0;\n    this.adminHeight = 0;\n  }\n\n  grpsExtend = () => {\n    this.setState({\n      groupsExtended: !this.state.groupsExtended,\n    });\n    this.loadGroups();\n  }\n\n  shExtend = () => {\n    this.setState({\n      sharedExtended: !this.state.sharedExtended,\n    });\n  }\n\n  loadGroups = () => {\n    let _this = this;\n    seafileAPI.listGroups().then(res =>{\n      let groupList = res.data.map(item => {\n        let group = new Group(item);\n        return group;\n      });\n\n      this.groupsHeight = (groupList.length + 1) * _this.listHeight;\n      _this.setState({\n        groupItems: groupList.sort((a, b) => {\n          return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        })\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  tabItemClick = (e, param, id) => {\n    if (window.uploader &&\n      window.uploader.isUploadProgressDialogShow &&\n      window.uploader.totalProgress !== 100) {\n      if (!window.confirm(gettext('A file is being uploaded. Are you sure you want to leave this page?'))) {\n        e.preventDefault();\n        return false;\n      }\n      window.uploader.isUploadProgressDialogShow = false;\n    }\n    this.props.tabItemClick(param, id);\n  }\n\n  onDTableClick = () => {\n    let url = dtableWebServer;\n    window.open(url);\n  }\n\n  getActiveClass = (tab) => {\n    return this.props.currentTab === tab ? 'active' : '';\n  }\n\n  renderSharedGroups() {\n    let style = {height: 0};\n    if (this.state.groupsExtended) {\n      style = {height: this.groupsHeight};\n    }\n    return (\n      <ul className={`nav sub-nav nav-pills flex-column grp-list ${this.state.groupsExtended ? 'side-panel-slide' : 'side-panel-slide-up'}`} style={style}>\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'groups/'}  className={`nav-link ellipsis ${this.getActiveClass('groups')}`} onClick={(e) => this.tabItemClick(e, 'groups')}>\n            <span className=\"sharp\" aria-hidden=\"true\">#</span>\n            <span className=\"nav-text\">{gettext('All Groups')}</span>\n          </Link>\n        </li>\n        {this.state.groupItems.map(item => {\n          return (\n            <li key={item.id} className=\"nav-item\">\n              <Link to={siteRoot + 'group/' + item.id + '/'} className={`nav-link ellipsis ${this.getActiveClass(item.name)}`} onClick={(e) => this.tabItemClick(e, item.name, item.id)}>\n                <span className=\"sharp\" aria-hidden=\"true\">#</span>\n                <span className=\"nav-text\">{item.name}</span>\n              </Link>\n            </li>\n          );\n        })}\n      </ul>\n    );\n  }\n\n  renderSharedAdmin() {\n    let height = 0;\n    if (this.state.sharedExtended) {\n      if (!this.adminHeight) {\n        this.adminHeight = 3 * this.listHeight;\n      }\n      height = this.adminHeight;\n    }\n    let style = {height: height};\n\n    let linksNavItem = null;\n    if (canGenerateShareLink) {\n      linksNavItem = (\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-share-links/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-share-links')}`} title={gettext('Links')} onClick={(e) => this.tabItemClick(e, 'share-admin-share-links')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Links')}</span>\n          </Link>\n        </li>\n      );\n    } else if (canGenerateUploadLink) {\n      linksNavItem = (\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-upload-links/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-upload-links')}`} title={gettext('Links')} onClick={(e) => this.tabItemClick(e, 'share-admin-upload-links')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Links')}</span>\n          </Link>\n        </li>\n      );\n    }\n    return (\n      <ul className={`nav sub-nav nav-pills flex-column ${this.state.sharedExtended ? 'side-panel-slide' : 'side-panel-slide-up'}`} style={style} >\n        {canAddRepo && (\n          <li className=\"nav-item\">\n            <Link to={siteRoot + 'share-admin-libs/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-libs')}`} title={gettext('Libraries')} onClick={(e) => this.tabItemClick(e, 'share-admin-libs')}>\n              <span aria-hidden=\"true\" className=\"sharp\">#</span>\n              <span className=\"nav-text\">{gettext('Libraries')}</span>\n            </Link>\n          </li>\n        )}\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-folders/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-folders')}`} title={gettext('Folders')} onClick={(e) => this.tabItemClick(e, 'share-admin-folders')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Folders')}</span>\n          </Link>\n        </li>\n        {linksNavItem}\n      </ul>\n    );\n  }\n\n  renderCustomNavItems() {\n    return (\n      customNavItems.map((item, idx) => {\n        return (\n          <li key={idx} className=\"nav-item\">\n            <a href={item.link} className=\"nav-link ellipsis\" title={item.desc}>\n              <span className={item.icon} aria-hidden=\"true\"></span>\n              <span className=\"nav-text\">{item.desc}</span>\n            </a>\n          </li>\n        );\n      })\n    );\n  }\n\n  render() {\n    let showActivity = isDocs || isPro;\n    return (\n      <div className=\"side-nav\">\n        <div className=\"side-nav-con\">\n          <h3 className=\"sf-heading\">{gettext('Files')}</h3>\n          <ul className=\"nav nav-pills flex-column nav-container\">\n            {canAddRepo && (\n              <li className=\"nav-item\">\n                <Link to={ siteRoot + 'my-libs/' } className={`nav-link ellipsis ${this.getActiveClass('my-libs') || this.getActiveClass('deleted') }`} title={gettext('My Libraries')} onClick={(e) => this.tabItemClick(e, 'my-libs')}>\n                  <span className=\"sf2-icon-user\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('My Libraries')}</span>\n                </Link>\n              </li>\n            )}\n            <li className=\"nav-item\">\n              <Link to={siteRoot + 'shared-libs/'} className={`nav-link ellipsis ${this.getActiveClass('shared-libs')}`} title={gettext('Shared with me')} onClick={(e) => this.tabItemClick(e, 'shared-libs')}>\n                <span className=\"sf2-icon-share\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Shared with me')}</span>\n              </Link>\n            </li>\n            { canViewOrg &&\n              <li className=\"nav-item\" onClick={(e) => this.tabItemClick(e, 'org')}>\n                <Link to={ siteRoot + 'org/' } className={`nav-link ellipsis ${this.getActiveClass('org')}`} title={gettext('Shared with all')}>\n                  <span className=\"sf2-icon-organization\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared with all')}</span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item flex-column\" id=\"group-nav\">\n              <a className=\"nav-link ellipsis\" title={gettext('Shared with groups')} onClick={this.grpsExtend}>\n                <span className=\"sf2-icon-group\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Shared with groups')}</span>\n                <span className={`toggle-icon fas ${this.state.groupsExtended ?'fa-caret-down':'fa-caret-left'}`} aria-hidden=\"true\"></span>\n              </a>\n              {this.renderSharedGroups()}\n            </li>\n            {enableOCM &&\n              <li className=\"nav-item\">\n                <Link to={siteRoot + 'shared-with-ocm/'} className={`nav-link ellipsis ${this.getActiveClass('shared-with-ocm')}`} title={gettext('Shared from other servers')} onClick={(e) => this.tabItemClick(e, 'shared-with-ocm')}>\n                  <span className=\"sf3-font-share-from-other-servers sf3-font\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared from other servers')}</span>\n                </Link>\n              </li>\n            }\n            {enableOCMViaWebdav &&\n              <li className=\"nav-item\">\n                <Link to={siteRoot + 'ocm-via-webdav/'} className={`nav-link ellipsis ${this.getActiveClass('ocm-via-webdav')}`} title={gettext('Shared from other servers')} onClick={(e) => this.tabItemClick(e, 'ocm-via-webdav')}>\n                  <span className=\"sf3-font-share-from-other-servers sf3-font\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared from other servers')}</span>\n                </Link>\n              </li>\n            }\n          </ul>\n\n\n          <h3 className=\"sf-heading\">{gettext('Tools')}</h3>\n          <ul className=\"nav nav-pills flex-column nav-container\">\n            <li className=\"nav-item\">\n              <Link className={`nav-link ellipsis ${this.getActiveClass('starred')}`} to={siteRoot + 'starred/'} title={gettext('Favorites')} onClick={(e) => this.tabItemClick(e, 'starred')}>\n                <span className=\"sf2-icon-star\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Favorites')}</span>\n              </Link>\n            </li>\n            {showActivity &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('dashboard')}`} to={siteRoot + 'dashboard/'} title={gettext('Activities')} onClick={(e) => this.tabItemClick(e, 'dashboard')}>\n                  <span className=\"sf2-icon-clock\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Activities')}</span>\n                </Link>\n              </li>\n            }\n            {canPublishRepo &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('published')}`} to={siteRoot + 'published/'} title={gettext('Published Libraries')} onClick={(e) => this.tabItemClick(e, 'published')}>\n                  <span className=\"sf2-icon-wiki-view\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Published Libraries')}</span>\n                </Link>\n              </li>\n            }\n            {isDocs &&\n              <li className=\"nav-item\" onClick={(e) => this.tabItemClick(e, 'drafts')}>\n                <Link className={`nav-link ellipsis ${this.getActiveClass('drafts')}`} to={siteRoot + 'drafts/'} title={gettext('Drafts')}>\n                  <span className=\"sf2-icon-edit\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Drafts')}</span>\n                  {this.props.draftCounts > 0 && <span id=\"draft-num\">{this.props.draftCounts}</span>}\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item\">\n              <Link className={`nav-link ellipsis ${this.getActiveClass('linked-devices')}`} to={siteRoot + 'linked-devices/'} title={gettext('Linked Devices')} onClick={(e) => this.tabItemClick(e, 'linked-devices')}>\n                <span className=\"sf2-icon-monitor\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Linked Devices')}</span>\n              </Link>\n            </li>\n            {canInvitePeople &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('invitations')}`} to={siteRoot + 'invitations/'} title={gettext('Invite Guest')} onClick={(e) => this.tabItemClick(e, 'invitations')}>\n                  <span className=\"sf2-icon-invite\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Invite Guest')}</span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item flex-column\" id=\"share-admin-nav\">\n              <a className=\"nav-link ellipsis\" title={gettext('Share Admin')} onClick={this.shExtend}>\n                <span className=\"sf2-icon-wrench\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Share Admin')}</span>\n                <span className={`toggle-icon fas ${this.state.sharedExtended ? 'fa-caret-down':'fa-caret-left'}`} aria-hidden=\"true\"></span>\n              </a>\n              {this.renderSharedAdmin()}\n            </li>\n            {customNavItems && this.renderCustomNavItems()}\n          </ul>\n        </div>\n\n        {dtableWebServer &&\n          <div className=\"side-nav-link\" onClick={this.onDTableClick}>\n            <span className=\"link-icon icon-left sf3-font sf3-font-dtable-logo\" aria-hidden=\"true\"></span>\n            <span className=\"link-text\">SeaTable</span>\n            <span className=\"link-icon icon-right sf3-font sf3-font-arrow\"></span>\n          </div>\n        }\n      </div>\n    );\n  }\n}\n\nMainSideNav.propTypes = propTypes;\n\nexport default MainSideNav;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext, lang, mediaUrl, logoPath, logoWidth, logoHeight, siteTitle, seafileVersion, additionalAboutDialogLinks, aboutDialogCustomHtml } from '../../utils/constants';\n\nconst propTypes = {\n  onCloseAboutDialog: PropTypes.func.isRequired,\n};\n\nclass AboutDialog extends React.Component {\n\n  renderExternalAboutLinks = () => {\n    if (additionalAboutDialogLinks && (typeof additionalAboutDialogLinks) === 'object') {\n      let keys = Object.keys(additionalAboutDialogLinks);\n      return keys.map((key, index) => {\n        return <a key={index} className=\"d-block\" href={additionalAboutDialogLinks[key]}>{key}</a>;\n      });\n    }\n    return null;\n  }\n\n  render() {\n\n    let href = lang === lang == 'zh-cn' ? 'http://seafile.com/about/' : 'http://seafile.com/en/about/';\n    const { onCloseAboutDialog: toggleDialog } = this.props;\n\n    if (aboutDialogCustomHtml) {\n      return (\n        <Modal isOpen={true} toggle={toggleDialog}>\n          <ModalBody>\n            <button type=\"button\" className=\"close\" onClick={toggleDialog}><span aria-hidden=\"true\">×</span></button>\n            <div className=\"about-content\" dangerouslySetInnerHTML={{__html: aboutDialogCustomHtml}}></div>\n          </ModalBody>\n        </Modal>\n      );\n    } else {\n      return (\n        <Modal isOpen={true} toggle={toggleDialog}>\n          <ModalBody>\n            <button type=\"button\" className=\"close\" onClick={toggleDialog}><span aria-hidden=\"true\">×</span></button>\n            <div className=\"about-content\">\n              <p><img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" /></p>\n              <p>{gettext('Server Version: ')}{seafileVersion}<br />© {(new Date()).getFullYear()} {gettext('Seafile')}</p>\n              <p>{this.renderExternalAboutLinks()}</p>\n              <p><a href={href} target=\"_blank\">{gettext('About Us')}</a></p>\n            </div>\n          </ModalBody>\n        </Modal>\n      );\n    }\n  }\n}\n\nAboutDialog.propTypes = propTypes;\n\nexport default AboutDialog;\n","import React, { Fragment } from 'react';\nimport { gettext, siteRoot, enableTC, sideNavFooterCustomHtml, additionalAppBottomLinks } from '../utils/constants';\nimport ModalPortal from './modal-portal';\nimport AboutDialog from './dialog/about-dialog';\n\nclass SideNavFooter extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isAboutDialogShow: false,\n    };\n  }\n\n  onAboutDialogToggle = (e) => {\n    e.preventDefault();\n    this.setState({isAboutDialogShow: !this.state.isAboutDialogShow});\n  }\n\n  renderExternalAppLinks = () => {\n    if (additionalAppBottomLinks && (typeof additionalAppBottomLinks) === 'object') {\n      let keys = Object.keys(additionalAppBottomLinks);\n      return keys.map((key, index) => {\n        return <a key={index} className=\"item\" href={additionalAppBottomLinks[key]}>{key}</a>;\n      });\n    }\n    return null;\n  }\n\n  render() {\n\n    if (sideNavFooterCustomHtml) {\n      return (<div className='side-nav-footer' dangerouslySetInnerHTML={{__html: sideNavFooterCustomHtml}}></div>);\n    }\n    return (\n      <Fragment>\n        <div className=\"side-nav-footer flex-wrap\">\n          <a href={siteRoot + 'help/'} target=\"_blank\" rel=\"noopener noreferrer\" className=\"item\">{gettext('Help')}</a>\n          <a href=\"#\" className=\"item\" onClick={this.onAboutDialogToggle}>{gettext('About')}</a>\n          {enableTC && <a href={`${siteRoot}terms/`} className=\"item\">{gettext('Terms')}</a>}\n          {this.renderExternalAppLinks()}\n          <a href={siteRoot + 'download_client_program/'} className={`item ${additionalAppBottomLinks ? '' : 'last-item'}`}>\n            <span aria-hidden=\"true\" className=\"sf2-icon-monitor vam\"></span>{' '}\n            <span className=\"vam\">{gettext('Clients')}</span>\n          </a>\n        </div>\n        {this.state.isAboutDialogShow && (\n          <ModalPortal>\n            <AboutDialog onCloseAboutDialog={this.onAboutDialogToggle} />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport default SideNavFooter;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Logo from './logo';\nimport MainSideNav from './main-side-nav';\nimport SideNavFooter from './side-nav-footer';\n\nconst propTypes = {\n  isSidePanelClosed: PropTypes.bool.isRequired,\n  currentTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onCloseSidePanel: PropTypes.func.isRequired,\n  tabItemClick: PropTypes.func.isRequired,\n  draftCounts: PropTypes.number,\n};\n\nclass SidePanel extends React.Component {\n\n  render() {\n    return (\n      <div className={`side-panel ${this.props.isSidePanelClosed ? '' : 'left-zero'}`}>\n        <div className=\"side-panel-north\">\n          <Logo onCloseSidePanel={this.props.onCloseSidePanel}/>\n        </div>\n        <div className=\"side-panel-center\">\n          <MainSideNav tabItemClick={this.props.tabItemClick} currentTab={this.props.currentTab} draftCounts={this.props.draftCounts}/>\n        </div>\n        <div className=\"side-panel-footer\">\n          <SideNavFooter />\n        </div>\n      </div>\n    );\n  }\n}\n\nSidePanel.propTypes = propTypes;\n\nexport default SidePanel;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nconst propTypes = {\n  children: PropTypes.object.isRequired,\n};\n\nclass MainPanel extends Component {\n\n  render() {\n    return (\n      <div className=\"main-panel\">\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nMainPanel.propTypes = propTypes;\n\nexport default MainPanel;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.array,\n    PropTypes.object\n  ]).isRequired,\n};\n\nclass DraftsView extends React.Component {\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\">\n          <div className=\"cur-view-path\">\n            <div className=\"path-container\">\n              <h3 className=\"sf-heading\">{gettext('Drafts')}</h3>\n            </div>\n          </div>\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n\nDraftsView.propTypes = propTypes;\n\nexport default DraftsView;\n","import React from 'react';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, lang } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nmoment.locale(lang);\nconst propTypes = {\n  draft: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onDeleteHandler: PropTypes.func.isRequired,\n  onPublishHandler: PropTypes.func.isRequired,\n};\n\nclass DraftListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMenuIconShow: false,\n      isItemMenuShow: false,\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isMenuIconShow: true,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isMenuIconShow: false,\n        highlight: false,\n      });\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    this.toggleOperationMenu(e);\n  }\n\n  toggleOperationMenu = (e) => {\n    e.stopPropagation();\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow }, () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.setState({\n            highlight: false,\n            isMenuIconShow: false,\n          });\n          this.props.onUnfreezedItem();\n        }\n      }\n    );\n  }\n\n  onDeleteHandler = () => {\n    this.props.onDeleteHandler(this.props.draft);\n  }\n\n  onPublishHandler = () => {\n    this.props.onPublishHandler(this.props.draft);\n  }\n\n  render() {\n    let draft = this.props.draft;\n    let repoID = draft.origin_repo_id;\n    let filePath = draft.draft_file_path;\n    let fileName = Utils.getFileName(filePath);\n    let draftUrl = siteRoot + 'drafts/' + draft.id + '/';\n    let libraryUrl = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(draft.repo_name) + '/' ;\n    let localTime = moment.utc(draft.updated_at).toDate();\n    localTime = moment(localTime).fromNow();\n\n    let iconUrl = Utils.getFileIconUrl(fileName);\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt='' /></td>\n        <td className=\"name\" >\n          <a href={draftUrl} target=\"_blank\">{fileName}</a>\n        </td>\n        <td className=\"library\">\n          <a href={libraryUrl} target=\"_blank\">{draft.repo_name}</a>\n        </td>\n        <td className=\"update\">{localTime}</td>\n        <td className=\"text-center\">\n          {this.state.isMenuIconShow && (\n            <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"fas fa-ellipsis-v attr-action-icon\"\n                title={gettext('More Operations')}\n                onClick={this.onDropdownToggleClick}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isItemMenuShow}\n              />\n              <DropdownMenu>\n                <DropdownItem onClick={this.onDeleteHandler}>{gettext('Delete')}</DropdownItem>\n                {draft.status == 'open' &&\n                  <DropdownItem onClick={this.onPublishHandler}>{gettext('Publish')}</DropdownItem>\n                }\n              </DropdownMenu>\n            </Dropdown>\n          )}\n        </td>\n      </tr>\n    );\n  }\n}\n\nDraftListItem.propTypes = propTypes;\n\nexport default DraftListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport DraftListItem from './draft-list-item';\n\nconst propTypes = {\n  draftList: PropTypes.array.isRequired,\n  onDeleteHandler: PropTypes.func.isRequired,\n  onPublishHandler: PropTypes.func.isRequired,\n};\n\nclass DraftListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  render() {\n    let drafts = this.props.draftList;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th style={{width: '4%'}}>{/*img*/}</th>\n            <th style={{width: '46%'}}>{gettext('Name')}</th>\n            <th style={{width: '30%'}}>{gettext('Library')}</th>\n            <th style={{width: '10%'}}>{gettext('Last Update')}</th>\n            <th style={{width: '10%'}}></th>\n          </tr>\n        </thead>\n        <tbody>\n          { drafts && drafts.map((draft) => {\n            return (\n              <DraftListItem\n                key={draft.id}\n                draft={draft}\n                isItemFreezed={this.state.isItemFreezed}\n                onFreezedItem={this.onFreezedItem}\n                onUnfreezedItem={this.onUnfreezedItem}\n                onDeleteHandler={this.props.onDeleteHandler}\n                onPublishHandler={this.props.onPublishHandler}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nDraftListView.propTypes = propTypes;\n\nexport default DraftListView;\n","import React, { Fragment } from 'react';\nimport { gettext } from '../../utils/constants';\nimport editUtilities from '../../utils/editor-utilities';\nimport { Utils } from '../../utils/utils';\nimport PropTypes from 'prop-types';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport Loading from '../../components/loading';\nimport DraftListView from '../../components/draft-list-view/draft-list-view';\n\nconst propTypes = {\n  isLoadingDraft: PropTypes.bool.isRequired,\n  updateDraftsList: PropTypes.func.isRequired,\n  draftList: PropTypes.array.isRequired,\n  getDrafts: PropTypes.func.isRequired,\n};\n\nclass DraftContent extends React.Component {\n\n  componentDidMount() {\n    this.props.getDrafts();\n  }\n\n  onDeleteHandler = (draft) => {\n    // let draft = this.state.currentDraft;\n    let draft_name = Utils.getFileName(draft.draft_file_path);\n    editUtilities.deleteDraft(draft.id).then(res => {\n      this.props.updateDraftsList(draft.id);\n      let msg_s = gettext('Successfully deleted draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.success(msg_s);\n    }).catch(() => {\n      let msg_s = gettext('Failed to delete draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.danger(msg_s);\n    });\n  }\n\n  onPublishHandler = (draft) => {\n    // let draft = this.state.currentDraft;\n    let draft_name = Utils.getFileName(draft.draft_file_path);\n    editUtilities.publishDraft(draft.id).then(res => {\n      this.props.updateDraftsList(draft.id);\n      let msg_s = gettext('Successfully published draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.success(msg_s);\n    }).catch(() => {\n      let msg_s = gettext('Failed to publish draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.danger(msg_s);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"cur-view-content\">\n        {this.props.isLoadingDraft && <Loading />}\n        {!this.props.isLoadingDraft && (\n          <Fragment>\n            {this.props.draftList.length === 0 && (\n              <EmptyTip>\n                <h2>{gettext('No draft yet')}</h2>\n                <p>{gettext('Draft is a way to let you collaborate with others on files. You can create a draft from a file, edit the draft and then ask for a review. The original file will be updated only after the draft has been reviewed.')}</p>\n              </EmptyTip>\n            )}\n            {this.props.draftList.length !==0 && (\n              <DraftListView\n                draftList={this.props.draftList}\n                onDeleteHandler={this.onDeleteHandler}\n                onPublishHandler={this.onPublishHandler}\n              />\n            )}\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nDraftContent.propTypes = propTypes;\n\nexport default DraftContent;\n","class Acticity {\n  constructor(json) {\n    this.repo_id = json.repo_id;\n    this.repo_name = json.repo_name;\n    this.obj_type = json.obj_type;\n    this.commit_id = json.commit_id;\n    this.path = json.path;\n    this.name = json.name;\n    this.author_email = json.author_email;\n    this.author_name = json.author_name;\n    this.author_contact_email = json.author_contact_email;\n    this.avatar_url = json.avatar_url;\n    this.time = json.time;\n    this.op_type = json.op_type;\n    this.createdFilesCount = 0;\n    this.createdFilesList = [];\n    if (json.op_type === 'clean-up-trash') {\n      this.days = json.days;\n    } else if (json.op_type === 'rename' && json.obj_type === 'repo') {\n      this.old_repo_name = json.old_repo_name;\n    } else if (json.op_type === 'move' && ['dir', 'file'].includes(json.obj_type)) {\n      this.old_path = json.old_path;\n    } else if (json.op_type === 'rename' && ['dir', 'file'].includes(json.obj_type)) {\n      this.old_path = json.old_path;\n      this.old_name = json.old_name;\n    } else if (json.op_type === 'publish') {\n      this.old_path = json.old_path;\n    } else if (json.name.endsWith('(draft).md')) {\n      this.draft_id = json.draft_id;\n    }\n  }\n}\n\nexport default Acticity;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Table } from 'reactstrap';\nimport { gettext, siteRoot, serviceURL } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  activity: PropTypes.object.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n};\n\nclass ListCreatedFileDialog extends React.Component {\n\n  toggle = (activity) => {\n    this.props.toggleCancel(activity);\n  }\n\n  render() {\n    let activity = this.props.activity;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Created Files')}</ModalHeader>\n        <ModalBody>\n          <Table>\n            <thead>\n              <tr>\n                <th width='75%'>{gettext('Name')}</th>\n                <th width='25%'>{gettext('Time')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                activity.createdFilesList.map((item, index) => {\n                  let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n                  if (item.name.endsWith('(draft).md')) {\n                    fileURL = serviceURL + '/drafts/' + item.draft_id + '/';\n                  }\n                  let fileLink = <a href={fileURL} target='_blank'>{item.name}</a>;\n                  if (item.name.endsWith('(draft).md') && !item.draft_id) {\n                    fileLink = item.name;\n                  }\n                  return (\n                    <tr key={index}>\n                      <td>{fileLink}</td>\n                      <td>{moment(item.time).fromNow()}</td>\n                    </tr>\n                  );\n                })\n              }\n            </tbody>\n          </Table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle.bind(this, activity)}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListCreatedFileDialog.propTypes = propTypes;\n\nexport default ListCreatedFileDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, serviceURL } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Activity from '../../models/activity';\nimport ListCreatedFileDialog from '../../components/dialog/list-created-files-dialog';\nimport ModalPortal from '../../components/modal-portal';\n\nimport '../../css/files-activities.css';\n\nmoment.locale(window.app.config.lang);\n\nconst contentPropTypes = {\n  isLoadingMore: PropTypes.bool.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass FileActivitiesContent extends Component {\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    let { items, isLoadingMore } = this.props;\n\n    const desktopThead = (\n      <thead>\n        <tr>\n          <th width=\"8%\">{/* avatar */}</th>\n          <th width=\"15%\">{gettext('User')}</th>\n          <th width=\"20%\">{gettext('Operation')}</th>\n          <th width=\"37%\">{gettext('File')} / {gettext('Library')}</th>\n          <th width=\"20%\">{gettext('Time')}</th>\n        </tr>\n      </thead>\n    );\n\n    const mobileThead = (\n      <thead>\n        <tr>\n          <th width=\"15%\"></th>\n          <th width=\"53%\"></th>\n          <th width=\"32%\"></th>\n        </tr>\n      </thead>\n    );\n\n    return (\n      <Fragment>\n        <table className=\"table-hover table-thead-hidden\">\n          {isDesktop ? desktopThead : mobileThead}\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <ActivityItem\n                  key={index}\n                  isDesktop={isDesktop}\n                  item={item}\n                  index={index}\n                  items={items}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        {isLoadingMore ? <span className=\"loading-icon loading-tip\"></span> : ''}\n      </Fragment>\n    );\n  }\n}\n\nFileActivitiesContent.propTypes = contentPropTypes;\n\nconst activityPropTypes = {\n  item: PropTypes.object.isRequired,\n  index: PropTypes.number.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass ActivityItem extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isListCreatedFiles: false,\n    };\n  }\n\n  onListCreatedFilesToggle = () => {\n    this.setState({\n      isListCreatedFiles: !this.state.isListCreatedFiles,\n    });\n  }\n\n  render() {\n    const isDesktop = this.props.isDesktop;\n    let {item, index, items} = this.props;\n    let op, details, moreDetails = false;\n    let userProfileURL = `${siteRoot}profile/${encodeURIComponent(item.author_email)}/`;\n\n    let libURL = siteRoot + 'library/' + item.repo_id + '/' + encodeURIComponent(item.repo_name) + '/';\n    let libLink = <a href={libURL}>{item.repo_name}</a>;\n    let smallLibLink = <a className=\"small text-secondary\" href={libURL}>{item.repo_name}</a>;\n\n    if (item.obj_type == 'repo') {\n      switch(item.op_type) {\n        case 'create':\n          op = gettext('Created library');\n          details = libLink;\n          break;\n        case 'rename':\n          op = gettext('Renamed library');\n          details = <span>{item.old_repo_name} => {libLink}</span>;\n          break;\n        case 'delete':\n          op = gettext('Deleted library');\n          details = item.repo_name;\n          break;\n        case 'recover':\n          op = gettext('Restored library');\n          details = libLink;\n          break;\n        case 'clean-up-trash':\n          op = gettext('Cleaned trash');\n          if (item.days == 0) {\n            details = gettext('Removed all items from trash.');\n          } else {\n            details = gettext('Removed items older than {n} days from trash.').replace('{n}', item.days);\n          }\n          moreDetails = true;\n          break;\n      }\n    } else if (item.obj_type == 'draft') {\n      let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      let fileLink = <a href={fileURL} target=\"_blank\">{item.name}</a>;\n      op = gettext('Publish draft');\n      details = fileLink;\n      moreDetails = true;\n    } else if (item.obj_type == 'files') {\n      let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      if (item.name.endsWith('(draft).md')) {\n        fileURL = serviceURL + '/drafts/' + item.draft_id + '/';\n      }\n      let fileLink = `<a href=${fileURL} target=\"_blank\">${item.name}</a>`;\n      if (item.name.endsWith('(draft).md') && !item.draft_id) {\n        fileLink = item.name;\n      }\n      let fileCount = item.createdFilesCount - 1;\n      let firstLine = gettext('{file} and {n} other files')\n        .replace('{file}', fileLink)\n        .replace('{n}', fileCount);\n      op = gettext('Created {n} files').replace('{n}', item.createdFilesCount);\n      details = (\n        <Fragment>\n          <p className=\"m-0 d-inline\" dangerouslySetInnerHTML={{__html: firstLine}}></p>\n          {isDesktop && <button type=\"button\" onClick={this.onListCreatedFilesToggle} className=\"activity-details text-secondary ml-2 border-0 p-0 bg-transparent\">{gettext('details')}</button>}\n        </Fragment>\n      );\n      moreDetails = true;\n    } else if (item.obj_type == 'file') {\n      const isDraft = item.name.endsWith('(draft).md');\n      const fileURL = isDraft ? serviceURL + '/drafts/' + item.draft_id + '/' :\n        `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      let fileLink = <a href={fileURL} target=\"_blank\">{item.name}</a>;\n      if (isDraft && !item.draft_id) {\n        fileLink = item.name;\n      }\n      switch (item.op_type) {\n        case 'create':\n          op = isDraft ? gettext('Created draft') : gettext('Created file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n        case 'delete':\n          op = isDraft ? gettext('Deleted draft') : gettext('Deleted file');\n          details = item.name;\n          moreDetails = true;\n          break;\n        case 'recover':\n          op = gettext('Restored file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n        case 'rename':\n          op = gettext('Renamed file');\n          details = <span>{item.old_name} => {fileLink}</span>;\n          moreDetails = true;\n          break;\n        case 'move':\n          const filePathLink = <a href={fileURL}>{item.path}</a>;\n          op = gettext('Moved file');\n          details = <span>{item.old_path} => {filePathLink}</span>;\n          moreDetails = true;\n          break;\n        case 'edit': // update\n          op = isDraft ? gettext('Updated draft') : gettext('Updated file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n      }\n    } else { // dir\n      let dirURL = siteRoot + 'library/' + item.repo_id + '/' + encodeURIComponent(item.repo_name) + Utils.encodePath(item.path);\n      let dirLink = <a href={dirURL} target=\"_blank\">{item.name}</a>;\n      switch (item.op_type) {\n        case 'create':\n          op = gettext('Created folder');\n          details = dirLink;\n          moreDetails = true;\n          break;\n        case 'delete':\n          op = gettext('Deleted folder');\n          details = item.name;\n          moreDetails = true;\n          break;\n        case 'recover':\n          op = gettext('Restored folder');\n          details = dirLink;\n          moreDetails = true;\n          break;\n        case 'rename':\n          op = gettext('Renamed folder');\n          details = <span>{item.old_name} => {dirLink}</span>;\n          moreDetails = true;\n          break;\n        case 'move':\n          const dirPathLink = <a href={dirURL}>{item.path}</a>;\n          op = gettext('Moved folder');\n          details = <span>{item.old_path} => {dirPathLink}</span>;\n          moreDetails = true;\n          break;\n      }\n    }\n\n    let isShowDate = true;\n    if (index > 0) {\n      let lastEventTime = items[index - 1].time;\n      isShowDate = moment(item.time).isSame(lastEventTime, 'day') ? false : true;\n    }\n\n    return (\n      <Fragment>\n        {isShowDate &&\n          <tr>\n            <td colSpan={isDesktop ? 5 : 3} className=\"border-top-0\">{moment(item.time).format('YYYY-MM-DD')}</td>\n          </tr>\n        }\n        {isDesktop ? (\n          <tr>\n            <td className=\"text-center\">\n              <img src={item.avatar_url} alt=\"\" width=\"32\" height=\"32\" className=\"avatar\" />\n            </td>\n            <td>\n              <a href={userProfileURL}>{item.author_name}</a>\n            </td>\n            <td>{op}</td>\n            <td>\n              {details}\n              {moreDetails && <br /> }\n              {moreDetails && smallLibLink}\n            </td>\n            <td className=\"text-secondary\">\n              <time datetime={item.time} is=\"relative-time\" title={moment(item.time).format('llll')}>{moment(item.time).fromNow()}</time>\n            </td>\n          </tr>\n        ) : (\n          <tr>\n            <td className=\"text-center align-top\">\n              <img src={item.avatar_url} alt=\"\" width=\"32\" height=\"32\" className=\"avatar\" />\n            </td>\n            <td>\n              <a href={userProfileURL}>{item.author_name}</a>\n              <p className=\"m-0 text-secondary\">{op}</p>\n              {details}\n            </td>\n            <td className=\"text-right align-top\">\n              <span className=\"text-secondary mobile-activity-time\">\n                <time datetime={item.time} is=\"relative-time\" title={moment(item.time).format('llll')}>{moment(item.time).fromNow()}</time>\n              </span>\n              {moreDetails && <br /> }\n              {moreDetails && libLink}\n            </td>\n          </tr>\n        )}\n        {this.state.isListCreatedFiles &&\n          <ModalPortal>\n            <ListCreatedFileDialog\n              activity={item}\n              toggleCancel={this.onListCreatedFilesToggle}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nActivityItem.propTypes = activityPropTypes;\n\nclass FilesActivities extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isFirstLoading: true,\n      isLoadingMore: false,\n      currentPage: 1,\n      hasMore: true,\n      items: [],\n    };\n    this.avatarSize = 72;\n    this.curPathList = [];\n    this.oldPathList = [];\n  }\n\n  componentDidMount() {\n    let currentPage = this.state.currentPage;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      this.setState({\n        items: events,\n        currentPage: currentPage + 1,\n        isFirstLoading: false,\n        hasMore: true,\n      });\n      if (this.state.items.length < 25) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isFirstLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  mergePublishEvents = (events) => {\n    events.map((item) => {\n      if (item.op_type === 'publish') {\n        this.curPathList.push(item.path);\n        this.oldPathList.push(item.old_path);\n      }\n    });\n    let actuallyEvents = [];\n    for (var i = 0; i < events.length; i++) {\n      if (events[i].obj_type === 'file') {\n        if (events[i].op_type === 'delete' && this.oldPathList.includes(events[i].path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'edit' && this.curPathList.includes(events[i].path)) {\n          this.curPathList.splice(this.curPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'rename' && this.oldPathList.includes(events[i].old_path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].old_path), 1);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      } else {\n        actuallyEvents.push(events[i]);\n      }\n    }\n    return actuallyEvents;\n  }\n\n  mergeFileCreateEvents = (events) => {\n    let actuallyEvents = [];\n    let multiFilesActivity = null;\n    for (var i = 0; i < events.length; i++) {\n      let isFulfilCondition = events[i].obj_type === 'file' &&\n                              events[i].op_type === 'create' &&\n                              events[i + 1] &&\n                              events[i + 1].obj_type === 'file' &&\n                              events[i + 1].op_type === 'create' &&\n                              events[i + 1].repo_name === events[i].repo_name &&\n                              events[i + 1].author_email === events[i].author_email;\n      if (multiFilesActivity != null) {\n        multiFilesActivity.createdFilesCount++;\n        multiFilesActivity.createdFilesList.push(events[i]);\n        if (isFulfilCondition) {\n          continue;\n        } else {\n          actuallyEvents.push(multiFilesActivity);\n          multiFilesActivity = null;\n        }\n      } else {\n        if (isFulfilCondition) {\n          multiFilesActivity = new Activity(events[i]);\n          multiFilesActivity.obj_type = 'files';\n          multiFilesActivity.createdFilesCount++;\n          multiFilesActivity.createdFilesList.push(events[i]);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      }\n    }\n    return actuallyEvents;\n  }\n\n  getMore() {\n    let currentPage = this.state.currentPage;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      this.setState({\n        isLoadingMore: false,\n        items: [...this.state.items, ...events],\n        currentPage: currentPage + 1,\n        hasMore: res.data.events.length === 0 ? false : true\n      });\n      if (this.state.items.length < 25 && this.state.hasMore) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isLoadingMore: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  handleScroll = (event) => {\n    if (!this.state.isLoadingMore && this.state.hasMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.getMore();\n        });\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"activities\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Activities')}</h3>\n          </div>\n          <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n            {this.state.isFirstLoading && <Loading />}\n            {(!this.state.isFirstLoading && this.state.errorMsg) &&\n              <p className=\"error text-center\">{this.state.errorMsg}</p>\n            }\n            {!this.state.isFirstLoading &&\n              <FileActivitiesContent items={this.state.items} isLoadingMore={this.state.isLoadingMore}/>\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default FilesActivities;\n","import React, { Component } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { Link, navigate } from '@reach/router';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, enableVideoThumbnail } from '../../utils/constants';\nimport EmptyTip from '../../components/empty-tip';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\n\nclass Content extends Component {\n\n  render() {\n    const {loading, errorMsg, items} = this.props.data;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No favorites')}</h2>\n          <p>{gettext('You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name.')}</p>\n        </EmptyTip>\n      );\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"40%\">{gettext('Name')}</th>\n            <th width=\"32%\">{gettext('Library')}</th>\n            <th width=\"18%\">{gettext('Last Update')}</th>\n            <th width=\"6%\"></th>\n          </tr>\n        </thead>\n      );\n      const mobileThead = (\n        <thead>\n          <tr>\n            <th width=\"12%\"></th>\n            <th width=\"80%\"></th>\n            <th width=\"8%\"></th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      return items.length ? (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? desktopThead : mobileThead}\n          <TableBody items={items} />\n        </table>\n      ) : emptyTip;\n    }\n  }\n}\n\nclass TableBody extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: this.props.items\n    };\n  }\n\n  componentDidMount() {\n    this.getThumbnails();\n  }\n\n  getThumbnails() {\n    let items = this.state.items.filter((item) => {\n      return (Utils.imageCheck(item.obj_name) || (enableVideoThumbnail && Utils.videoCheck(item.obj_name))) && !item.repo_encrypted;\n    });\n    if (items.length == 0) {\n      return ;\n    }\n\n    const len = items.length;\n    const thumbnailSize = 48;\n    const _this = this;\n    let getThumbnail = function(i) {\n      const curItem = items[i];\n      seafileAPI.createThumbnail(curItem.repo_id, curItem.path, thumbnailSize).then((res) => {\n        curItem.encoded_thumbnail_src = res.data.encoded_thumbnail_src;\n      }).catch((error) => {\n        // do nothing\n      }).then(() => {\n        if (i < len - 1) {\n          getThumbnail(++i);\n        } else {\n          // when done, `setState()`\n          _this.setState({\n            items: _this.state.items\n          });\n        }\n      });\n    };\n    getThumbnail(0);\n  }\n\n  render() {\n\n    let listItems = this.state.items.map(function(item, index) {\n\n      if (item.path === '/') {\n        item.item_icon_url = Utils.getDefaultLibIconUrl(false);\n      } else {\n        item.item_icon_url = item.is_dir ? Utils.getFolderIconUrl(false) : Utils.getFileIconUrl(item.obj_name);\n      }\n\n      item.encoded_path = Utils.encodePath(item.path);\n\n      item.thumbnail_url = item.encoded_thumbnail_src ? `${siteRoot}${item.encoded_thumbnail_src}` : '';\n      item.dirent_view_url = item.is_dir ? `${siteRoot}library/${item.repo_id}/${item.repo_name}${item.encoded_path}` : `${siteRoot}lib/${item.repo_id}/file${item.encoded_path}`;\n\n      item.mtime_relative = moment(item.mtime).fromNow();\n\n\n      return <Item key={index} data={item} />;\n    }, this);\n\n    return (\n      <tbody>{listItems}</tbody>\n    );\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showOpIcon: false,\n      unstarred: false,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      showOpIcon: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      showOpIcon: false\n    });\n  }\n\n  unstar = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n    seafileAPI.unstarItem(data.repo_id, data.path).then((res) => {\n      this.setState({unstarred: true});\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  visitItem = () => {\n    const data = this.props.data;\n    if (data.is_dir) {\n      navigate(data.dirent_view_url);\n    } else {\n      window.open(data.dirent_view_url);\n    }\n  }\n\n  render() {\n\n    if (this.state.unstarred) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    let opClasses = 'sf2-icon-x3 unstar action-icon';\n    opClasses += this.state.showOpIcon ? '' : ' invisible';\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td className=\"text-center\">\n          {\n            data.thumbnail_url ?\n              <img className=\"thumbnail\" src={data.thumbnail_url} alt=\"\" /> :\n              <img src={data.item_icon_url} alt={gettext('icon')} width=\"24\" />\n          }\n        </td>\n        <td>\n          { data.is_dir ?\n            <Link to={data.dirent_view_url}>{data.obj_name}</Link> :\n            <a className=\"normal\" href={data.dirent_view_url} target=\"_blank\">{data.obj_name}</a>\n          }\n        </td>\n        <td>{data.repo_name}</td>\n        <td dangerouslySetInnerHTML={{__html:data.mtime_relative}}></td>\n        <td>\n          <a href=\"#\" role=\"button\" className={opClasses} title={gettext('Unstar')} aria-label={gettext('Unstar')} onClick={this.unstar}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td className=\"text-center\" onClick={this.visitItem}>\n          {\n            data.thumbnail_url ?\n              <img className=\"thumbnail\" src={data.thumbnail_url} alt=\"\" /> :\n              <img src={data.item_icon_url} alt={gettext('icon')} width=\"24\" />\n          }\n        </td>\n        <td onClick={this.visitItem}>\n          { data.is_dir ?\n            <Link to={data.dirent_view_url}>{data.obj_name}</Link> :\n            <a className=\"normal\" href={data.dirent_view_url} target=\"_blank\">{data.obj_name}</a>\n          }\n          <br />\n          <span className=\"item-meta-info\">{data.repo_name}</span>\n          <span className=\"item-meta-info\" dangerouslySetInnerHTML={{__html:data.mtime_relative}}></span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.unstar}>{gettext('Unstar')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return Utils.isDesktop() ? desktopItem : mobileItem;\n  }\n}\n\nclass Starred extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listStarredItems().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.starred_item_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"starred\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Favorites')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content data={this.state} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Starred;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button, FormGroup, Label, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  executeOperation: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ConfirmUnlinkDevice extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isChecked: false\n    };\n  }\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  executeOperation = () => {\n    this.toggle();\n    this.props.executeOperation(this.state.isChecked);\n  }\n\n  onInputChange = (e) => {\n    this.setState({\n      isChecked: e.target.checked\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Unlink device')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to unlink this device?')}</p>\n          <FormGroup check>\n            <Label check>\n              <Input type=\"checkbox\" checked={this.state.isChecked} onChange={this.onInputChange} />\n              <span>{gettext('Delete files from this device the next time it comes online.')}</span>\n            </Label>\n          </FormGroup>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.executeOperation}>{gettext('Unlink')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nConfirmUnlinkDevice.propTypes = propTypes;\n\nexport default ConfirmUnlinkDevice;\n","import React, { Component } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport ConfirmUnlinkDeviceDialog from '../../components/dialog/confirm-unlink-device';\nimport { Utils } from '../../utils/utils';\n\nclass Content extends Component {\n\n  render() {\n    const {loading, errorMsg, items} = this.props.data;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No linked devices')}</h2>\n          <p>{gettext('You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably.')}</p>\n        </EmptyTip>\n      );\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"13%\">{gettext('Platform')}</th>\n            <th width=\"30%\">{gettext('Device Name')}</th>\n            <th width=\"30%\">{gettext('IP')}</th>\n            <th width=\"17%\">{gettext('Last Access')}</th>\n            <th width=\"10%\"></th>\n          </tr>\n        </thead>\n      );\n      const mobileThead = (\n        <thead>\n          <tr>\n            <th width=\"92%\"></th>\n            <th width=\"8%\"></th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      return items.length ? (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? desktopThead : mobileThead}\n          <tbody>\n            {items.map((item, index) => {\n              return <Item key={index} data={item} isDesktop={isDesktop} />;\n            })}\n          </tbody>\n        </table>\n      ): emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpMenuOpen: false, // for mobile\n      isOpIconShown: false,\n      unlinked: false,\n      isConfirmUnlinkDialogOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  toggleDialog = () => {\n    this.setState({\n      isConfirmUnlinkDialogOpen: !this.state.isConfirmUnlinkDialogOpen\n    });\n  }\n\n  handleClick = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n    if (data.is_desktop_client) {\n      this.toggleDialog();\n    } else {\n      const wipeDevice = true;\n      this.unlinkDevice(wipeDevice);\n    }\n  }\n\n  unlinkDevice = (wipeDevice) => {\n    const data = this.props.data;\n    seafileAPI.unlinkDevice(data.platform, data.device_id, wipeDevice).then((res) => {\n      this.setState({\n        unlinked: true\n      });\n      let msg = gettext('Successfully unlinked %(name)s.');\n      msg = msg.replace('%(name)s', data.device_name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unlinked) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    let opClasses = 'sf2-icon-delete unlink-device action-icon';\n    opClasses += this.state.isOpIconShown ? '' : ' invisible';\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td>{data.platform}</td>\n        <td>{data.device_name}</td>\n        <td>{data.last_login_ip}</td>\n        <td>{moment(data.last_accessed).fromNow()}</td>\n        <td>\n          <a href=\"#\" className={opClasses} title={gettext('Unlink')} role=\"button\" aria-label={gettext('Unlink')} onClick={this.handleClick}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td>\n          {data.device_name}<br />\n          <span className=\"item-meta-info\">{data.last_login_ip}</span>\n          <span className=\"item-meta-info\">{moment(data.last_accessed).fromNow()}</span>\n          <span className=\"item-meta-info\">{data.platform}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.handleClick}>{gettext('Unlink')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <React.Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {this.state.isConfirmUnlinkDialogOpen &&\n        <ConfirmUnlinkDeviceDialog\n          executeOperation={this.unlinkDevice}\n          toggleDialog={this.toggleDialog}\n        />\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nclass LinkedDevices extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listLinkedDevices().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"linked-devices\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Linked Devices')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content data={this.state} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default LinkedDevices;\n","class SharedRepoInfo {\n\n  constructor(object) {\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.share_type = object.share_type;\n    this.share_permission = object.share_permission;\n    this.modifier_name = object.modifier_name;\n    this.modifier_email = object.modifier_email;\n    this.modifier_contact_email = object.modifier_contact_email;\n    this.encrypted = object.encrypted;\n    if (this.share_type === 'personal') {\n      this.is_admin = object.is_admin;\n      this.user_name = object.user_name;\n      this.user_email = object.user_email;\n      this.contact_email = object.contact_email;\n    } else if (this.share_type === 'group') {\n      this.is_admin = object.is_admin;\n      this.group_id = object.group_id;\n      this.group_name = object.group_name;\n    }\n  }\n\n}\n\nexport default SharedRepoInfo;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport CustomPermission from '../../models/custom-permission';\nimport Loading from '../loading';\nimport toaster from '../toast';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nconst propTypes = {\n  repoID: PropTypes.string,\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass PermSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      currentOption: this.props.currentPerm,\n      customPermissions: []\n    };\n\n    this.customPermissions = null;\n  }\n\n  componentDidMount() {\n    if (this.props.repoID) {\n      this.listCustomPermissions();\n    } else {\n      this.setState({isLoading: false});\n    }\n  }\n\n  listCustomPermissions = () => {\n    const { repoID } = this.props;\n    seafileAPI.listCustomPermissions(repoID).then(res => {\n      const { permission_list: permissions } = res.data;\n      const customPermissions = permissions.map(item => new CustomPermission(item));\n      this.setState({\n        isLoading: false,\n        customPermissions: customPermissions\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n      this.setState({isLoading: false});\n    });\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  }\n\n  translatePermission = (permission) => {\n    let value = Utils.sharePerms(permission);\n    if (!value) {\n      const { customPermissions } = this.state;\n      const item = customPermissions.find(item => item.id + '' === permission);\n      value = item && item.name;\n    }\n    return value;\n    \n  }\n  \n  translateExplanation = (explanation) => {\n    let value = Utils.sharePermsExplanation(explanation);\n    if (!value) {\n      const { customPermissions } = this.state;\n      const item = customPermissions.find(item => item.id + '' === explanation);\n      value = item && item.description;\n    }\n    return value;\n  }\n\n  getPermissions = () => {\n    const { permissions } = this.props;\n    let newPermissions = permissions.slice();\n    const { customPermissions } = this.state;\n    if (!this.customPermissions) {\n      if (customPermissions.length > 0) {\n        customPermissions.forEach(item => {\n          newPermissions.push(item.id + '');\n        });\n      }\n      this.customPermissions = newPermissions;\n    }\n    return this.customPermissions;\n  }\n\n\n  render() {\n    const { isLoading, currentOption } = this.state;\n    let permissions = [];\n    if (!isLoading) {\n      permissions = this.getPermissions();\n    }\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody style={{maxHeight: '400px', overflow: 'auto'}}>\n          {isLoading && <Loading />}\n          {!isLoading && permissions.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {this.translatePermission(item)}\n                  <p className=\"text-secondary small m-0\">\n                    {this.translateExplanation(item)}\n                  </p>\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nPermSelect.propTypes = propTypes;\n\nexport default PermSelect;\n","import React, { Fragment, Component } from 'react';\nimport { Link } from '@reach/router';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport SharePermissionEditor from '../../components/select-editor/share-permission-editor';\nimport SharedRepoInfo from '../../models/shared-repo-info';\nimport PermSelect from '../../components/dialog/perm-select';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No libraries shared')}</h2>\n          <p>{gettext('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\\'s name in \"My Libraries\".')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"30%\">{gettext('Share To')}</th>\n                <th width=\"24%\">{gettext('Permission')}</th>\n                <th width=\"8%\"></th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item\n                key={index}\n                isDesktop={isDesktop}\n                item={item}\n              />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n\n    let item = this.props.item;\n    this.state = {\n      share_permission: item.share_permission,\n      is_admin: item.is_admin,\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      unshared: false\n    };\n    let permissions = ['rw', 'r'];\n    this.permissions = permissions;\n    this.showAdmin = isPro && (item.share_type !== 'public');\n    if (this.showAdmin) {\n      permissions.push('admin');\n    }\n    if (isPro) {\n      permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const share_type = item.share_type;\n    let options = {\n      'share_type': share_type,\n      'permission': permission\n    };\n    if (share_type == 'personal') {\n      options.user = item.user_email;\n    } else if (share_type == 'group') {\n      options.group_id = item.group_id;\n    }\n\n    seafileAPI.updateRepoSharePerm(item.repo_id, options).then(() => {\n      this.setState({\n        share_permission: permission == 'admin' ? 'rw' : permission,\n        is_admin: permission == 'admin',\n      });\n      toaster.success(gettext('Successfully modified permission.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unshare = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const share_type = item.share_type;\n    let options = {\n      'share_type': share_type\n    };\n    if (share_type == 'personal') {\n      options.user = item.user_email;\n    } else if (share_type == 'group') {\n      options.group_id = item.group_id;\n    }\n\n    seafileAPI.unshareRepo(item.repo_id, options).then((res) => {\n      this.setState({\n        unshared: true\n      });\n      let message = gettext('Successfully unshared {name}').replace('{name}', item.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    let { share_permission, is_admin, isOpIconShown, isPermSelectDialogOpen } = this.state;\n    let item = this.props.item;\n    Object.assign(item, {\n      share_permission: share_permission,\n      is_admin: is_admin\n    });\n\n    let iconUrl = Utils.getLibIconUrl(item);\n    let iconTitle = Utils.getLibIconTitle(item);\n    let repoUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}/`;\n\n\n    let shareTo;\n    const shareType = item.share_type;\n    if (shareType == 'personal') {\n      shareTo = item.user_name;\n    } else if (shareType == 'group') {\n      shareTo = item.group_name;\n    } else if (shareType == 'public') {\n      shareTo = gettext('all members');\n    }\n\n    if (this.showAdmin && is_admin) {\n      share_permission = 'admin';\n    }\n\n    // custom defined permission\n    if (share_permission.startsWith('custom-')) {\n      share_permission = share_permission.slice(7);\n    }\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td><Link to={repoUrl}>{item.repo_name}</Link></td>\n        <td>\n          {item.share_type == 'personal' ? <span title={item.contact_email}>{shareTo}</span> : shareTo}\n        </td>\n        <td>\n          <SharePermissionEditor\n            repoID={item.repo_id}\n            isTextMode={true}\n            isEditIconShow={this.state.isOpIconShown}\n            currentPermission={share_permission}\n            permissions={this.permissions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        <td><a href=\"#\" role=\"button\" aria-label={gettext('Unshare')} className={`action-icon sf2-icon-x3 ${isOpIconShown ? '': 'invisible'}`} title={gettext('Unshare')} onClick={this.unshare}></a></td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            <Link to={repoUrl}>{item.repo_name}</Link>\n            <span className=\"item-meta-info-highlighted\">{Utils.sharePerms(share_permission)}</span>\n            <br />\n            <span className=\"item-meta-info\">{`${gettext('Share To:')} ${shareTo}`}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.unshare}>{gettext('Unshare')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen && (\n          <PermSelect\n            repoID={item.repo_id}\n            currentPerm={share_permission}\n            permissions={this.permissions}\n            changePerm={this.changePerm}\n            toggleDialog={this.togglePermSelectDialog}\n          />\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nclass ShareAdminLibraries extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name', // 'name' or 'time'\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listSharedRepos().then((res) => {\n      // res: {data: Array(2), status: 200, statusText: \"OK\", headers: {…}, config: {…}, …}\n      let items = res.data.map(item => {\n        return new SharedRepoInfo(item);\n      });\n      this.setState({\n        loading: false,\n        items: Utils.sortRepos(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortRepos(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"share-admin-libs\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Libraries')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              errorMsg={this.state.errorMsg}\n              loading={this.state.loading}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminLibraries;\n","class SharedFolderInfo {\n\n  constructor(object) {\n    this.path = object.path;\n    this.folder_name = object.folder_name;\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.share_type = object.share_type;\n    this.share_permission = object.share_permission;\n    if (object.share_type === 'group') {\n      this.group_id = object.group_id;\n      this.group_name = object.group_name;\n    } else {\n      this.user_name = object.user_name;\n      this.user_email = object.user_email;\n      this.contact_email = object.contact_email;\n    }\n  }\n\n}\n\nexport default SharedFolderInfo;\n","import React, { Fragment, Component } from 'react';\nimport { Link } from '@reach/router';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport toaster from '../../components/toast';\nimport SharePermissionEditor from '../../components/select-editor/share-permission-editor';\nimport SharedFolderInfo from '../../models/shared-folder-info';\nimport PermSelect from '../../components/dialog/perm-select';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No folders shared')}</h2>\n          <p>{gettext('You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder\\'s name.')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"30%\">{gettext('Share To')}</th>\n                <th width=\"24%\">{gettext('Permission')}</th>\n                <th width=\"8%\"></th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item key={index} isDesktop={isDesktop} item={item} />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      share_permission: this.props.item.share_permission,\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      unshared: false\n    };\n\n    this.permissions = ['rw', 'r'];\n    if (isPro) {\n      this.permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  unshare = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    let options = {\n      'p': item.path\n    };\n    if (item.share_type == 'personal') {\n      Object.assign(options, {\n        'share_type': 'user',\n        'username': item.user_email\n      });\n    } else {\n      Object.assign(options, {\n        'share_type': item.share_type, // 'group'\n        'group_id': item.group_id\n      });\n    }\n\n    seafileAPI.unshareFolder(item.repo_id, options).then((res) => {\n      this.setState({\n        unshared: true\n      });\n      let message = gettext('Successfully unshared {name}').replace('{name}', item.folder_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster(errMessage);\n    });\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const postData = {\n      'permission': permission\n    };\n    let options = {\n      'p': item.path\n    };\n    if (item.share_type == 'personal') {\n      Object.assign(options, {\n        'share_type': 'user',\n        'username': item.user_email\n      });\n    } else {\n      Object.assign(options, {\n        'share_type': item.share_type, // 'group'\n        'group_id': item.group_id\n      });\n    }\n\n    seafileAPI.updateFolderSharePerm(item.repo_id, postData, options).then((res) => {\n      this.setState({share_permission: permission});\n      toaster.success(gettext('Successfully modified permission.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    const item = this.props.item;\n    let { share_permission, isOpIconShown, isPermSelectDialogOpen } = this.state;\n\n    let is_readonly = false;\n    if (share_permission == 'r' || share_permission == 'preview') {\n      is_readonly = true;\n    }\n    let iconUrl = Utils.getFolderIconUrl(is_readonly);\n    let iconTitle = Utils.getFolderIconTitle({\n      'permission': share_permission\n    });\n    let folderUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(item.path)}`;\n\n    // custom defined permission\n    if (share_permission.startsWith('custom-')) {\n      share_permission = share_permission.slice(7);\n    }\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td><Link to={folderUrl}>{item.folder_name}</Link></td>\n        <td>\n          {item.share_type == 'personal' ?\n            <span title={item.contact_email}>{item.user_name}</span> : item.group_name}\n        </td>\n        <td>\n          <SharePermissionEditor\n            repoID={item.repo_id}\n            isTextMode={true}\n            isEditIconShow={isOpIconShown}\n            currentPermission={share_permission}\n            permissions={this.permissions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        <td><a href=\"#\" role=\"button\" aria-label={gettext('Unshare')} className={`action-icon sf2-icon-x3 ${isOpIconShown ? '': 'invisible'}`} title={gettext('Unshare')} onClick={this.unshare}></a></td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            <Link to={folderUrl}>{item.folder_name}</Link>\n            <span className=\"item-meta-info-highlighted\">{Utils.sharePerms(share_permission)}</span>\n            <br />\n            <span className=\"item-meta-info\">{`${gettext('Share To:')} ${item.share_type == 'personal' ? item.user_name : item.group_name}`}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.unshare}>{gettext('Unshare')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&(\n          <PermSelect\n            repoID={item.repo_id}\n            currentPerm={share_permission}\n            permissions={this.permissions}\n            changePerm={this.changePerm}\n            toggleDialog={this.togglePermSelectDialog}\n          />\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nclass ShareAdminFolders extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name',\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  _sortItems = (items, sortBy, sortOrder) => {\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.folder_name, b.folder_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.folder_name, b.folder_name);\n          return -result;\n        };\n        break;\n    }\n\n    items.sort(comparator);\n    return items;\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: this._sortItems(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  componentDidMount() {\n    seafileAPI.listSharedFolders().then((res) => {\n      let items = res.data.map(item => {\n        return new SharedFolderInfo(item);\n      });\n      this.setState({\n        loading: false,\n        items: this._sortItems(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"share-admin-libs\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Folders')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              errorMsg={this.state.errorMsg}\n              loading={this.state.loading}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminFolders;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ShareLinkPermissionSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentOption: this.props.currentPerm\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    const options = this.props.permissions;\n    const { currentOption } = this.state;\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {options.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {Utils.getShareLinkPermissionObject(item).text}\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nShareLinkPermissionSelect.propTypes = propTypes;\n\nexport default ShareLinkPermissionSelect;\n","import arrayWithHoles from \"@babel/runtime/helpers/esm/arrayWithHoles\";\nimport iterableToArrayLimit from \"@babel/runtime/helpers/esm/iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableRest from \"@babel/runtime/helpers/esm/nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortOptions: PropTypes.array,\n  sortItems: PropTypes.func.isRequired\n};\n\nclass SortOptions extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.sortOptions = this.props.sortOptions || [\n      {value: 'name-asc', text: gettext('By name ascending')},\n      {value: 'name-desc', text: gettext('By name descending')},\n      {value: 'size-asc', text: gettext('By size ascending')},\n      {value: 'size-desc', text: gettext('By size descending')},\n      {value: 'time-asc', text: gettext('By time ascending')},\n      {value: 'time-desc', text: gettext('By time descending')}\n    ];\n    const { sortBy, sortOrder } = this.props;\n    this.state = {\n      currentOption: `${sortBy}-${sortOrder}`\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    this.setState({\n      currentOption: e.target.value\n    });\n\n    const [sortBy, sortOrder] = e.target.value.split('-');\n    this.props.sortItems(sortBy, sortOrder);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {this.sortOptions.map((item, index) => {\n            return (\n              <Fragment key={index}>\n                <input id={`option-${index}`} className=\"align-middle\" type=\"radio\" name=\"sort-option\" value={item.value} checked={this.state.currentOption == item.value} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"align-middle m-2\">{item.text}</label><br />\n              </Fragment>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nSortOptions.propTypes = propTypes;\n\nexport default SortOptions;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { isPro, gettext, siteRoot, canGenerateUploadLink } from '../../utils/constants';\nimport ShareLink from '../../models/share-link';\nimport ShareLinkPermissionEditor from '../../components/select-editor/share-link-permission-editor';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport ShareLinkPermissionSelect from '../../components/dialog/share-link-permission-select';\nimport ShareAdminLink from '../../components/dialog/share-admin-link';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No share links')}</h2>\n          <p>{gettext('You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name.')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortByTime = sortBy == 'time';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      // only for some columns\n      const columnWidths = isPro ? ['14%', '7%', '14%'] : ['21%', '14%', '20%'];\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"31%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width={columnWidths[0]}>{gettext('Library')}</th>\n                {isPro && <th width=\"20%\">{gettext('Permission')}</th>}\n                <th width={columnWidths[1]}>{gettext('Visits')}</th>\n                <th width={columnWidths[2]}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Expiration')} {sortByTime && sortIcon}</a></th>\n                <th width=\"10%\">{/*Operations*/}</th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item key={index} isDesktop={isDesktop} item={item} onRemoveLink={this.props.onRemoveLink} />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nconst itemPropTypes = {\n  item: PropTypes.object.isRequired,\n  isDesktop: PropTypes.bool.isRequired,\n  onRemoveLink: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      isLinkDialogOpen: false,\n      permissionOptions: [],\n      currentPermission: '',\n    };\n  }\n\n  componentDidMount() {\n    if (isPro) {\n      this.updatePermissionOptions();\n    }\n  }\n\n  updatePermissionOptions = () => {\n    const item = this.props.item;\n    let itemType = item.is_dir ? (item.path === '/' ? 'library' : 'dir') : 'file';\n    let permission = item.repo_folder_permission;\n    let permissionOptions = Utils.getShareLinkPermissionList(itemType, permission, item.path, item.can_edit);\n    let currentPermission = Utils.getShareLinkPermissionStr(this.props.item.permissions);\n    this.setState({\n      permissionOptions: permissionOptions,\n      currentPermission: currentPermission\n    });\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  toggleLinkDialog = () => {\n    this.setState({\n      isLinkDialogOpen: !this.state.isLinkDialogOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  viewLink = (e) => {\n    e.preventDefault();\n    this.toggleLinkDialog();\n  }\n\n  removeLink = (e) => {\n    e.preventDefault();\n    this.props.onRemoveLink(this.props.item);\n  }\n\n  renderExpiration = () => {\n    const item = this.props.item;\n    if (!item.expire_date) {\n      return '--';\n    }\n    const expire_date = moment(item.expire_date).format('YYYY-MM-DD');\n    const expire_time = moment(item.expire_date).format('YYYY-MM-DD HH:mm:ss');\n    return (<span className={item.is_expired ? 'error' : ''} title={expire_time}>{expire_date}</span>);\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const permissionDetails = Utils.getShareLinkPermissionObject(permission).permissionDetails;\n    seafileAPI.updateShareLink(item.token, JSON.stringify(permissionDetails)).then(() => {\n      this.setState({\n        currentPermission: permission\n      });\n      let message = gettext('Successfully modified permission.');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const item = this.props.item;\n    const { currentPermission, permissionOptions , isOpIconShown, isPermSelectDialogOpen, isLinkDialogOpen } = this.state;\n\n    let iconUrl, objUrl;\n    if (item.is_dir) {\n      let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n      iconUrl = Utils.getFolderIconUrl(false);\n      objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n    } else {\n      iconUrl = Utils.getFileIconUrl(item.obj_name);\n      objUrl = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n    }\n\n    const desktopItem = (\n      <tr onMouseEnter={this.handleMouseOver} onMouseLeave={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td><img src={iconUrl} width=\"24\" alt=\"\" /></td>\n        <td>\n          {item.is_dir ?\n            <Link to={objUrl}>{item.obj_name}</Link> :\n            <a href={objUrl} target=\"_blank\" rel=\"noreferrer\">{item.obj_name}</a>\n          }\n        </td>\n        <td><Link to={`${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}/`}>{item.repo_name}</Link></td>\n        {isPro &&\n        <td>\n          <ShareLinkPermissionEditor\n            isTextMode={true}\n            isEditIconShow={isOpIconShown && !item.is_expired}\n            currentPermission={currentPermission}\n            permissionOptions={permissionOptions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        }\n        <td>{item.view_cnt}</td>\n        <td>{this.renderExpiration()}</td>\n        <td>\n          {!item.is_expired && <a href=\"#\" className={`sf2-icon-link action-icon ${isOpIconShown ? '': 'invisible'}`} title={gettext('View')} aria-label={gettext('View')} role=\"button\" onClick={this.viewLink}></a>}\n          <a href=\"#\" className={`sf2-icon-delete action-icon ${isOpIconShown ? '': 'invisible'}`} title={gettext('Remove')} aria-label={gettext('Remove')} role=\"button\" onClick={this.removeLink}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n          <td>\n            {item.is_dir ?\n              <Link to={objUrl}>{item.obj_name}</Link> :\n              <a href={objUrl} target=\"_blank\" rel=\"noreferrer\">{item.obj_name}</a>\n            }\n            {isPro && <span className=\"item-meta-info-highlighted\">{Utils.getShareLinkPermissionObject(currentPermission).text}</span>}\n            <br />\n            <span>{item.repo_name}</span><br />\n            <span className=\"item-meta-info\">{gettext('Visits')}: {item.view_cnt}</span>\n            <span className=\"item-meta-info\">{gettext('Expiration')}: {this.renderExpiration()}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  {(isPro && !item.is_expired) && <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>}\n                  {!item.is_expired && <DropdownItem className=\"mobile-menu-item\" onClick={this.viewLink}>{gettext('View')}</DropdownItem>}\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.removeLink}>{gettext('Remove')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&\n        <ShareLinkPermissionSelect\n          currentPerm={currentPermission}\n          permissions={permissionOptions}\n          changePerm={this.changePerm}\n          toggleDialog={this.togglePermSelectDialog}\n        />\n        }\n      </Fragment>\n    );\n\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isLinkDialogOpen &&\n        <ShareAdminLink\n          link={item.link}\n          toggleDialog={this.toggleLinkDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nItem.propTypes = itemPropTypes;\n\nclass ShareAdminShareLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name', // 'name' or 'time'\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n\n    // for mobile\n    this.sortOptions = [\n      {value: 'name-asc', text: gettext('By name ascending')},\n      {value: 'name-desc', text: gettext('By name descending')},\n      {value: 'time-asc', text: gettext('By expiration ascending')},\n      {value: 'time-desc', text: gettext('By expiration descending')}\n    ];\n  }\n\n  _sortItems = (items, sortBy, sortOrder) => {\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.obj_name, b.obj_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.obj_name, b.obj_name);\n          return -result;\n        };\n        break;\n      case 'time-asc':\n        comparator = function(a, b) {\n          return a.expire_date < b.expire_date ? -1 : 1;\n        };\n        break;\n      case 'time-desc':\n        comparator = function(a, b) {\n          return a.expire_date < b.expire_date ? 1 : -1;\n        };\n        break;\n\n      // no default\n    }\n\n    items.sort((a, b) => {\n      if (a.is_dir && !b.is_dir) {\n        return -1;\n      } else if (!a.is_dir && b.is_dir) {\n        return 1;\n      } else {\n        return comparator(a, b);\n      }\n    });\n    return items;\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: this._sortItems(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  componentDidMount() {\n    seafileAPI.listUserShareLinks().then((res) => {\n      let items = res.data.map(item => {\n        return new ShareLink(item);\n      });\n      this.setState({\n        loading: false,\n        items: this._sortItems(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onRemoveLink = (item) => {\n    seafileAPI.deleteShareLink(item.token).then(() => {\n      let items = this.state.items.filter(uploadItem => {\n        return uploadItem.token !== item.token;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item.');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path share-upload-nav\">\n              <ul className=\"nav\">\n                <li className=\"nav-item\">\n                  <Link to={`${siteRoot}share-admin-share-links/`} className=\"nav-link active\">{gettext('Share Links')}</Link>\n                </li>\n                {canGenerateUploadLink && (\n                  <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-upload-links/`} className=\"nav-link\">{gettext('Upload Links')}</Link></li>\n                )}\n              </ul>\n              {(!Utils.isDesktop() && this.state.items.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                sortBy={this.state.sortBy}\n                sortOrder={this.state.sortOrder}\n                sortItems={this.sortItems}\n                onRemoveLink={this.onRemoveLink}\n              />\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortOptions={this.sortOptions}\n          sortItems={this.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nexport default ShareAdminShareLinks;\n","import React, { Component, Fragment } from 'react';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport UploadLink from '../../models/upload-link';\nimport ShareAdminLink from '../../components/dialog/share-admin-link';\n\nclass Content extends Component {\n\n  render() {\n    const { loading, errorMsg, items } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    }\n    if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    }\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No upload links')}</h2>\n        <p>{gettext('You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name.')}</p>\n      </EmptyTip>\n    );\n\n    const isDesktop = Utils.isDesktop();\n    const table = (\n      <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ? (\n            <tr>\n              <th width=\"4%\">{/*icon*/}</th>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"24%\">{gettext('Library')}</th>\n              <th width=\"16%\">{gettext('Visits')}</th>\n              <th width=\"16%\">{gettext('Expiration')}</th>\n              <th width=\"10%\">{/*Operations*/}</th>\n            </tr>\n          ) : (\n            <tr>\n              <th width=\"12%\"></th>\n              <th width=\"80%\"></th>\n              <th width=\"8%\"></th>\n            </tr>\n          )}\n        </thead>\n        <tbody>\n          {items.map((item, index) => {\n            return (<Item key={index} isDesktop={isDesktop} item={item} onRemoveLink={this.props.onRemoveLink}/>);\n          })}\n        </tbody>\n      </table>\n    );\n\n    return items.length ? table : emptyTip;\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isLinkDialogOpen: false\n    };\n  }\n\n toggleOpMenu = () => {\n   this.setState({\n     isOpMenuOpen: !this.state.isOpMenuOpen\n   });\n }\n\n  toggleLinkDialog = () => {\n    this.setState({\n      isLinkDialogOpen: !this.state.isLinkDialogOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  viewLink = (e) => {\n    e.preventDefault();\n    this.toggleLinkDialog();\n  }\n\n  removeLink = (e) => {\n    e.preventDefault();\n    this.props.onRemoveLink(this.props.item);\n  }\n\n  renderExpiration = () => {\n    const item = this.props.item;\n    if (!item.expire_date) {\n      return '--';\n    }\n    const expire_date = moment(item.expire_date).format('YYYY-MM-DD');\n    const expire_time = moment(item.expire_date).format('YYYY-MM-DD HH:mm:ss');\n    return (<span className={item.is_expired ? 'error' : ''} title={expire_time}>{expire_date}</span>);\n  }\n\n  render() {\n    let item = this.props.item;\n    const { isOpIconShown, isLinkDialogOpen } = this.state;\n\n    const iconUrl = Utils.getFolderIconUrl(false);\n    const repoUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}`;\n    const objUrl = `${repoUrl}${Utils.encodePath(item.path)}`;\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n        <td><Link to={objUrl}>{item.obj_name}</Link></td>\n        <td><Link to={repoUrl}>{item.repo_name}</Link></td>\n        <td>{item.view_cnt}</td>\n        <td>{this.renderExpiration()}</td>\n        <td>\n          {!item.is_expired && <a href=\"#\" className={`sf2-icon-link action-icon ${isOpIconShown ? '' : 'invisible'}`} title={gettext('View')} aria-label={gettext('View')} role=\"button\" onClick={this.viewLink}></a>}\n          <a href=\"#\" className={`sf2-icon-delete action-icon ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Remove')} aria-label={gettext('Remove')} role=\"button\" onClick={this.removeLink}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n        <td>\n          <Link to={objUrl}>{item.obj_name}</Link>\n          <br />\n          <span>{item.repo_name}</span><br />\n          <span className=\"item-meta-info\">{gettext('Visits')}: {item.view_cnt}</span>\n          <span className=\"item-meta-info\">{gettext('Expiration')}: {this.renderExpiration()}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {!item.is_expired && <DropdownItem className=\"mobile-menu-item\" onClick={this.viewLink}>{gettext('View')}</DropdownItem>}\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.removeLink}>{gettext('Remove')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isLinkDialogOpen &&\n        <ShareAdminLink\n          link={item.link}\n          toggleDialog={this.toggleLinkDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nclass ShareAdminUploadLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listUserUploadLinks().then((res) => {\n      let items = res.data.map(item => {\n        return new UploadLink(item);\n      });\n      this.setState({\n        loading: false,\n        items: items\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onRemoveLink = (item) => {\n    seafileAPI.deleteUploadLink(item.token).then(() => {\n      let items = this.state.items.filter(uploadItem => {\n        return uploadItem.token !== item.token;\n      });\n      this.setState({items: items});\n      const message = gettext('Successfully deleted 1 item.');\n      toaster.success(message);\n    }).catch((error) => {\n      const errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\">\n          <div className=\"cur-view-path share-upload-nav\">\n            <ul className=\"nav\">\n              {canGenerateShareLink && (\n                <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-share-links/`} className=\"nav-link\">{gettext('Share Links')}</Link></li>\n              )}\n              <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-upload-links/`} className=\"nav-link active\">{gettext('Upload Links')}</Link></li>\n            </ul>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              loading={this.state.loading}\n              errorMsg={this.state.errorMsg}\n              items={this.state.items}\n              onRemoveLink={this.onRemoveLink}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminUploadLinks;\n","import { Utils } from '../utils/utils';\n\nclass Repo {\n  constructor(object) {\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.permission = object.permission;\n    this.size_original = object.size;\n    this.size = Utils.bytesToSize(object.size);\n    this.owner_name = object.owner_name;\n    this.owner_email = object.owner_email;\n    this.owner_contact_email = object.owner_contact_email;\n    this.encrypted = object.encrypted;\n    this.last_modified = object.last_modified;\n    this.modifier_contact_email = object.modifier_contact_email;\n    this.modifier_email = object.modifier_email;\n    this.modifier_name = object.modifier_name;\n    this.type = object.type;\n    this.starred = object.starred;\n    this.status = object.status;\n    this.storage_name = object.storage_name;\n    if (object.is_admin != undefined) {\n      this.is_admin = object.is_admin;\n    }\n  }\n}\n\nexport default Repo;\n","import React from 'react';\nimport { gettext } from '../utils/constants';\n\nfunction LibsMobileThead() {\n  return (\n    <thead>\n      <tr>\n        <th width=\"12%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n        <th width=\"80%\"></th>\n        <th width=\"8%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n      </tr>\n    </thead>\n  );\n}\n\nexport default LibsMobileThead;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport cookie from 'react-cookies';\nimport { Link, navigate } from '@reach/router';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Repo from '../../models/repo';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport LibsMobileThead from '../../components/libs-mobile-thead';\nimport ModalPotal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No shared libraries')}</h2>\n        <p>{gettext('No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortByTime = sortBy == 'time';\n      const sortBySize = sortBy == 'size';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n            <th width=\"10%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width=\"14%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n            <th width=\"18%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n            <th width=\"16%\">{gettext('Owner')}</th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={isDesktop ? '' : 'table-thead-hidden'}>\n          {isDesktop ? desktopThead : <LibsMobileThead />}\n          <tbody>\n            {items.map((item, index) => {\n              return <Item key={index} data={item} isDesktop={isDesktop} />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showOpIcon: false,\n      unshared: false,\n      isShowSharedDialog: false,\n      isStarred: this.props.data.starred,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      showOpIcon: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      showOpIcon: false\n    });\n  }\n\n  share = (e) => {\n    e.preventDefault();\n    this.setState({isShowSharedDialog: true});\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n\n    let request;\n    if (data.owner_email.indexOf('@seafile_group') == -1) {\n      let options = {\n        'share_type': 'personal',\n        'from': data.owner_email\n      };\n      request = seafileAPI.leaveShareRepo(data.repo_id, options);\n    } else {\n      request = seafileAPI.leaveShareGroupOwnedRepo(data.repo_id);\n    }\n\n    request.then((res) => {\n      this.setState({unshared: true});\n      let message = gettext('Successfully unshared {name}').replace('{name}', data.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to unshare {name}').replace('{name}', data.repo_name);\n      }\n      toaster(errMessage);\n    });\n  }\n\n  toggleShareDialog = () => {\n    this.setState({isShowSharedDialog: false});\n  }\n\n  onToggleStarRepo = (e) => {\n    e.preventDefault();\n    const repoName = this.props.data.repo_name;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.data.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.data.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  visitRepo = () => {\n    navigate(this.repoURL);\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    data.icon_url = Utils.getLibIconUrl(data);\n    data.icon_title = Utils.getLibIconTitle(data);\n\n    let iconVisibility = this.state.showOpIcon ? '' : ' invisible';\n    let shareIconClassName = 'op-icon sf2-icon-share repo-share-btn' + iconVisibility;\n    let leaveShareIconClassName = 'op-icon sf2-icon-x3' + iconVisibility;\n    let shareRepoUrl = this.repoURL = `${siteRoot}library/${data.repo_id}/${Utils.encodePath(data.repo_name)}/`;\n    const desktopItem = (\n      <Fragment>\n        <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n          <td className=\"text-center\">\n            <a href=\"#\" role=\"button\" aria-label={this.state.isStarred ? gettext('Unstar') : gettext('Star')} onClick={this.onToggleStarRepo}>\n              <i className={`fa-star ${this.state.isStarred ? 'fas' : 'far star-empty'}`}></i>\n            </a>\n          </td>\n          <td><img src={data.icon_url} title={data.icon_title} alt={data.icon_title} width=\"24\" /></td>\n          <td><Link to={shareRepoUrl}>{data.repo_name}</Link></td>\n          <td>\n            {(isPro && data.is_admin) &&\n              <a href=\"#\" className={shareIconClassName} title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.share}></a>\n            }\n            <a href=\"#\" className={leaveShareIconClassName} title={gettext('Leave Share')} role=\"button\" aria-label={gettext('Leave Share')} onClick={this.leaveShare}></a>\n          </td>\n          <td>{data.size}</td>\n          <td title={moment(data.last_modified).format('llll')}>{moment(data.last_modified).fromNow()}</td>\n          <td title={data.owner_contact_email}>{data.owner_name}</td>\n        </tr>\n        {this.state.isShowSharedDialog && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={data.repo_name}\n              itemPath={'/'}\n              repoID={data.repo_id}\n              repoEncrypted={data.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={data.permission}\n              isAdmin={true}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n          <td onClick={this.visitRepo}><img src={data.icon_url} title={data.icon_title} alt={data.icon_title} width=\"24\" /></td>\n          <td onClick={this.visitRepo}>\n            <Link to={shareRepoUrl}>{data.repo_name}</Link><br />\n            <span className=\"item-meta-info\" title={data.owner_contact_email}>{data.owner_name}</span>\n            <span className=\"item-meta-info\">{data.size}</span>\n            <span className=\"item-meta-info\" title={moment(data.last_modified).format('llll')}>{moment(data.last_modified).fromNow()}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.onToggleStarRepo}>{this.state.isStarred ? gettext('Unstar') : gettext('Star')}</DropdownItem>\n                  {(isPro && data.is_admin) &&\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.share}>{gettext('Share')}</DropdownItem>\n                  }\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.leaveShare}>{gettext('Leave Share')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {this.state.isShowSharedDialog && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={data.repo_name}\n              itemPath={'/'}\n              repoID={data.repo_id}\n              repoEncrypted={data.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={data.permission}\n              isAdmin={true}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nItem.propTypes = {\n  isDesktop: PropTypes.bool.isRequired,\n  data: PropTypes.object.isRequired\n};\n\nclass SharedLibraries extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type:'shared'}).then((res) => {\n      let repoList = res.data.repos.map((item) => {\n        return new Repo(item);\n      });\n      this.setState({\n        loading: false,\n        items: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortRepos(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared with me')}</h3>\n              {(!Utils.isDesktop() && this.state.items.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                sortBy={this.state.sortBy}\n                sortOrder={this.state.sortOrder}\n                sortItems={this.sortItems}\n              />\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortItems={this.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nexport default SharedLibraries;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Link } from '@reach/router';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\n\nclass Content extends Component {\n\n  render() {\n    const { loading, errorMsg, items } = this.props;\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries have been shared with you')}</h2>\n        <p>{gettext('No libraries have been shared with you from other servers.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const table = (\n        <table>\n          <thead>\n            <tr>\n              <th width=\"4%\"></th>\n              <th width=\"20%\">{gettext('Name')}</th>\n              <th width=\"20%\">{gettext('Shared by')}</th>\n              <th width=\"26%\">{gettext('At server')}</th>\n              <th width=\"20%\">{gettext('Time')}</th>\n              <th width=\"10%\">{/* operations */}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return <Item\n                key={index}\n                item={item}\n                leaveShare={this.props.leaveShare}\n              />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n    this.props.leaveShare(this.props.item);\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isOpIconShown } = this.state;\n\n    item.icon_url = Utils.getLibIconUrl(item);\n    item.icon_title = Utils.getLibIconTitle(item);\n\n    let shareRepoUrl =`${siteRoot}remote-library/${this.props.item.provider_id}/${this.props.item.repo_id}/${Utils.encodePath(this.props.item.repo_name)}/`;\n    return (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut} onFocus={this.handleMouseOver}>\n        <td><img src={item.icon_url} title={item.icon_title} alt={item.icon_title} width=\"24\" /></td>\n        <td><Link to={shareRepoUrl}>{item.repo_name}</Link></td>\n        <td>{item.from_user}</td>\n        <td>{item.from_server_url}</td>\n        <td title={moment(item.last_modified).format('llll')}>{moment(item.ctime).fromNow()}</td>\n        <td>\n          <a href=\"#\" role=\"button\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Leave Share')} aria-label={gettext('Leave Share')} onClick={this.leaveShare}></a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = {\n  item: PropTypes.object.isRequired\n};\n\nclass SharedWithOCM extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listOCMSharesReceived().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.ocm_share_received_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  leaveShare = (item) => {\n    const { id, repo_name } = item;\n    seafileAPI.deleteOCMShareReceived(id).then((res) => {\n      let items = this.state.items.filter(item => {\n        return item.id != id;\n      });\n      this.setState({items: items});\n      toaster.success(gettext('Successfully unshared {name}').replace('{name}', repo_name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared from other servers')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                leaveShare={this.leaveShare}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default SharedWithOCM;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Link } from '@reach/router';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\n\nclass OCMViaWebdav extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      shareID: '',\n      path: '',\n      items: [],\n      errorMsg: '',\n    };\n  }\n\n  componentDidMount() {\n    this.getAllReceivedShares()\n  }\n\n  getAllReceivedShares = () => {\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/';\n    seafileAPI.req.get(url).then((res) => {\n      this.setState({\n        loading: false,\n        shareID: '',\n        path: '',\n        items: res.data.received_share_list,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  leaveShare = (item) => {\n    const { id, name } = item;\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/' + id + '/';\n    seafileAPI.req.delete(url).then((res) => {\n      let items = this.state.items.filter(item => {\n        return item.id != id;\n      });\n      this.setState({items: items});\n      toaster.success(gettext('Successfully unshared {name}').replace('{name}', name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openFolder = (item) => {\n\n    this.setState({\n      loading: true,\n    });\n\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/' + item.id + '/?path=' + item.path;\n    seafileAPI.req.get(url).then((res) => {\n      this.setState({\n        loading: false,\n        shareID: item.id,\n        path: res.data.parent_dir,\n        items: res.data.received_share_list,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onPathClick = (path) => {\n\n    this.setState({\n      loading: true,\n    });\n\n    const url = seafileAPI.server + '/ocm-via-webdav/received-shares/' + this.state.shareID + '/?path=' + path;\n    seafileAPI.req.get(url).then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.received_share_list,\n        path: res.data.parent_dir,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path align-items-center\">\n              <DirPath\n                shareID={this.state.shareID}\n                currentPath={this.state.path}\n                onPathClick={this.onPathClick}\n                getAllReceivedShares={this.getAllReceivedShares}\n              />\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                path={this.state.path}\n                leaveShare={this.leaveShare}\n                openFolder={this.openFolder}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\n\nclass Content extends Component {\n\n  static propTypes = {\n    loading: PropTypes.bool.isRequired,\n    errorMsg: PropTypes.string.isRequired,\n    items: PropTypes.array.isRequired,\n    path: PropTypes.string.isRequired,\n  }\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const { loading, errorMsg, items, path } = this.props;\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries have been shared with you')}</h2>\n        <p>{gettext('No libraries have been shared with you from other servers.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const table = (\n        <table>\n          <thead>\n            <tr>\n              <th width=\"5%\"></th>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"35%\">{gettext('Shared By')}</th>\n              <th width=\"20%\">{gettext('Time')}</th>\n              <th width=\"5%\">{/* operations */}</th>\n              <th width=\"5%\">{/* operations */}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return <Item\n                key={index}\n                item={item}\n                path={path}\n                leaveShare={this.props.leaveShare}\n                openFolder={this.props.openFolder}\n              />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  static propTypes = {\n    item: PropTypes.object.isRequired\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  downloadFile = () => {\n    let downloadUrl = siteRoot + 'ocm-via-webdav/download-received-file/?share_id=' + this.props.item.id + '&path=' + this.props.item.path;\n    window.location.href = downloadUrl;\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n    this.props.leaveShare(this.props.item);\n  }\n\n  openFolder = (e) => {\n    e.preventDefault();\n    this.props.openFolder(this.props.item);\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isOpIconShown } = this.state;\n\n    if (item.is_dir) {\n      item.icon_url = Utils.getFolderIconUrl();\n    } else {\n      item.icon_url = Utils.getFileIconUrl(item.name);\n    }\n    return (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td><img src={item.icon_url} width=\"24\" /></td>\n        <td>\n          {item.is_dir ? <a href=\"#\" onClick={this.openFolder}>{item.name}</a> : item.name}\n\t</td>\n        <td>{item.shared_by}</td>\n        <td title={moment(item.last_modified).format('llll')}>{moment(item.ctime).fromNow()}</td>\n        <td>\n\t  {item.is_dir ? \"\" : <a href=\"#\" className={`action-icon sf2-icon-download ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Download')} onClick={this.downloadFile}></a>}\n        </td>\n        <td>\n\t  {this.props.path ? \"\" : <a href=\"#\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Leave Share')} onClick={this.leaveShare}></a>}\n        </td>\n      </tr>\n    );\n  }\n}\n\nclass DirPath extends React.Component {\n\n  static propTypes = {\n    currentPath: PropTypes.string.isRequired,\n    onPathClick: PropTypes.func.isRequired,\n    getAllReceivedShares: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n    };\n  }\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  turnPathToLink = (path) => {\n    path = path.slice(1, path.length - 1);\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n\tif (index === 0) {\n          nodePath = '/';\n\t} else {\n          nodePath += item + '/';\n\t}\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let pathElem = this.turnPathToLink(this.props.currentPath);\n    return (\n      <div className=\"path-container\">\n        <a href=\"#\" onClick={this.props.getAllReceivedShares}>{gettext('All')}</a>\n        {pathElem}\n      </div>\n    );\n  }\n}\n\nexport default OCMViaWebdav;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Account from '../../components/common/account';\n\nconst propTypes = {\n  children: PropTypes.object\n};\n\nclass MainPanelTopbar extends Component {\n\n  render() {\n    return (\n      <div className={`main-panel-north ${this.props.children ? 'border-left-show' : ''}`}>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\"></span>\n          <div className=\"operation\">\n            {this.props.children}\n          </div>\n        </div>\n        <div className=\"common-toolbar\">\n          <Account isAdminPanel={false} />\n        </div>\n      </div>\n    );\n  }\n}\n\nMainPanelTopbar.propTypes = propTypes;\n\nexport default MainPanelTopbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoName: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass DirPath extends React.Component {\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  turnPathToLink = (path) => {\n    path = path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let { currentPath, repoName } = this.props;\n    let pathElem = this.turnPathToLink(currentPath);\n\n    return (\n      <div className=\"path-container\">\n        <Link to={siteRoot + 'shared-with-ocm/'} className=\"normal\" onClick={(e) => this.props.onTabNavClick('shared-with-ocm')}>{gettext('All')}</Link>\n        <span className=\"path-split\">/</span>\n        {(currentPath === '/' || currentPath === '') ?\n          <span className=\"path-repo-name\">{repoName}</span>:\n          <a className=\"path-link\" data-path=\"/\" onClick={this.onPathClick}>{repoName}</a>\n        }\n        {pathElem}\n      </div>\n    );\n  }\n}\n\nDirPath.propTypes = propTypes;\n\nexport default DirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\n\nclass DirentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  openFolder = () => {\n    this.props.openFolder(this.props.dirent);\n  }\n\n  downloadDirent = (e) => {\n    e.preventDefault();\n    this.props.downloadDirent(this.props.dirent);\n  }\n\n  render () {\n    let { isOpIconShown } = this.state;\n    let { dirent } = this.props;\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    return (\n      <Fragment>\n        <tr onMouseEnter={this.handleMouseOver} onMouseLeave={this.handleMouseOut}>\n          <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt='' /></td>\n          <td>\n            {dirent.is_file ?\n              dirent.name :\n              <Link to=\"#\" onClick={this.openFolder}>{dirent.name}</Link>\n            }\n          </td>\n          <td>\n            {isOpIconShown && dirent.is_file &&\n            <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} onClick={this.downloadDirent}></a>\n            }\n          </td>\n          <td>{Utils.bytesToSize(dirent.size)}</td>\n          <td>{moment(dirent.mtime).fromNow()}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n}\n\n\nconst propTypes = {\n  direntList: PropTypes.array.isRequired\n};\n\nclass DirContent extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { loading, errorMsg, direntList } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error text-center mt-4\">{errorMsg}</p>;\n    }\n\n    return (\n      <Fragment>\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"5%\">{/*icon*/}</th>\n              <th width=\"55%\">{gettext('Name')}</th>\n              <th width=\"10%\">{/*operation*/}</th>\n              <th width=\"15%\">{gettext('Size')}</th>\n              <th width=\"15%\">{gettext('Last Update')}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {direntList.map((dirent, index) => {\n              return <DirentItem\n                key={index}\n                dirent={dirent}\n                openFolder={this.props.openFolder}\n                deleteDirent={this.props.deleteDirent}\n                downloadDirent={this.props.downloadDirent}\n                fromSystemRepo={this.props.fromSystemRepo}\n              />;\n            })}\n          </tbody>\n        </table>\n      </Fragment>\n    );\n  }\n}\n\nDirContent.propTypes = propTypes;\n\nexport default DirContent;\n","import React, { Component, Fragment } from 'react';\nimport { Button } from 'reactstrap';\nimport { post } from 'axios';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { loginUrl, siteRoot, gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport MainPanelTopbar from './remote-dir-topbar';\nimport DirPathBar from './remote-dir-path';\nimport DirContent from './remote-dir-content';\n\nclass Dirent {\n  constructor(obj) {\n    this.name = obj.name;\n    this.mtime = obj.mtime;\n    this.size = obj.size;\n    this.is_file = obj.type === 'file';\n  }\n\n  isDir() {\n    return !this.is_file;\n  }\n}\n\nclass DirView extends Component {\n\n  constructor(props) {\n    super(props);\n    this.fileInput = React.createRef();\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      repoName: '',\n      path: '',\n      direntList: [],\n      isNewFolderDialogOpen: false,\n      userPerm: '',\n    };\n  }\n\n  componentDidMount () {\n    this.loadDirentList('/');\n  }\n\n  onPathClick = (path) => {\n    this.loadDirentList(path);\n  }\n\n  openFolder = (dirent) => {\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (!dirent.is_file) {\n      this.loadDirentList(direntPath);\n    }\n  }\n\n  loadDirentList = (path) => {\n    const { providerID, repoID } = this.props;\n    seafileAPI.listOCMRepoDir(providerID, repoID, path).then(res => {\n      const { repo_name: repoName, dirent_list, user_perm } = res.data;\n      let direntList = [];\n      dirent_list.forEach(item => {\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n      this.setState({\n        loading: false,\n        repoName: repoName,\n        direntList: direntList,\n        path: path,\n        userPerm: user_perm,\n      }, () => {\n        let url =`${siteRoot}remote-library/${providerID}/${repoID}/${repoName}${Utils.encodePath(path)}`;\n        window.history.replaceState({url: url, path: path}, path, url);\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  downloadDirent = (dirent) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    seafileAPI.getOCMRepoDownloadURL(this.props.providerID, this.props.repoID, path).then(res => {\n      location.href = res.data;\n    }).catch((err) => {\n      let errMessage = Utils.getErrorMsg(err);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openFileInput = () => {\n    this.fileInput.current.click();\n  }\n\n  onFileInputChange = () => {\n    if (!this.fileInput.current.files.length) {\n      return;\n    }\n    const file = this.fileInput.current.files[0];\n\n    let { path } = this.state;\n    let { providerID, repoID } = this.props;\n    seafileAPI.getOCMRepoUploadURL(providerID, repoID, path).then(res => {\n      let formData = new FormData();\n      formData.append('parent_dir', path);\n      formData.append('file', file);\n      post(res.data, formData).then(res => {\n        const fileObj = res.data[0];\n        let newDirent = new Dirent({\n          'type': 'file',\n          'name': fileObj.name,\n          'size': fileObj.size,\n          'mtime': (new Date()).getTime()\n        });\n        let direntList = this.state.direntList;\n        const dirs = direntList.filter(item => { return !item.is_file; });\n        direntList.splice(dirs.length, 0, newDirent);\n        this.setState({\n          direntList: direntList\n        });\n      });\n    }).catch((err) => {\n      let errMessage = Utils.getErrorMsg(err);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg,\n      repoName, direntList, path, userPerm } = this.state;\n    const { repoID } = this.props;\n\n    return (\n      <Fragment>\n        <MainPanelTopbar>\n          <Fragment>\n            <input className=\"d-none\" type=\"file\" onChange={this.onFileInputChange} ref={this.fileInput} />\n            {userPerm === 'rw' &&\n              <Button className=\"operation-item\" onClick={this.openFileInput}>{gettext('Upload')}</Button>\n            }\n          </Fragment>\n        </MainPanelTopbar>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path align-items-center\">\n              <DirPathBar\n                repoID={repoID}\n                repoName={repoName}\n                currentPath={path}\n                onPathClick={this.onPathClick}\n                onTabNavClick={this.props.onTabNavClick}\n              />\n            </div>\n            <div className=\"cur-view-content\">\n              <DirContent\n                loading={loading}\n                errorMsg={errorMsg}\n                direntList={direntList}\n                openFolder={this.openFolder}\n                deleteDirent={this.deleteDirent}\n                downloadDirent={this.downloadDirent}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default DirView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, enableEncryptedLibrary, repoPasswordMinLength, storages, libraryTemplates } from '../../utils/constants';\n\nconst propTypes = {\n  libraryType: PropTypes.string.isRequired,\n  onCreateRepo: PropTypes.func.isRequired,\n  onCreateToggle: PropTypes.func.isRequired,\n};\n\nclass CreateRepoDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoName: '',\n      disabled: true,\n      encrypt: false,\n      password1: '',\n      password2: '',\n      errMessage: '',\n      permission: 'rw',\n      storage_id: storages.length ? storages[0].id : '',\n      library_template: libraryTemplates.length ? libraryTemplates[0] : '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  handleRepoNameChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({repoName: e.target.value});\n  }\n\n  handlePassword1Change = (e) => {\n    this.setState({password1: e.target.value});\n  }\n\n  handlePassword2Change = (e) => {\n    this.setState({password2: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let isValid = this.validateInputParams();\n    if (isValid) {\n      let repoData = this.prepareRepoData();\n      if (this.props.libraryType === 'department') {\n        this.props.onCreateRepo(repoData, 'department');\n        return;\n      }\n      this.props.onCreateRepo(repoData);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.onCreateToggle();\n  }\n\n  componentDidMount() {\n    this.newInput.focus();\n  }\n\n  validateInputParams() {\n    let errMessage = '';\n    let repoName = this.state.repoName.trim();\n    if (!repoName.length) {\n      errMessage = gettext('Name is required');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (repoName.indexOf('/') > -1) {\n      errMessage = gettext('Name should not include \\'/\\'.');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (this.state.encrypt) {\n      let password1 = this.state.password1.trim();\n      let password2 = this.state.password2.trim();\n      if (!password1.length) {\n        errMessage = gettext('Please enter password');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (!password2.length) {\n        errMessage = gettext('Please enter the password again');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (password1.length < repoPasswordMinLength) {\n        errMessage = gettext('Password is too short');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (password1 !== password2) {\n        errMessage = gettext('Passwords don\\'t match');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n    }\n    return true;\n  }\n\n  onPermissionChange = (e) => {\n    let permission = e.target.value;\n    this.setState({permission: permission});\n  }\n\n  handleStorageInputChange = (selectedItem) => {\n    this.setState({storage_id: selectedItem.value});\n  }\n\n  handlelibraryTemplatesInputChange = (selectedItem) => {\n    this.setState({library_template: selectedItem.value});\n  }\n\n  onEncrypted = (e) => {\n    let isChecked = e.target.checked;\n    this.setState({\n      encrypt: isChecked,\n      disabled: !isChecked\n    });\n  }\n\n  prepareRepoData = () => {\n    let libraryType = this.props.libraryType;\n\n    let repoName = this.state.repoName.trim();\n    let password = this.state.encrypt ? this.state.password1 : '';\n    let permission = this.state.permission;\n\n    let repo = null;\n    if (libraryType === 'mine' || libraryType === 'public') {\n      repo = {\n        name: repoName,\n        passwd: password\n      };\n    }\n    if (libraryType === 'group') {\n      repo = {\n        repo_name: repoName,\n        password: password,\n        permission: permission,\n      };\n    }\n    if (libraryType === 'department') {\n      repo = {\n        repo_name: repoName,\n        passwd: password,\n      };\n    }\n\n    const storage_id = this.state.storage_id;\n    if (storage_id) {\n      repo.storage_id = storage_id;\n    }\n\n    const library_template = this.state.library_template;\n    if (library_template) {\n      repo.library_template = library_template;\n    }\n\n    return repo;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Library')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"repoName\">{gettext('Name')}</Label>\n              <Input\n                id=\"repoName\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={input => {this.newInput = input;}}\n                value={this.state.repoName}\n                onChange={this.handleRepoNameChange}\n              />\n            </FormGroup>\n\n            {libraryTemplates.length > 0 && (\n              <FormGroup>\n                <Label for=\"library-template\">{gettext('Template')}</Label>\n                <Select\n                  id=\"library-template\"\n                  defaultValue={{value: libraryTemplates[0], label: libraryTemplates[0]}}\n                  options={libraryTemplates.map((item, index) => { return {value: item, label: item}; })}\n                  onChange={this.handlelibraryTemplatesInputChange}\n                /> \n              </FormGroup>\n            )}\n\n            {storages.length > 0 && (\n              <FormGroup>\n                <Label for=\"storage-backend\">{gettext('Storage Backend')}</Label>\n                <Select\n                  id=\"storage-backend\"\n                  defaultValue={{value: storages[0].id, label: storages[0].name}}\n                  options={storages.map((item, index) => { return {value: item.id, label: item.name}; })}\n                  onChange={this.handleStorageInputChange}\n                />\n              </FormGroup>\n            )}\n\n            {this.props.libraryType === 'group' && (\n              <FormGroup>\n                <Label for=\"exampleSelect\">{gettext('Permission')}</Label>\n                <Input type=\"select\" name=\"select\" id=\"exampleSelect\" onChange={this.onPermissionChange} value={this.state.permission}>\n                  <option value='rw'>{gettext('Read-Write')}</option>\n                  <option value='r'>{gettext('Read-Only')}</option>\n                </Input>\n              </FormGroup>\n            )}\n            {enableEncryptedLibrary &&\n              <div>\n                <FormGroup check>\n                  <Input type=\"checkbox\" id=\"encrypt\" onChange={this.onEncrypted} />\n                  <Label for=\"encrypt\">{gettext('Encrypt')}</Label>\n                </FormGroup>\n                {!this.state.disabled &&\n                  <FormGroup>\n                    {/* todo translate */}\n                    <Label for=\"passwd1\">{gettext('Password')}</Label><span className=\"tip\">{' '}{gettext('(at least {placeholder} characters)').replace('{placeholder}', repoPasswordMinLength)}</span>\n                    <Input\n                      id=\"passwd1\"\n                      type=\"password\"\n                      disabled={this.state.disabled}\n                      value={this.state.password1}\n                      onChange={this.handlePassword1Change}\n                      autoComplete=\"new-password\"\n                    />\n                  </FormGroup>\n                }\n                {!this.state.disabled &&\n                  <FormGroup>\n                    <Label for=\"passwd2\">{gettext('Password again')}</Label>\n                    <Input\n                      id=\"passwd2\"\n                      type=\"password\"\n                      disabled={this.state.disabled}\n                      value={this.state.password2}\n                      onChange={this.handlePassword2Change}\n                      autoComplete=\"new-password\"\n                    />\n                  </FormGroup>\n                }\n              </div>\n            }\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateRepoDialog.propTypes = propTypes;\n\nexport default CreateRepoDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { Link, navigate } from '@reach/router';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport ModalPortal from '../modal-portal';\nimport CreateRepoDialog from '../dialog/create-repo-dialog';\nimport { DropdownToggle, Dropdown, DropdownMenu, DropdownItem } from 'reactstrap';\n\nconst propTypes = {\n  libraryType: PropTypes.string.isRequired,\n  onCreateRepo: PropTypes.func.isRequired,\n  onShowSidePanel: PropTypes.func.isRequired,\n};\n\nclass RepoViewToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCreateRepoDialogShow: false,\n      isOpen: false,\n    };\n  }\n\n  onCreateRepo = (repo) => {\n    this.props.onCreateRepo(repo);\n    this.onCreateToggle();\n  }\n\n  onCreateToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  toggleMore = () => {\n    this.setState({ isOpen: !this.state.isOpen });\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.toggleMore();\n    }\n  }\n\n  visitDeletedviaKey = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      navigate(`${siteRoot}my-libs/deleted/`);\n    }\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n          {Utils.isDesktop() ? (\n            <div className=\"operation\">\n              <button className=\"btn btn-secondary operation-item\" title={gettext('New Library')} onClick={this.onCreateToggle}>\n                <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Library')}\n              </button>\n              <Dropdown isOpen={this.state.isOpen} toggle={this.toggleMore}>\n                <DropdownToggle className='btn btn-secondary operation-item' onKeyDown={this.onDropdownToggleKeyDown}>\n                  {gettext('More')}\n                </DropdownToggle>\n                <DropdownMenu>\n                  <DropdownItem className=\"link-dropdown-container\" onKeyDown={this.visitDeletedviaKey}>\n                    <Link className=\"link-dropdown-item\" to={siteRoot + 'my-libs/deleted/'}>{gettext('Deleted Libraries')}</Link>\n                  </DropdownItem>\n                </DropdownMenu>\n              </Dropdown>\n            </div>\n          ) : (\n            <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Library')} onClick={this.onCreateToggle}></span>\n          )}\n        </div>\n        {this.state.isCreateRepoDialogShow && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.props.libraryType}\n              onCreateRepo={this.onCreateRepo}\n              onCreateToggle={this.onCreateToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nRepoViewToolbar.propTypes = propTypes;\n\nexport default RepoViewToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  currentRepo: PropTypes.object.isRequired,\n  closeDetails: PropTypes.func.isRequired,\n};\n\nclass LibDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileCount: 0,\n    };\n  }\n\n  componentDidMount() {\n    let repo = this.props.currentRepo;\n    this.getFileCounts(repo);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.currentRepo.repo_id !== this.props.currentRepo.repo_id) {\n      this.getFileCounts(nextProps.currentRepo);\n    }\n  }\n\n  getFileCounts = (repo) => {\n    seafileAPI.getRepoInfo(repo.repo_id).then(res => {\n      this.setState({fileCount: res.data.file_count});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let repo = this.props.currentRepo;\n    let smallIconUrl = Utils.getLibIconUrl(repo);\n    let bigIconUrl = Utils.getLibIconUrl(repo, true);\n\n    return (\n      <div className=\"detail-container\">\n        <div className=\"detail-header\">\n          <div className=\"detail-control sf2-icon-x1\" onClick={this.props.closeDetails}></div>\n          <div className=\"detail-title dirent-title\">\n            <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{'  '}\n            <span className=\"name ellipsis\" title={repo.repo_name}>{repo.repo_name}</span>\n          </div>\n        </div>\n        <div className=\"detail-body dirent-info\">\n          <div className=\"img\">\n            <img src={bigIconUrl} height=\"96\"  alt=\"\" />\n          </div>\n          <div className=\"dirent-table-container\">\n            <table className=\"table-thead-hidden\">\n              <thead>\n                <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n              </thead>\n              <tbody>\n                <tr><th>{gettext('Files')}</th><td>{this.state.fileCount}</td></tr>\n                <tr><th>{gettext('Size')}</th><td>{repo.size}</td></tr>\n                <tr><th>{gettext('Last Update')}</th><td>{ moment(repo.last_modified).fromNow()}</td></tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nLibDetail.propTypes = propTypes;\n\nexport default LibDetail;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext, enableRepoHistorySetting } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  itemName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibHistorySetting extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      keepDays: -1,\n      expireDays: 30,\n      disabled: true,\n      allHistory: true,\n      noHistory: false,\n      autoHistory: false,\n      errorInfo: ''\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoHistoryLimit(this.props.repoID).then(res => {\n      this.setState({\n        keepDays: res.data.keep_days,\n        allHistory: res.data.keep_days < 0 ? true : false,\n        noHistory: res.data.keep_days === 0 ? true : false,\n        autoHistory: res.data.keep_days > 0 ? true : false,\n        disabled: res.data.keep_days > 0 ? false : true,\n        expireDays: res.data.keep_days > 0 ? res.data.keep_days : 30,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let days = this.state.keepDays;\n    if (this.state.autoHistory) {\n      days = this.state.expireDays;\n    }\n    let repoID = this.props.repoID;\n    let reg = /^-?\\d+$/;\n    let flag = reg.test(days);\n    if (flag) {\n      let message = gettext('Successfully set library history.');\n      seafileAPI.setRepoHistoryLimit(repoID, days).then(res => {\n        toaster.success(message);\n        this.setState({keepDays: res.data.keep_days});\n        this.props.toggleDialog();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      this.setState({\n        errorInfo: gettext('Please enter a non-negative integer'),\n      });\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  }\n\n  onChange = (e) => {\n    let num = e.target.value;\n    this.setState({\n      keepDays: num,\n      expireDays: num,\n    });\n  }\n\n  setLimitDays = (type) => {\n    if (type === 'allHistory') {\n      this.setState({\n        keepDays: -1,\n        disabled: true\n      });\n    } else if (type === 'noHistory') {\n      this.setState({\n        keepDays: 0,\n        disabled: true\n      });\n    } else {\n      this.setState({\n        disabled: false\n      });\n    }\n\n    this.setState({\n      allHistory: type === 'allHistory' ? true : false,\n      noHistory: type === 'noHistory' ? true : false,\n      autoHistory: type === 'autoHistory' ? true : false,\n    });\n  }\n\n  render() {\n    const itemName = this.props.itemName;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          <span className=\"op-target\" title={itemName}>{itemName}</span>{' '}\n          {gettext('History Setting')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            {!enableRepoHistorySetting &&\n              <FormGroup>\n                <Label className=\"error\">{gettext('Setting library history is disabled by Admin.')}</Label>\n              </FormGroup>\n            }\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.allHistory} disabled={!enableRepoHistorySetting} onChange={() => {this.setLimitDays('allHistory');}}/>{' '}\n              <Label>{gettext('Keep full history')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.noHistory} disabled={!enableRepoHistorySetting} onChange={() =>{this.setLimitDays('noHistory');}}/>{' '}\n              <Label>{gettext('Don\\'t keep history')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.autoHistory} disabled={!enableRepoHistorySetting} onChange={() =>{this.setLimitDays('autoHistory');}}/>{' '}\n              <Label>{gettext('Only keep a period of history:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.expireDays}\n                onChange={this.onChange}\n                disabled={this.state.disabled}\n                onKeyDown={this.handleKeyPress}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibHistorySetting.propTypes = propTypes;\n\nexport default LibHistorySetting;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext, repoPasswordMinLength } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ChangeRepoPasswordDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      oldPassword: '',\n      newPassword: '',\n      newPasswordAgain: '',\n      submitBtnDisabled: false,\n      errorMsg: ''\n    };\n  }\n\n  handleOldPasswordInputChange = (e) => {\n    this.setState({\n      oldPassword: e.target.value\n    });\n  }\n\n  handleNewPasswordInputChange = (e) => {\n    this.setState({\n      newPassword: e.target.value\n    });\n  }\n\n  handleNewPasswordAgainInputChange = (e) => {\n    this.setState({\n      newPasswordAgain: e.target.value\n    });\n  }\n\n  formSubmit = (e) => {\n    const { oldPassword, newPassword, newPasswordAgain } = this.state;\n    if (!oldPassword) {\n      this.setState({\n        errorMsg: gettext('Please enter the old password')\n      });\n      return false;\n    }\n    if (!newPassword) {\n      this.setState({\n        errorMsg: gettext('Please enter a new password')\n      });\n      return false;\n    }\n    if (newPassword.length < repoPasswordMinLength) {\n      this.setState({\n        errorMsg: gettext('New password is too short')\n      });\n      return false;\n    }\n    if (!newPasswordAgain) {\n      this.setState({\n        errorMsg: gettext('Please enter the new password again')\n      });\n      return false;\n    }\n    if (newPassword != newPasswordAgain) {\n      this.setState({\n        errorMsg: gettext('New passwords don\\'t match')\n      });\n      return false;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n    seafileAPI.changeEncryptedRepoPassword(this.props.repoID, oldPassword, newPassword)\n      .then(() => {\n        this.props.toggleDialog();\n        toaster.success(gettext('Successfully changed library password.'));\n      }).catch((error) => {\n        let errorMsg = Utils.getErrorMsg(error);\n        this.setState({\n          errorMsg: errorMsg,\n          submitBtnDisabled: false\n        });\n      });\n  }\n\n\n  render() {\n    const { repoName, toggleDialog } = this.props;\n\n    return (\n      <Modal isOpen={true} centered={true} style={{height: 'auto'}}>\n        <ModalHeader toggle={toggleDialog}>\n          <span>\n            {Utils.generateDialogTitle(gettext('Change Password of Library {placeholder}'), repoName)}\n          </span>\n        </ModalHeader>\n        <ModalBody>\n          <form id=\"repo-change-passwd-form\" action=\"\" method=\"post\">\n            <label htmlFor=\"passwd\">{gettext('Old Password')}</label><br />\n            <input type=\"password\" name=\"old_passwd\" className=\"form-control\" id=\"passwd\" value={this.state.oldPassword} onChange={this.handleOldPasswordInputChange} /><br />\n            <label htmlFor=\"new-passwd\">{gettext('New Password')}</label><span className=\"tip\">{gettext('(at least {placeholder} characters)').replace('{placeholder}', repoPasswordMinLength)}</span><br />\n            <input type=\"password\" name=\"new_passwd\" className=\"form-control\" id=\"new-passwd\" value={this.state.newPassword} onChange={this.handleNewPasswordInputChange} /><br />\n            <label htmlFor=\"new-passwd-again\">{gettext('New Password Again')}</label><br />\n            <input type=\"password\" name=\"new_passwd_again\" className=\"form-control\" id=\"new-passwd-again\" value={this.state.newPasswordAgain} onChange={this.handleNewPasswordAgainInputChange} /><br />\n            {this.state.errorMsg && <Alert color=\"danger\">{this.state.errorMsg}</Alert>}\n          </form>\n        </ModalBody>\n        <ModalFooter>\n          <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nChangeRepoPasswordDialog.propTypes = propTypes;\n\nexport default ChangeRepoPasswordDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport toaster from '../../components/toast';\nimport { Button, Form, FormGroup, Label, Input, Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext, contactEmail } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass ResetEncryptedRepoPasswordDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      errMessage: '',\n      showLoading: true,\n      showSuccess: false,\n      showError: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.resetAndSendEncryptedRepoPassword(this.props.repoID).then((res) => {\n      this.setState({showLoading: false});\n      this.setState({showSuccess: true});\n    }).catch((error) => {\n      if (error.response) {\n        this.setState({\n          errMessage: error.response.data.error_msg\n        });\n        this.setState({showLoading: false});\n        this.setState({showError: true});\n      }\n    });\n  }\n\n  render() {\n\n    let user_email = '<strong>' + contactEmail + '</strong>';\n    let message = gettext('New password has been sent to your email {mail}. Please check your mailbox. If you don’t receive the password, please check if your email address is properly configured.').replace('{mail}', user_email);\n\n    return (\n      <Modal isOpen={true}  centered={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Reset library password')}\n        </ModalHeader>\n        <ModalBody>\n          {this.state.showLoading && (\n            <span>{gettext('Sending new password...')}</span>\n          )}\n          {this.state.showSuccess && (\n            <div dangerouslySetInnerHTML={{__html:message}} />\n          )}\n          {this.state.showError && (\n            <span className=\"err-message\">{this.state.errMessage}</span>\n          )}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nResetEncryptedRepoPasswordDialog.propTypes = propTypes;\n\nexport default ResetEncryptedRepoPasswordDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport CreatableSelect from 'react-select/lib/Creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LabelRepoStateDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      existingLabels: null,\n      errorMsg: '',\n      submitBtnDisabled: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getAllRepoSnapshotLabels().then((res) => {\n      this.setState({\n        isLoading: false,\n        existingLabels: res.data,\n        errorMsg: ''\n      });\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  }\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n\n    if (!inputValue || !inputValue.length) { // undefined or []\n      this.setState({\n        formErrorMsg: gettext('It is required.')\n      });\n      return;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    const {repoID, repoName} = this.props;\n    const labels = inputValue.map((item, index) => item.value).join(',');\n    seafileAPI.addNewRepoLabels(repoID, labels).then((res) => {\n      const msg = gettext('Successfully added label(s) for library {placeholder}').replace('{placeholder}', repoName);\n      toaster.success(msg);\n      this.props.toggleDialog();\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Label Current State')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} handleChange={this.handleInputChange} />\n        </ModalBody>\n        {this.state.existingLabels && (\n          <ModalFooter>\n            <button className=\"btn btn-secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</button>\n            <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n          </ModalFooter>\n        )}\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const { isLoading, errorMsg, existingLabels, formErrorMsg } = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <React.Fragment>\n        <CreatableSelect\n          isMulti={true}\n          onChange={this.props.handleChange}\n          placeholder=''\n          options={existingLabels.map((item, index) => { return {label: item, value: item}; })}\n        />\n        {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n      </React.Fragment>\n    );\n  }\n}\n\nLabelRepoStateDialog.propTypes = propTypes;\n\nexport default LabelRepoStateDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, isPro, siteRoot } from '../../utils/constants';\nimport { Button, Input, InputGroup, InputGroupAddon } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils.js';\nimport UserSelect from '../user-select';\nimport SharePermissionEditor from '../select-editor/share-permission-editor';\nimport FileChooser from '../file-chooser/file-chooser';\n\nclass UserItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  }\n\n  deleteUserFolderPermission = () => {\n    let item = this.props.item;\n    this.props.deleteUserFolderPermission(item);\n  }\n\n  onChangeUserFolderPerm = (permission) => {\n    let item = this.props.item;\n    this.props.onChangeUserFolderPerm(item.repo_id, permission, item.folder_path, item.user_email);\n  }\n\n  render() {\n    let item = this.props.item;\n    let currentPermission = item.permission;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td>\n          <a href={`${siteRoot}profile/${encodeURIComponent(item.user_email)}/`} target=\"_blank\">{item.user_name}</a>\n        </td>\n        {this.props.showPath &&\n          <td>\n            <a href={`${siteRoot}library/${item.repo_id}/${Utils.encodePath(this.props.repoName + item.folder_path)}`}>{item.folder_name}</a>\n          </td>\n        }\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={currentPermission}\n            permissions={this.props.permissions}\n            onPermissionChanged={this.onChangeUserFolderPerm}\n          />\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.deleteUserFolderPermission}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  isDepartmentRepo: PropTypes.bool\n};\n\n\nclass LibSubFolderSetUserPermissionDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedUsers: null,\n      errorMsg: [],\n      permission: 'rw',\n      userFolderPermItems: [],\n      folderPath: '',\n      showFileChooser: false\n    };\n    if (!isPro) {\n      this.permissions = ['r', 'rw'];\n    } else {\n      this.permissions = ['r', 'rw', 'cloud-edit', 'preview'];\n    }\n  }\n\n  handleUserSelectChange = (option) => {\n    this.setState({selectedUsers: option});\n  }\n\n  componentDidMount() {\n    const {repoID, folderPath, isDepartmentRepo} = this.props;\n    const request = isDepartmentRepo ?\n      seafileAPI.listDepartmentRepoUserFolderPerm(repoID, folderPath) :\n      seafileAPI.listUserFolderPerm(repoID, folderPath);\n    request.then((res) => {\n      if (res.data.length !== 0) {\n        this.setState({userFolderPermItems: res.data});\n      }\n    });\n  }\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  }\n\n  addUserFolderPerm = () => {\n    const { selectedUsers } = this.state;\n    const folderPath = this.props.folderPath || this.state.folderPath;\n    if (!selectedUsers || !selectedUsers.length || !folderPath) { // selectedUsers: null or []\n      return false;\n    }\n\n    const users = selectedUsers.map((item, index) => item.email);\n\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.addDepartmentRepoUserFolderPerm(this.props.repoID, this.state.permission, folderPath, users) :\n      seafileAPI.addUserFolderPerm(this.props.repoID, this.state.permission, folderPath, users);\n    request.then(res => {\n      let errorMsg = [];\n      if (res.data.failed.length > 0) {\n        for (let i = 0; i < res.data.failed.length; i++) {\n          errorMsg[i] = res.data.failed[i];\n        }\n      }\n      this.setState({\n        errorMsg: errorMsg,\n        userFolderPermItems: this.state.userFolderPermItems.concat(res.data.success),\n        selectedUsers: null,\n        permission: 'rw',\n        folderPath: '',\n      });\n      this.refs.userSelect.clearSelect();\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        if (error.response.data && error.response.data['error_msg']) {\n          errorMsg = error.response.data['error_msg'];\n        } else {\n          errorMsg = gettext('Error');\n        }\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      this.setState({\n        errorMsg: [errorMsg]\n      });\n    });\n  }\n\n  deleteUserFolderPermItem = (item) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.deleteDepartmentRepoUserFolderPerm(item.repo_id, item.permission, item.folder_path, item.user_email) :\n      seafileAPI.deleteUserFolderPerm(item.repo_id, item.permission, item.folder_path, item.user_email);\n    request.then(res => {\n      this.setState({\n        userFolderPermItems: this.state.userFolderPermItems.filter(deletedItem => {\n          return deletedItem != item;\n        })\n      });\n    });\n  }\n\n  onChangeUserFolderPerm = (repoID, permission, folderPath, userEmail) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.updateDepartmentRepoUserFolderPerm(repoID, permission, folderPath, userEmail) :\n      seafileAPI.updateUserFolderPerm(repoID, permission, folderPath, userEmail);\n    request.then(res => {\n      let userFolderPermItems = this.state.userFolderPermItems.map(item => {\n        if (item.user_email === userEmail && item.folder_path === folderPath) {\n          item.permission = permission;\n        }\n        return item;\n      });\n      this.setState({userFolderPermItems: userFolderPermItems});\n    });\n  }\n\n  onSetSubFolder = (e) => {\n    this.setState({\n      folderPath: e.target.value\n    });\n  }\n\n  toggleFileChooser = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser,\n      folderPath: ''\n    });\n  }\n\n  toggleSubFolder = (repo, path, item) => {\n    this.setState({\n      folderPath: path,\n    });\n  }\n\n  handleFileChooserSubmit = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser\n    });\n  }\n\n  onRepoItemClick = () => {\n    this.setState({\n      folderPath: '/'\n    });\n  }\n\n  render() {\n    let showPath = this.props.folderPath ? false : true;\n    let { userFolderPermItems } = this.state;\n\n    if (this.state.showFileChooser) {\n      return (\n        <div>\n          <FileChooser\n            repoID={this.props.repoID}\n            mode={'only_current_library'}\n            onDirentItemClick={this.toggleSubFolder}\n            onRepoItemClick={this.onRepoItemClick}\n          />\n          <div className=\"modal-footer\">\n            <Button color=\"secondary\" onClick={this.toggleFileChooser}>{gettext('Cancel')}</Button>\n            <Button color=\"primary\" onClick={this.handleFileChooserSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      );\n    }\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width={showPath ? '32%': '55%'}>{gettext('User')}</th>\n          {showPath &&\n          <th width=\"32%\">{gettext('Folder')}</th>\n          }\n          <th width={showPath ? '24%': '30%'}>{gettext('Permission')}</th>\n          <th width={showPath ? '12%' : '15%'}></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        <table className=\"w-xs-250\">\n          {thead}\n          <tbody>\n            <tr>\n              <td>\n                <UserSelect\n                  ref=\"userSelect\"\n                  isMulti={true}\n                  className=\"reviewer-select\"\n                  placeholder={gettext('Search users...')}\n                  onSelectChange={this.handleUserSelectChange}\n                  value={this.state.selectedUsers}\n                />\n              </td>\n              {showPath &&\n                <td>\n                  <InputGroup>\n                    <Input value={this.state.folderPath} onChange={this.onSetSubFolder} />\n                    <InputGroupAddon addonType=\"append\"><Button className=\"sf2-icon-plus\" onClick={this.toggleFileChooser}></Button></InputGroupAddon>\n                  </InputGroup>\n                </td>\n              }\n              <td>\n                <SharePermissionEditor\n                  isTextMode={false}\n                  isEditIconShow={false}\n                  currentPermission={this.state.permission}\n                  permissions={this.permissions}\n                  onPermissionChanged={this.setPermission}\n                />\n              </td>\n              <td>\n                <Button onClick={this.addUserFolderPerm}>{gettext('Submit')}</Button>\n              </td>\n            </tr>\n            {this.state.errorMsg.length > 0 &&\n              this.state.errorMsg.map((item, index) => {\n                let errMessage = '';\n                if (item.user_email) {\n                  errMessage = item.user_email + ': ' + item.error_msg;\n                } else {\n                  errMessage = item;\n                }\n                return (\n                  <tr key={index}>\n                    <td colSpan={3}><p className=\"error\">{errMessage}</p></td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n        <div className=\"share-list-container\">\n          <table className=\"table-thead-hidden w-xs-250\">\n            {thead}\n            <tbody>\n              {userFolderPermItems.map((item, index) => {\n                return (\n                  <UserItem\n                    key={index}\n                    item={item}\n                    permissions={this.permissions}\n                    deleteUserFolderPermission={this.deleteUserFolderPermItem}\n                    onChangeUserFolderPerm={this.onChangeUserFolderPerm}\n                    showPath={showPath}\n                    repoName={this.props.repoName}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nLibSubFolderSetUserPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderSetUserPermissionDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Input, InputGroup, InputGroupAddon } from 'reactstrap';\nimport Select from 'react-select';\nimport makeAnimated from 'react-select/lib/animated';\nimport { gettext, isPro, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils.js';\nimport SharePermissionEditor from '../select-editor/share-permission-editor';\nimport FileChooser from '../file-chooser/file-chooser';\n\nclass GroupItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  }\n\n  deleteGroupPermissionItem = () => {\n    let item = this.props.item;\n    this.props.deleteGroupPermissionItem(item);\n  }\n\n  onChangeGroupPermission = (permission) => {\n    let item = this.props.item;\n    this.props.onChangeGroupPermission(item, permission);\n  }\n\n  render() {\n    let item = this.props.item;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td>\n          <a href={`${siteRoot}group/${item.group_id}/`} target=\"_blank\">{item.group_name}</a>\n        </td>\n        {this.props.showPath &&\n          <td>\n            <a href={`${siteRoot}library/${item.repo_id}/${Utils.encodePath(this.props.repoName + item.folder_path)}`}>{item.folder_name}</a>\n          </td>\n        }\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={item.permission}\n            permissions={this.props.permissions}\n            onPermissionChanged={this.onChangeGroupPermission}\n          />\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.deleteGroupPermissionItem}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  isDepartmentRepo: PropTypes.bool\n};\n\nconst NoOptionsMessage = (props) => {\n  return (\n    <div {...props.innerProps} style={{margin: '6px 10px', textAlign: 'center', color: 'hsl(0,0%,50%)'}}>{gettext('Group not found')}</div>\n  );\n};\n\nclass LibSubFolderSerGroupPermissionDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedOption: null,\n      errorMsg: [],\n      permission: 'rw',\n      groupPermissionItems: [],\n      folderPath: '',\n      showFileChooser: false\n    };\n    this.options = [];\n    if (!isPro) {\n      this.permissions = ['r', 'rw'];\n    } else {\n      this.permissions = ['r', 'rw', 'cloud-edit', 'preview'];\n    }\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({selectedOption: option});\n  }\n\n  componentDidMount() {\n    this.loadOptions();\n    this.listGroupPermissionItems();\n  }\n\n  loadOptions = () => {\n    seafileAPI.shareableGroups().then((res) => {\n      this.options = res.data.map((item, index) => {\n        return {\n          id: item.id,\n          label: item.name,\n          value: item.name\n        };\n      });\n    });\n  }\n\n  listGroupPermissionItems = () => {\n    const { isDepartmentRepo, repoID, folderPath } = this.props;\n    const request = isDepartmentRepo ?\n      seafileAPI.listDepartmentRepoGroupFolderPerm(repoID, folderPath) :\n      seafileAPI.listGroupFolderPerm(repoID, folderPath);\n    request.then((res) => {\n      if (res.data.length !== 0) {\n        this.setState({\n          groupPermissionItems: res.data\n        });\n      }\n    });\n  }\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  }\n\n  addGroupFolderPerm = () => {\n    const { selectedOption } = this.state;\n    const folderPath = this.props.folderPath || this.state.folderPath;\n    if (!selectedOption || !folderPath) {\n      return false;\n    }\n\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.addDepartmentRepoGroupFolderPerm(this.props.repoID, this.state.permission, folderPath, selectedOption.id) :\n      seafileAPI.addGroupFolderPerm(this.props.repoID, this.state.permission, folderPath, selectedOption.id);\n    request.then(res => {\n      let errorMsg = [];\n      if (res.data.failed.length > 0) {\n        for (let i = 0; i < res.data.failed.length; i++) {\n          errorMsg[i] = res.data.failed[i];\n        }\n      }\n\n      this.setState({\n        errorMsg: errorMsg,\n        groupPermissionItems: this.state.groupPermissionItems.concat(res.data.success),\n        selectedOption: null,\n        permission: 'rw',\n        folderPath: ''\n      });\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        if (error.response.data && error.response.data['error_msg']) {\n          errorMsg = error.response.data['error_msg'];\n        } else {\n          errorMsg = gettext('Error');\n        }\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      this.setState({\n        errorMsg: [errorMsg]\n      });\n    });\n  }\n\n  deleteGroupPermissionItem = (item) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.deleteDepartmentRepoGroupFolderPerm(item.repo_id, item.permission, item.folder_path, item.group_id) :\n      seafileAPI.deleteGroupFolderPerm(item.repo_id, item.permission, item.folder_path, item.group_id);\n    request.then(() => {\n      this.setState({\n        groupPermissionItems: this.state.groupPermissionItems.filter(deletedItem => { return deletedItem != item; })\n      });\n    });\n  }\n\n  onChangeGroupPermission = (item, permission) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.updateDepartmentRepoGroupFolderPerm(item.repo_id, permission, item.folder_path, item.group_id) :\n      seafileAPI.updateGroupFolderPerm(item.repo_id, permission, item.folder_path, item.group_id);\n    request.then(() => {\n      this.updateGroupPermission(item, permission);\n    });\n  }\n\n  updateGroupPermission = (item, permission) => {\n    let groupID = item.group_id;\n    let groupPermissionItems = this.state.groupPermissionItems.map(sharedItem => {\n      let sharedItemGroupID = sharedItem.group_id;\n      if (groupID === sharedItemGroupID && item.folder_path === sharedItem.folder_path) {\n        sharedItem.permission = permission;\n      }\n      return sharedItem;\n    });\n    this.setState({groupPermissionItems: groupPermissionItems});\n  }\n\n  onSetSubFolder = (e) => {\n    this.setState({\n      folderPath: e.target.value\n    });\n  }\n\n  toggleFileChooser = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser,\n      folderPath: ''\n    });\n  }\n\n  toggleSubFolder = (repo, path, item) => {\n    this.setState({\n      folderPath: path,\n    });\n  }\n\n  handleSubmit = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser\n    });\n  }\n\n  onRepoItemClick = () => {\n    this.setState({\n      folderPath: '/'\n    });\n  }\n\n  render() {\n    let showPath = this.props.folderPath ? false : true;\n\n    if (this.state.showFileChooser) {\n      return (\n        <div>\n          <FileChooser\n            repoID={this.props.repoID}\n            mode={'only_current_library'}\n            onDirentItemClick={this.toggleSubFolder}\n            onRepoItemClick={this.onRepoItemClick}\n          />\n          <div className=\"modal-footer\">\n            <Button color=\"secondary\" onClick={this.toggleFileChooser}>{gettext('Cancel')}</Button>\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      );\n    }\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width={showPath ? '32%' : '55%'}>{gettext('Group')}</th>\n          {showPath &&\n          <th width=\"32%\">{gettext('Folder')}</th>\n          }\n          <th width={showPath ? '24%' : '30%'}>{gettext('Permission')}</th>\n          <th width={showPath ? '12%' : '15%'}></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        <table className=\"w-xs-250\">\n          {thead}\n          <tbody>\n            <tr>\n              <td>\n                <Select\n                  onChange={this.handleSelectChange}\n                  options={this.options}\n                  placeholder={gettext('Select a group')}\n                  maxMenuHeight={200}\n                  inputId={'react-select-2-input'}\n                  value={this.state.selectedOption}\n                  components={{ NoOptionsMessage }}\n                />\n              </td>\n              {showPath &&\n                <td>\n                  <InputGroup>\n                    <Input value={this.state.folderPath} onChange={this.onSetSubFolder} />\n                    <InputGroupAddon addonType=\"append\"><Button className=\"sf2-icon-plus\" onClick={this.toggleFileChooser}></Button></InputGroupAddon>\n                  </InputGroup>\n                </td>\n              }\n              <td>\n                <SharePermissionEditor\n                  isTextMode={false}\n                  isEditIconShow={false}\n                  currentPermission={this.state.permission}\n                  permissions={this.permissions}\n                  onPermissionChanged={this.setPermission}\n                />\n              </td>\n              <td>\n                <Button onClick={this.addGroupFolderPerm}>{gettext('Submit')}</Button>\n              </td>\n            </tr>\n            {this.state.errorMsg.length > 0 &&\n              this.state.errorMsg.map((item, index) => {\n                let errMessage = item.group_id + ': ' + item.error_msg;\n                return (\n                  <tr key={index}>\n                    <td colSpan={3}><p className=\"error\">{errMessage}</p></td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n        <div className=\"share-list-container\">\n          <table className=\"table-thead-hidden w-xs-250\">\n            {thead}\n            <tbody>\n              {this.state.groupPermissionItems.map((item, index) => {\n                return (\n                  <GroupItem\n                    key={index}\n                    item={item}\n                    permissions={this.permissions}\n                    deleteGroupPermissionItem={this.deleteGroupPermissionItem}\n                    onChangeGroupPermission={this.onChangeGroupPermission}\n                    showPath={showPath}\n                    repoName={this.props.repoName}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nLibSubFolderSerGroupPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderSerGroupPermissionDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, TabContent, TabPane, Nav, NavItem, NavLink } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport LibSubFolderSetUserPermissionDialog from './lib-sub-folder-set-user-permission-dialog';\nimport LibSubFolderSetGroupPermissionDialog from './lib-sub-folder-set-group-permission-dialog';\nimport '../../css/share-link-dialog.css';\nimport '../../css/sub-folder-permission.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string,\n  isDepartmentRepo: PropTypes.bool,\n  folderPath: PropTypes.string,\n  folderName: PropTypes.string,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LibSubFolderPermissionDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTab: 'userPermission'\n    };\n  }\n\n  toggle = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({activeTab: tab});\n    }\n  }\n\n  renderContent = () => {\n    const activeTab = this.state.activeTab;\n\n    return (\n      <Fragment>\n        <div className=\"share-dialog-side\">\n          <Nav pills>\n            <NavItem role=\"tab\" aria-selected={activeTab === 'userPermission'} aria-controls=\"user-perm-panel\">\n              <NavLink className={activeTab === 'userPermission' ? 'active' : ''} onClick={this.toggle.bind(this, 'userPermission')} tabIndex=\"0\" onKeyDown={Utils.onKeyDown}>\n                {gettext('User Permission')}\n              </NavLink>\n            </NavItem>\n            <NavItem role=\"tab\" aria-selected={activeTab === 'groupPermission'} aria-controls=\"group-perm-panel\">\n              <NavLink className={activeTab === 'groupPermission' ? 'active' : ''} onClick={this.toggle.bind(this, 'groupPermission')} tabIndex=\"0\" onKeyDown={Utils.onKeyDown}>\n                {gettext('Group Permission')}\n              </NavLink>\n            </NavItem>\n          </Nav>\n        </div>\n        <div className=\"share-dialog-main\">\n          <TabContent activeTab={this.state.activeTab}>\n            <TabPane tabId=\"userPermission\" role=\"tabpanel\" id=\"user-perm-panel\">\n              <LibSubFolderSetUserPermissionDialog repoID={this.props.repoID} repoName={this.props.repoName} folderPath={this.props.folderPath} isDepartmentRepo={this.props.isDepartmentRepo} />\n            </TabPane>\n            <TabPane tabId=\"groupPermission\" role=\"tabpanel\" id=\"group-perm-panel\">\n              <LibSubFolderSetGroupPermissionDialog repoID={this.props.repoID} repoName={this.props.repoName} folderPath={this.props.folderPath} isDepartmentRepo={this.props.isDepartmentRepo} />\n            </TabPane>\n          </TabContent>\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const { repoName, folderName } = this.props;\n    return (\n      <div>\n        <Modal isOpen={true} style={{maxWidth: '980px'}} className=\"share-dialog\" toggle={this.props.toggleDialog}>\n          <ModalHeader toggle={this.props.toggleDialog}>\n            <span>{repoName ? Utils.generateDialogTitle(gettext('{placeholder} Folder Permission'), repoName) : Utils.generateDialogTitle(gettext('Set {placeholder}\\'s permission'), folderName)}</span>\n          </ModalHeader>\n          <ModalBody className=\"dialog-list-container share-dialog-content\" role=\"tablist\">\n            {this.renderContent()}\n          </ModalBody>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nLibSubFolderPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderPermissionDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../utils/constants';\nimport toaster from './toast';\n\nconst propTypes = {\n  hasSuffix: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onRenameConfirm: PropTypes.func.isRequired,\n  onRenameCancel: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: props.name\n    };\n  }\n\n  componentDidMount() {\n    this.refs.renameInput.focus();\n    if (this.props.hasSuffix) {\n      var endIndex = this.props.name.lastIndexOf('.');\n      this.refs.renameInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.refs.renameInput.setSelectionRange(0, -1);\n    }\n  }\n\n  onChange = (e) => {\n    this.setState({name: e.target.value});\n  }\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  onKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.onRenameConfirm(e);\n    }\n  }\n\n  onRenameConfirm = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let newName = this.state.name.trim();\n    if (newName === this.props.name) {\n      this.props.onRenameCancel();\n      return;\n    }\n\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      toaster.danger(errMessage);\n    } else {\n      this.props.onRenameConfirm(newName);\n    }\n  }\n\n  onRenameCancel = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onRenameCancel();\n  }\n\n  validateInput = () => {\n    let newName = this.state.name.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  render() {\n    return (\n      <div className=\"rename-container\">\n        <input\n          ref=\"renameInput\"\n          value={this.state.name}\n          onChange={this.onChange}\n          onKeyPress={this.onKeyPress}\n          onClick={this.onClick}\n        />\n        <button className=\"btn btn-secondary sf2-icon-confirm confirm\" onClick={this.onRenameConfirm}></button>\n        <button className=\"btn btn-secondary sf2-icon-cancel cancel\" onClick={this.onRenameCancel}></button>\n      </div>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, isPro, folderPermEnabled, enableRepoSnapshotLabel, enableResetEncryptedRepoPassword, isEmailConfigured, enableRepoAutoDel } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  isPC: PropTypes.bool,\n  repo: PropTypes.object.isRequired,\n  isStarred: PropTypes.bool,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemMenuShow: false,\n    };\n  }\n\n  onMenuItemClick = (e) => {\n    let operation = Utils.getEventData(e, 'toggle');\n    this.props.onMenuItemClick(operation);\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    this.toggleOperationMenu(e);\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onDropdownToggleClick(e);\n    }\n  }\n\n  toggleOperationMenu = (e) => {\n    let dataset = e.target ? e.target.dataset : null;\n    if (dataset && dataset.toggle && dataset.toggle === 'Rename') {\n      this.setState({isItemMenuShow: !this.state.isItemMenuShow});\n      return;\n    }\n\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.props.onUnfreezedItem();\n        }\n      }\n    );\n  }\n\n  generatorOperations = () => {\n    let repo = this.props.repo;\n    let showResetPasswordMenuItem = isPro && repo.encrypted && enableResetEncryptedRepoPassword && isEmailConfigured;\n    let operations = ['Rename', 'Transfer'];\n    if (folderPermEnabled) {\n      operations.push('Folder Permission');\n    }\n    operations.push('Share Links Admin', 'Divider');\n    if (repo.encrypted) {\n      operations.push('Change Password');\n    }\n    if (showResetPasswordMenuItem) {\n      operations.push('Reset Password');\n    }\n    operations.push('History Setting', 'API Token');\n    if (this.props.isPC && enableRepoSnapshotLabel) {\n      operations.push('Label Current State');\n    }\n    if (enableRepoAutoDel) {\n      operations.push('Old Files Auto Delete');\n    }\n    return operations;\n  }\n\n  translateOperations = (item) => {\n    let translateResult = '';\n    switch(item) {\n      case 'Star':\n        translateResult = gettext('Star');\n        break;\n      case 'Unstar':\n        translateResult = gettext('Unstar');\n        break;\n      case 'Share':\n        translateResult = gettext('Share');\n        break;\n      case 'Delete':\n        translateResult = gettext('Delete');\n        break;\n      case 'Rename':\n        translateResult = gettext('Rename');\n        break;\n      case 'Transfer':\n        translateResult = gettext('Transfer');\n        break;\n      case 'History Setting':\n        translateResult = gettext('History Setting');\n        break;\n      case 'Change Password':\n        translateResult = gettext('Change Password');\n        break;\n      case 'Reset Password':\n        translateResult = gettext('Reset Password');\n        break;\n      case 'Folder Permission':\n        translateResult = gettext('Folder Permission');\n        break;\n      case 'Label Current State':\n        translateResult = gettext('Label Current State');\n        break;\n      case 'API Token':\n        translateResult = 'API Token'; // translation is not needed here\n        break;\n      case 'Share Links Admin':\n        translateResult = gettext('Share Links Admin');\n        break;\n      case 'Old Files Auto Delete':\n        translateResult = gettext('Auto deletion');\n        break;\n      default:\n        break;\n    }\n\n    return translateResult;\n  }\n\n  render() {\n    let operations = this.generatorOperations();\n\n    // pc menu\n    if (this.props.isPC) {\n      return (\n        <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n          <DropdownToggle\n            tag=\"i\"\n            role=\"button\"\n            tabIndex=\"0\"\n            className=\"sf-dropdown-toggle sf2-icon-caret-down\"\n            title={gettext('More Operations')}\n            aria-label={gettext('More Operations')}\n            onClick={this.onDropdownToggleClick}\n            onKeyDown={this.onDropdownToggleKeyDown}\n            data-toggle=\"dropdown\"\n          />\n          <DropdownMenu>\n            {operations.map((item, index)=> {\n              if (item == 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (<DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{this.translateOperations(item)}</DropdownItem>);\n              }\n            })}\n          </DropdownMenu>\n        </Dropdown>\n      );\n    }\n\n    // mobile menu\n    operations.unshift('Delete');\n    operations.unshift('Share');\n    this.props.isStarred ? operations.unshift('Unstar') : operations.unshift('Star');\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n        <DropdownToggle\n          tag=\"i\"\n          className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n          title={gettext('More Operations')}\n          // onClick={this.clickOperationMenuToggle}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n        />\n        <div className={`${this.state.isItemMenuShow ? '' : 'd-none'}`} onClick={this.toggleOperationMenu}>\n          <div className=\"mobile-operation-menu-bg-layer\"></div>\n          <div className=\"mobile-operation-menu\">\n            {operations.map((item, index) => {\n              if (item != 'Divider') {\n                return (<DropdownItem key={index} className=\"mobile-menu-item\" data-toggle={item} onClick={this.onMenuItemClick}>{this.translateOperations(item)}</DropdownItem>);\n              }\n            })}\n          </div>\n        </div>\n      </Dropdown>\n    );\n  }\n}\n\nMylibRepoMenu.propTypes = propTypes;\n\nexport default MylibRepoMenu;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport { gettext } from '../../utils/constants';\nimport OpIcon from '../op-icon';\n\nconst propTypes = {\n  isTextMode: PropTypes.bool.isRequired,\n  isEditIconShow: PropTypes.bool.isRequired,\n  currentPermission: PropTypes.string.isRequired,\n  onPermissionChanged: PropTypes.func.isRequired,\n};\n\nclass RepoAPITokenPermissionEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditing: false,\n    };\n    this.options = [\n      { value: 'rw', label: <div>{gettext('Read-Write')}</div> },\n      { value: 'r', label: <div>{gettext('Read-Only')}</div> }\n    ];\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.onHideSelect);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onHideSelect);\n  }\n\n  onHideSelect = () => {\n    this.setState({ isEditing: false });\n  }\n\n  onEditPermission = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ isEditing: true });\n  }\n\n  onPermissionChanged = (e) => {\n    if (e.value !== this.props.currentPermission) {\n      this.props.onPermissionChanged(e.value);\n    }\n    this.setState({ isEditing: false });\n  }\n\n  onSelectHandler = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  render() {\n    const { currentPermission, isTextMode } = this.props;\n    let optionTranslation = currentPermission === 'rw' ? gettext('Read-Write') : gettext('Read-Only');\n    return (\n      <div onClick={this.onSelectHandler}>\n        {(isTextMode && !this.state.isEditing) ?\n          <Fragment>\n            <span>{optionTranslation}</span>\n            {this.props.isEditIconShow &&\n              <OpIcon title={gettext('Edit')} className=\"fa fa-pencil-alt attr-action-icon\" op={this.onEditPermission} />\n            }\n          </Fragment>\n          :\n          <Select\n            options={this.options}\n            placeholder={optionTranslation}\n            onChange={this.onPermissionChanged}\n            captureMenuScroll={false}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nRepoAPITokenPermissionEditor.propTypes = propTypes;\n\nexport default RepoAPITokenPermissionEditor;\n","import React, {Fragment} from 'react';\nimport PropTypes from 'prop-types';\nimport {gettext} from '../../utils/constants';\nimport {Modal, ModalHeader, ModalBody, Button, Input} from 'reactstrap';\nimport RepoAPITokenPermissionEditor from '../select-editor/repo-api-token-permission-editor';\nimport {seafileAPI} from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport copy from 'copy-to-clipboard';\nimport Loading from '../loading';\nimport OpIcon from '../op-icon';\n\nconst apiTokenItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteAPIToken: PropTypes.func.isRequired,\n  updateAPIToken: PropTypes.func.isRequired,\n};\n\nclass APITokenItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteAPIToken = () => {\n    this.props.deleteAPIToken(this.props.item.app_name);\n  };\n\n  onUpdateAPIToken = (permission) => {\n    this.props.updateAPIToken(this.props.item.app_name, permission);\n  };\n\n  onCopyAPIToken = () => {\n    let api_token = this.props.item.api_token;\n    copy(api_token);\n    toaster.success(gettext('API token is copied to the clipboard.'));\n  };\n\n  render() {\n    let item = this.props.item;\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} tabIndex=\"0\" onFocus={this.onMouseEnter}>\n        <td className=\"name\">{item.app_name}</td>\n        <td>\n          <RepoAPITokenPermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={item.permission}\n            onPermissionChanged={this.onUpdateAPIToken}\n          />\n        </td>\n        <td>\n          <span>{item.api_token}</span>\n          {this.state.isOperationShow &&\n            <OpIcon\n              className=\"far fa-copy action-icon\"\n              op={this.onCopyAPIToken}\n              title={gettext('Copy')}\n            />\n          }\n        </td>\n        <td>\n          <OpIcon\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            op={this.onDeleteAPIToken}\n            title={gettext('Delete')}\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nAPITokenItem.propTypes = apiTokenItemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  onRepoAPITokenToggle: PropTypes.func.isRequired,\n};\n\nclass RepoAPITokenDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      apiTokenList: [],\n      permission: 'rw',\n      appName: '',\n      errorMsg: '',\n      loading: true,\n      isSubmitBtnActive: true,\n    };\n    this.repo = this.props.repo;\n  }\n\n  listAPITokens = () => {\n    seafileAPI.listRepoAPITokens(this.repo.repo_id).then((res) => {\n      this.setState({\n        apiTokenList: res.data.repo_api_tokens,\n        loading: false,\n      });\n    }).catch(error => {\n      if (error.response.status === 403) {\n        this.setState({\n          errorMsg: gettext('Permission denied'),\n        });\n      } else {\n        this.handleError(error);\n      }\n    });\n  };\n\n  onInputChange = (e) => {\n    let appName = e.target.value;\n    this.setState({\n      appName: appName,\n    });\n  };\n\n  onKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.addAPIToken();\n    }\n  };\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  };\n\n  addAPIToken = () => {\n    if (!this.state.appName) {\n      return;\n    }\n\n    this.setState({\n      isSubmitBtnActive: false,\n    });\n    const {appName, permission, apiTokenList} = this.state;\n\n    seafileAPI.addRepoAPIToken(this.repo.repo_id, appName, permission).then((res) => {\n      apiTokenList.push(res.data);\n      this.setState({\n        apiTokenList: apiTokenList,\n        isSubmitBtnActive: true,\n      });\n    }).catch(error => {\n      this.handleError(error);\n      this.setState({\n        isSubmitBtnActive: true,\n      });\n    });\n  };\n\n  deleteAPIToken = (appName) => {\n    seafileAPI.deleteRepoAPIToken(this.repo.repo_id, appName).then((res) => {\n      const apiTokenList = this.state.apiTokenList.filter(item => {\n        return item.app_name !== appName;\n      });\n      this.setState({\n        apiTokenList: apiTokenList,\n      });\n    }).catch(error => {\n      this.handleError(error);\n    });\n  };\n\n  updateAPIToken = (appName, permission) => {\n    seafileAPI.updateRepoAPIToken(this.repo.repo_id, appName, permission).then((res) => {\n      let apiTokenList = this.state.apiTokenList.filter(item => {\n        if (item.app_name === appName) {\n          item.permission = permission;\n        }\n        return item;\n      });\n      this.setState({\n        apiTokenList: apiTokenList,\n      });\n    }).catch(error => {\n      this.handleError(error);\n    });\n  };\n\n  handleError = (e) => {\n    if (e.response) {\n      toaster.danger(e.response.data.error_msg || e.response.data.detail || gettext('Error'), {duration: 3});\n    } else {\n      toaster.danger(gettext('Please check the network.'), {duration: 3});\n    }\n  };\n\n  componentDidMount() {\n    this.listAPITokens();\n  }\n\n  renderContent = () => {\n    const renderAPITokenList = this.state.apiTokenList.map((item, index) => {\n      return (\n        <APITokenItem\n          key={index}\n          item={item}\n          deleteAPIToken={this.deleteAPIToken}\n          updateAPIToken={this.updateAPIToken}\n        />\n      );\n    });\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width=\"20%\">{gettext('App Name')}</th>\n          <th width=\"20%\">{gettext('Permission')}</th>\n          <th width=\"48%\">API Token</th>\n          <th width=\"12%\"></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        {this.state.errorMsg &&\n          <p className=\"error text-center\">{this.state.errorMsg}</p>\n        }\n        {!this.state.errorMsg &&\n        <Fragment>\n          <table className=\"w-xs-250\">\n            {thead}\n            <tbody>\n              <tr>\n                <td>\n                  <Input\n                    type=\"text\"\n                    id=\"appName\"\n                    value={this.state.appName}\n                    onChange={this.onInputChange}\n                    onKeyDown={this.onKeyDown}\n                  />\n                </td>\n                <td>\n                  <RepoAPITokenPermissionEditor\n                    isTextMode={false}\n                    isEditIconShow={false}\n                    currentPermission={this.state.permission}\n                    onPermissionChanged={this.setPermission}\n                  />\n                </td>\n                <td><span className=\"text-secondary\">--</span></td>\n                <td>\n                  <Button onClick={this.addAPIToken} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <div style={{minHeight: '10rem', maxHeight: '18rem'}}>\n            {this.state.apiTokenList.length !== 0 &&\n            <table className=\"table-thead-hidden w-xs-250\">\n              {thead}\n              <tbody>\n                {renderAPITokenList}\n              </tbody>\n            </table>\n            }\n          </div>\n          {this.state.loading && <Loading/>}\n        </Fragment>\n        }\n      </Fragment>\n    );\n  };\n\n  render() {\n    let repo = this.repo;\n\n    const itemName = '<span class=\"op-target\">' + Utils.HTMLescape(repo.repo_name) + '</span>';\n    const title = gettext('{placeholder} API Token').replace('{placeholder}', itemName);\n    return (\n      <Modal\n        isOpen={true} style={{maxWidth: '800px'}}\n        toggle={this.props.onRepoAPITokenToggle}\n      >\n        <ModalHeader toggle={this.props.onRepoAPITokenToggle}>\n          <p dangerouslySetInnerHTML={{__html: title}} className=\"m-0\"></p>\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"o-auto\">\n            {this.renderContent()}\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nRepoAPITokenDialog.propTypes = propTypes;\n\nexport default RepoAPITokenDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, NavLink } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport Loading from '../loading';\nimport EmptyTip from '../empty-tip';\n\nconst repoShareUploadLinkItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  activeTab: PropTypes.string.isRequired,\n  deleteItem: PropTypes.func.isRequired\n};\n\nclass RepoShareUploadLinkItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteLink = (e) => {\n    e.preventDefault();\n    this.props.deleteItem(this.props.item.token);\n  };\n\n  render() {\n\n    let objUrl;\n    let item = this.props.item;\n    let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n\n    if (this.props.activeTab === 'shareLinks') {\n      if (item.is_dir) {\n        objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n      } else {\n        objUrl = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      }\n    }\n\n    if (this.props.activeTab === 'uploadLinks') {\n      objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n    }\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td className=\"name\">{item.creator_name}</td>\n        <td>\n          <a href={objUrl} target=\"_blank\" className=\"text-inherit\" rel=\"noreferrer\">{item.obj_name}</a>\n        </td>\n        <td>\n          <a href={item.link} target=\"_blank\" className=\"text-inherit\" rel=\"noreferrer\">{item.link}</a>\n        </td>\n        <td>\n          <span\n            tabIndex=\"0\"\n            role=\"button\"\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'invisible'}`}\n            onClick={this.onDeleteLink}\n            onKeyDown={Utils.onKeyDown}\n            title={gettext('Delete')}\n            aria-label={gettext('Delete')}\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nRepoShareUploadLinkItem.propTypes = repoShareUploadLinkItemPropTypes;\n\nconst RepoShareUploadLinksDialogPropTypes = {\n  repo: PropTypes.object.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass RepoShareUploadLinksDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      activeTab: 'shareLinks',\n      repoShareUploadLinkList: [],\n      errorMsg: ''\n    };\n  }\n\n  componentDidMount() {\n    this.getItems('share-link');\n  }\n\n  getItems = (itemType) => {\n    const repoID = this.props.repo.repo_id;\n    const request = itemType == 'share-link' ?\n      seafileAPI.listRepoShareLinks(repoID) :\n      seafileAPI.listRepoUploadLinks(repoID);\n    request.then((res) => {\n      this.setState({\n        loading: false,\n        repoShareUploadLinkList: res.data,\n      });\n    }).catch(error => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true)\n      });\n    });\n  }\n\n  deleteItem = (token) => {\n    const repoID = this.props.repo.repo_id;\n    const request = this.state.activeTab == 'shareLinks' ?\n      seafileAPI.deleteRepoShareLink(repoID, token) :\n      seafileAPI.deleteRepoUploadLink(repoID, token);\n    request.then((res) => {\n      const repoShareUploadLinkList = this.state.repoShareUploadLinkList.filter(item => {\n        return item.token !== token;\n      });\n      this.setState({\n        repoShareUploadLinkList: repoShareUploadLinkList\n      });\n    }).catch(error => {\n      toaster.danger(Utils.getErrorMsg(error));\n    });\n  };\n\n  toggle = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({activeTab: tab});\n    }\n    if (tab == 'shareLinks') {\n      this.getItems('share-link');\n    }\n    if (tab == 'uploadLinks') {\n      this.getItems('upload-link');\n    }\n  };\n\n  render() {\n\n    const { loading, errorMsg, activeTab, repoShareUploadLinkList } = this.state;\n\n    const itemName = '<span class=\"op-target\">' + Utils.HTMLescape(this.props.repo.repo_name) + '</span>';\n    const title = gettext('{placeholder} Share/Upload Links').replace('{placeholder}', itemName);\n\n    return (\n      <Modal isOpen={true} style={{maxWidth: '800px'}}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          <span dangerouslySetInnerHTML={{__html: title}}></span>\n        </ModalHeader>\n        <ModalBody className=\"p-0 pb-4\">\n          <div className=\"main-panel-center\">\n            <div className=\"cur-view-container\" role=\"tablist\">\n              <div className=\"cur-view-path share-upload-nav\">\n                <ul className=\"nav\">\n                  <li className=\"nav-item\" role=\"tab\" aria-selected={activeTab === 'shareLinks'} aria-controls=\"share-links-panel\">\n                    <NavLink className={activeTab === 'shareLinks' ? 'active' : ''} onClick={this.toggle.bind(this, 'shareLinks')} tabIndex=\"0\" onKeyDown={Utils.onKeyDown}>{gettext('Share Links')}</NavLink>\n                  </li>\n                  <li className=\"nav-item\" role=\"tab\" aria-selected={activeTab === 'uploadLinks'} aria-controls=\"upload-links-panel\">\n                    <NavLink className={activeTab === 'uploadLinks' ? 'active' : ''} onClick={this.toggle.bind(this, 'uploadLinks')} tabIndex=\"0\" onKeyDown={Utils.onKeyDown}>{gettext('Upload Links')}</NavLink>\n                  </li>\n                </ul>\n              </div>\n              <div className=\"cur-view-content\" style={{minHeight: '20rem', maxHeight: '20rem'}} role=\"tabpanel\" id={activeTab === 'shareLinks' ? 'share-links-panel' : 'upload-links-panel'}>\n                {loading && <Loading />}\n                {!loading && errorMsg && <p className=\"error text-center mt-8\">{errorMsg}</p>}\n                {!loading && !errorMsg && !repoShareUploadLinkList.length &&\n                  <EmptyTip forDialog={true}>\n                    <p className=\"text-secondary\">{activeTab == 'shareLinks' ? gettext('No share links') : gettext('No upload links')}</p>\n                  </EmptyTip>\n                }\n                {!loading && !errorMsg && repoShareUploadLinkList.length > 0 &&\n                <table>\n                  <thead>\n                    <tr>\n                      <th width=\"22%\">{gettext('Creator')}</th>\n                      <th width=\"20%\">{gettext('Name')}</th>\n                      <th width=\"48%\">{gettext('Link')}</th>\n                      <th width=\"10%\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {this.state.repoShareUploadLinkList.map((item, index) => {\n                      return (\n                        <RepoShareUploadLinkItem\n                          key={index}\n                          item={item}\n                          activeTab={this.state.activeTab}\n                          deleteItem={this.deleteItem}\n                        />\n                      );\n                    })}\n                  </tbody>\n                </table>\n                }\n              </div>\n            </div>\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nRepoShareUploadLinksDialog.propTypes = RepoShareUploadLinksDialogPropTypes;\n\nexport default RepoShareUploadLinksDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibOldFilesAutoDelDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      autoDelDays: 0,\n      isAutoDel: false,\n      errorInfo: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoOldFilesAutoDelDays(this.props.repoID).then(res => {\n      this.setState({\n        autoDelDays: res.data.auto_delete_days,\n        isAutoDel: res.data.auto_delete_days > 0,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let daysNeedTobeSet;\n\n    if (this.state.isAutoDel) {\n      daysNeedTobeSet = this.state.autoDelDays;\n\n      let reg = /^-?\\d+$/;\n      let isvalid_days = reg.test(daysNeedTobeSet);\n      if (!isvalid_days || daysNeedTobeSet <= 0) {\n        this.setState({\n          errorInfo: gettext('Please enter a positive integer'),\n        });\n        return;\n      }\n\n    } else {\n      daysNeedTobeSet = 0;    // if no auto del, give 0 to server\n    }\n\n\n    let repoID = this.props.repoID;\n\n    seafileAPI.setRepoOldFilesAutoDelDays(repoID, daysNeedTobeSet).then(res => {\n      this.props.toggleDialog();\n      toaster.success(gettext('Successfully set it.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  }\n\n  onChange = (e) => {\n    let days = e.target.value;\n    this.setState({\n      autoDelDays: days,\n    });\n  }\n\n  updateRadioCheck = (type) => {\n    if (type === 'noAutoDel') {\n      this.setState({\n        isAutoDel: false,\n      });\n    } else if (type === 'autoDel') {\n      this.setState({\n        isAutoDel: true,\n      });\n    }\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Auto deletion')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={!this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('noAutoDel');}}/>{' '}\n              <Label>{gettext('Do not automatically delete files')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('autoDel');}}/>{' '}\n              <Label>{gettext('Automatically delete files that are not modified within certain days:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.autoDelDays}\n                disabled={!this.state.isAutoDel}\n                onChange={this.onChange}\n                onKeyDown={this.handleKeyPress}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibOldFilesAutoDelDialog.propTypes = propTypes;\n\nexport default LibOldFilesAutoDelDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport moment from 'moment';\nimport { Link, navigate } from '@reach/router';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, storages } from '../../utils/constants';\nimport ModalPortal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport toaster from '../../components/toast';\nimport DeleteRepoDialog from '../../components/dialog/delete-repo-dialog';\nimport TransferDialog from '../../components/dialog/transfer-dialog';\nimport LibHistorySettingDialog from '../../components/dialog/lib-history-setting-dialog';\nimport ChangeRepoPasswordDialog from '../../components/dialog/change-repo-password-dialog';\nimport ResetEncryptedRepoPasswordDialog from '../../components/dialog/reset-encrypted-repo-password-dialog';\nimport LabelRepoStateDialog from '../../components/dialog/label-repo-state-dialog';\nimport LibSubFolderPermissionDialog from '../../components/dialog/lib-sub-folder-permission-dialog';\nimport Rename from '../../components/rename';\nimport MylibRepoMenu from './mylib-repo-menu';\nimport RepoAPITokenDialog from '../../components/dialog/repo-api-token-dialog';\nimport RepoShareUploadLinksDialog from '../../components/dialog/repo-share-upload-links-dialog';\nimport LibOldFilesAutoDelDialog from '../../components/dialog/lib-old-files-auto-del-dialog';\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onRenameRepo: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n  onTransferRepo: PropTypes.func.isRequired,\n  onRepoClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShow: false,\n      isStarred: this.props.repo.starred,\n      isRenaming: false,\n      isShareDialogShow: false,\n      isDeleteDialogShow: false,\n      isTransferDialogShow: false,\n      isHistorySettingDialogShow: false,\n      isChangePasswordDialogShow: false,\n      isResetPasswordDialogShow: false,\n      isLabelRepoStateDialogOpen: false,\n      isFolderPermissionDialogShow: false,\n      isAPITokenDialogShow: false,\n      isRepoShareUploadLinksDialogOpen: false,\n      isRepoDeleted: false,\n      isOldFilesAutoDelDialogOpen: false,\n    };\n  }\n\n  onFocus = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: true\n      });\n    }\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: true,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: false,\n        highlight: false\n      });\n    }\n  }\n\n  onMenuItemClick = (item) => {\n    switch(item) {\n      case 'Star':\n      case 'Unstar':\n        this.onToggleStarRepo();\n        break;\n      case 'Share':\n        this.onShareToggle();\n        break;\n      case 'Delete':\n        this.onDeleteToggle();\n        break;\n      case 'Rename':\n        this.onRenameToggle();\n        break;\n      case 'Transfer':\n        this.onTransferToggle();\n        break;\n      case 'History Setting':\n        this.onHistorySettingToggle();\n        break;\n      case 'Change Password':\n        this.onChangePasswordToggle();\n        break;\n      case 'Reset Password':\n        this.onResetPasswordToggle();\n        break;\n      case 'Folder Permission':\n        this.onFolderPermissionToggle();\n        break;\n      case 'Label Current State':\n        this.onLabelToggle();\n        break;\n      case 'API Token':\n        this.onAPITokenToggle();\n        break;\n      case 'Share Links Admin':\n        this.toggleRepoShareUploadLinksDialog();\n        break;\n      case 'Old Files Auto Delete':\n        this.toggleOldFilesAutoDelDialog();\n        break;\n      default:\n        break;\n    }\n  }\n\n  visitRepo = () => {\n    if (!this.state.isRenaming && this.props.repo.repo_name) {\n      navigate(this.repoURL);\n    }\n  }\n\n  onRepoClick = () => {\n    this.props.onRepoClick(this.props.repo);\n  }\n\n  onToggleStarRepo = (e) => {\n    e.preventDefault();\n    const repoName = this.props.repo.repo_name;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  onShareToggle = (e) => {\n    // when close share dialog after send share link email,\n    // there is no event\n    if (e != undefined) {\n      e.preventDefault();\n    }\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onDeleteToggle = (e) => {\n    e.preventDefault();\n    this.setState({isDeleteDialogShow: !this.state.isDeleteDialogShow});\n  }\n\n  onRenameToggle = () => {\n    this.props.onFreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onTransferToggle = () => {\n    this.setState({isTransferDialogShow: !this.state.isTransferDialogShow});\n  }\n\n  onHistorySettingToggle = () => {\n    this.setState({isHistorySettingDialogShow: !this.state.isHistorySettingDialogShow});\n  }\n\n  onChangePasswordToggle = () => {\n    this.setState({isChangePasswordDialogShow: !this.state.isChangePasswordDialogShow});\n  }\n\n  onResetPasswordToggle = () => {\n    this.setState({isResetPasswordDialogShow: !this.state.isResetPasswordDialogShow});\n  }\n\n  onLabelToggle = () => {\n    this.setState({isLabelRepoStateDialogOpen: !this.state.isLabelRepoStateDialogOpen});\n  }\n\n  onFolderPermissionToggle = () => {\n    this.setState({isFolderPermissionDialogShow: !this.state.isFolderPermissionDialogShow});\n  }\n\n  onAPITokenToggle = () => {\n    this.setState({isAPITokenDialogShow: !this.state.isAPITokenDialogShow});\n  }\n\n  toggleRepoShareUploadLinksDialog = () => {\n    this.setState({isRepoShareUploadLinksDialogOpen: !this.state.isRepoShareUploadLinksDialogOpen});\n  }\n\n  toggleOldFilesAutoDelDialog = () => {\n    this.setState({isOldFilesAutoDelDialogOpen: !this.state.isOldFilesAutoDelDialogOpen});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({\n      highlight: false,\n      isOpIconShow: false,\n    });\n    this.props.onUnfreezedItem();\n  }\n\n  onRenameConfirm = (newName) => {\n    let repo = this.props.repo;\n    let repoID = repo.repo_id;\n    seafileAPI.renameRepo(repoID, newName).then(() => {\n      this.props.onRenameRepo(repo, newName);\n      this.onRenameCancel();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRenameCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onTransferRepo = (user) => {\n    let repoID = this.props.repo.repo_id;\n    seafileAPI.transferRepo(repoID, user.email).then(res => {\n      this.props.onTransferRepo(repoID);\n      let message = gettext('Successfully transferred the library.');\n      toaster.success(message);\n    }).catch(error => {\n      if (error.response){\n        toaster.danger(error.response.data.error_msg || gettext('Error'), {duration: 3});\n      } else {\n        toaster.danger(gettext('Failed. Please check the network.'), {duration: 3});\n      }\n    });\n    this.onTransferToggle();\n  }\n\n  onDeleteRepo = (repo) => {\n    seafileAPI.deleteRepo(repo.repo_id).then((res) => {\n\n      this.setState({\n        isRepoDeleted: true,\n        isDeleteDialogShow: false,\n      });\n\n      this.props.onDeleteRepo(repo);\n      let name = repo.repo_name;\n      var msg = gettext('Successfully deleted {name}.').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = repo.repo_name;\n        errMessage = gettext('Failed to delete {name}.').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n\n      this.setState({isRepoDeleted: false});\n    });\n  }\n\n  renderPCUI = () => {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let repoURL = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={this.onRepoClick} onFocus={this.onFocus}>\n        <td className=\"text-center\">\n          <a href=\"#\" role=\"button\" aria-label={this.state.isStarred ? gettext('Unstar') : gettext('Star')} onClick={this.onToggleStarRepo}>\n            <i className={`fa-star ${this.state.isStarred ? 'fas' : 'far star-empty'}`}></i>\n          </a>\n        </td>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td>\n          {this.state.isRenaming && (\n            <Rename\n              name={repo.repo_name}\n              onRenameConfirm={this.onRenameConfirm}\n              onRenameCancel={this.onRenameCancel}\n            />\n          )}\n          {!this.state.isRenaming && repo.repo_name && (\n            <Link to={repoURL}>{repo.repo_name}</Link>\n          )}\n          {!this.state.isRenaming && !repo.repo_name &&\n            (gettext('Broken (please contact your administrator to fix this library)'))\n          }\n        </td>\n        <td>\n          {(repo.repo_name && this.state.isOpIconShow) && (\n            <div>\n              <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onShareToggle}></a>\n              <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onDeleteToggle}></a>\n              <MylibRepoMenu\n                isPC={true}\n                repo={this.props.repo}\n                onMenuItemClick={this.onMenuItemClick}\n                onFreezedItem={this.props.onFreezedItem}\n                onUnfreezedItem={this.onUnfreezedItem}\n              />\n            </div>\n          )}\n        </td>\n        <td>{repo.size}</td>\n        {storages.length > 0 && <td>{repo.storage_name}</td>}\n        <td title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</td>\n      </tr>\n    );\n  }\n\n  renderMobileUI = () => {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let repoURL = this.repoURL = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''}  onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={this.onRepoClick}>\n        <td onClick={this.visitRepo}><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td onClick={this.visitRepo}>\n          {this.state.isRenaming && (\n            <Rename\n              name={repo.repo_name}\n              onRenameConfirm={this.onRenameConfirm}\n              onRenameCancel={this.onRenameCancel}\n            />\n          )}\n          {!this.state.isRenaming && repo.repo_name && (\n            <div><Link to={repoURL}>{repo.repo_name}</Link></div>\n          )}\n          {!this.state.isRenaming && !repo.repo_name &&\n            <div>(gettext('Broken (please contact your administrator to fix this library)'))</div>\n          }\n          <span className=\"item-meta-info\">{repo.size}</span>\n          <span className=\"item-meta-info\" title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</span>\n        </td>\n        <td>\n          {repo.repo_name && (\n            <MylibRepoMenu\n              repo={this.props.repo}\n              isStarred={this.state.isStarred}\n              onMenuItemClick={this.onMenuItemClick}\n              onFreezedItem={this.props.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n            />\n          )}\n        </td>\n      </tr>\n    );\n  }\n\n  render() {\n    let repo = this.props.repo;\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          {this.renderPCUI()}\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {this.renderMobileUI()}\n        </MediaQuery>\n        {this.state.isShareDialogShow && (\n          <ModalPortal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={repo.repo_name}\n              itemPath={'/'}\n              repoID={repo.repo_id}\n              repoEncrypted={repo.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={repo.permission}\n              toggleDialog={this.onShareToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isDeleteDialogShow && (\n          <ModalPortal>\n            <DeleteRepoDialog\n              repo={repo}\n              isRepoDeleted={this.state.isRepoDeleted}\n              onDeleteRepo={this.onDeleteRepo}\n              toggle={this.onDeleteToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isTransferDialogShow && (\n          <ModalPortal>\n            <TransferDialog\n              itemName={repo.repo_name}\n              submit={this.onTransferRepo}\n              toggleDialog={this.onTransferToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isHistorySettingDialogShow && (\n          <ModalPortal>\n            <LibHistorySettingDialog\n              repoID={repo.repo_id}\n              itemName={repo.repo_name}\n              toggleDialog={this.onHistorySettingToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isChangePasswordDialogShow && (\n          <ModalPortal>\n            <ChangeRepoPasswordDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onChangePasswordToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isResetPasswordDialogShow && (\n          <ModalPortal>\n            <ResetEncryptedRepoPasswordDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.onResetPasswordToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isLabelRepoStateDialogOpen && (\n          <ModalPortal>\n            <LabelRepoStateDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onLabelToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isFolderPermissionDialogShow && (\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onFolderPermissionToggle}\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isAPITokenDialogShow && (\n          <ModalPortal>\n            <RepoAPITokenDialog\n              repo={repo}\n              onRepoAPITokenToggle={this.onAPITokenToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isRepoShareUploadLinksDialogOpen && (\n          <ModalPortal>\n            <RepoShareUploadLinksDialog\n              repo={repo}\n              toggleDialog={this.toggleRepoShareUploadLinksDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isOldFilesAutoDelDialogOpen && (\n          <ModalPortal>\n            <LibOldFilesAutoDelDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.toggleOldFilesAutoDelDialog}\n            />\n          </ModalPortal>\n        )}\n\n      </Fragment>\n    );\n  }\n}\n\nMylibRepoListItem.propTypes = propTypes;\n\nexport default MylibRepoListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport { gettext, storages } from '../../utils/constants';\nimport MylibRepoListItem from './mylib-repo-list-item';\nimport LibsMobileThead from '../../components/libs-mobile-thead';\n\nconst propTypes = {\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  repoList: PropTypes.array.isRequired,\n  sortRepoList: PropTypes.func.isRequired,\n  onRenameRepo: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n  onTransferRepo: PropTypes.func.isRequired,\n  onRepoClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  renderRepoListView = () => {\n    return (\n      <Fragment>\n        {this.props.repoList.map(item => {\n          return (\n            <MylibRepoListItem\n              key={item.repo_id}\n              repo={item}\n              isItemFreezed={this.state.isItemFreezed}\n              onFreezedItem={this.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n              onRenameRepo={this.props.onRenameRepo}\n              onDeleteRepo={this.props.onDeleteRepo}\n              onTransferRepo={this.props.onTransferRepo}\n              onRepoClick={this.props.onRepoClick}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  }\n\n  renderPCUI = () => {\n    const showStorageBackend = storages.length > 0;\n    const sortIcon = this.props.sortOrder === 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width={showStorageBackend ? '33%' : '38%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {this.props.sortBy === 'name' && sortIcon}</a></th>\n            <th width=\"14%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width={showStorageBackend ? '15%' : '20%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {this.props.sortBy === 'size' && sortIcon}</a></th>\n            {showStorageBackend ? <th width=\"15%\">{gettext('Storage Backend')}</th> : null}\n            <th width={showStorageBackend ? '15%' : '20%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {this.props.sortBy === 'time' && sortIcon}</a></th>\n          </tr>\n        </thead>\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  renderMobileUI = () => {\n    return (\n      <table className=\"table-thead-hidden\">\n        <LibsMobileThead />\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          {this.renderPCUI()}\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {this.renderMobileUI()}\n        </MediaQuery>\n      </Fragment>\n    );\n  }\n}\n\nMylibRepoListView.propTypes = propTypes;\n\nexport default MylibRepoListView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext, mediaUrl, siteName, canAddRepo } from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass GuideForNewDialog extends React.Component {\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalBody>\n          <button type=\"button\" className=\"close text-gray\" onClick={this.toggle}><span aria-hidden=\"true\">×</span></button>\n          <div className=\"p-2 text-center\">\n            <img src={`${mediaUrl}img/welcome.png`} width=\"180\" alt=\"\" />\n            <h3 id=\"dialogTitle\">{gettext('Welcome to {site_name_placeholder}').replace('{site_name_placeholder}', siteName)}</h3>\n            {canAddRepo ?\n              <p>{gettext('{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.').replace('{site_name_placeholder}', siteName)}</p> :\n              <p>{gettext('{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.').replace('{site_name_placeholder}', siteName)}</p>\n            }\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nGuideForNewDialog.propTypes = propTypes;\n\nexport default GuideForNewDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Repo from '../../models/repo';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport RepoViewToolbar from '../../components/toolbar/repo-view-toobar';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport MylibRepoListView from './mylib-repo-list-view';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport GuideForNewDialog from '../../components/dialog/guide-for-new-dialog';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass MyLibraries extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isLoading: true,\n      repoList: [],\n      isShowDetails: false,\n      isSortOptionsDialogOpen: false,\n      isGuideForNewDialogOpen: window.app.pageOptions.guideEnabled,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n    };\n\n    this.emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries')}</h2>\n        <p>{gettext('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the \"New Library\" button in the menu bar.')}</p>\n      </EmptyTip>\n    );\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'mine'}).then((res) => {\n      let repoList = res.data.repos.map((item) => {\n        return new Repo(item);\n      });\n      this.setState({\n        isLoading: false,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  onCreateRepo = (repo) => {\n    seafileAPI.createMineRepo(repo).then((res) => {\n      const newRepo = new Repo({\n        repo_id: res.data.repo_id,\n        repo_name: res.data.repo_name,\n        size: res.data.repo_size,\n        mtime: res.data.mtime,\n        owner_email: res.data.email,\n        encrypted: res.data.encrypted,\n        permission: res.data.permission,\n        storage_name: res.data.storage_name\n      });\n      this.state.repoList.unshift(newRepo);\n      this.setState({repoList: this.state.repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  sortRepoList = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  onTransferRepo = (repoID) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repoID;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onRenameRepo = (repo, newName) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.repo_name = newName;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onDeleteRepo = (repo) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onRepoClick = (repo) => {\n    if (this.state.isShowDetails) {\n      this.onRepoDetails(repo);\n    }\n  }\n\n  onRepoDetails = (repo) => {\n    this.setState({\n      currentRepo: repo,\n      isShowDetails: true,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: !this.state.isShowDetails});\n  }\n\n  toggleGuideForNewDialog = () => {\n    window.app.pageOptions.guideEnabled = false;\n    this.setState({\n      isGuideForNewDialogOpen: false\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <RepoViewToolbar onShowSidePanel={this.props.onShowSidePanel} onCreateRepo={this.onCreateRepo} libraryType={'mine'}/>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('My Libraries')}</h3>\n              {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {!this.state.isLoading && this.state.errorMsg && <p className=\"error text-center mt-8\">{this.state.errorMsg}</p>}\n              {!this.state.isLoading && !this.state.errorMsg && this.state.repoList.length === 0 && this.emptyTip}\n              {!this.state.isLoading && !this.state.errorMsg && this.state.repoList.length > 0 &&\n                <MylibRepoListView\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  repoList={this.state.repoList}\n                  onRenameRepo={this.onRenameRepo}\n                  onDeleteRepo={this.onDeleteRepo}\n                  onTransferRepo={this.onTransferRepo}\n                  onRepoClick={this.onRepoClick}\n                  sortRepoList={this.sortRepoList}\n                />\n              }\n            </div>\n          </div>\n          {!this.state.isLoading && !this.state.errorMsg && this.state.isGuideForNewDialogOpen &&\n            <GuideForNewDialog\n              toggleDialog={this.toggleGuideForNewDialog}\n            />\n          }\n          {this.state.isSortOptionsDialogOpen &&\n            <SortOptionsDialog\n              toggleDialog={this.toggleSortOptionsDialog}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortRepoList}\n            />\n          }\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail\n                currentRepo={this.state.currentRepo}\n                closeDetails={this.closeDetails}\n              />\n            </div>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nMyLibraries.propTypes = propTypes;\n\nexport default MyLibraries;\n","import React, { Component, Fragment } from 'react';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { gettext, siteRoot, lang, trashReposExpireDays } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\n\nmoment.locale(lang);\n\nclass MyLibsDeleted extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      deletedRepoList: [],\n      isLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listDeletedRepo().then(res => {\n      this.setState({\n        deletedRepoList: res.data,\n        isLoading: false,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  refreshDeletedRepoList = (repoID) => {\n    let deletedRepoList = this.state.deletedRepoList.filter(item => {\n      return item.repo_id !== repoID;\n    });\n    this.setState({deletedRepoList: deletedRepoList});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north\">\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <div className=\"path-container\">\n                <Link to={ siteRoot + 'my-libs/' }>{gettext('My Libraries')}</Link>\n                <span className=\"path-split\">/</span>\n                <span>{gettext('Deleted Libraries')}</span>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && this.state.deletedRepoList.length === 0) &&\n              <EmptyTip>\n                <h2>{gettext('No deleted libraries')}</h2>\n                <p>{gettext('You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.').replace('{placeholder}', trashReposExpireDays)}</p>\n              </EmptyTip>\n              }\n              {this.state.deletedRepoList.length !== 0 &&\n                <div>\n                  <p className=\"tip mt-2\">{gettext('Tip: libraries deleted {placeholder} days ago will be cleaned automatically.').replace('{placeholder}', trashReposExpireDays)}</p>\n                  <DeletedRepoTable\n                    deletedRepoList={this.state.deletedRepoList}\n                    refreshDeletedRepoList={this.refreshDeletedRepoList}\n                  />\n                </div>\n              }\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nclass DeletedRepoTable extends Component {\n\n  render() {\n    let deletedRepos = this.props.deletedRepoList;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th style={{width: '4%'}}>{/*img*/}</th>\n            <th style={{width: '52%'}}>{gettext('Name')}</th>\n            <th style={{width: '30%'}}>{gettext('Deleted Time')}</th>\n            <th style={{width: '14%'}}></th>\n          </tr>\n        </thead>\n        <tbody>\n          { deletedRepos && deletedRepos.map((item) => {\n            return (\n              <DeletedRepoItem\n                key={item.repo_id}\n                repo={item}\n                refreshDeletedRepoList={this.props.refreshDeletedRepoList}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass DeletedRepoItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hideRestoreMenu: true,\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        hideRestoreMenu: false,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        hideRestoreMenu: true,\n        highlight: false,\n      });\n    }\n  }\n\n  restoreDeletedRepo = (e) => {\n    e.preventDefault();\n    let repoID = this.props.repo.repo_id;\n    let repoName = this.props.repo.repo_name;\n    seafileAPI.restoreDeletedRepo(repoID).then(res => {\n      let message = gettext('Successfully restored the library.') + '  ' + repoName;\n      toaster.success(message);\n      this.props.refreshDeletedRepoList(repoID);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed. Please check the network.');\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let localTime = moment.utc(this.props.repo.del_time).toDate();\n    localTime = moment(localTime).fromNow();\n    let iconUrl = Utils.getLibIconUrl(this.props.repo);\n\n    return (\n      <tr\n        className={this.state.highlight ? 'tr-highlight' : ''}\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n        tabIndex=\"0\"\n        onFocus={this.onMouseEnter}\n      >\n        <td className=\"text-center\"><img src={iconUrl} alt='' width=\"24\" /></td>\n        <td className=\"name\">{this.props.repo.repo_name}</td>\n        <td className=\"update\">{localTime}</td>\n        <td>\n          <a href=\"#\" onClick={this.restoreDeletedRepo} title={gettext('Restore')}\n            role=\"button\" aria-label={gettext('Restore')}\n            className={`sf2-icon-reply action-icon ${this.state.highlight ? '' : 'vh'}`}></a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nexport default MyLibsDeleted;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input, Alert } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Repo from '../../models/repo';\n\nconst shareRepoListItemProps = {\n  repo: PropTypes.object.isRequired,\n  onRepoSelect: PropTypes.func.isRequired,\n  onPermissionChange: PropTypes.func.isRequired,\n};\n\nclass ShareRepoListItem extends React.Component {\n\n  onRepoSelect = (e) => {\n    let isChecked = e.target.checked;\n    this.props.onRepoSelect(this.props.repo, isChecked);\n  }\n\n  onPermissionChange = (e) => {\n    let permission = e.target.value;\n    let repo = this.props.repo;\n    this.props.onPermissionChange(repo, permission);\n  }\n\n  render() {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    return (\n      <tr>\n        <td className=\"text-center\"><input type=\"checkbox\" className=\"vam\" name=\"repo\" onChange={this.onRepoSelect} /></td>\n        <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt={gettext('icon')} /></td>\n        <td className=\"name\">{repo.repo_name}</td>\n        <td>{moment(repo.last_modified).fromNow()}</td>\n        <td>\n          <Input style={{height: '1.5rem', padding: 0}} type=\"select\" name=\"select\" onChange={this.onPermissionChange} value={repo.sharePermission}>\n            <option value='rw'>{gettext('Read-Write')}</option>\n            <option value='r'>{gettext('Read-Only')}</option>\n          </Input>\n        </td>\n      </tr>\n    );\n  }\n}\n\nShareRepoListItem.propTypes = shareRepoListItemProps;\n\nconst propTypes = {\n  onRepoSelectedHandler: PropTypes.func.isRequired,\n  onShareRepoDialogClose: PropTypes.func.isRequired,\n};\n\nclass ShareRepoDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoList: [],\n      currentRepo: null,\n      permission: 'rw',\n      selectedRepoList: [],\n      errMessage: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'mine'}).then(res => {\n      let repoList = res.data.repos.map(item => {\n        let repo = new Repo(item);\n        repo.sharePermission = 'rw';\n        return repo;\n      });\n      this.setState({repoList: repoList});\n    });\n  }\n\n  onRepoSelect = (repo, isChecked) => {\n    let selectedRepoList = [];\n    if (isChecked) {\n      this.state.selectedRepoList.push(repo);\n      selectedRepoList = this.state.selectedRepoList;\n    } else {\n      selectedRepoList = this.state.selectedRepoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n    }\n    this.setState({selectedRepoList: selectedRepoList});\n  }\n\n  onPermissionChange = (repo, permission) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.sharePermission = permission;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  handleSubmit = () => {\n    if (this.state.selectedRepoList.length === 0) {\n      let errMessage = gettext('Please select a library to share.');\n      this.setState({errMessage: errMessage});\n      return;\n    }\n\n    this.props.onRepoSelectedHandler(this.state.selectedRepoList);\n    this.onCloseDialog();\n  }\n\n  onCloseDialog = () => {\n    this.props.onShareRepoDialogClose();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Select libraries to share')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='4%'>{/* select */}</th>\n                <th width='6%'>{/* icon */}</th>\n                <th width='35%'>{gettext('Name')}</th>\n                <th width='25%'>{gettext('Last Update')}</th>\n                <th width='30%'>{gettext('Permission')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repoList.map((repo, index) => {\n                return (\n                  <ShareRepoListItem\n                    key={index}\n                    repo={repo}\n                    onRepoSelect={this.onRepoSelect}\n                    onPermissionChange={this.onPermissionChange}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.onCloseDialog}>{gettext('Close')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nShareRepoDialog.propTypes = propTypes;\n\nexport default ShareRepoDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { Link, navigate } from '@reach/router';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, isPro, username, folderPermEnabled, isSystemStaff, enableResetEncryptedRepoPassword, isEmailConfigured } from '../../utils/constants';\nimport ModalPortal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport LibSubFolderPermissionDialog from '../../components/dialog/lib-sub-folder-permission-dialog';\nimport DeleteRepoDialog from '../../components/dialog/delete-repo-dialog';\nimport ChangeRepoPasswordDialog from '../../components/dialog/change-repo-password-dialog';\nimport ResetEncryptedRepoPasswordDialog from '../../components/dialog/reset-encrypted-repo-password-dialog';\nimport Rename from '../rename';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport LibHistorySettingDialog from '../dialog/lib-history-setting-dialog';\nimport toaster from '../toast';\nimport RepoAPITokenDialog from '../dialog/repo-api-token-dialog';\nimport RepoShareUploadLinksDialog from '../dialog/repo-share-upload-links-dialog';\n\nconst propTypes = {\n  currentGroup: PropTypes.object,\n  libraryType: PropTypes.string,\n  repo: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onItemUnshare: PropTypes.func.isRequired,\n  onItemDetails: PropTypes.func,\n  onItemRename: PropTypes.func,\n  onItemDelete: PropTypes.func,\n};\n\nclass SharedRepoListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      highlight: false,\n      isOperationShow: false,\n      isItemMenuShow: false,\n      isShowSharedDialog: false,\n      isRenaming: false,\n      isStarred: this.props.repo.starred,\n      isFolderPermissionDialogOpen: false,\n      isHistorySettingDialogShow: false,\n      isDeleteDialogShow: false,\n      isAPITokenDialogShow: false,\n      isRepoShareUploadLinksDialogOpen: false,\n      isRepoDeleted: false,\n      isChangePasswordDialogShow: false,\n      isResetPasswordDialogShow: false\n    };\n    this.isDeparementOnwerGroupMember = false;\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      });\n    }\n  }\n\n  clickOperationMenuToggle = (e) => {\n    this.toggleOperationMenu(e);\n  }\n\n  onDropdownToggleKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.clickOperationMenuToggle(e);\n    }\n  }\n\n  toggleOperationMenu = (e) => {\n    let dataset = e.target ? e.target.dataset : null;\n    if (dataset && dataset.toggle && dataset.toggle === 'Rename') {\n      this.setState({isItemMenuShow: !this.state.isItemMenuShow});\n      return;\n    }\n\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.props.onUnfreezedItem();\n          this.setState({\n            highlight: false,\n            isOperationShow: false,\n          });\n        }\n      }\n    );\n  }\n\n  getRepoComputeParams = () => {\n    let repo = this.props.repo;\n\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let libPath = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n\n    return { iconUrl, iconTitle, libPath };\n  }\n\n  onMenuItemKeyDown = (e) => {\n    if (e.key == 'Enter' || e.key == 'Space') {\n      this.onMenuItemClick(e);\n    }\n  }\n\n  onMenuItemClick = (e) => {\n    let operation = e.target.dataset.toggle;\n    switch(operation) {\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Folder Permission':\n        this.onItemFolderPermissionToggle();\n        break;\n      case 'Details':\n        this.onItemDetails();\n        break;\n      case 'Share':\n        this.onItemShare();\n        break;\n      case 'Unshare':\n        this.onItemUnshare();\n        break;\n      case 'History Setting':\n        this.onHistorySettingToggle();\n        break;\n      case 'API Token':\n        this.onAPITokenToggle();\n        break;\n      case 'Share Links Admin':\n        this.toggleRepoShareUploadLinksDialog();\n        break;\n      case 'Change Password':\n        this.onChangePasswordToggle();\n        break;\n      case 'Reset Password':\n        this.onResetPasswordToggle();\n        break;\n      default:\n        break;\n    }\n  }\n\n  onItemRenameToggle = () => {\n    this.props.onFreezedItem();\n    this.setState({\n      isRenaming: !this.state.isRenaming,\n      isOperationShow: !this.state.isOperationShow\n    });\n  }\n\n  onRenameConfirm = (name) => {\n    this.props.onItemRename(this.props.repo, name);\n    this.onRenameCancel();\n  }\n\n  onRenameCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onItemFolderPermissionToggle = () => {\n    this.setState({isFolderPermissionDialogOpen: !this.state.isFolderPermissionDialogOpen});\n  }\n\n  onHistorySettingToggle = () => {\n    this.setState({isHistorySettingDialogShow: !this.state.isHistorySettingDialogShow});\n  }\n\n  onItemDetails = () => {\n    this.props.onItemDetails(this.props.repo);\n  }\n\n  onItemShare = (e) => {\n    e.preventDefault();\n    this.setState({isShowSharedDialog: true});\n  }\n\n  onItemUnshare = (e) => {\n    e.preventDefault();\n    this.props.onItemUnshare(this.props.repo);\n  }\n\n  onItemDeleteToggle = (e) => {\n    e.preventDefault();\n    this.setState({isDeleteDialogShow: !this.state.isDeleteDialogShow});\n  }\n\n  onItemDelete = () => {\n    const { currentGroup, repo } = this.props;\n    if (!currentGroup) {  // repo can not be deleted in share all module\n      return;\n    }\n\n    const groupID = currentGroup.id;\n\n    seafileAPI.deleteGroupOwnedLibrary(groupID, repo.repo_id).then(() => {\n\n      this.setState({\n        isRepoDeleted: true,\n        isDeleteDialogShow: false,\n      });\n\n      this.props.onItemDelete(repo);\n      let name = repo.repo_name;\n      var msg = gettext('Successfully deleted {name}.').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = repo.repo_name;\n        errMessage = gettext('Failed to delete {name}.').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n\n      this.setState({isRepoDeleted: false});\n    });\n  }\n\n  toggleShareDialog = () => {\n    this.setState({isShowSharedDialog: false});\n  }\n\n  toggleRepoShareUploadLinksDialog = () => {\n    this.setState({isRepoShareUploadLinksDialogOpen: !this.state.isRepoShareUploadLinksDialogOpen});\n  }\n\n  onAPITokenToggle = () => {\n    this.setState({isAPITokenDialogShow: !this.state.isAPITokenDialogShow});\n  }\n\n  onChangePasswordToggle = () => {\n    this.setState({isChangePasswordDialogShow: !this.state.isChangePasswordDialogShow});\n  }\n\n  onResetPasswordToggle = () => {\n    this.setState({isResetPasswordDialogShow: !this.state.isResetPasswordDialogShow});\n  }\n\n  translateMenuItem = (menuItem) => {\n    let translateResult = '';\n    switch(menuItem) {\n      case 'Rename':\n        translateResult = gettext('Rename');\n        break;\n      case 'Folder Permission':\n        translateResult = gettext('Folder Permission');\n        break;\n      case 'Details':\n        translateResult = gettext('Details');\n        break;\n      case 'Unshare':\n        translateResult = gettext('Unshare');\n        break;\n      case 'Share':\n        translateResult = gettext('Share');\n        break;\n      case 'History Setting':\n        translateResult = gettext('History Setting');\n        break;\n      case 'Share Links Admin':\n        translateResult = gettext('Share Links Admin');\n        break;\n      case 'Change Password':\n        translateResult = gettext('Change Password');\n        break;\n      case 'Reset Password':\n        translateResult = gettext('Reset Password');\n        break;\n      case 'API Token':\n        translateResult = 'API Token'; // translation is not needed here\n        break;\n      default:\n        break;\n    }\n    return translateResult;\n  }\n\n  generatorOperations = () => {\n    let { repo, currentGroup } = this.props;\n    //todo this have a bug; use current api is not return admins param;\n    let isStaff = currentGroup && currentGroup.admins && currentGroup.admins.indexOf(username) > -1; //for group repolist;\n    let isRepoOwner = repo.owner_email === username;\n    let isAdmin = repo.is_admin;\n    let operations = [];\n    if (isPro) {\n      if (repo.owner_email.indexOf('@seafile_group') != -1) {\n        if (isStaff) {\n          if (repo.owner_email == currentGroup.id + '@seafile_group') {\n            this.isDeparementOnwerGroupMember = true;\n            operations = ['Rename'];\n            if (folderPermEnabled) {\n              operations.push('Folder Permission');\n            }\n            operations.push('Share Links Admin');\n            if (repo.encrypted) {\n              operations.push('Change Password');\n            }\n            if (repo.encrypted && enableResetEncryptedRepoPassword && isEmailConfigured) {\n              operations.push('Reset Password');\n            }\n            operations.push('History Setting', 'API Token', 'Details');\n          } else {\n            operations.push('Unshare');\n          }\n        }\n      } else {\n        if (isRepoOwner || isAdmin) {\n          operations.push('Share');\n        }\n        if (isStaff || isRepoOwner || isAdmin) {\n          operations.push('Unshare');\n        }\n      }\n    } else {\n      if (isRepoOwner) {\n        operations.push('Share');\n      }\n      if (isStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    }\n    return operations;\n  }\n\n  generatorMobileMenu = () => {\n    let operations = [];\n    if (this.props.libraryType && this.props.libraryType === 'public') {\n      let isRepoOwner = this.props.repo.owner_email === username;\n      if (isSystemStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    } else {\n      operations = this.generatorOperations();\n      if (this.isDeparementOnwerGroupMember) {\n        operations.unshift('Unshare');\n        operations.unshift('Share');\n      }\n    }\n\n    if (!operations.length) {\n      return null;\n    }\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n        <DropdownToggle\n          tag=\"i\"\n          className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          onClick={this.clickOperationMenuToggle}\n        />\n        <div className={`${this.state.isItemMenuShow?'':'d-none'}`} onClick={this.toggleOperationMenu}>\n          <div className=\"mobile-operation-menu-bg-layer\"></div>\n          <div className=\"mobile-operation-menu\">\n            {operations.map((item, index) => {\n              return (\n                <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick}>{this.translateMenuItem(item)}</DropdownItem>\n              );\n            })}\n          </div>\n        </div>\n      </Dropdown>\n    );\n  }\n\n  generatorPCMenu = () => {\n    let operations = [];\n    if (this.props.libraryType && this.props.libraryType === 'public') {\n      let isRepoOwner = this.props.repo.owner_email === username;\n      if (isSystemStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    } else {\n      // scene one: (Share, Delete, itemToggle and other operations);\n      // scene two: (Share, Unshare), (Share), (Unshare)\n      operations = this.generatorOperations();\n    }\n    const shareOperation   = <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onItemShare}></a>;\n    const unshareOperation = <a href=\"#\" className=\"op-icon sf2-icon-x3\" title={gettext('Unshare')} role=\"button\" aria-label={gettext('Unshare')} onClick={this.onItemUnshare}></a>;\n    const deleteOperation  = <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onItemDeleteToggle}></a>;\n\n    if (this.isDeparementOnwerGroupMember) {\n      return (\n        <Fragment>\n          {shareOperation}\n          {deleteOperation}\n          <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n            <DropdownToggle\n              className=\"sf-dropdown-toggle sf2-icon-caret-down border-0 p-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isItemMenuShow}\n              aria-haspopup={true}\n              style={{'minWidth': '0'}}\n              onClick={this.clickOperationMenuToggle}\n              onKeyDown={this.onDropdownToggleKeyDown}\n            />\n            <DropdownMenu>\n              {operations.map((item, index) => {\n                return <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick} onKeyDown={this.onMenuItemKeyDown}>{this.translateMenuItem(item)}</DropdownItem>;\n              })}\n            </DropdownMenu>\n          </Dropdown>\n        </Fragment>\n      );\n    } else {\n      if (operations.length == 2) {\n        return (\n          <Fragment>\n            {shareOperation}\n            {unshareOperation}\n          </Fragment>\n        );\n      }\n      if (operations.length == 1 && operations[0] === 'Share') {\n        return shareOperation;\n      }\n\n      if (operations.length == 1 && operations[0] === 'Unshare') {\n        return unshareOperation;\n      }\n    }\n    return null;\n  }\n\n  onToggleStarRepo = (e) => {\n    e.preventDefault();\n    const { repo_name: repoName } = this.props.repo;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  renderPCUI = () => {\n    let { iconUrl, iconTitle, libPath } = this.getRepoComputeParams();\n    let { repo } = this.props;\n    return (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseOver={this.onMouseOver} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n          <td className=\"text-center\">\n          <a href=\"#\" role=\"button\" aria-label={this.state.isStarred ? gettext('Unstar') : gettext('Star')} onClick={this.onToggleStarRepo}>\n            <i className={`fa-star ${this.state.isStarred ? 'fas' : 'far star-empty'}`}></i>\n          </a>\n          </td>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            {this.state.isRenaming ?\n              <Rename name={repo.repo_name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/> :\n              <Link to={libPath}>{repo.repo_name}</Link>\n            }\n          </td>\n          <td>{this.state.isOperationShow && this.generatorPCMenu()}</td>\n          <td>{repo.size}</td>\n          <td title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</td>\n          <td title={repo.owner_contact_email}>{repo.owner_name}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n\n  visitRepo = () => {\n    if (!this.state.isRenaming) {\n      navigate(this.repoURL);\n    }\n  }\n  \n  renderMobileUI = () => {\n    let { iconUrl, iconTitle, libPath } = this.getRepoComputeParams();\n    let { repo } = this.props;\n    this.repoURL = libPath;\n    return (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''}  onMouseEnter={this.onMouseEnter} onMouseOver={this.onMouseOver} onMouseLeave={this.onMouseLeave}>\n          <td onClick={this.visitRepo}><img src={iconUrl} title={iconTitle} width=\"24\" alt={iconTitle}/></td>\n          <td onClick={this.visitRepo}>\n            {this.state.isRenaming ?\n              <Rename name={repo.repo_name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> :\n              <Link to={libPath}>{repo.repo_name}</Link>\n            }\n            <br />\n            <span className=\"item-meta-info\" title={repo.owner_contact_email}>{repo.owner_name}</span>\n            <span className=\"item-meta-info\">{repo.size}</span>\n            <span className=\"item-meta-info\" title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</span>\n          </td>\n          <td>{this.generatorMobileMenu()}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { repo } = this.props;\n    let isGroupOwnedRepo = repo.owner_email.indexOf('@seafile_group') > -1;\n    return (\n      <Fragment>\n        {Utils.isDesktop() ? this.renderPCUI() : this.renderMobileUI()}\n        {this.state.isShowSharedDialog && (\n          <ModalPortal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={repo.repo_name}\n              itemPath={'/'}\n              repoID={repo.repo_id}\n              repoEncrypted={repo.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={repo.permission}\n              isAdmin={repo.is_admin}\n              isGroupOwnedRepo={isGroupOwnedRepo}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isFolderPermissionDialogOpen && (\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onItemFolderPermissionToggle}\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              isDepartmentRepo={true}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isDeleteDialogShow &&\n          <ModalPortal>\n            <DeleteRepoDialog\n              repo={this.props.repo}\n              isRepoDeleted={this.state.isRepoDeleted}\n              onDeleteRepo={this.onItemDelete}\n              toggle={this.onItemDeleteToggle}\n            />\n          </ModalPortal>\n        }\n        {this.state.isHistorySettingDialogShow && (\n          <ModalPortal>\n            <LibHistorySettingDialog\n              repoID={repo.repo_id}\n              itemName={repo.repo_name}\n              toggleDialog={this.onHistorySettingToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isAPITokenDialogShow && (\n          <ModalPortal>\n            <RepoAPITokenDialog\n              repo={repo}\n              onRepoAPITokenToggle={this.onAPITokenToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isRepoShareUploadLinksDialogOpen && (\n          <ModalPortal>\n            <RepoShareUploadLinksDialog\n              repo={repo}\n              toggleDialog={this.toggleRepoShareUploadLinksDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isChangePasswordDialogShow && (\n          <ModalPortal>\n            <ChangeRepoPasswordDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onChangePasswordToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isResetPasswordDialogShow && (\n          <ModalPortal>\n            <ResetEncryptedRepoPasswordDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.onResetPasswordToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nSharedRepoListItem.propTypes = propTypes;\n\nexport default SharedRepoListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport SharedRepoListItem from './shared-repo-list-item';\nimport toaster from '../toast';\nimport LibsMobileThead from '../libs-mobile-thead';\nimport Loading from '../loading';\n\nconst propTypes = {\n  libraryType: PropTypes.string,\n  currentGroup: PropTypes.object,\n  isShowTableThread: PropTypes.bool,\n  sortBy: PropTypes.string,\n  sortOrder: PropTypes.string,\n  sortItems: PropTypes.func,\n  repoList: PropTypes.array.isRequired,\n  onItemUnshare: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func,\n  onItemDetails: PropTypes.func,\n  onItemRename: PropTypes.func,\n  hasNextPage: PropTypes.bool\n};\n\nclass SharedRepoListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  getSortMetaData = () => {\n    return {\n      sortByName: this.props.sortBy == 'name',\n      sortByTime: this.props.sortBy == 'time',\n      sortBySize: this.props.sortBy == 'size',\n      sortIcon: this.props.sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onItemRename = (repo, newName) => {\n    let isDuplicated = this.props.repoList.some(item => {\n      return item.name === newName;\n    });\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      toaster.danger(errMessage);\n      return false;\n    }\n    this.props.onItemRename(repo, newName);\n  }\n\n  renderRepoListView = () => {\n    return (\n      <Fragment>\n        {this.props.repoList.map(repo => {\n          return (\n            <SharedRepoListItem\n              key={repo.repo_id}\n              repo={repo}\n              libraryType={this.props.libraryType}\n              currentGroup={this.props.currentGroup}\n              isItemFreezed={this.state.isItemFreezed}\n              onFreezedItem={this.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n              onItemUnshare={this.props.onItemUnshare}\n              onItemDelete={this.props.onItemDelete}\n              onItemDetails={this.props.onItemDetails}\n              onItemRename={this.props.onItemRename}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  }\n\n  renderPCUI = () => {\n    let isShowTableThread = this.props.isShowTableThread !== undefined ? this.props.isShowTableThread : true;\n\n    const { sortByName, sortByTime, sortBySize, sortIcon } = this.getSortMetaData();\n\n    return (\n      <table className={isShowTableThread ? '' : 'table-thead-hidden'}>\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width=\"36%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n            <th width=\"12%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width={'14%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n            <th width={'14%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n            <th width=\"16%\">{gettext('Owner')}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  renderMobileUI = () => {\n    return (\n      <table className=\"table-thead-hidden\">\n        <LibsMobileThead />\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  render() {\n    const table = Utils.isDesktop() ? this.renderPCUI() : this.renderMobileUI();\n    if (this.props.hasNextPage) {\n      return (\n        <Fragment>\n          {table}\n          <Loading />\n        </Fragment>\n      );\n    } else {\n      return table;\n    }\n  }\n}\n\nSharedRepoListView.propTypes = propTypes;\n\nexport default SharedRepoListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport MediaQuery from 'react-responsive';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, canAddPublicRepo } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport ModalPortal from '../../components/modal-portal';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport CreateRepoDialog from '../../components/dialog/create-repo-dialog';\nimport ShareRepoDialog from '../../components/dialog/share-repo-dialog';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass PublicSharedView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errMessage: '',\n      emptyTip: '',\n      repoList: [],\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false,\n      libraryType: 'public',\n      isCreateMenuShow: false,\n      isCreateRepoDialogShow: false,\n      isSelectRepoDialpgShow: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'public'}).then((res) => {\n      let repoList = res.data.repos.map(item => {\n        let repo = new Repo(item);\n        return repo;\n      });\n      this.setState({\n        isLoading: false,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onCreateRepo = (repo) => {\n    seafileAPI.createPublicRepo(repo).then(res => {\n      let object = {  // need modify api return value\n        repo_id: res.data.id,\n        repo_name: res.data.name,\n        permission: res.data.permission,\n        size: res.data.size,\n        owner_name: res.data.owner_name,\n        owner_email: res.data.owner,\n        mtime: res.data.mtime,\n        encrypted: res.data.encrypted,\n      };\n      let repo = new Repo(object);\n      let repoList = this.addRepoItem(repo);\n      this.setState({repoList: repoList});\n      this.onCreateRepoToggle();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRepoSelectedHandler = (selectedRepoList) => {\n    selectedRepoList.forEach(repo => {\n      seafileAPI.selectOwnedRepoToPublic(repo.repo_id, {share_type: 'public', permission: repo.sharePermission}).then(() => {\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    });\n  }\n\n  onItemUnshare = (repo) => {\n    seafileAPI.unshareRepo(repo.repo_id, {share_type: 'public'}).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n      let message = gettext('Successfully unshared {name}').replace('{name}', repo.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to unshare {name}').replace('{name}', repo.repo_name);\n      }\n      toaster(errMessage);\n    });\n  }\n\n  onItemDelete = () => {\n    // todo need to optimized\n  }\n\n  addRepoItem = (repo) => {\n    let isExist = false;\n    let repoIndex = 0;\n    let repoList = this.state.repoList;\n    for (let i = 0; i < repoList.length; i ++) {\n      if (repo.repo_id === repoList[i].repo_id) {\n        isExist = true;\n        repoIndex = i;\n        break;\n      }\n    }\n    if (isExist) {\n      this.state.repoList.splice(repoIndex, 1);\n    }\n\n    let newRepoList = this.state.repoList.map(item => {return item;});\n    newRepoList.unshift(repo);\n    return newRepoList;\n  }\n\n  onAddRepoToggle = () => {\n    this.setState({isCreateMenuShow: !this.state.isCreateMenuShow});\n  }\n\n  onCreateRepoToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  onSelectRepoToggle = () => {\n    this.setState({isSelectRepoDialpgShow: !this.state.isSelectRepoDialpgShow});\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    let errMessage = this.state.errMessage;\n    let emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No public libraries')}</h2>\n        <p>{gettext('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the \"Add Library\" button in the menu bar.')}</p>\n      </EmptyTip>\n    );\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          {canAddPublicRepo &&\n            <div className=\"cur-view-toolbar\">\n              <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n              <div className=\"operation\">\n                <Dropdown isOpen={this.state.isCreateMenuShow} toggle={this.onAddRepoToggle}>\n                  <MediaQuery query=\"(min-width: 768px)\">\n                    <DropdownToggle className='btn btn-secondary operation-item'>\n                      <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Add Library')}\n                    </DropdownToggle>\n                  </MediaQuery>\n                  <MediaQuery query=\"(max-width: 767.8px)\">\n                    <DropdownToggle\n                      tag=\"span\"\n                      className=\"sf2-icon-plus mobile-toolbar-icon\"\n                      title={gettext('Add Library')}\n                    />\n                  </MediaQuery>\n                  <DropdownMenu>\n                    <DropdownItem onClick={this.onSelectRepoToggle}>{gettext('Share existing libraries')}</DropdownItem>\n                    <DropdownItem onClick={this.onCreateRepoToggle}>{gettext('New Library')}</DropdownItem>\n                  </DropdownMenu>\n                </Dropdown>\n              </div>\n            </div>\n          }\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared with all')}</h3>\n              {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && errMessage) && errMessage}\n              {(!this.state.isLoading && this.state.repoList.length === 0) && emptyTip}\n              {(!this.state.isLoading && this.state.repoList.length > 0) &&\n                <SharedRepoListView\n                  libraryType={this.state.libraryType}\n                  repoList={this.state.repoList}\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  sortItems={this.sortItems}\n                  onItemUnshare={this.onItemUnshare}\n                  onItemDelete={this.onItemDelete}\n                />\n              }\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortItems={this.sortItems}\n        />\n        }\n        {this.state.isCreateRepoDialogShow && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.state.libraryType}\n              onCreateToggle={this.onCreateRepoToggle}\n              onCreateRepo={this.onCreateRepo}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isSelectRepoDialpgShow && (\n          <ModalPortal>\n            <ShareRepoDialog\n              onRepoSelectedHandler={this.onRepoSelectedHandler}\n              onShareRepoDialogClose={this.onSelectRepoToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nPublicSharedView.propTypes = propTypes;\n\nexport default PublicSharedView;\n","import io from 'socket.io-client';\nimport { name, username, contactEmail, seafileCollabServer } from './constants';\n\nconst socket = (seafileCollabServer !== '') ? io(seafileCollabServer) : undefined;\n\nclass CollabServer {\n\n  watchRepo(repoID, fn) {\n    if (!socket) {\n      return;\n    }\n    socket.emit('repo_update', {\n      request: 'watch_update',\n      repo_id: repoID,\n      user: {\n        name: name,\n        username: username,\n        contact_email: contactEmail,\n      },\n    });\n    socket.on('repo_update', fn);\n  }\n\n  unwatchRepo(repoID, fn) {\n    if (!socket) {\n      return;\n    }\n    socket.emit('repo_update', {\n      request: 'unwatch_update',\n      repo_id: repoID,\n      user: {\n        name: name,\n        username: username,\n        contact_email: contactEmail,\n      },\n    });\n    socket.off('repo_update', fn);\n  }\n}\n\nconst collabServer = new CollabServer();\n\nexport default collabServer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody, Form } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nimport '../../css/lib-decrypt.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  onLibDecryptDialog: PropTypes.func.isRequired\n};\n\n\nclass LibDecryptDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      password: '',\n      showError: false,\n    };\n  }\n\n  handleSubmit = (e) => {\n    let repoID = this.props.repoID;\n    let password = this.state.password;\n    seafileAPI.setRepoDecryptPassword(repoID, password).then(res => {\n      this.props.onLibDecryptDialog();\n    }).catch(res => {\n      this.setState({\n        showError: true\n      });\n    });\n\n    e.preventDefault();\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key == 'Enter') {\n      this.handleSubmit(e);\n    }\n  };\n\n  handleChange = (e) => {\n    this.setState({\n      password: e.target.value,\n      showError: false\n    });\n  }\n\n  toggle = () => {\n    window.location.href = siteRoot;\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalBody>\n          <button type=\"button\" className=\"close\" onClick={this.toggle}><span aria-hidden=\"true\">×</span></button>\n          <Form className=\"lib-decrypt-form text-center\">\n            <img src={`${mediaUrl}img/lock.png`} alt=\"\" aria-hidden=\"true\" />\n            <p className=\"intro\">{gettext('This library is password protected')}</p>\n            {this.state.showError &&\n              <p className=\"error\">{gettext('Wrong password')}</p>\n            }\n            <input type=\"password\" name=\"password\" className=\"form-control password-input\" autoComplete=\"off\" onKeyPress={this.handleKeyPress} placeholder={gettext('Password')} onChange={this.handleChange} />\n            <button type=\"submit\" className=\"btn btn-primary submit\" onClick={this.handleSubmit}>{gettext('Submit')}</button>\n            <p className=\"tip\">{'* '}{gettext('The password will be kept in the server for only 1 hour.')}</p>\n          </Form>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nLibDecryptDialog.propTypes = propTypes;\n\nexport default LibDecryptDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n  isCustomPermission: PropTypes.bool,\n};\n\nclass ViewModeToolbar extends React.Component {\n\n  static defaultProps = {\n    isCustomPermission: false,\n  }\n\n  switchViewMode = (e) => {\n    e.preventDefault();\n    let id = e.target.id;\n    if (id === this.props.currentMode) {\n      return;\n    }\n    this.props.switchViewMode(id);\n  }\n\n  render() {\n    let baseClass = 'btn btn-secondary btn-icon sf-view-mode-btn ';\n    return (\n      <React.Fragment>\n        <div className=\"view-mode btn-group\">\n          <button className={`${baseClass} sf2-icon-list-view ${this.props.currentMode === 'list' ? 'current-mode' : ''}`} id='list' title={gettext('List')} aria-label={gettext('List')} onClick={this.switchViewMode}></button>\n          <button className={`${baseClass} sf2-icon-grid-view ${this.props.currentMode === 'grid' ? 'current-mode' : ''}`} id='grid' title={gettext('Grid')} aria-label={gettext('Grid')} onClick={this.switchViewMode}></button>\n          <button className={`${baseClass} sf2-icon-two-columns ${this.props.currentMode === 'column' ? 'current-mode' : ''}`} id='column' title={gettext('Column')} aria-label={gettext('Column')} onClick={this.switchViewMode}></button>\n        </div>\n        {!this.props.isCustomPermission && (\n          <div className=\"detail-btn btn-group\">\n            <button className=\"btn btn-secondary btn-icon ml-1 fas fa-info\" id='detail' title={gettext('Detail')} aria-label={gettext('Detail')} onClick={this.switchViewMode}></button>\n          </div>\n        )}\n      </React.Fragment>\n    );\n  }\n}\n\nViewModeToolbar.propTypes = propTypes;\n\nexport default ViewModeToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, isDocs } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  addFileCancel: PropTypes.func.isRequired,\n};\n\nclass CreateFile extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      parentPath: '',\n      childName: props.fileType || '',\n      isDraft: false,\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0,0);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      childName: e.target.value,\n    }) ;\n  }\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n\n    let isDuplicated = this.checkDuplicatedName();\n    let newName = this.state.childName;\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      let isDraft = this.state.isDraft;\n      this.props.onAddFile(path, isDraft);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  handleCheck = () => {\n    let pos = this.state.childName.lastIndexOf('.');\n\n    if (this.state.isDraft) {\n      // from draft to not draft\n      // case 1, normally, the file name is ended with `(draft)`, like `test(draft).md`\n      // case 2, the file name is not ended with `(draft)`, the user has deleted some characters, like `test(dra.md`\n      let p = this.state.childName.substring(pos-7, pos);\n      let fileName = this.state.childName.substring(0, pos-7);\n      let fileType = this.state.childName.substring(pos);\n      if (p === '(draft)') {\n        // remove `(draft)` from file name\n        this.setState({\n          childName: fileName + fileType,\n          isDraft: !this.state.isDraft\n        });\n      } else {\n        // don't change file name\n        this.setState({\n          isDraft: !this.state.isDraft\n        });\n      }\n    }\n\n    if (!this.state.isDraft) {\n      // from not draft to draft\n      // case 1, test.md  ===> test(draft).md\n      // case 2, .md ===> (draft).md\n      // case 3, no '.' in the file name, don't change the file name\n      if (pos > 0) {\n        let fileName = this.state.childName.substring(0, pos);\n        let fileType = this.state.childName.substring(pos);\n        this.setState({\n          childName: fileName + '(draft)' + fileType,\n          isDraft: !this.state.isDraft\n        });\n      } else if (pos === 0 ) {\n        this.setState({\n          childName: '(draft)' + this.state.childName,\n          isDraft: !this.state.isdraft\n        });\n      } else {\n        this.setState({\n          isDraft: !this.state.isdraft\n        });\n      }\n    }\n  }\n\n  toggle = () => {\n    this.props.addFileCancel();\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New File')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"fileName\">{gettext('Name')}</Label>\n              <Input\n                id=\"fileName\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={input => {this.newInput = input;}}\n                value={this.state.childName}\n                onChange={this.handleChange}\n              />\n            </FormGroup>\n            {this.props.fileType == '.md' && isDocs && (\n              <FormGroup check>\n                <Label check>\n                  <Input type=\"checkbox\" onChange={this.handleCheck}/>{'  '}{gettext('This is a draft')}\n                </Label>\n              </FormGroup>\n            )}\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateFile.propTypes = propTypes;\n\nexport default CreateFile;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport ModalPortal from '../modal-portal';\nimport CreateFolder from '../../components/dialog/create-folder-dialog';\nimport CreateFile from '../../components/dialog/create-file-dialog';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport ViewModeToolbar from './view-mode-toolbar';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onUploadFile: PropTypes.func.isRequired,\n  onUploadFolder: PropTypes.func.isRequired,\n  direntList: PropTypes.array.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass DirOperationToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: '.md',\n      isCreateFileDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isUploadMenuShow: false,\n      isCreateMenuShow: false,\n      isShareDialogShow: false,\n      operationMenuStyle: '',\n      isMobileOpMenuOpen: false\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.hideOperationMenu);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.hideOperationMenu);\n  }\n\n  toggleMobileOpMenu = () => {\n    this.setState({isMobileOpMenuOpen: !this.state.isMobileOpMenuOpen});\n  }\n\n  hideOperationMenu = () => {\n    this.setState({\n      isUploadMenuShow: false,\n      isCreateMenuShow: false,\n    });\n  }\n\n  toggleOperationMenu = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let targetRect = e.target.getBoundingClientRect();\n    let left = targetRect.left;\n    let top  = targetRect.bottom;\n    let style = {position: 'fixed', display: 'block', left: left, top: top};\n    this.setState({operationMenuStyle: style});\n  }\n\n  onUploadClick = (e) => {\n    this.toggleOperationMenu(e);\n    this.setState({\n      isUploadMenuShow: !this.state.isUploadMenuShow,\n      isCreateMenuShow: false,\n    });\n  }\n\n  onUploadFile = (e) => {\n    this.setState({isUploadMenuShow: false});\n    this.props.onUploadFile(e);\n  }\n\n  onUploadFolder = (e) => {\n    this.setState({isUploadMenuShow: false});\n    this.props.onUploadFolder(e);\n  }\n\n  onCreateClick = (e) => {\n    this.toggleOperationMenu(e);\n    this.setState({\n      isCreateMenuShow: !this.state.isCreateMenuShow,\n      isUploadMenuShow: false,\n    });\n  }\n\n  onShareClick = () => {\n    this.setState({\n      isShareDialogShow: !this.state.isShareDialogShow\n    });\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow});\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '',\n    });\n  }\n\n  onCreateMarkdownToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.md'\n    });\n  }\n\n  onCreateExcelToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.xlsx'\n    });\n  }\n\n  onCreatePPTToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.pptx'\n    });\n  }\n\n  onCreateWordToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.docx'\n    });\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  checkDuplicatedName = (newName) => {\n    let direntList = this.props.direntList;\n    let isDuplicated = direntList.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  render() {\n    let { path, repoName, userPerm } = this.props;\n\n    let itemType = path === '/' ? 'library' : 'dir';\n    let itemName = path == '/' ? repoName : Utils.getFolderName(path);\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    let canUpload = true;\n    let canCreate = true;\n    if (isCustomPermission) {\n      const { permission } = customPermission;\n      canUpload = permission.upload;\n      canCreate = permission.create;\n    }\n\n    let content = null;\n    if (Utils.isDesktop()) {\n      let { showShareBtn } = this.props;\n      content = (\n        <Fragment>\n          {canUpload && (\n            <Fragment>\n              {Utils.isSupportUploadFolder() ?\n                <Fragment>\n                  <button className=\"btn btn-secondary operation-item\" onClick={this.onUploadClick} aria-haspopup=\"true\" aria-expanded={this.state.isUploadMenuShow} aria-controls=\"upload-menu\">{gettext('Upload')}</button>\n                  {this.state.isUploadMenuShow && (\n                    <div className=\"menu dropdown-menu\" style={this.state.operationMenuStyle} role=\"menu\" id=\"upload-menu\">\n                      <button type=\"button\" className=\"dropdown-item\" onClick={this.onUploadFile} role=\"menuitem\">{gettext('Upload Files')}</button>\n                      <button type=\"button\" className=\"dropdown-item\" onClick={this.onUploadFolder} role=\"menuitem\">{gettext('Upload Folder')}</button>\n                    </div>\n                  )}\n                </Fragment>\n                :\n                <button className=\"btn btn-secondary operation-item\" title={gettext('Upload')} onClick={this.onUploadFile}>{gettext('Upload')}</button>}\n            </Fragment>\n          )}\n          {canCreate &&\n          <Fragment>\n            <button className=\"btn btn-secondary operation-item\" onClick={this.onCreateClick} aria-haspopup=\"true\" aria-expanded={this.state.isUploadMenuShow} aria-controls=\"new-menu\">{gettext('New')}</button>\n            {this.state.isCreateMenuShow && (\n              <div className=\"menu dropdown-menu\" style={this.state.operationMenuStyle} role=\"menu\" id=\"new-menu\">\n                <button className=\"dropdown-item\" onClick={this.onCreateFolderToggle} role=\"menuitem\">{gettext('New Folder')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreateFileToggle}>{gettext('New File')}</button>\n                <div className=\"dropdown-divider\"></div>\n                <button className=\"dropdown-item\" onClick={this.onCreateMarkdownToggle} role=\"menuitem\">{gettext('New Markdown File')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreateExcelToggle} role=\"menuitem\">{gettext('New Excel File')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreatePPTToggle} role=\"menuitem\">{gettext('New PowerPoint File')}</button>\n                <button className=\"dropdown-item\" onClick={this.onCreateWordToggle} role=\"menuitem\">{gettext('New Word File')}</button>\n              </div>\n            )}\n          </Fragment>\n          }\n          {showShareBtn && <button className=\"btn btn-secondary operation-item\" title={gettext('Share')} onClick={this.onShareClick}>{gettext('Share')}</button>}\n        </Fragment>\n      );\n    } else {\n      content = (\n        <Dropdown isOpen={this.state.isMobileOpMenuOpen} toggle={this.toggleMobileOpMenu}>\n          <DropdownToggle tag=\"span\" className=\"sf2-icon-plus mobile-toolbar-icon\" />\n          <DropdownMenu>\n            {canUpload && (\n              <DropdownItem onClick={this.onUploadFile}>{gettext('Upload')}</DropdownItem>\n            )}\n            {canCreate && (\n              <Fragment>\n                <DropdownItem onClick={this.onCreateFolderToggle}>{gettext('New Folder')}</DropdownItem>\n                <DropdownItem onClick={this.onCreateFileToggle}>{gettext('New File')}</DropdownItem>\n              </Fragment>\n            )}\n          </DropdownMenu>\n        </Dropdown>\n      );\n    }\n\n    return (\n      <Fragment>\n        {(userPerm === 'rw' || userPerm === 'admin' || isCustomPermission) && (\n          <div className=\"dir-operation\">\n            {content}\n          </div>\n        )}\n        {Utils.isDesktop() && <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} isCustomPermission={isCustomPermission} />}\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              fileType={this.state.fileType}\n              onAddFile={this.onAddFile}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFileCancel={this.onCreateFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.props.path}\n              onAddFolder={this.onAddFolder}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onCreateFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={itemType}\n              itemName={itemName}\n              itemPath={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.onShareClick}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDirOperationToolbar.propTypes = propTypes;\n\nexport default DirOperationToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalFooter, ModalBody, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  isMutipleOperation: PropTypes.bool.isRequired,\n  onItemMove: PropTypes.func,\n  onItemsMove: PropTypes.func,\n  onCancelMove: PropTypes.func.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n};\n\n// need dirent file Path；\nclass MoveDirent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: { repo_id: this.props.repoID },\n      selectedPath: this.props.path,\n      errMessage: ''\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.state.errMessage === nextState.errMessage) {\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit = () => {\n    if (this.props.isMutipleOperation) {\n      this.moveItems();\n    } else {\n      this.moveItem();\n    }\n  }\n\n  moveItems = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let message = gettext('Invalid destination path');\n\n    if (!repo || selectedPath === '') {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    let selectedDirentList = this.props.selectedDirentList;\n    let direntPaths = [];\n    selectedDirentList.forEach(dirent => {\n      let path = Utils.joinPath(this.props.path, dirent.name);\n      direntPaths.push(path);\n    });\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // move dirents to current path\n    if (selectedPath && selectedPath === this.props.path && (repo.repo_id === repoID)) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let moveDirentPath = '';\n    let isChildPath = direntPaths.some(direntPath => {\n      let flag = selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1;\n      if (flag) {\n        moveDirentPath = direntPath;\n      }\n      return flag;\n    });\n\n    if (isChildPath) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', moveDirentPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemsMove(repo, selectedPath);\n    this.toggle();\n  }\n\n  moveItem = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let direntPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    let message = gettext('Invalid destination path');\n\n    if (!repo || (repo.repo_id === repoID && selectedPath === '')) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (selectedPath && direntPath === selectedPath) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to current path\n    if (selectedPath && this.props.path === selectedPath && repo.repo_id === repoID) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if ( selectedPath && selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', direntPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemMove(repo, this.props.dirent, selectedPath, this.props.path);\n    this.toggle();\n  }\n\n  toggle = () => {\n    this.props.onCancelMove();\n  }\n\n  onDirentItemClick = (repo, selectedPath) => {\n    this.setState({\n      repo: repo,\n      selectedPath: selectedPath,\n      errMessage: ''\n    });\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n      errMessage: ''\n    });\n  }\n\n  render() {\n    let title = gettext('Move {placeholder} to');\n    if (!this.props.isMutipleOperation) {\n      title = title.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    } else {\n      title = gettext('Move selected item(s) to:');\n    }\n    let mode = this.props.repoEncrypted ? 'only_current_library':'current_repo_and_other_repos';\n    const { dirent, selectedDirentList } = this.props;\n    const movedDirent = dirent ? dirent : selectedDirentList[0];\n    const { permission } = movedDirent;\n    const { isCustomPermission } = Utils.getUserPermission(permission);\n    if (isCustomPermission) {\n      mode = 'only_current_library';\n    }\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <FileChooser\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode={mode}\n          />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nMoveDirent.propTypes = propTypes;\n\nexport default MoveDirent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalFooter, ModalBody, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  isMutipleOperation: PropTypes.bool.isRequired,\n  onItemCopy: PropTypes.func,\n  onItemsCopy: PropTypes.func,\n  onCancelCopy: PropTypes.func.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n};\n\n// need dirent file Path；\nclass CopyDirent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: { repo_id: this.props.repoID },\n      selectedPath: this.props.path,\n      errMessage: ''\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.state.errMessage === nextState.errMessage) {\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit = () => {\n    if (this.props.isMutipleOperation) {\n      this.copyItems();\n    } else {\n      this.copyItem();\n    }\n  }\n\n  copyItems = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let message = gettext('Invalid destination path');\n\n    if (!repo || selectedPath === '') {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    let selectedDirentList = this.props.selectedDirentList;\n    let direntPaths = [];\n    selectedDirentList.forEach(dirent => {\n      let path = Utils.joinPath(this.props.path, dirent.name);\n      direntPaths.push(path);\n    });\n\n    // copy dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let copyDirentPath = '';\n    let isChildPath = direntPaths.some(direntPath => {\n      let flag = selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1;\n      if (flag) {\n        copyDirentPath = direntPath;\n      }\n      return flag;\n    });\n\n    if (isChildPath) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', copyDirentPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemsCopy(repo, selectedPath);\n    this.toggle();\n  }\n\n  copyItem = () => {\n    let { repo, repoID, selectedPath } = this.state;\n    let direntPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    let message = gettext('Invalid destination path');\n\n    if (!repo || (repo.repo_id === repoID && selectedPath === '')) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (selectedPath && direntPath === selectedPath) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if ( selectedPath && selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1) {\n      message = gettext('Can not copy directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', direntPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemCopy(repo, this.props.dirent, selectedPath, this.props.path);\n    this.toggle();\n  }\n\n  toggle = () => {\n    this.props.onCancelCopy();\n  }\n\n  onDirentItemClick = (repo, selectedPath) => {\n    this.setState({\n      repo: repo,\n      selectedPath: selectedPath,\n      errMessage: ''\n    });\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n      errMessage: ''\n    });\n  }\n\n  render() {\n    let title = gettext('Copy {placeholder} to');\n    if (!this.props.isMutipleOperation) {\n      title = title.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    } else {\n      title = gettext('Copy selected item(s) to:');\n    }\n    let mode = this.props.repoEncrypted ? 'only_current_library':'current_repo_and_other_repos';\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <FileChooser\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode={mode}\n          />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCopyDirent.propTypes = propTypes;\n\nexport default CopyDirent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  dirent: PropTypes.object,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentWillMount() {\n    this.setState({newName: this.props.dirent.name});\n  }\n\n  componentDidMount() {\n    let {dirent} = this.props;\n    this.changeState(dirent);\n    this.newInput.focus();\n    let type = dirent.type;\n    if (type === 'file') {\n      var endIndex = dirent.name.lastIndexOf('.md');\n      this.newInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.setSelectionRange(0, -1);\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.dirent);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n        this.props.toggleCancel();\n      }\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  changeState = (dirent) => {\n    let name = dirent.name;\n    this.setState({newName: name});\n  }\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  }\n\n  render() {\n    let type = this.props.dirent.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ButtonGroup } from 'reactstrap';\nimport { gettext, siteRoot, name, fileServerRoot, useGoFileserver } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport Rename from '../dialog/rename-dirent';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\nimport ViewModeToolbar from './view-mode-toolbar';\n\nimport ModalPortal from '../modal-portal';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport toaster from '../toast';\n\nimport '../../css/dirents-menu.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onFilesTagChanged: PropTypes.func.isRequired,\n  unSelectDirent: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass MultipleDirOperationToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isZipDialogOpen: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isMutipleOperation: true,\n      showLibContentViewDialogs: false,\n      showShareDialog: false,\n      showEditFileTagDialog: false,\n      fileTagList: [],\n      multiFileTagList: [],\n      isRenameDialogOpen: false,\n      isPermissionDialogOpen: false\n    };\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onItemsDelete = () => {\n    this.props.onItemsDelete();\n  }\n\n  onItemsDownload = () => {\n    let { path, repoID, selectedDirentList } = this.props;\n    if (selectedDirentList.length) {\n      if (selectedDirentList.length === 1 && !selectedDirentList[0].isDir()) {\n        let direntPath = Utils.joinPath(path, selectedDirentList[0].name);\n        let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n        location.href= url;\n        return;\n      }\n      if (!useGoFileserver) {\n        this.setState({\n          isZipDialogOpen: true\n        });\n      } else {\n        const target = this.props.selectedDirentList.map(dirent => dirent.name);\n        seafileAPI.zipDownload(repoID, path, target).then((res) => {\n          const zipToken = res.data['zip_token'];\n          location.href = `${fileServerRoot}zip/${zipToken}`;\n        }).catch((error) => {\n          let errorMsg = Utils.getErrorMsg(error);\n          this.setState({\n            isLoading: false,\n            errorMsg: errorMsg\n          });\n        });\n      }\n    }\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  checkDuplicatedName = (newName) => {\n    return Utils.checkDuplicatedNameInList(this.props.direntList, newName);\n  }\n\n  onItemRename = (newName) => {\n    const dirent = this.props.selectedDirentList[0];\n    this.props.onItemRename(dirent, newName);\n  }\n\n  onPermissionItem = () => {\n    this.setState({\n      showLibContentViewDialogs: !this.state.showLibContentViewDialogs,\n      isPermissionDialogOpen: !this.state.isPermissionDialogOpen\n    });\n  }\n\n  onCommentItem = () => {\n    this.props.showDirentDetail('comments');\n  }\n\n  getDirentMenuList = (dirent) => {\n    const isRepoOwner = this.props.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    const isContextmenu = true;\n    let opList = Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n    const list = ['Move', 'Copy', 'Delete', 'Download'];\n    if (dirent.type == 'dir') {\n      opList = opList.filter((item, index) => {\n        return list.indexOf(item.key) == -1 && item != 'Divider';\n      });\n    } else {\n      opList = opList.filter((item, index) => {\n        return list.indexOf(item.key) == -1;\n      });\n    }\n    return opList;\n  }\n\n  onMenuItemClick = (operation) => {\n    const dirents = this.props.selectedDirentList;\n    const dirent = dirents[0];\n    switch (operation) {\n      case 'Share':\n        this.setState({\n          showLibContentViewDialogs: true,\n          showShareDialog: true,\n        });\n        break;\n      case 'Rename':\n        this.setState({\n          showLibContentViewDialogs: true,\n          isRenameDialogOpen: true\n        });\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Tags':\n        this.listFileTags(dirent);\n        break;\n      case 'Lock':\n        this.lockFile(dirent);\n        break;\n      case 'Unlock':\n        this.unlockFile(dirent);\n        break;\n      case 'Comment':\n        this.onCommentItem();\n        break;\n      case 'History':\n        this.onHistory(dirent);\n        break;\n      case 'Access Log':\n        this.onAccessLog(dirent);\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient(dirent);\n        break;\n      default:\n        break;\n    }\n  }\n\n  lockFile = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    seafileAPI.lockfile(this.props.repoID, filePath).then((res) => {\n      if (res.data.is_locked) {\n        this.props.updateDirent(dirent, 'is_locked', true);\n        this.props.updateDirent(dirent, 'locked_by_me', true);\n        this.props.updateDirent(dirent, 'lock_owner_name', name);\n        this.props.unSelectDirent();\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unlockFile = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    seafileAPI.unlockfile(this.props.repoID, filePath).then((res) => {\n      if (!res.data.is_locked) {\n        this.props.updateDirent(dirent, 'is_locked', false);\n        this.props.updateDirent(dirent, 'locked_by_me', false);\n        this.props.updateDirent(dirent, 'lock_owner_name', '');\n        this.props.unSelectDirent();\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onOpenViaClient = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    let url = URLDecorator.getUrl({\n      type: 'open_via_client',\n      repoID: this.props.repoID,\n      filePath: filePath\n    });\n    location.href = url;\n  }\n\n  onHistory = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    let url = URLDecorator.getUrl({\n      type: 'file_revisions',\n      repoID: this.props.repoID,\n      filePath: filePath\n    });\n    location.href = url;\n  }\n\n  onAccessLog = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  toggleCancel = () => {\n    this.setState({\n      showLibContentViewDialogs: false,\n      showShareDialog: false,\n      showEditFileTagDialog: false,\n      isRenameDialogOpen: false,\n      isPermissionDialogOpen: false,\n    });\n  }\n\n  listFileTags = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.listFileTags(this.props.repoID, filePath).then(res => {\n      let fileTagList = res.data.file_tags;\n      for (let i = 0, length = fileTagList.length; i < length; i++) {\n        fileTagList[i].id = fileTagList[i].file_tag_id;\n      }\n      this.setState({\n        fileTagList: fileTagList,\n        showLibContentViewDialogs: true,\n        showEditFileTagDialog: true,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMenuFileTagChanged = () => {\n    this.listFileTags(this.props.selectedDirentList[0]);\n    let length = this.props.selectedDirentList.length;\n    for (let i = 0; i < length; i++) {\n      const dirent = this.props.selectedDirentList[i];\n      const direntPath = this.getDirentPath(dirent);\n      this.props.onFilesTagChanged(dirent, direntPath);\n    }\n  }\n\n  getDirentPath = (dirent) => {\n    if (dirent) return Utils.joinPath(this.props.path, dirent.name);\n  }\n\n  render() {\n\n    const { repoID, userPerm } = this.props;\n    const dirent = this.props.selectedDirentList[0];\n    const direntPath = this.getDirentPath(dirent);\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    let canDelete = true;\n    let canDownload = true;\n    let canCopy = true;\n    let canModify = true;\n    if (isCustomPermission) {\n      const { permission } = customPermission;\n      canDelete = permission.delete;\n      canDownload = permission.download;\n      canCopy = permission.copy;\n      canModify = permission.modify;\n    }\n\n    return (\n      <Fragment>\n        <div className=\"dir-operation\">\n          <div className=\"d-flex\">\n            <ButtonGroup className=\"flex-row group-operations\">\n              {(userPerm === 'rw' || userPerm === 'admin' || isCustomPermission) && (\n                <Fragment>\n                  {canModify && <Button className=\"secondary group-op-item action-icon sf2-icon-move\" title={gettext('Move')} aria-label={gettext('Move')} onClick={this.onMoveToggle}></Button>}\n                  {canCopy && <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} aria-label={gettext('Copy')} onClick={this.onCopyToggle}></Button>}\n                  {canDelete && <Button className=\"secondary group-op-item action-icon sf2-icon-delete\" title={gettext('Delete')} aria-label={gettext('Delete')} onClick={this.onItemsDelete}></Button>}\n                  {canDownload && <Button className=\"secondary group-op-item action-icon sf2-icon-download\" title={gettext('Download')} aria-label={gettext('Download')} onClick={this.onItemsDownload}></Button>}\n                </Fragment>\n              )}\n              {userPerm === 'r' && (\n                <Fragment>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} aria-label={gettext('Copy')} onClick={this.onCopyToggle}></Button>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-download\" title={gettext('Download')} aria-label={gettext('Download')} onClick={this.onItemsDownload}></Button>\n                </Fragment>\n              )}\n              {this.props.selectedDirentList.length === 1 &&\n                <ItemDropdownMenu\n                  tagName={'button'}\n                  item={this.props.selectedDirentList[0]}\n                  toggleClass={'fas fa-ellipsis-v dirents-more-menu'}\n                  onMenuItemClick={this.onMenuItemClick}\n                  getMenuList={this.getDirentMenuList}\n                />\n              }\n            </ButtonGroup>\n          </div>\n        </div>\n        {Utils.isDesktop() && <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} isCustomPermission={isCustomPermission} />}\n        {this.state.isMoveDialogShow &&\n          <MoveDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.repoEncrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            selectedDirentList={this.props.selectedDirentList}\n            onItemsMove={this.props.onItemsMove}\n            onCancelMove={this.onMoveToggle}\n          />\n        }\n        {this.state.isCopyDialogShow &&\n          <CopyDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.repoEncrypted}\n            selectedDirentList={this.props.selectedDirentList}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemsCopy={this.props.onItemsCopy}\n            onCancelCopy={this.onCopyToggle}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n        <ModalPortal>\n          <ZipDownloadDialog\n            repoID={this.props.repoID}\n            path={this.props.path}\n            target={this.props.selectedDirentList.map(dirent => dirent.name)}\n            toggleDialog={this.closeZipDialog}\n          />\n        </ModalPortal>\n        }\n        {this.state.showLibContentViewDialogs && (\n          <Fragment>\n            {this.state.showShareDialog &&\n              <ModalPortal>\n                <ShareDialog\n                  itemType={dirent.type}\n                  itemName={dirent.name}\n                  itemPath={direntPath}\n                  userPerm={dirent.permission}\n                  repoID={repoID}\n                  repoEncrypted={this.props.repoEncrypted}\n                  enableDirPrivateShare={this.props.enableDirPrivateShare}\n                  isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                  toggleDialog={this.toggleCancel}\n                />\n              </ModalPortal>\n            }\n            {this.state.isRenameDialogOpen &&\n              <ModalPortal>\n                <Rename\n                  dirent={dirent}\n                  onRename={this.onItemRename}\n                  checkDuplicatedName={this.checkDuplicatedName}\n                  toggleCancel={this.toggleCancel}\n                />\n              </ModalPortal>\n            }\n            {this.state.isPermissionDialogOpen &&\n              <ModalPortal>\n                <LibSubFolderPermissionDialog\n                  toggleDialog={this.toggleCancel}\n                  repoID={repoID}\n                  folderPath={direntPath}\n                  folderName={dirent.name}\n                  isDepartmentRepo={this.props.isGroupOwnedRepo}\n                />\n              </ModalPortal>\n            }\n            {this.state.showEditFileTagDialog &&\n              <ModalPortal>\n                <EditFileTagDialog\n                  repoID={repoID}\n                  filePath={direntPath}\n                  fileTagList={this.state.fileTagList}\n                  toggleCancel={this.toggleCancel}\n                  onFileTagChanged={this.onMenuFileTagChanged}\n                />\n              </ModalPortal>\n            }\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nMultipleDirOperationToolbar.propTypes = propTypes;\n\nexport default MultipleDirOperationToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { DropdownToggle, Dropdown, DropdownMenu, DropdownItem, Tooltip} from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink, isDocs } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport ModalPotal from '../modal-portal';\nimport ShareDialog from '../dialog/share-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n};\n\nclass ViewFileToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isDraftMessageShow: false,\n      isMoreMenuShow: false,\n      isShareDialogShow: false,\n      isEditTagDialogShow: false,\n    };\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path) + '?mode=edit';\n    window.open(url);\n  }\n\n  onNewDraft = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    seafileAPI.createDraft(repoID, path).then(res => {\n      window.location.href = siteRoot + 'lib/' + res.data.origin_repo_id + '/file' + res.data.draft_file_path + '?mode=edit';\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDraftHover = () => {\n    this.setState({isDraftMessageShow: !this.state.isDraftMessageShow});\n  }\n\n  toggleMore = () => {\n    this.setState({isMoreMenuShow: !this.state.isMoreMenuShow});\n  }\n\n  onShareToggle = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({isEditTagDialogShow: !this.state.isEditTagDialogShow});\n  }\n\n  onHistoryClick = () => {\n    let historyUrl = siteRoot + 'repo/file_revisions/' + this.props.repoID + '/?p=' + Utils.encodePath(this.props.path);\n    location.href = historyUrl;\n  }\n\n  render() {\n    let { filePermission } = this.props;\n    let name = Utils.getFileName(this.props.path);\n    let dirent = { name: name };\n    return (\n      <Fragment>\n        <div className=\"dir-operation\">\n          {((filePermission === 'rw' || filePermission === 'cloud-edit') && !this.props.hasDraft) && (\n            <Fragment>\n              <button className=\"btn btn-secondary operation-item\" title={gettext('Edit File')} onClick={this.onEditClick}>{gettext('Edit')}</button>\n            </Fragment>\n          )}\n          {(filePermission === 'rw' && !this.props.isDraft && !this.props.hasDraft && isDocs) && (\n            <Fragment>\n              <button id=\"new-draft\" className=\"btn btn-secondary operation-item\" onClick={this.onNewDraft}>{gettext('New Draft')}</button>\n              <Tooltip target=\"new-draft\" placement=\"bottom\" isOpen={this.state.isDraftMessageShow} toggle={this.onDraftHover}>{gettext('Create a draft from this file, instead of editing it directly.')}</Tooltip>\n            </Fragment>\n          )}\n          {filePermission === 'rw' && (\n            <Dropdown isOpen={this.state.isMoreMenuShow} toggle={this.toggleMore}>\n              <DropdownToggle className='btn btn-secondary operation-item'>\n                {gettext('More')}\n              </DropdownToggle>\n              <DropdownMenu>\n                {this.props.showShareBtn &&\n                  <DropdownItem onClick={this.onShareToggle}>{gettext('Share')}</DropdownItem>\n                }\n                <DropdownItem onClick={this.onEditFileTagToggle}>{gettext('Tags')}</DropdownItem>\n                <DropdownItem onClick={this.onHistoryClick}>{gettext('History')}</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n          )}\n        </div>\n        {this.state.isShareDialogShow && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'file'}\n              itemName={Utils.getFileName(this.props.path)}\n              itemPath={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.onShareToggle}\n            />\n          </ModalPotal>\n        )}\n        {this.state.isEditTagDialogShow && (\n          <ModalPotal>\n            <EditFileTagDialog\n              filePath={this.props.path}\n              repoID={this.props.repoID}\n              fileTagList={this.props.fileTags}\n              toggleCancel={this.onEditFileTagToggle}\n              onFileTagChanged={this.props.onFileTagChanged}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nViewFileToolbar.propTypes = propTypes;\n\nexport default ViewFileToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport ViewModeToolbar from '../../components/toolbar/view-mode-toolbar';\nimport DirOperationToolBar from '../../components/toolbar/dir-operation-toolbar';\nimport MultipleDirOperationToolbar from '../../components/toolbar/multiple-dir-operation-toolbar';\nimport ViewFileToolbar from '../../components/toolbar/view-file-toolbar';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  isViewFile: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,  // for file-view-toolbar\n  // side-panel\n  onSideNavMenuClick: PropTypes.func.isRequired,\n  // mutiple-dir\n  isDirentSelected: PropTypes.bool.isRequired,\n  repoID: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  // dir\n  direntList: PropTypes.array.isRequired,\n  repoName: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onUploadFile: PropTypes.func.isRequired,\n  onUploadFolder: PropTypes.func.isRequired,\n  // view-mode\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n  // search\n  onSearchedClick: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired,\n  // selected menu\n  onFilesTagChanged: PropTypes.func.isRequired, // for mutiple select toolbar\n  updateDirent: PropTypes.func.isRequired,\n  unSelectDirent: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n};\n\nclass LibContentToolbar extends React.Component {\n\n  render() {\n\n    const { userPerm } = this.props;\n    const { isCustomPermission } = Utils.getUserPermission(userPerm);\n\n    if (this.props.isViewFile) {\n      return (\n        <Fragment>\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title={gettext('Side Nav Menu')} onClick={this.props.onSideNavMenuClick}></span>\n            <ViewFileToolbar\n              path={this.props.path}\n              repoID={this.props.repoID}\n              userPerm={this.props.userPerm}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              filePermission={this.props.filePermission}\n              isDraft={this.props.isDraft}\n              hasDraft={this.props.hasDraft}\n              fileTags={this.props.fileTags}\n              onFileTagChanged={this.props.onFileTagChanged}\n              showShareBtn={this.props.showShareBtn}\n            />\n            <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} isCustomPermission={isCustomPermission} />\n          </div>\n          <CommonToolbar isLibView={true} repoID={this.props.repoID} repoName={this.props.repoName} onSearchedClick={this.props.onSearchedClick} searchPlaceholder={gettext('Search files in this library')}/>\n        </Fragment>\n      );\n    }\n\n    return (\n      <Fragment>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title={gettext('Side Nav Menu')} onClick={this.props.onSideNavMenuClick}></span>\n          {this.props.isDirentSelected ?\n            <MultipleDirOperationToolbar\n              repoID={this.props.repoID}\n              path={this.props.path}\n              userPerm={this.props.userPerm}\n              repoEncrypted={this.props.repoEncrypted}\n              selectedDirentList={this.props.selectedDirentList}\n              direntList={this.props.direntList}\n              onItemsMove={this.props.onItemsMove}\n              onItemsCopy={this.props.onItemsCopy}\n              onItemsDelete={this.props.onItemsDelete}\n              onItemRename={this.props.onItemRename}\n              isRepoOwner={this.props.isRepoOwner}\n              currentRepoInfo={this.props.currentRepoInfo}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              updateDirent={this.props.updateDirent}\n              unSelectDirent={this.props.unSelectDirent}\n              onFilesTagChanged={this.props.onFilesTagChanged}\n              showShareBtn={this.props.showShareBtn}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              showDirentDetail={this.props.showDirentDetail}\n              currentMode={this.props.currentMode}\n              switchViewMode={this.props.switchViewMode}\n            /> :\n            <DirOperationToolBar\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoName={this.props.repoName}\n              repoEncrypted={this.props.repoEncrypted}\n              direntList={this.props.direntList}\n              showShareBtn={this.props.showShareBtn}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              onAddFile={this.props.onAddFile}\n              onAddFolder={this.props.onAddFolder}\n              onUploadFile={this.props.onUploadFile}\n              onUploadFolder={this.props.onUploadFolder}\n              currentMode={this.props.currentMode}\n              switchViewMode={this.props.switchViewMode}\n            />\n          }\n        </div>\n        <CommonToolbar isLibView={true} repoID={this.props.repoID} repoName={this.props.repoName} onSearchedClick={this.props.onSearchedClick} searchPlaceholder={gettext('Search files in this library')}/>\n      </Fragment>\n    );\n  }\n}\n\nLibContentToolbar.propTypes = propTypes;\n\nexport default LibContentToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport InternalLinkDialog from '../dialog/internal-link-dialog';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoName: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func,\n  pathPrefix: PropTypes.array,\n  repoID: PropTypes.string.isRequired,\n  isViewFile: PropTypes.bool,\n  fileTags: PropTypes.array.isRequired,\n};\n\nclass DirPath extends React.Component {\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  onTabNavClick = (e, tabName, id) => {\n    if (window.uploader &&\n      window.uploader.isUploadProgressDialogShow &&\n      window.uploader.totalProgress !== 100) {\n      if (!window.confirm(gettext('A file is being uploaded. Are you sure you want to leave this page?'))) {\n        e.preventDefault();\n        return false;\n      }\n      window.uploader.isUploadProgressDialogShow = false;\n    }\n    this.props.onTabNavClick(tabName, id);\n  }\n\n  turnPathToLink = (path) => {\n    path = path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let { currentPath, repoName, fileTags } = this.props;\n    let pathElem = this.turnPathToLink(currentPath);\n\n    let tagTitle = '';\n    if (fileTags.length > 0) {\n      fileTags.forEach(item => {\n        tagTitle += item.name + ' ';\n      });\n    }\n\n    return (\n      <div className=\"path-container\">\n        {this.props.pathPrefix && this.props.pathPrefix.map((item, index) => {\n          return (\n            <Fragment key={index}>\n              <Link to={item.url} className=\"normal\" onClick={(e) => this.onTabNavClick(e, item.name, item.id)}>{gettext(item.showName)}</Link>\n              <span className=\"path-split\">/</span>\n            </Fragment>\n          );\n        })}\n        {this.props.pathPrefix && this.props.pathPrefix.length === 0 && (\n          <Fragment>\n            <Link to={siteRoot + 'my-libs/'} className=\"normal\" onClick={(e) => this.onTabNavClick(e, 'my-libs')}>{gettext('Libraries')}</Link>\n            <span className=\"path-split\">/</span>\n          </Fragment>\n        )}\n        {!this.props.pathPrefix && (\n          <Fragment>\n            <Link href={siteRoot + 'my-libs/'} className=\"normal\" onClick={(e) => this.onTabNavClick(e, 'my-libs')}>{gettext('Libraries')}</Link>\n            <span className=\"path-split\">/</span>\n          </Fragment>\n        )}\n        {(currentPath === '/' || currentPath === '') ?\n          <span className=\"path-repo-name\">{repoName}</span>:\n          <a className=\"path-link\" data-path=\"/\" onClick={this.onPathClick}>{repoName}</a>\n        }\n        {pathElem}\n        {this.props.isViewFile &&\n          <InternalLinkDialog\n            repoID={this.props.repoID}\n            path={this.props.currentPath}\n          />\n        }\n        {(this.props.isViewFile && fileTags.length !== 0) &&\n          <span id='column-mode-file-tags' className=\"tag-list tag-list-stacked align-middle ml-1\">\n            {fileTags.map((fileTag, index) => {\n              return (<span className=\"file-tag\" key={fileTag.id} style={{zIndex: index, backgroundColor: fileTag.color}}></span>);\n            })}\n            <UncontrolledTooltip target=\"column-mode-file-tags\" placement=\"bottom\">\n              {tagTitle}\n            </UncontrolledTooltip>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nDirPath.propTypes = propTypes;\n\nexport default DirPath;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Popover, PopoverBody } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/repo-tag.css';\n\nconst tagColorPropTypes = {\n  tag: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired\n};\n\nclass TagColor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagColor: this.props.tag.color,\n      isPopoverOpen: false\n    };\n  }\n\n  togglePopover = () => {\n    this.setState({\n      isPopoverOpen: !this.state.isPopoverOpen\n    });\n  }\n\n  selectTagColor = (e) => {\n    const newColor = e.target.value;\n    const { repoID, tag } = this.props;\n    const { id, name } = tag;\n    seafileAPI.updateRepoTag(repoID, id, name, newColor).then(() => {\n      this.setState({\n        tagColor: newColor,\n        isPopoverOpen: !this.state.isPopoverOpen\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { isPopoverOpen, tagColor } = this.state;\n    const { tag } = this.props;\n    const { id, color } = tag;\n\n    let colorList = ['#FBD44A', '#EAA775', '#F4667C', '#DC82D2', '#9860E5', '#9F8CF1', '#59CB74', '#ADDF84', '#89D2EA', '#4ECCCB', '#46A1FD', '#C2C2C2'];\n    // for color from previous color options\n    if (colorList.indexOf(color) == -1) {\n      colorList.unshift(color);\n    }\n\n    return (\n      <div>\n        <span\n          id={`tag-${id}-color`}\n          className=\"tag-color cursor-pointer w-4 h-4 rounded-circle d-flex align-items-center justify-content-center\"\n          style={{backgroundColor: tagColor}}\n          onClick={this.togglePopover}\n        >\n          <i className=\"fas fa-caret-down text-white\"></i>\n        </span>\n        <Popover\n          target={`tag-${id}-color`}\n          isOpen={isPopoverOpen}\n          placement=\"bottom\"\n          toggle={this.togglePopover}\n          className=\"mw-100\"\n        >\n          <PopoverBody className=\"p-2\">\n            <div className=\"d-flex justify-content-between\">\n              {colorList.map((item, index)=>{\n                return (\n                  <div key={index} className=\"tag-color-option mx-1\">\n                    <label className=\"colorinput\">\n                      <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" defaultChecked={item == tagColor} onClick={this.selectTagColor} />\n                      <span className=\"colorinput-color rounded-circle d-flex align-items-center justify-content-center\" style={{backgroundColor: item}}>\n                        <i className=\"fas fa-check color-selected\"></i>\n                      </span>\n                    </label>\n                  </div>\n                );\n              })\n              }\n            </div>\n          </PopoverBody>\n        </Popover>\n      </div>\n    );\n  }\n}\n\nTagColor.propTypes = tagColorPropTypes;\n\nexport default TagColor;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/repo-tag.css';\n\nconst tagNamePropTypes = {\n  tag: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired\n};\n\nclass TagName extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagName: this.props.tag.name,\n      isEditing: false\n    };\n    this.input = React.createRef();\n  }\n\n  toggleMode = () => {\n    this.setState({\n      isEditing: !this.state.isEditing\n    }, () => {\n      if (this.state.isEditing) {\n        this.input.current.focus();\n      }\n    });\n  }\n\n  updateTagName = (e) => {\n    const newName = e.target.value;\n    const { repoID, tag } = this.props;\n    const { id, color } = tag;\n    seafileAPI.updateRepoTag(repoID, id, newName, color).then(() => {\n      this.setState({\n        tagName: newName\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onInputKeyDown = (e) => {\n    if (e.key == 'Enter') {\n      this.toggleMode();\n      this.updateTagName(e);\n    }\n  }\n\n  onInputBlur = (e) => {\n    this.toggleMode();\n    this.updateTagName(e);\n  }\n\n  render() {\n    const { isEditing, tagName } = this.state;\n    return (\n      <div className=\"mx-2 flex-fill d-flex\">\n        {isEditing ?\n          <input\n            type=\"text\"\n            ref={this.input}\n            defaultValue={tagName}\n            onBlur={this.onInputBlur}\n            onKeyDown={this.onInputKeyDown}\n            className=\"flex-fill form-control-sm form-control\"\n          /> :\n          <span\n            onClick={this.toggleMode}\n            className=\"cursor-pointer flex-fill\"\n          >{tagName}</span>\n        }\n      </div>\n    );\n  }\n}\n\nTagName.propTypes = tagNamePropTypes;\n\nexport default TagName;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport RepoTag from '../../models/repo-tag';\nimport TagColor from './tag-color';\nimport TagName from './tag-name';\n\nimport '../../css/repo-tag.css';\n\nconst tagListItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  onDeleteTag : PropTypes.func.isRequired\n};\n\nclass TagListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isTagHighlighted: false\n    };\n  }\n\n  onMouseOver = () => {\n    this.setState({\n      isTagHighlighted: true\n    });\n  }\n\n  onMouseOut = () => {\n    this.setState({\n      isTagHighlighted: false\n    });\n  }\n\n  deleteTag = () => {\n    this.props.onDeleteTag(this.props.item);\n  }\n\n  render() {\n    const { isTagHighlighted } = this.state;\n    const { item, repoID } = this.props;\n    return (\n      <li\n        className={`tag-list-item px-4 d-flex justify-content-between align-items-center ${isTagHighlighted ? 'hl' : ''}`}\n        onMouseOver={this.onMouseOver}\n        onMouseOut={this.onMouseOut}\n      >\n        <TagColor repoID={repoID} tag={item} />\n        <TagName repoID={repoID} tag={item} />\n        <button\n          className={`tag-delete-icon sf2-icon-delete border-0 px-0 bg-transparent cursor-pointer ${isTagHighlighted ? '' : 'invisible'}`}\n          onClick={this.deleteTag}\n          aria-label={gettext('Delete')}\n          title={gettext('Delete')}\n        ></button>\n      </li>\n    );\n  }\n}\n\nTagListItem.propTypes = tagListItemPropTypes;\n\nconst listTagPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  onListTagCancel: PropTypes.func.isRequired,\n  onCreateRepoTag: PropTypes.func.isRequired\n};\n\nclass ListTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repotagList: []\n    };\n  }\n\n  componentDidMount() {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let repotagList = [];\n      res.data.repo_tags.forEach(item => {\n        let repo_tag = new RepoTag(item);\n        repotagList.push(repo_tag);\n      });\n      this.setState({\n        repotagList: repotagList\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggle = () => {\n    this.props.onListTagCancel();\n  }\n\n  createNewTag = (e) => {\n    e.preventDefault();\n    this.props.onCreateRepoTag();\n  }\n\n  onDeleteTag = (tag) => {\n    const { repoID } = this.props;\n    const { id: targetTagID } = tag;\n    seafileAPI.deleteRepoTag(repoID, targetTagID).then((res) => {\n      this.setState({\n        repotagList: this.state.repotagList.filter(tag => tag.id != targetTagID)\n      });\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.toggle}>{gettext('Tags')}</ModalHeader>\n        <ModalBody className=\"px-0\">\n          <ul className=\"tag-list tag-list-container\">\n            {this.state.repotagList.map((repoTag, index) => {\n              return (\n                <TagListItem\n                  key={index}\n                  item={repoTag}\n                  repoID={this.props.repoID}\n                  onDeleteTag={this.onDeleteTag}\n                />\n              );\n            })}\n          </ul>\n          <a\n            href=\"#\"\n            className=\"add-tag-link px-4 py-2 d-flex align-items-center\"\n            onClick={this.createNewTag}\n          >\n            <span className=\"sf2-icon-plus mr-2\"></span>\n            {gettext('Create a new tag')}\n          </a>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nListTagDialog.propTypes = listTagPropTypes;\n\nexport default ListTagDialog;\n","import React, { Fragment } from 'react';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport PropTypes from 'prop-types';\nimport ModalPortal from '../modal-portal';\nimport { Modal } from 'reactstrap';\nimport ListTagDialog from '../dialog/list-tag-dialog';\nimport CreateTagDialog from '../dialog/create-tag-dialog';\nimport ListTaggedFilesDialog from '../dialog/list-taggedfiles-dialog';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  userPerm: PropTypes.string,\n  currentPath: PropTypes.string.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass DirTool extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isRepoTagDialogShow: false,\n      currentTag: null,\n      isListRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false,\n    };\n  }\n\n  onShowListRepoTag = (e) => {\n    e.preventDefault();\n    this.setState({\n      isRepoTagDialogShow: true,\n      isListRepoTagShow: true,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false\n    });\n  }\n\n  onCloseRepoTagDialog = () => {\n    this.setState({\n      isRepoTagDialogShow: false,\n      isListRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false\n    });\n  }\n\n  onCreateRepoTagToggle = () => {\n    this.setState({\n      isCreateRepoTagShow: !this.state.isCreateRepoTagShow,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n    });\n  }\n\n  onListTaggedFileToggle = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n      isListTaggedFileShow: !this.state.isListTaggedFileShow,\n    });\n  }\n\n  isMarkdownFile(filePath) {\n    let name = Utils.getFileName(filePath);\n    return name.indexOf('.md') > -1 ? true : false;\n  }\n\n  render() {\n    let { repoID, userPerm, currentPath } = this.props;\n    let isFile = this.isMarkdownFile(currentPath);\n    let name = Utils.getFileName(currentPath);\n    let trashUrl = siteRoot + 'repo/' + repoID + '/trash/';\n    let historyUrl = siteRoot + 'repo/history/' + repoID + '/';\n    if (userPerm === 'rw') {\n      if (!isFile) {\n        if (name) { // name not '' is not root path\n          trashUrl = siteRoot + 'repo/' + repoID + '/trash/?path=' + encodeURIComponent(currentPath);\n          return (\n            <ul className=\"path-toolbar\">\n              <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a></li>\n            </ul>\n          );\n        } else { // currentPath === '/' is root path\n          return (\n            <Fragment>\n              <ul className=\"path-toolbar\">\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-tag\" href=\"#\" role=\"button\" onClick={this.onShowListRepoTag} title={gettext('Tags')} aria-label={gettext('Tags')}></a></li>\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a></li>\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-history\" href={historyUrl} title={gettext('History')} aria-label={gettext('History')}></a></li>\n              </ul>\n\n              {this.state.isRepoTagDialogShow && (\n                <ModalPortal>\n                  <Modal isOpen={true}>\n                    {this.state.isListRepoTagShow && (\n                      <ListTagDialog\n                        repoID={repoID}\n                        onListTagCancel={this.onCloseRepoTagDialog}\n                        onCreateRepoTag={this.onCreateRepoTagToggle}\n                      />\n                    )}\n                    {this.state.isCreateRepoTagShow && (\n                      <CreateTagDialog\n                        repoID={repoID}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onCreateRepoTagToggle}\n                      />\n                    )}\n                    {this.state.isListTaggedFileShow && (\n                      <ListTaggedFilesDialog\n                        repoID={this.props.repoID}\n                        currentTag={this.state.currentTag}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onListTaggedFileToggle}\n                        updateUsedRepoTags={this.props.updateUsedRepoTags}\n                      />\n                    )}\n                  </Modal>\n                </ModalPortal>\n              )}\n            </Fragment>\n          );\n        }\n      }\n    }\n    return '';\n  }\n}\n\nDirTool.propTypes = propTypes;\n\nexport default DirTool;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport DirPath from './dir-path';\nimport DirTool from './dir-tool';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  userPerm: PropTypes.string,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func,\n  pathPrefix: PropTypes.array,\n  isViewFile: PropTypes.bool,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass CurDirPath extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSortOptionsDialogOpen: false\n    };\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    return (\n      <Fragment>\n        <DirPath\n          repoName={this.props.repoName}\n          pathPrefix={this.props.pathPrefix}\n          currentPath={this.props.currentPath}\n          onPathClick={this.props.onPathClick}\n          onTabNavClick={this.props.onTabNavClick}\n          repoID={this.props.repoID}\n          isViewFile={this.props.isViewFile}\n          fileTags={this.props.fileTags}\n        />\n        {isDesktop &&\n        <DirTool\n          repoID={this.props.repoID}\n          repoName={this.props.repoName}\n          userPerm={this.props.userPerm}\n          currentPath={this.props.currentPath}\n          updateUsedRepoTags={this.props.updateUsedRepoTags}\n          onDeleteRepoTag={this.props.onDeleteRepoTag}\n        />}\n        {!isDesktop && this.props.direntList.length > 0 &&\n        <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.props.sortBy}\n          sortOrder={this.props.sortOrder}\n          sortItems={this.props.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nCurDirPath.propTypes = propTypes;\n\nexport default CurDirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { processor } from '@seafile/seafile-editor';\nimport { Button, Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { gettext, username, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport ParticipantsList from '../file-view/participants-list';\nimport { MentionsInput, Mention } from 'react-mentions';\nimport { defaultStyle, defaultMentionStyle } from '../../css/react-mentions-default-style';\nimport '../../css/comments-list.css';\n\nconst DetailCommentListPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  onParticipantsChange: PropTypes.func.isRequired,\n  fileParticipantList: PropTypes.array.isRequired,\n};\n\nclass DetailCommentList extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      commentsList: [],\n      relatedUsers: null,\n      comment: '',\n    };\n    this.toBeAddedParticipant = [];\n  }\n\n  componentDidMount() {\n    this.listComments();\n    this.checkParticipant();\n    this.listRepoRelatedUsers();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.filePath !== this.props.filePath) {\n      this.listComments(nextProps.filePath);\n    }\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ comment: event.target.value });\n  }\n\n  listComments = (filePath) => {\n    seafileAPI.listComments(this.props.repoID, (filePath || this.props.filePath)).then((res) => {\n      this.setState({ commentsList: res.data.comments });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  addComment = () => {\n    const { repoID, filePath } = this.props;\n    if (!this.state.comment.trim()) return;\n    seafileAPI.postComment(repoID, filePath, this.state.comment.trim()).then(() => {\n      this.listComments();\n    }).catch(err => {\n      toaster.danger(Utils.getErrorMsg(err));\n    });\n    this.setState({ comment: '' });\n  }\n\n  onSubmit = () => {\n    this.addParticipant(username);\n    if (this.toBeAddedParticipant.length === 0) {\n      this.addComment();\n    } else {\n      const { repoID, filePath } = this.props;\n      seafileAPI.addFileParticipants(repoID, filePath, this.toBeAddedParticipant).then((res) => {\n        this.props.onParticipantsChange(repoID, filePath);\n        this.toBeAddedParticipant = [];\n        this.addComment();\n      }).catch((err) => {\n        toaster.danger(Utils.getErrorMsg(err));\n      });\n    }\n  }\n\n  resolveComment = (event) => {\n    const { repoID } = this.props;\n    seafileAPI.updateComment(repoID, event.target.id, 'true').then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteComment = (event) => {\n    const { repoID } = this.props;\n    seafileAPI.deleteComment(repoID, event.target.id).then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  editComment = (commentID, newComment) => {\n    const { repoID } = this.props;\n    seafileAPI.updateComment(repoID, commentID, null, null, newComment).then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  listRepoRelatedUsers = () => {\n    const { repoID } = this.props;\n    seafileAPI.listRepoRelatedUsers(repoID).then((res) => {\n      let users = res.data.user_list.map((item) => {\n        return { id: item.email, display: item.name};\n      });\n      this.setState({ relatedUsers: users });\n    });\n  }\n\n  checkParticipant = (email) => {\n    return this.props.fileParticipantList.map((participant) => {return participant.email;}).includes(email);\n  }\n\n  addParticipant = (email) => {\n    if (this.checkParticipant(email)) return;\n    this.toBeAddedParticipant.push(email);\n  }\n\n  renderUserSuggestion = (entry, search, highlightedDisplay, index, focused) => {\n    return <div className={`user ${focused ? 'focused' : ''}`}>{highlightedDisplay}</div>;\n  }\n\n  render() {\n    const { repoID, filePath, fileParticipantList } = this.props;\n    const { commentsList } = this.state;\n    return (\n      <div className=\"seafile-comment detail-comments h-100\">\n        <div className=\"flex-fill o-auto\">\n          {commentsList.length > 0 ? (\n            <ul className=\"seafile-comment-list\">\n              {commentsList.map((item, index = 0, arr) => {\n                let oldTime = (new Date(item.created_at)).getTime();\n                let time = moment(oldTime).format('YYYY-MM-DD HH:mm');\n                return (\n                  <CommentItem\n                    key={item.id}\n                    item={item}\n                    time={time}\n                    deleteComment={this.deleteComment}\n                    resolveComment={this.resolveComment}\n                    editComment={this.editComment}\n                  />\n                );\n              })\n              }\n            </ul>) :\n            <p className=\"text-center my-4\">{gettext('No comment yet.')}</p>\n          }\n        </div>\n        <div className=\"seafile-comment-footer flex-shrink-0\">\n          {fileParticipantList &&\n            <ParticipantsList\n              onParticipantsChange={this.props.onParticipantsChange}\n              participants={fileParticipantList}\n              repoID={repoID}\n              filePath={filePath}\n              showIconTip={true}\n            />\n          }\n          <MentionsInput\n            value={this.state.comment}\n            onChange={this.handleCommentChange}\n            placeholder={gettext('Add a comment...')}\n            style={defaultStyle}\n          >\n            <Mention\n              trigger=\"@\"\n              displayTransform={(username, display) => `@${display}`}\n              data={this.state.relatedUsers}\n              renderSuggestion={this.renderUserSuggestion}\n              style={defaultMentionStyle}\n              onAdd={(id, display) => {this.addParticipant(id);}}\n              appendSpaceOnAdd={true}\n            />\n          </MentionsInput>\n          <div className=\"comment-submit-container\">\n            <Button className=\"submit-comment\" color=\"primary\" size=\"sm\" onClick={this.onSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nDetailCommentList.propTypes = DetailCommentListPropTypes;\n\nconst commentItemPropTypes = {\n  time: PropTypes.string.isRequired,\n  item: PropTypes.object.isRequired,\n  deleteComment: PropTypes.func.isRequired,\n  resolveComment: PropTypes.func.isRequired,\n  editComment: PropTypes.func.isRequired,\n};\n\nclass CommentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      dropdownOpen: false,\n      html: '',\n      newComment: this.props.item.comment,\n      editable: false,\n    };\n  }\n\n  componentWillMount() {\n    this.convertComment(this.props.item.comment);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.convertComment(nextProps.item.comment);\n  }\n\n  convertComment = (mdFile) => {\n    processor.process(mdFile).then((result) => {\n      let html = String(result);\n      this.setState({ html: html });\n    });\n  }\n\n  toggleDropDownMenu = () => {\n    this.setState({ dropdownOpen: !this.state.dropdownOpen });\n  }\n\n  toggleEditComment = () => {\n    this.setState({ editable: !this.state.editable });\n  }\n\n  updateComment = (event) => {\n    const newComment = this.state.newComment;\n    if (this.props.item.comment !== newComment) {\n      this.props.editComment(event.target.id, newComment);\n    }\n    this.toggleEditComment();\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ newComment: event.target.value });\n  }\n\n  onCommentClick = (e) => {\n    // click participant link, page shouldn't jump\n    if (e.target.nodeName !== 'A') return;\n    const preNode = e.target.previousSibling;\n    if (preNode && preNode.nodeType === 3 && preNode.nodeValue.slice(-1) === '@') {\n      e.preventDefault();\n    }\n  }\n\n  renderInfo = (item) => {\n    return (\n      <Fragment>\n        <img className=\"avatar\" src={item.avatar_url} alt=\"\"/>\n        <div className=\"reviewer-info\">\n          <div className=\"reviewer-name ellipsis\">{item.user_name}</div>\n          <div className=\"review-time\">{this.props.time}</div>\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const item = this.props.item;\n    if (this.state.editable) {\n      return(\n        <li className=\"seafile-comment-item\" id={item.id}>\n          <div className=\"seafile-comment-info\">\n            {this.renderInfo(item)}\n          </div>\n          <div className=\"seafile-edit-comment\">\n            <textarea className=\"edit-comment-input\" value={this.state.newComment}\n              onChange={this.handleCommentChange} clos=\"100\" rows=\"3\" warp=\"virtual\"\n            ></textarea>\n            <Button className=\"comment-btn\" color=\"primary\" size=\"sm\" onClick={this.updateComment} id={item.id}>{gettext('Update')}</Button>{' '}\n            <Button className=\"comment-btn\" color=\"secondary\" size=\"sm\" onClick={this.toggleEditComment}> {gettext('Cancel')}</Button>\n          </div>\n        </li>\n      );\n    }\n    return (\n      <li className={item.resolved ? 'seafile-comment-item seafile-comment-item-resolved' : 'seafile-comment-item'} id={item.id}>\n        <div className=\"seafile-comment-info\">\n          {this.renderInfo(item)}\n          <Dropdown isOpen={this.state.dropdownOpen} size=\"sm\" className=\"seafile-comment-dropdown\" toggle={this.toggleDropDownMenu}>\n            <DropdownToggle className=\"seafile-comment-dropdown-btn\"><i className=\"fas fa-ellipsis-v\"></i></DropdownToggle>\n            <DropdownMenu>\n              {item.user_email === username &&\n                <DropdownItem onClick={this.props.deleteComment} className=\"delete-comment\" id={item.id}>{gettext('Delete')}</DropdownItem>\n              }\n              {item.user_email === username &&\n                <DropdownItem onClick={this.toggleEditComment} className=\"edit-comment\" id={item.id}>{gettext('Edit')}</DropdownItem>\n              }\n              {!item.resolved &&\n                <DropdownItem onClick={this.props.resolveComment} className=\"seafile-comment-resolved\"\n                  id={item.id}>{gettext('Mark as resolved')}</DropdownItem>\n              }\n            </DropdownMenu>\n          </Dropdown>\n        </div>\n        <div\n          className=\"seafile-comment-content\"\n          dangerouslySetInnerHTML={{ __html: this.state.html }}\n          onClick={e => this.onCommentClick(e)}\n        ></div>\n      </li>\n    );\n  }\n}\n\nCommentItem.propTypes = commentItemPropTypes;\n\nexport default DetailCommentList;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport ModalPortal from '../modal-portal';\nimport ParticipantsList from '../file-view/participants-list';\n\nconst propTypes = {\n  repoInfo: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  direntType: PropTypes.string.isRequired,\n  direntDetail: PropTypes.object.isRequired,\n  path: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  onParticipantsChange: PropTypes.func.isRequired,\n  fileParticipantList: PropTypes.array.isRequired,\n};\n\nclass DetailListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditFileTagShow: false\n    };\n  }\n\n  getDirentPostion = () => {\n    let { repoInfo } = this.props;\n    let direntPath = this.getDirentPath();\n    let position = repoInfo.repo_name;\n    if (direntPath !== '/') {\n      let index = direntPath.lastIndexOf('/');\n      let path = direntPath.slice(0, index);\n      position = position + path;\n    }\n    return position;\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let direntPath = this.getDirentPath();\n    this.props.onFileTagChanged(this.props.dirent, direntPath);\n  }\n\n  getDirentPath = () => {\n    if (Utils.isMarkdownFile(this.props.path)) {\n      return this.props.path; // column mode: view file\n    }\n    let { dirent, path } = this.props;\n    return Utils.joinPath(path, dirent.name);\n  }\n\n  render() {\n    let { direntType, direntDetail, fileTagList, fileParticipantList } = this.props;\n    let position = this.getDirentPostion();\n    let direntPath = this.getDirentPath();\n    if (direntType === 'dir') {\n      return (\n        <table className=\"table-thead-hidden\">\n          <thead>\n            <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n          </thead>\n          <tbody>\n            <tr><th>{gettext('Location')}</th><td>{position}</td></tr>\n            <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.mtime).format('YYYY-MM-DD')}</td></tr>\n          </tbody>\n        </table>\n      );\n    } else {\n      return (\n        <Fragment>\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n            </thead>\n            <tbody>\n              <tr><th>{gettext('Size')}</th><td>{Utils.bytesToSize(direntDetail.size)}</td></tr>\n              <tr><th>{gettext('Location')}</th><td>{position}</td></tr>\n              <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.last_modified).fromNow()}</td></tr>\n              <tr className=\"file-tag-container\">\n                <th>{gettext('Tags')}</th>\n                <td>\n                  <ul className=\"file-tag-list\">\n                    {fileTagList.map((fileTag) => {\n                      return (\n                        <li key={fileTag.id} className=\"file-tag-item\">\n                          <span className=\"file-tag\" style={{backgroundColor:fileTag.color}}></span>\n                          <span className=\"tag-name\" title={fileTag.name}>{fileTag.name}</span>\n                        </li>\n                      );\n                    })}\n                  </ul>\n                  <i className='fa fa-pencil-alt attr-action-icon' onClick={this.onEditFileTagToggle}></i>\n                </td>\n              </tr>\n              <tr className=\"file-participants\">\n                <th>{gettext('Participants')}</th>\n                <td>\n                  {fileParticipantList &&\n                    <ParticipantsList\n                      onParticipantsChange={this.props.onParticipantsChange}\n                      participants={fileParticipantList}\n                      repoID={this.props.repoID}\n                      filePath={direntPath}\n                      showIconTip={false}\n                    />\n                  }\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          {this.state.isEditFileTagShow &&\n            <ModalPortal>\n              <EditFileTagDialog\n                repoID={this.props.repoID}\n                fileTagList={fileTagList}\n                filePath={direntPath}\n                toggleCancel={this.onEditFileTagToggle}\n                onFileTagChanged={this.onFileTagChanged}\n              />\n            </ModalPortal>\n          }\n        </Fragment>\n      );\n    }\n  }\n}\n\nDetailListView.propTypes = propTypes;\n\nexport default DetailListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport { Nav, NavItem, NavLink, TabContent, TabPane } from 'reactstrap';\nimport DetailCommentList from './detail-comments-list';\nimport { siteRoot, enableVideoThumbnail } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport Dirent from '../../models/dirent';\nimport DetailListView from './detail-list-view';\n\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  path: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onItemDetailsClose: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  direntDetailPanelTab: PropTypes.string,\n};\n\nclass DirentDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      direntType: '',\n      direntDetail: '',\n      folderDirent: null,\n      activeTab: 'info',\n      fileParticipantList: [],\n    };\n  }\n\n  componentWillMount() {\n    if (this.props.direntDetailPanelTab) {\n      this.tabItemClick(this.props.direntDetailPanelTab);\n    }\n  }\n\n  componentDidMount() {\n    let { dirent, path, repoID } = this.props;\n    this.loadDirentInfo(dirent, path, repoID);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { dirent, path, repoID } = nextProps;\n    if (this.props.dirent !== nextProps.dirent) {\n      this.loadDirentInfo(dirent, path, repoID);\n    }\n    if (this.props.direntDetailPanelTab) {\n      this.tabItemClick(this.props.direntDetailPanelTab);\n    }\n  }\n\n  loadDirentInfo = (dirent, path, repoID) => {\n    if (dirent) {\n      let direntPath = Utils.joinPath(path, dirent.name);\n      this.updateDetailView(dirent, direntPath);\n    } else {\n      let dirPath = Utils.getDirName(path);\n      seafileAPI.listDir(repoID, dirPath).then(res => {\n        let direntList = res.data.dirent_list;\n        let folderDirent = null;\n        for (let i = 0; i < direntList.length; i++) {\n          let dirent = direntList[i];\n          if (dirent.parent_dir + dirent.name === path) {\n            folderDirent = new Dirent(dirent);\n            break;\n          }\n        }\n        this.setState({folderDirent: folderDirent});\n        this.updateDetailView(folderDirent, path);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  updateDetailView = (dirent, direntPath) => {\n    let repoID = this.props.repoID;\n    if (dirent.type === 'file') {\n      seafileAPI.getFileInfo(repoID, direntPath).then(res => {\n        this.setState({\n          direntType: 'file',\n          direntDetail: res.data,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n      this.listParticipants(repoID, direntPath);\n    } else {\n      seafileAPI.getDirInfo(repoID, direntPath).then(res => {\n        this.setState({\n          direntType: 'dir',\n          direntDetail: res.data\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  listParticipants = (repoID, filePath) => {\n    seafileAPI.listFileParticipants(repoID, filePath).then((res) => {\n      this.setState({ fileParticipantList: res.data.participant_list });\n    });\n  }\n\n  onParticipantsChange = (repoID, filePath) => {\n    this.listParticipants(repoID, filePath);\n  }\n\n  tabItemClick = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({ activeTab: tab });\n    }\n  }\n\n  renderNavItem = (showTab) => {\n    switch(showTab) {\n      case 'info':\n        return (\n          <NavItem className=\"nav-item w-50\">\n            <NavLink className={classnames({ active: this.state.activeTab === 'info' })} onClick={() => { this.tabItemClick('info');}}>\n              <i className=\"fas fa-info-circle\"></i>\n            </NavLink>\n          </NavItem>\n        );\n      case 'comments':\n        return (\n          <NavItem className=\"nav-item w-50\">\n            <NavLink className={classnames({ active: this.state.activeTab === 'comments' })} onClick={() => {this.tabItemClick('comments');}}>\n              <i className=\"fa fa-comments\"></i>\n            </NavLink>\n          </NavItem>\n        );\n    }\n  }\n\n  renderHeader = (smallIconUrl, direntName) => {\n    return (\n      <div className=\"detail-header\">\n        <div className=\"detail-control sf2-icon-x1\" onClick={this.props.onItemDetailsClose}></div>\n        <div className=\"detail-title dirent-title\">\n          <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{' '}\n          <span className=\"name ellipsis\" title={direntName}>{direntName}</span>\n        </div>\n      </div>\n    );\n  }\n\n  renderDetailBody = (bigIconUrl, folderDirent) => {\n    const { dirent } = this.props;\n    return (\n      <Fragment>\n        <div className=\"detail-body dirent-info\">\n          <div className=\"img\"><img src={bigIconUrl} className=\"thumbnail\" alt=\"\" /></div>\n          {this.state.direntDetail &&\n            <div className=\"dirent-table-container\">\n              <DetailListView\n                repoInfo={this.props.currentRepoInfo}\n                path={this.props.path}\n                repoID={this.props.repoID}\n                dirent={this.props.dirent || folderDirent}\n                direntType={this.state.direntType}\n                direntDetail={this.state.direntDetail}\n                fileTagList={dirent ? dirent.file_tags : []}\n                onFileTagChanged={this.props.onFileTagChanged}\n                fileParticipantList={this.state.fileParticipantList}\n                onParticipantsChange={this.onParticipantsChange}\n              />\n            </div>\n          }\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { dirent, repoID, path } = this.props;\n    let { folderDirent } = this.state;\n    if (!dirent && !folderDirent) {\n      return '';\n    }\n    let smallIconUrl = dirent ? Utils.getDirentIcon(dirent) : Utils.getDirentIcon(folderDirent);\n    let bigIconUrl = dirent ? Utils.getDirentIcon(dirent, true) : Utils.getDirentIcon(folderDirent, true);\n    const isImg = dirent ? Utils.imageCheck(dirent.name) : Utils.imageCheck(folderDirent.name);\n    const isVideo = dirent ? Utils.videoCheck(dirent.name) : Utils.videoCheck(folderDirent.name);\n    if (isImg || (enableVideoThumbnail && isVideo)) {\n      bigIconUrl = `${siteRoot}thumbnail/${repoID}/1024` + Utils.encodePath(`${path === '/' ? '' : path}/${dirent.name}`);\n    }\n    let direntName = dirent ? dirent.name : folderDirent.name;\n\n    if ((dirent && dirent.type === 'file') || path.lastIndexOf('.') > -1) {\n      return (\n        <div className=\"detail-container\">\n          {this.renderHeader(smallIconUrl, direntName)}\n          <Nav tabs className=\"mx-0\">{this.renderNavItem('info')}{this.renderNavItem('comments')}</Nav>\n          <TabContent activeTab={this.state.activeTab} className=\"flex-fill o-auto\">\n            <TabPane tabId=\"info\">{this.renderDetailBody(bigIconUrl, folderDirent)}</TabPane>\n            <TabPane tabId=\"comments\" className=\"comments h-100\">\n              <DetailCommentList\n                repoID={this.props.repoID}\n                filePath={(dirent && dirent.type === 'file') ? Utils.joinPath(path, dirent.name) : path}\n                fileParticipantList={this.state.fileParticipantList}\n                onParticipantsChange={this.onParticipantsChange}\n              />\n            </TabPane>\n          </TabContent>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"detail-container\">\n          {this.renderHeader(smallIconUrl, direntName)}\n          {this.renderDetailBody(bigIconUrl, folderDirent)}\n        </div>\n      );\n    }\n  }\n}\n\nDirentDetail.propTypes = propTypes;\n\nexport default DirentDetail;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport Loading from '../loading';\nimport ModalPortal from '../modal-portal';\nimport CreateFile from '../../components/dialog/create-file-dialog';\n\nimport '../../css/tip-for-new-file.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n};\n\nclass DirentNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: '',\n      isCreateFileDialogShow: false,\n    };\n  }\n\n  onCreateNewFile = (type) => {\n    this.setState({\n      fileType: type,\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      fileType: '',\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  checkDuplicatedName = () => {\n    return false; // current repo is null, and unnecessary to check duplicated name\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  render() {\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    return (\n      <Fragment>\n        <div className=\"tip-for-new-file text-center\">\n          <p className=\"text-secondary\">{gettext('This folder has no content at this time.')}</p>\n          <p className=\"text-secondary\">{gettext('You can create files quickly')}{' +'}</p>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.md')}>\n            {'+ Markdown'}</button>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.pptx')}>\n            {'+ PPT'}</button>\n          <br />\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.docx')}>\n            {'+ Word'}</button>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.xlsx')}>\n            {'+ Excel'}</button>\n        </div>\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              fileType={this.state.fileType}\n              onAddFile={this.onAddFile}\n              addFileCancel={this.onCreateFileToggle}\n              checkDuplicatedName={this.checkDuplicatedName}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirentNodeView.propTypes = propTypes;\n\nexport default DirentNodeView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MD5 from 'MD5';\nimport moment from 'moment';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl, username, useGoFileserver, fileServerRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport Rename from '../rename';\nimport ModalPortal from '../modal-portal';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\n\nimport '../../css/dirent-list-item.css';\nimport toaster from '../toast';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onItemRenameToggle: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  showImagePopup: PropTypes.func.isRequired,\n  currentRepoInfo: PropTypes.object,\n  isRepoOwner: PropTypes.bool,\n  isAdmin: PropTypes.bool.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  onItemMouseDown: PropTypes.func.isRequired,\n  onItemContextMenu: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  activeDirent: PropTypes.object,\n  getDirentItemMenuList: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onShowDirentsDraggablePreview: PropTypes.func,\n};\n\nclass DirentListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false,\n      highlight: false,\n      isZipDialogOpen: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isShareDialogShow: false,\n      isMutipleOperation: false,\n      isShowTagTooltip: false,\n      isDragTipShow: false,\n      isDropTipshow: false,\n      isEditFileTagShow: false,\n      isPermissionDialogOpen: false,\n      isOpMenuOpen: false // for mobile\n    };\n\n    const { dirent } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(dirent.permission);\n    this.isCustomPermission = isCustomPermission;\n    this.customPermission = customPermission;\n    this.canPreview = true;\n    this.canDrag = dirent.permission === 'rw';\n    if (isCustomPermission) {\n      const { preview, modify } = customPermission.permission;\n      this.canPreview = preview || modify;\n      this.canDrag = modify;\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.isItemFreezed !== this.props.isItemFreezed && !nextProps.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      }, () => {\n        if (nextProps.activeDirent && nextProps.activeDirent.name === nextProps.dirent.name) {\n          this.setState({isOperationShow: true});\n        }\n      });\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  //UI Interactive\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n    if (this.canDrag) {\n      this.setState({isDragTipShow: true});\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n    if (this.canDrag) {\n      this.setState({isDragTipShow: true});\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      });\n    }\n    this.setState({isDragTipShow: false});\n  }\n\n  unfreezeItem = () => {\n    this.setState({\n      highlight: false,\n      isOperationShow: false,\n    });\n    this.props.unfreezeItem();\n  }\n\n  //buiness handler\n  onItemSelected = () => {\n    this.props.onItemSelected(this.props.dirent);\n  }\n\n  onItemStarred = (e) => {\n    let dirent = this.props.dirent;\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(dirent);\n\n    e.preventDefault();\n\n    if (dirent.starred) {\n      seafileAPI.unstarItem(repoID, filePath).then(() => {\n        this.props.updateDirent(this.props.dirent, 'starred', false);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(repoID, filePath).then(() => {\n        this.props.updateDirent(this.props.dirent, 'starred', true);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  // on '<tr>'\n  onDirentClick = (e) => {\n    // '<td>' is clicked\n    e.stopPropagation();\n    if (e.target.tagName == 'TD') {\n      this.props.onDirentClick(this.props.dirent);\n    }\n  }\n\n  onItemClick = (e) => {\n    e.preventDefault();\n    const dirent = this.props.dirent;\n    if (this.state.isRenameing) {\n      return;\n    }\n\n    if (dirent.isDir()) {\n      this.props.onItemClick(dirent);\n      return;\n    }\n\n    if (!this.canPreview) {\n      return;\n    }\n\n    if (Utils.imageCheck(dirent.name)) {\n      this.props.showImagePopup(dirent);\n    } else {\n      this.props.onItemClick(dirent);\n    }\n  }\n\n  onItemDelete = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.props.onItemDelete(this.props.dirent);\n  }\n\n  onItemShare = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  closeSharedDialog = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onMobileMenuItemClick = (e) => {\n    const operation = e.target.getAttribute('data-op');\n    this.onMenuItemClick(operation, e);\n  }\n\n  onMenuItemClick = (operation, event) => {\n    switch(operation) {\n      case 'Download':\n        this.onItemDownload(event);\n        break;\n      case 'Share':\n        this.onItemShare(event);\n        break;\n      case 'Delete':\n        this.onItemDelete(event);\n        break;\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Move':\n        this.onItemMoveToggle();\n        break;\n      case 'Copy':\n        this.onItemCopyToggle();\n        break;\n      case 'Tags':\n        this.onEditFileTagToggle();\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Unlock':\n        this.onUnlockItem();\n        break;\n      case 'Lock':\n        this.onLockItem();\n        break;\n      case 'Comment':\n        this.props.onDirentClick(this.props.dirent);\n        this.props.showDirentDetail('comments');\n        break;\n      case 'History':\n        this.onHistory();\n        break;\n      case 'Access Log':\n        this.onAccessLog();\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient();\n        break;\n      case 'Convert with ONLYOFFICE':\n        this.onConvertWithONLYOFFICE();\n        break;\n      default:\n        break;\n    }\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let direntPath = this.getDirentPath(this.props.dirent);\n    this.props.onFileTagChanged(this.props.dirent, direntPath);\n  }\n\n  onItemRenameToggle = () => {\n    this.props.onItemRenameToggle(this.props.dirent);\n    this.setState({\n      isOperationShow: false,\n      isRenameing: true,\n    });\n  }\n\n  onRenameConfirm = (newName) => {\n    this.props.onItemRename(this.props.dirent, newName);\n    this.onRenameCancel();\n  }\n\n  onRenameCancel = () => {\n    this.setState({isRenameing: false});\n    this.unfreezeItem();\n  }\n\n  onItemMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onItemCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onPermissionItem = () => {\n    this.setState({isPermissionDialogOpen: !this.state.isPermissionDialogOpen});\n  }\n\n  onLockItem = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.lockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(this.props.dirent, 'is_locked', true);\n      this.props.updateDirent(this.props.dirent, 'locked_by_me', true);\n      let lockName = username.split('@');\n      this.props.updateDirent(this.props.dirent, 'lock_owner_name', lockName[0]);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnlockItem = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.unlockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(this.props.dirent, 'is_locked', false);\n      this.props.updateDirent(this.props.dirent, 'locked_by_me', false);\n      this.props.updateDirent(this.props.dirent, 'lock_owner_name', '');\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onHistory = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    let url = URLDecorator.getUrl({type: 'file_revisions', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onAccessLog = () => {\n    let filePath = this.getDirentPath(this.props.dirent);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  onOpenViaClient = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    let url = URLDecorator.getUrl({type: 'open_via_client', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onConvertWithONLYOFFICE = ()=> {\n\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent)\n\n    seafileAPI.onlyofficeConvert(repoID, filePath).then(res => {\n      this.props.loadDirentList(res.data.parent_dir)\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemDownload = (e) => {\n    e.preventDefault();\n    e.nativeEvent.stopImmediatePropagation();\n    let dirent = this.props.dirent;\n    let repoID = this.props.repoID;\n    let direntPath = this.getDirentPath(dirent);\n    if (dirent.type === 'dir') {\n      if (!useGoFileserver) {\n        this.setState({\n          isZipDialogOpen: true\n        });\n      } else {\n        seafileAPI.zipDownload(repoID, this.props.path, this.props.dirent.name).then((res) => {\n          const zipToken = res.data['zip_token'];\n          location.href = `${fileServerRoot}zip/${zipToken}`;\n        }).catch((error) => {\n          let errorMsg = Utils.getErrorMsg(error);\n          this.setState({\n            isLoading: false,\n            errorMsg: errorMsg\n          });\n        });\n      }\n    } else {\n      let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n      location.href = url;\n    }\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  getDirentPath = (dirent) => {\n    let path = this.props.path;\n    return path === '/' ? path + dirent.name : path + '/' + dirent.name;\n  }\n\n  onTagTooltipToggle = (e) => {\n    e.stopPropagation();\n    this.setState({isShowTagTooltip: !this.state.isShowTagTooltip});\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  onItemDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    e.dataTransfer.effectAllowed = 'move';\n    let { selectedDirentList } = this.props;\n    if (selectedDirentList.length > 0 && selectedDirentList.includes(this.props.dirent)) { // drag items and selectedDirentList include item\n      this.props.onShowDirentsDraggablePreview();\n      e.dataTransfer.setDragImage(this.refs.empty_content, 0, 0); // Show an empty content\n      let selectedList =  selectedDirentList.map(item => {\n        let nodeRootPath = this.getDirentPath(item);\n        let dragStartItemData = {nodeDirent: item, nodeParentPath: this.props.path, nodeRootPath: nodeRootPath};\n        return dragStartItemData;\n      });\n      selectedList = JSON.stringify(selectedList);\n      e.dataTransfer.setData('applicaiton/drag-item-info', selectedList);\n      return ;\n    }\n\n    if (e.dataTransfer && e.dataTransfer.setDragImage) {\n      e.dataTransfer.setDragImage(this.refs.drag_icon, 15, 15);\n    }\n\n    let nodeRootPath = this.getDirentPath(this.props.dirent);\n    let dragStartItemData = {nodeDirent: this.props.dirent, nodeParentPath: this.props.path, nodeRootPath: nodeRootPath};\n    dragStartItemData = JSON.stringify(dragStartItemData);\n\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartItemData);\n  }\n\n  onItemDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n      this.setState({isDropTipshow: true});\n    }\n  }\n\n  onItemDragOver = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (e.dataTransfer.dropEffect === 'copy') {\n      return;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onItemDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n    }\n    this.setState({isDropTipshow: false});\n  }\n\n  onItemDragDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isDropTipshow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n    } else {\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n    if (Array.isArray(dragStartItemData)) { //move items\n      let direntPaths =  dragStartItemData.map(draggedItem => {\n        return draggedItem.nodeRootPath;\n      });\n\n      let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n\n      if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) { //eg; A/B, A/C --> A/B\n        return;\n      }\n\n      this.props.onItemsMove(this.props.currentRepoInfo, selectedPath);\n      return ;\n    }\n\n    let { nodeDirent, nodeParentPath, nodeRootPath } = dragStartItemData;\n    let dropItemData = this.props.dirent;\n\n    if (nodeDirent.name === dropItemData.name) {\n      return;\n    }\n\n    //  copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropItemData.type === 'dir' && nodeDirent.type === 'dir') {\n      if (nodeParentPath !== this.props.path) {\n        if (this.props.path.indexOf(nodeRootPath) !== -1) {\n          return;\n        }\n      }\n    }\n\n    let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, selectedPath, nodeParentPath);\n  }\n\n  onItemMouseDown = (event) => {\n    this.props.onItemMouseDown(event);\n  }\n\n  onItemContextMenu = (event) => {\n    let dirent = this.props.dirent;\n    this.props.onItemContextMenu(event, dirent);\n  }\n\n  renderItemOperation = () => {\n    let { dirent, currentRepoInfo, selectedDirentList } = this.props;\n    let canDownload = true;\n    let canDelete = true;\n    const { isCustomPermission, customPermission } = this;\n    if (isCustomPermission) {\n      const { permission } = customPermission;\n      canDownload = permission.download;\n      canDelete = permission.delete;\n    }\n\n    // https://dev.seafile.com/seahub/lib/d6f300e7-bb2b-4722-b83e-cf45e370bfbc/file/seaf-server%20%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/%E6%9D%83%E9%99%90%E7%9B%B8%E5%85%B3/%E8%B5%84%E6%96%99%E5%BA%93%E6%9D%83%E9%99%90%E8%A7%84%E8%8C%83.md\n    let showShareBtn = Utils.isHasPermissionToShare(currentRepoInfo, dirent.permission, dirent);\n\n    return (\n      <Fragment>\n        {selectedDirentList.length > 1 ?\n          <Fragment>\n            {this.state.isOperationShow && !dirent.isSelected &&\n              <div className=\"operations\">\n                {(dirent.permission === 'rw' || dirent.permission === 'r' || (isCustomPermission && canDownload)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} role=\"button\" aria-label={gettext('Download')} onClick={this.onItemDownload}></a>\n                )}\n                {showShareBtn && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onItemShare}></a>\n                )}\n                {(dirent.permission === 'rw' || (isCustomPermission && canDelete)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onItemDelete}></a>\n                )}\n                <ItemDropdownMenu\n                  item={this.props.dirent}\n                  toggleClass={'sf2-icon-caret-down'}\n                  isHandleContextMenuEvent={true}\n                  getMenuList={this.props.getDirentItemMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  unfreezeItem={this.unfreezeItem}\n                  freezeItem={this.props.freezeItem}\n                />\n              </div>\n            }\n          </Fragment> :\n          <Fragment>\n            {this.state.isOperationShow &&\n              <div className=\"operations\">\n                {(dirent.permission === 'rw' || dirent.permission === 'r' || (isCustomPermission && canDownload)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} role=\"button\" aria-label={gettext('Download')} onClick={this.onItemDownload}></a>\n                )}\n                {showShareBtn && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} role=\"button\" aria-label={gettext('Share')} onClick={this.onItemShare}></a>\n                )}\n                {(dirent.permission === 'rw' || (isCustomPermission && canDelete)) && (\n                  <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} role=\"button\" aria-label={gettext('Delete')} onClick={this.onItemDelete}></a>\n                )}\n                <ItemDropdownMenu\n                  item={this.props.dirent}\n                  toggleClass={'sf2-icon-caret-down'}\n                  isHandleContextMenuEvent={true}\n                  getMenuList={this.props.getDirentItemMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  unfreezeItem={this.unfreezeItem}\n                  freezeItem={this.props.freezeItem}\n                />\n              </div>\n            }\n          </Fragment>\n        }\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { path, dirent, activeDirent } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    let dirHref = '';\n    if (this.props.currentRepoInfo) {\n      dirHref = siteRoot + 'library/' + this.props.repoID + '/' + this.props.currentRepoInfo.repo_name + Utils.encodePath(direntPath);\n    }\n    let fileHref = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(direntPath);\n\n    let toolTipID = '';\n    let tagTitle = '';\n    if (dirent.file_tags && dirent.file_tags.length > 0) {\n      toolTipID = MD5(dirent.name).slice(0, 7);\n      tagTitle = dirent.file_tags.map(item => item.name).join(' ');\n    }\n\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    let trClass = this.state.highlight ? 'tr-highlight ' : '';\n    trClass += this.state.isDropTipshow ? 'tr-drop-effect' : '';\n    trClass += (activeDirent && activeDirent.name === dirent.name)  ? 'tr-active' : '';\n    trClass += dirent.isSelected? 'tr-active' : '';\n\n    let lockedInfo = gettext('locked by {name}').replace('{name}', dirent.lock_owner_name);\n\n    const isDesktop = Utils.isDesktop();\n    const desktopItem = (\n      <tr\n        className={trClass}\n        draggable={this.canDrag}\n        onFocus={this.onMouseEnter}\n        onMouseEnter={this.onMouseEnter}\n        onMouseOver={this.onMouseOver}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onDirentClick}\n        onDragStart={this.onItemDragStart}\n        onDragEnter={this.onItemDragEnter}\n        onDragOver={this.onItemDragOver}\n        onDragLeave={this.onItemDragLeave}\n        onDrop={this.onItemDragDrop}\n        onMouseDown={this.onItemMouseDown}\n        onContextMenu={this.onItemContextMenu}\n      >\n        <td className={`pl10 ${this.state.isDragTipShow ? 'tr-drag-effect' : ''}`}>\n          <input type=\"checkbox\" className=\"vam\" onChange={this.onItemSelected} checked={dirent.isSelected}/>\n        </td>\n        <td className=\"pl10\">\n          {dirent.starred !== undefined &&\n          <a href=\"#\" role=\"button\" aria-label={dirent.starred ? gettext('Unstar') : gettext('Star')} onClick={this.onItemStarred}>\n            <i className={`fa-star ${dirent.starred ? 'fas' : 'far star-empty'}`}></i>\n          </a>\n          }\n        </td>\n        <td className=\"pl10\">\n          <div className=\"dir-icon\">\n            {(this.canPreview && dirent.encoded_thumbnail_src) ?\n              <img ref='drag_icon' src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" onClick={this.onItemClick} alt=\"\" /> :\n              <img ref='drag_icon' src={iconUrl} width=\"24\" alt='' />\n            }\n            {dirent.is_locked && <img className=\"locked\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n            <div ref=\"empty_content\" style={{position: 'absolute', width: '1px', height: '1px'}}></div>\n          </div>\n        </td>\n        <td className=\"name\">\n          {this.state.isRenameing && <Rename hasSuffix={dirent.type !== 'dir'} name={dirent.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} />}\n          {!this.state.isRenameing && (\n            <Fragment>\n              {(!dirent.isDir() && !this.canPreview) ? \n                <a className=\"sf-link\" onClick={this.onItemClick}>{dirent.name}</a> :\n                <a href={dirent.type === 'dir' ? dirHref : fileHref} onClick={this.onItemClick}>{dirent.name}</a>\n              }\n            </Fragment>\n          )}\n        </td>\n        <td className=\"tag-list-title\">\n          {(dirent.type !== 'dir' && dirent.file_tags && dirent.file_tags.length > 0) && (\n            <Fragment>\n              <div id={`tag-list-title-${toolTipID}`} className=\"dirent-item tag-list tag-list-stacked\">\n                {dirent.file_tags.map((fileTag, index) => {\n                  let length = dirent.file_tags.length;\n                  return (\n                    <span className=\"file-tag\" key={fileTag.id} style={{zIndex:length - index, backgroundColor:fileTag.color}}></span>\n                  );\n                })}\n              </div>\n              <UncontrolledTooltip target={`tag-list-title-${toolTipID}`} placement=\"bottom\">\n                {tagTitle}\n              </UncontrolledTooltip>\n            </Fragment>\n          )}\n        </td>\n        <td className=\"operation\">{this.renderItemOperation()}</td>\n        <td className=\"file-size\">{dirent.size && dirent.size}</td>\n        <td className=\"last-update\" title={moment.unix(dirent.mtime).format('llll')}>{dirent.mtime_relative}</td>\n      </tr>\n    );\n    const mobileItem = (\n      <tr>\n        <td onClick={this.onItemClick}>\n          <div className=\"dir-icon\">\n            {(this.canPreview && dirent.encoded_thumbnail_src) ?\n              <img src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" alt=\"\" /> :\n              <img src={iconUrl} width=\"24\" alt=\"\" />\n            }\n            {dirent.is_locked && <img className=\"locked\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n          </div>\n        </td>\n        <td onClick={this.onItemClick}>\n          {this.state.isRenameing && <Rename hasSuffix={dirent.type !== 'dir'} name={dirent.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> }\n          {!this.state.isRenameing && (\n            <Fragment>\n              {(!dirent.isDir() && !this.canPreview) ?\n                <a className=\"sf-link\">{dirent.name}</a> :\n                <a href={dirent.type === 'dir' ? dirHref : fileHref}>{dirent.name}</a>\n              }\n            </Fragment>\n          )}\n          <br />\n          {dirent.size && <span className=\"item-meta-info\">{dirent.size}</span>}\n          <span className=\"item-meta-info\">{dirent.mtime_relative}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {dirent.starred !== undefined &&\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.onItemStarred}>{dirent.starred ? gettext('Unstar') : gettext('Star')}</DropdownItem>}\n                {this.props.getDirentItemMenuList(dirent, true).map((item, index) => {\n                  if (item != 'Divider' && item.key != 'Open via Client') {\n                    return (\n                      <DropdownItem className=\"mobile-menu-item\" key={index} data-op={item.key} onClick={this.onMobileMenuItemClick}>{item.value}</DropdownItem>\n                    );\n                  } else {\n                    return null;\n                  }\n                })}\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {isDesktop ? desktopItem : mobileItem}\n        {this.state.isMoveDialogShow &&\n          <ModalPortal>\n            <MoveDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              dirent={this.props.dirent}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemMove={this.props.onItemMove}\n              onCancelMove={this.onItemMoveToggle}\n              repoEncrypted={this.props.repoEncrypted}\n            />\n          </ModalPortal>\n        }\n        {this.state.isCopyDialogShow &&\n          <ModalPortal>\n            <CopyDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              dirent={this.props.dirent}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemCopy={this.props.onItemCopy}\n              onCancelCopy={this.onItemCopyToggle}\n              repoEncrypted={this.props.repoEncrypted}\n            />\n          </ModalPortal>\n        }\n        {this.state.isEditFileTagShow &&\n          <EditFileTagDialog\n            repoID={this.props.repoID}\n            fileTagList={dirent.file_tags}\n            filePath={direntPath}\n            toggleCancel={this.onEditFileTagToggle}\n            onFileTagChanged={this.onFileTagChanged}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n          <ModalPortal>\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={this.props.dirent.name}\n              toggleDialog={this.closeZipDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={dirent.type}\n              itemName={dirent.name}\n              itemPath={direntPath}\n              userPerm={dirent.permission}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.closeSharedDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isPermissionDialogOpen &&\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onPermissionItem}\n              repoID={this.props.repoID}\n              folderPath={direntPath}\n              folderName={dirent.name}\n              isDepartmentRepo={this.props.isGroupOwnedRepo}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDirentListItem.propTypes = propTypes;\n\nexport default DirentListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  selectedDirentList: PropTypes.array,\n  onHideDirentsDraggablePreview: PropTypes.func\n};\n\nclass DirentsDraggedPreview extends React.Component {\n\n  componentDidMount() {\n    document.addEventListener('dragover', this.handleDragOver);\n    document.addEventListener('drop', this.handleDrop);\n    document.addEventListener('dragend', this.handleDragEnd);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('dragover', this.handleDragOver);\n    document.removeEventListener('drop', this.handleDrop);\n    document.removeEventListener('dragend', this.handleDragEnd);\n  }\n\n  handleDragEnd = () => {\n    this.element.style.opacity = 0;\n    this.props.onHideDirentsDraggablePreview();\n  }\n\n  handleDragOver = (event) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n\n    this.element.style.top = event.clientY + 'px';\n    this.element.style.left = event.clientX + 'px';\n  }\n\n  handleDrop = (event) => {\n    this.element.style.opacity = 0;\n    this.props.onHideDirentsDraggablePreview();\n  }\n\n  render() {\n    let{ selectedDirentList } = this.props;\n    const inlineStyle = {\n      position: 'absolute',\n      opacity: 1,\n      pointerEvents: 'none',\n      display: 'block',\n      left: '-9999px',\n      top: '-9999px',\n      zIndex: 101,\n      maxHeight: document.documentElement.clientHeight,\n      overflow: 'hidden'\n    };\n    return (\n      <div style={inlineStyle} ref={element => this.element = element}>\n        {selectedDirentList.map((dirent, index) => {\n          let iconUrl = Utils.getDirentIcon(dirent);\n          return (\n            <div key={index}>\n              {dirent.encoded_thumbnail_src ?\n                <img src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" alt=\"\" /> :\n                <img src={iconUrl} width=\"24\" alt='' />\n              }\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nDirentsDraggedPreview.propTypes = propTypes;\n\nexport default DirentsDraggedPreview;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot, gettext, thumbnailSizeForOriginal, username, isPro, enableFileComment, fileAuditEnabled, folderPermEnabled, canGenerateShareLink } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport TextTranslation from '../../utils/text-translation';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport Loading from '../loading';\nimport toaster from '../toast';\nimport ModalPortal from '../modal-portal';\nimport CreateFile from '../dialog/create-file-dialog';\nimport CreateFolder from '../dialog/create-folder-dialog';\nimport ImageDialog from '../dialog/image-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport DirentListItem from './dirent-list-item';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport DirentsDraggedPreview from '../draggable/dirents-dragged-preview';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  showDirentDetail: PropTypes.func.isRequired,\n  loadDirentList: PropTypes.func.isRequired,\n};\n\nclass DirentListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isImagePopupOpen: false,\n      imageItems: [],\n      imageIndex: 0,\n      fileType: '',\n      isCreateFileDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isProgressDialogShow: false,\n      downloadItems: [],\n      isMutipleOperation: true,\n      activeDirent: null,\n      isListDropTipShow: false,\n      isShowDirentsDraggablePreview: false,\n    };\n\n    this.enteredCounter = 0; // Determine whether to enter the child element to avoid dragging bubbling bugs。\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n    this.isAdmin = props.currentRepoInfo.is_admin;\n    this.repoEncrypted = props.currentRepoInfo.encrypted;\n\n    this.clickedDirent = null;\n    this.direntItems = [];\n    this.currentItemRef = null;\n\n    this.zipToken = null;\n\n    const { userPerm } = props;\n    this.canDrop = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrop = modify;\n    }\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onItemRename = (dirent, newName) => {\n    let isDuplicated = this.props.direntList.some(item => {\n      return item.name === newName;\n    });\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      toaster.danger(errMessage);\n      return false;\n    }\n    this.props.onItemRename(dirent, newName);\n  }\n\n  onItemRenameToggle = () => {\n    this.freezeItem();\n  }\n\n  onItemSelected = (dirent) => {\n    this.setState({activeDirent: null});\n    this.props.onItemSelected(dirent);\n  }\n\n  onDirentClick = (dirent) => {\n    if (this.props.selectedDirentList.length > 0 && !this.state.activeDirent ) {\n      return;\n    }\n    this.setState({activeDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  // for image popup\n  prepareImageItem = (item) => {\n    const useThumbnail = !this.repoEncrypted;\n    const name = item.name;\n\n    const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n    const isGIF = fileExt == 'gif';\n\n    const path = Utils.encodePath(Utils.joinPath(this.props.path, name));\n    const repoID = this.props.repoID;\n    let src;\n    if (useThumbnail && !isGIF) {\n      src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n    } else {\n      src = `${siteRoot}repo/${repoID}/raw${path}`;\n    }\n\n    return {\n      'name': name,\n      'url': `${siteRoot}lib/${repoID}/file${path}`,\n      'src': src\n    };\n  }\n\n  showImagePopup = (curItem) => {\n    let items = this.props.fullDirentList.filter((item) => {\n      return Utils.imageCheck(item.name);\n    });\n\n    const imageItems = items.map((item) => {\n      return this.prepareImageItem(item);\n    });\n\n    this.setState({\n      isImagePopupOpen: true,\n      imageItems: imageItems,\n      imageIndex: items.indexOf(curItem)\n    });\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  closeImagePopup = () => {\n    this.setState({isImagePopupOpen: false});\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({isCreateFileDialogShow: !this.state.isCreateFileDialogShow});\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow});\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  checkDuplicatedName = (newName) => {\n    let direntList = this.props.direntList;\n    let isDuplicated = direntList.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onItemsDownload = () => {\n    let { path, repoID, selectedDirentList } = this.props;\n    if (selectedDirentList.length) {\n      if (selectedDirentList.length === 1 && !selectedDirentList[0].isDir()) {\n        let direntPath = Utils.joinPath(path, selectedDirentList[0].name);\n        let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n        location.href= url;\n        return;\n      }\n\n      let selectedDirentNames = selectedDirentList.map(dirent => {\n        return dirent.name;\n      });\n\n      this.setState({\n        isProgressDialogShow: true,\n        downloadItems: selectedDirentNames\n      });\n    }\n  }\n\n  onCloseZipDownloadDialog = () => {\n    this.setState({isProgressDialogShow: false});\n  }\n\n  // common contextmenu handle\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  handleContextClick = (event, id, menuList, currentObject = null) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let showMenuConfig = {\n      id: id,\n      position: { x, y },\n      target: event.target,\n      currentObject: currentObject,\n      menuList: menuList,\n    };\n\n    if (menuList.length === 0) {\n      return;\n    }\n\n    showMenu(showMenuConfig);\n  }\n\n  // table-container contextmenu handle\n  onContainerClick = () => {\n    if (this.state.activeDirent) {\n      this.onDirentClick(null);\n    }\n  }\n\n  onContainerMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onContainerContextMenu = (event) => {\n    event.preventDefault();\n    // Display menu items based on the permissions of the current path\n    let permission = this.props.userPerm;\n\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(this.props.userPerm);\n    if (permission !== 'admin' && permission !== 'rw' && !isCustomPermission) {\n      return;\n    }\n\n    if (this.props.selectedDirentList.length === 0) {\n      let id = 'dirent-container-menu';\n\n      // custom permission judgement\n      if (isCustomPermission) {\n        const { create: canCreate } = customPermission.permission;\n        if (!canCreate) return;\n      }\n\n      let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n      this.handleContextClick(event, id, menuList);\n    } else {\n      if (this.props.selectedDirentList.length === 1) {\n        if (!this.state.activeDirent) {\n          let id = 'dirent-item-menu';\n          let dirent = this.props.selectedDirentList[0];\n          let menuList = this.getDirentItemMenuList(dirent, true);\n          this.handleContextClick(event, id, menuList, dirent);\n        } else {\n          this.onDirentClick(null);\n          event.preventDefault();\n          event.persist();\n\n          // custom permission judgement\n          if (isCustomPermission) {\n            const { modify } = customPermission.permission;\n            if (!modify) return;\n          }\n\n          setTimeout(() => {\n            let id = 'dirent-container-menu';\n            let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n            this.handleContextClick(event, id, menuList);\n          }, 0);\n        }\n      } else {\n        let id = 'dirents-menu';\n        let menuList = [];\n        if (isCustomPermission) {\n          const { modify: canModify, copy: canCopy, download: canDownload, delete: canDelete } = customPermission.permission; \n          canModify && menuList.push(TextTranslation.MOVE);\n          canCopy && menuList.push(TextTranslation.COPY);\n          canDownload && menuList.push(TextTranslation.DOWNLOAD);\n          canDelete && menuList.push(TextTranslation.DELETE);\n        } else {\n          menuList = [TextTranslation.MOVE, TextTranslation.COPY, TextTranslation.DOWNLOAD, TextTranslation.DELETE];\n        }\n\n        this.handleContextClick(event, id, menuList);\n      }\n    }\n  }\n\n  onContainerMenuItemClick = (operation) => {\n    switch(operation) {\n      case 'New Folder':\n        this.onCreateFolderToggle();\n        break;\n      case 'New File':\n        this.onCreateFileToggle();\n        break;\n      default:\n        break;\n    }\n\n    hideMenu();\n  }\n\n  onDirentsMenuItemClick = (operation) => {\n    switch(operation) {\n      case 'Move':\n        this.onMoveToggle();\n        break;\n      case 'Copy':\n        this.onCopyToggle();\n        break;\n      case 'Download':\n        this.onItemsDownload();\n        break;\n      case 'Delete':\n        this.props.onItemsDelete();\n        break;\n      default:\n        break;\n    }\n\n    hideMenu();\n  }\n\n  // table-thread contextmenu handle -- Shield event\n  onThreadMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onThreadContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  // table-dirent-item contextmenu handle\n  onItemMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onItemContextMenu = (event, dirent) => {\n    // Display menu items according to the current dirent permission\n    if (this.props.selectedDirentList.length > 1) {\n      return;\n    }\n    this.onDirentClick(dirent);\n    let id = 'dirent-item-menu';\n    let menuList = this.getDirentItemMenuList(dirent, true);\n    this.handleContextClick(event, id, menuList, dirent);\n  }\n\n  setDirentItemRef = (index) => item => {\n    this.direntItems[index] = item;\n  }\n\n  onMenuItemClick = (operation, currentObject, event) => {\n    let index = this.getDirentIndex(currentObject);\n    this.direntItems[index].onMenuItemClick(operation, event);\n\n    hideMenu();\n  }\n\n  onShowMenu = (e) => {\n    this.freezeItem();\n  }\n\n  onHideMenu = (e) => {\n    this.unfreezeItem();\n  }\n\n  // contextmenu utils\n  getDirentIndex = (dirent) => {\n    let direntList = this.props.direntList;\n    let index = 0;\n    for (let i = 0; i < direntList.length; i++) {\n      if (direntList[i].name === dirent.name) {\n        index = i;\n        break;\n      }\n    }\n    return index;\n  }\n\n  getDirentItemMenuList = (dirent, isContextmenu) => {\n    const isRepoOwner = this.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    return Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  }\n\n  onTableDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    this.enteredCounter++;\n    if (this.enteredCounter !== 0) {\n      if (this.state.isListDropTipShow) {\n        return ;\n      }\n      this.setState({isListDropTipShow: true});\n    }\n  }\n\n  onTableDragOver = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.dataTransfer.dropEffect === 'copy') {\n      return;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onTableDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    this.enteredCounter--;\n    if (this.enteredCounter === 0) {\n      this.setState({isListDropTipShow: false});\n    }\n  }\n\n  tableDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.persist();\n    this.enteredCounter = 0;\n    this.setState({isListDropTipShow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartItemData;\n\n    if (Array.isArray(dragStartItemData)) { //selected items\n      return;\n    }\n\n    if (nodeRootPath === this.props.path || nodeParentPath === this.props.path) {\n      return;\n    }\n\n    if (this.props.path.indexOf(nodeRootPath) !== -1) {\n      return;\n    }\n\n    this.props.onItemMove(this.props.currentRepoInfo, nodeDirent, this.props.path, nodeParentPath);\n  }\n\n  onShowDirentsDraggablePreview = () => {\n    this.setState({\n      isShowDirentsDraggablePreview: true,\n    });\n  }\n\n  onHideDirentsDraggablePreview = () => {\n    this.setState({\n      isShowDirentsDraggablePreview: false\n    });\n  }\n\n  render() {\n    const { direntList, sortBy, sortOrder } = this.props;\n\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    // sort\n    const sortByName = sortBy == 'name';\n    const sortByTime = sortBy == 'time';\n    const sortBySize = sortBy == 'size';\n    const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n    const isDesktop = Utils.isDesktop();\n\n    return (\n      <div\n        className={`table-container ${(this.state.isListDropTipShow && this.canDrop) ? 'table-drop-active' : ''}`}\n        onMouseDown={this.onContainerMouseDown}\n        onContextMenu={this.onContainerContextMenu}\n        onClick={this.onContainerClick}\n        onDragEnter={this.onTableDragEnter}\n        onDragOver={this.onTableDragOver}\n        onDragLeave={this.onTableDragLeave}\n        onDrop={this.tableDrop}\n      >\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? (\n            <thead onMouseDown={this.onThreadMouseDown} onContextMenu={this.onThreadContextMenu}>\n              <tr>\n                <th width=\"3%\" className=\"pl10\">\n                  <input type=\"checkbox\" className=\"vam\" onChange={this.props.onAllItemSelected} checked={this.props.isAllItemSelected} />\n                </th>\n                <th width=\"3%\" className=\"pl10\">{/*icon */}</th>\n                <th width=\"5%\" className=\"pl10\">{/*star */}</th>\n                <th width=\"39%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"6%\">{/*tag */}</th>\n                <th width=\"18%\">{/*operation */}</th>\n                <th width=\"11%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n                <th width=\"15%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n              </tr>\n            </thead>\n          ) : (\n            <thead>\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            </thead>\n          )}\n          <tbody>\n            {direntList.map((dirent, index) => {\n              return (\n                <DirentListItem\n                  ref={this.setDirentItemRef(index)}\n                  key={index}\n                  dirent={dirent}\n                  path={this.props.path}\n                  repoID={this.props.repoID}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  isAdmin={this.isAdmin}\n                  isRepoOwner={this.isRepoOwner}\n                  repoEncrypted={this.repoEncrypted}\n                  enableDirPrivateShare={this.props.enableDirPrivateShare}\n                  isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                  onItemClick={this.props.onItemClick}\n                  onItemRenameToggle={this.onItemRenameToggle}\n                  onItemSelected={this.onItemSelected}\n                  onItemDelete={this.props.onItemDelete}\n                  onItemRename={this.onItemRename}\n                  onItemMove={this.props.onItemMove}\n                  onItemCopy={this.props.onItemCopy}\n                  updateDirent={this.props.updateDirent}\n                  isItemFreezed={this.state.isItemFreezed}\n                  freezeItem={this.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                  onDirentClick={this.onDirentClick}\n                  showImagePopup={this.showImagePopup}\n                  onItemMouseDown={this.onItemMouseDown}\n                  onItemContextMenu={this.onItemContextMenu}\n                  selectedDirentList={this.props.selectedDirentList}\n                  activeDirent={this.state.activeDirent}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                  getDirentItemMenuList={this.getDirentItemMenuList}\n                  showDirentDetail={this.props.showDirentDetail}\n                  onItemsMove={this.props.onItemsMove}\n                  onShowDirentsDraggablePreview={this.onShowDirentsDraggablePreview}\n                  loadDirentList={this.props.loadDirentList}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        <Fragment>\n          <ContextMenu\n            id={'dirent-container-menu'}\n            onMenuItemClick={this.onContainerMenuItemClick}\n          />\n          <ContextMenu\n            id={'dirent-item-menu'}\n            onMenuItemClick={this.onMenuItemClick}\n            onShowMenu={this.onShowMenu}\n            onHideMenu={this.onHideMenu}\n          />\n          <ContextMenu\n            id={'dirents-menu'}\n            onMenuItemClick={this.onDirentsMenuItemClick}\n          />\n          {this.state.isShowDirentsDraggablePreview &&\n            <ModalPortal>\n              <DirentsDraggedPreview\n                selectedDirentList={this.props.selectedDirentList}\n                onHideDirentsDraggablePreview={this.onHideDirentsDraggablePreview}\n                dragStartPosition={this.state.dragStartPosition}\n              />\n            </ModalPortal>\n          }\n          {this.state.isImagePopupOpen && (\n            <ModalPortal>\n              <ImageDialog\n                imageItems={this.state.imageItems}\n                imageIndex={this.state.imageIndex}\n                closeImagePopup={this.closeImagePopup}\n                moveToPrevImage={this.moveToPrevImage}\n                moveToNextImage={this.moveToNextImage}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isCreateFolderDialogShow && (\n            <ModalPortal>\n              <CreateFolder\n                parentPath={this.props.path}\n                onAddFolder={this.onAddFolder}\n                checkDuplicatedName={this.checkDuplicatedName}\n                addFolderCancel={this.onCreateFolderToggle}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isCreateFileDialogShow && (\n            <ModalPortal>\n              <CreateFile\n                parentPath={this.props.path}\n                fileType={this.state.fileType}\n                onAddFile={this.onAddFile}\n                checkDuplicatedName={this.checkDuplicatedName}\n                addFileCancel={this.onCreateFileToggle}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isMoveDialogShow &&\n            <MoveDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              isMutipleOperation={this.state.isMutipleOperation}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n              onCancelMove={this.onMoveToggle}\n            />\n          }\n          {this.state.isCopyDialogShow &&\n            <CopyDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              selectedDirentList={this.props.selectedDirentList}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemsCopy={this.props.onItemsCopy}\n              onCancelCopy={this.onCopyToggle}\n            />\n          }\n          {this.state.isProgressDialogShow &&\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={this.state.downloadItems}\n              toggleDialog={this.onCloseZipDownloadDialog}\n            />\n          }\n        </Fragment>\n      </div>\n    );\n  }\n}\n\nDirentListView.propTypes = propTypes;\n\nexport default DirentListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport DirentNoneView from '../../components/dirent-list-view/dirent-none-view';\nimport RepoInfoBar from '../../components/repo-info-bar';\nimport DirentListView from '../../components/dirent-list-view/dirent-list-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  showDirentDetail: PropTypes.func.isRequired,\n  loadDirentList: PropTypes.func.isRequired,\n};\n\nclass DirListView extends React.Component {\n\n  render() {\n\n    if (this.props.path === '/' && this.props.direntList.length === 0) {\n      return (\n        <DirentNoneView\n          path={this.props.path}\n          isDirentListLoading={this.props.isDirentListLoading}\n          onAddFile={this.props.onAddFile}\n        />\n      );\n    }\n\n    return (\n      <Fragment>\n        {this.props.isRepoInfoBarShow && (\n          <RepoInfoBar\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            readmeMarkdown={this.props.readmeMarkdown}\n            draftCounts={this.props.draftCounts}\n            usedRepoTags={this.props.usedRepoTags}\n            updateUsedRepoTags={this.props.updateUsedRepoTags}\n            onFileTagChanged={this.props.onFileTagChanged}\n          />\n        )}\n        <DirentListView\n          path={this.props.path}\n          currentRepoInfo={this.props.currentRepoInfo}\n          repoID={this.props.repoID}\n          isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n          userPerm={this.props.userPerm}\n          enableDirPrivateShare={this.props.enableDirPrivateShare}\n          direntList={this.props.direntList}\n          fullDirentList={this.props.fullDirentList}\n          sortBy={this.props.sortBy}\n          sortOrder={this.props.sortOrder}\n          sortItems={this.props.sortItems}\n          onItemClick={this.props.onItemClick}\n          onItemSelected={this.props.onItemSelected}\n          onItemDelete={this.props.onItemDelete}\n          onItemRename={this.props.onItemRename}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          onDirentClick={this.props.onDirentClick}\n          isDirentListLoading={this.props.isDirentListLoading}\n          updateDirent={this.props.updateDirent}\n          isAllItemSelected={this.props.isAllItemSelected}\n          onAllItemSelected={this.props.onAllItemSelected}\n          selectedDirentList={this.props.selectedDirentList}\n          onItemsMove={this.props.onItemsMove}\n          onItemsCopy={this.props.onItemsCopy}\n          onItemsDelete={this.props.onItemsDelete}\n          onAddFile={this.props.onAddFile}\n          onAddFolder={this.props.onAddFolder}\n          onFileTagChanged={this.props.onFileTagChanged}\n          showDirentDetail={this.props.showDirentDetail}\n          loadDirentList={this.props.loadDirentList}\n        />\n      </Fragment>\n    );\n  }\n}\n\nDirListView.propTypes = propTypes;\n\nexport default DirListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MD5 from 'MD5';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  showImagePopup: PropTypes.func.isRequired,\n  onGridItemContextMenu: PropTypes.func.isRequired,\n  onGridItemClick: PropTypes.func.isRequired,\n  activeDirent: PropTypes.object,\n  onGridItemMouseDown: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  onItemMove: PropTypes.func.isRequired,\n};\n\nclass DirentGridItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isGridSelected: false,\n      isGridDropTipShow: false,\n    };\n\n    const { dirent } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(dirent.permission);\n    this.isCustomPermission = isCustomPermission;\n    this.customPermission = customPermission;\n    this.canPreview = true;\n    this.canDrag = dirent.permission === 'rw';\n    if (isCustomPermission) {\n      const { preview, modify } = customPermission.permission;\n      this.canPreview = preview || modify;\n      this.canDrag = modify;\n    }\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({isGridSelected: false}, () => {\n      if (nextProps.activeDirent && nextProps.activeDirent.name === nextProps.dirent.name) {\n        this.setState({isGridSelected: true});\n      }\n    });\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  onItemClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const { dirent, activeDirent } = this.props;\n    if (dirent.isDir()) {\n      this.props.onItemClick(dirent);\n      return;\n    }\n\n    // is have preview permission\n    if (!this.canPreview) {\n      return;\n    }\n\n    if (dirent === activeDirent) {\n      this.setState({isGridSelected: false});\n      if (Utils.imageCheck(dirent.name)) {\n        this.props.showImagePopup(dirent);\n      } else {\n        this.props.onItemClick(dirent);\n      }\n    } else {\n      this.setState({isGridSelected: false});\n      this.props.onGridItemClick(this.props.dirent);\n    }\n  }\n\n  onItemLinkClick = (e) => {\n    e.preventDefault();\n    const dirent = this.props.dirent;\n\n    if (dirent.isDir()) {\n      this.props.onItemClick(dirent);\n      return;\n    }\n\n    // is have preview permission\n    if (!this.canPreview) {\n      return;\n    }\n\n    if (Utils.imageCheck(dirent.name)) {\n      this.props.showImagePopup(dirent);\n    } else {\n      this.props.onItemClick(dirent);\n    }\n  }\n\n  onGridItemDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    let dragStartItemData = {nodeDirent: this.props.dirent, nodeParentPath: this.props.path};\n    dragStartItemData = JSON.stringify(dragStartItemData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartItemData);\n  }\n\n  onGridItemDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (this.props.dirent.type === 'dir') {\n      this.setState({isGridDropTipShow: true});\n    }\n  }\n\n  onGridItemDragOver = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onGridItemDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isGridDropTipShow: false});\n  }\n\n  onGridItemDragDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isGridDropTipShow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n    let {nodeDirent, nodeParentPath} = dragStartItemData;\n    let dropItemData = this.props.dirent;\n\n    if (nodeDirent.name === dropItemData.name) {\n      return;\n    }\n\n    if (dropItemData.type !== 'dir') {\n      return;\n    }\n\n    let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, selectedPath, nodeParentPath);\n  }\n\n  onGridItemMouseDown = (event) =>{\n    this.props.onGridItemMouseDown(event);\n  }\n\n  getFileUrl = (url) => {\n    let fileUrlArr = url.split('/');\n    if (fileUrlArr.indexOf('48') !== -1) {\n      fileUrlArr.splice(fileUrlArr.indexOf('48'), 1, '192');\n    }\n    let fileUrl = fileUrlArr.join('/');\n    return fileUrl;\n  }\n\n  onGridItemContextMenu = (event) => {\n    let dirent = this.props.dirent;\n    this.props.onGridItemContextMenu(event, dirent);\n  }\n\n  render() {\n    let { dirent, path } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    let iconUrl = Utils.getDirentIcon(dirent, true);\n    let fileUrl = dirent.encoded_thumbnail_src ? this.getFileUrl(dirent.encoded_thumbnail_src) : '';\n\n    let toolTipID = '';\n    let tagTitle = '';\n    if (dirent.file_tags && dirent.file_tags.length > 0) {\n      toolTipID = MD5(dirent.name).slice(0, 7);\n      tagTitle = dirent.file_tags.map(item => item.name).join(' ');\n    }\n\n    let dirHref = '';\n    if (this.props.currentRepoInfo) {\n      dirHref = siteRoot + 'library/' + this.props.repoID + '/' + this.props.currentRepoInfo.repo_name + Utils.encodePath(direntPath);\n    }\n    let fileHref = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(direntPath);\n\n    let gridClass = 'grid-file-img-link cursor-pointer';\n    gridClass += this.state.isGridSelected ? ' grid-selected-active' : ' ';\n    gridClass += this.state.isGridDropTipShow ? ' grid-drop-show' : ' ';\n\n    let lockedInfo = gettext('locked by {name}');\n    lockedInfo = lockedInfo.replace('{name}', dirent.lock_owner_name);\n\n    return (\n      <Fragment>\n        <li className=\"grid-item\" onContextMenu={this.onGridItemContextMenu} onMouseDown={this.onGridItemMouseDown}>\n          <div\n            className={gridClass}\n            draggable={this.canDrag}\n            onClick={this.onItemClick}\n            onDragStart={this.onGridItemDragStart}\n            onDragEnter={this.onGridItemDragEnter}\n            onDragOver={this.onGridItemDragOver}\n            onDragLeave={this.onGridItemDragLeave}\n            onDrop={this.onGridItemDragDrop}\n          >\n            {(this.canPreview && dirent.encoded_thumbnail_src) ?\n              <img src={`${siteRoot}${fileUrl}`} ref={this.gridIcon} className=\"thumbnail\" onClick={this.onItemClick} alt=\"\"/> :\n              <img src={iconUrl} ref={this.gridIcon} width=\"96\" alt='' />\n            }\n            {dirent.is_locked && <img className=\"grid-file-locked-icon\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n          </div>\n          <div className=\"grid-file-name\" onDragStart={this.onGridItemDragStart} draggable={this.canDrag} >\n            {(dirent.type !== 'dir' && dirent.file_tags && dirent.file_tags.length > 0) && (\n              <Fragment>\n                <div id={`tag-list-title-${toolTipID}`} className=\"dirent-item tag-list tag-list-stacked d-inline-block align-middle\">\n                  {dirent.file_tags.map((fileTag, index) => {\n                    let length = dirent.file_tags.length;\n                    return (\n                      <span className=\"file-tag\" key={fileTag.id} style={{zIndex:length - index, backgroundColor:fileTag.color}}></span>\n                    );\n                  })}\n                </div>\n                <UncontrolledTooltip target={`tag-list-title-${toolTipID}`} placement=\"bottom\">\n                  {tagTitle}\n                </UncontrolledTooltip>\n              </Fragment>\n            )}\n            {(!dirent.isDir() && !this.canPreview) ? \n              <a className={`sf-link grid-file-name-link ${this.state.isGridSelected ? 'grid-link-selected-active' : ''}`} onClick={this.onItemLinkClick}>{dirent.name}</a> :\n              <a className={`grid-file-name-link ${this.state.isGridSelected ? 'grid-link-selected-active' : ''}`} href={dirent.type === 'dir' ? dirHref : fileHref} onClick={this.onItemLinkClick}>{dirent.name}</a>\n            }\n          </div>\n        </li>\n      </Fragment>\n    );\n  }\n}\n\nDirentGridItem.propTypes = propTypes;\nexport default DirentGridItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot, thumbnailSizeForOriginal, username, isPro, enableFileComment, fileAuditEnabled, folderPermEnabled, canGenerateShareLink } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport Loading from '../loading';\nimport ModalPortal from '../modal-portal';\nimport ImageDialog from '../../components/dialog/image-dialog';\nimport DirentGridItem from '../../components/dirent-grid-view/dirent-grid-item';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport TextTranslation from '../../utils/text-translation';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport Rename from '../../components/dialog/rename-dirent';\nimport CreateFile from '../dialog/create-file-dialog';\nimport CreateFolder from '../dialog/create-folder-dialog';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\nimport toaster from '../toast';\n\nimport '../../css/grid-view.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object,\n  direntList: PropTypes.array.isRequired,\n  onAddFile: PropTypes.func,\n  onItemDelete: PropTypes.func,\n  onItemCopy: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string, // current path's user permission\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  onGridItemClick: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  onAddFolder: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n};\n\nclass DirentGridView extends React.Component{\n  constructor(props) {\n    super(props);\n    this.state = {\n      isImagePopupOpen: false,\n      imageItems: [],\n      imageIndex: 0,\n      // onmenuClick\n      isShareDialogShow: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isEditFileTagShow: false,\n      isZipDialogOpen: false,\n      isRenameDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isCreateFileDialogShow: false,\n      isPermissionDialogOpen: false,\n\n      isMutipleOperation: false,\n      isGridItemFreezed: false,\n      activeDirent: null,\n    };\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  onGridItemClick = (dirent) => {\n    this.setState({activeDirent: dirent});\n    this.props.onGridItemClick(dirent);\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  onItemShare = (e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  closeSharedDialog = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onItemDelete = (currentObject, e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.props.onItemDelete(currentObject);\n  }\n\n  onMenuItemClick = (operation, currentObject, event) => {\n    hideMenu();\n    switch(operation) {\n      case 'Download':\n        this.onItemDownload(currentObject, event);\n        break;\n      case 'Share':\n        this.onItemShare(event);\n        break;\n      case 'Delete':\n        this.onItemDelete(currentObject, event);\n        break;\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Move':\n        this.onItemMoveToggle();\n        break;\n      case 'Copy':\n        this.onItemCopyToggle();\n        break;\n      case 'Tags':\n        this.onEditFileTagToggle();\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Unlock':\n        this.onUnlockItem(currentObject);\n        break;\n      case 'Lock':\n        this.onLockItem(currentObject);\n        break;\n      case 'Comment':\n        this.onCommentItem();\n        break;\n      case 'History':\n        this.onHistory(currentObject);\n        break;\n      case 'New Folder':\n        this.onCreateFolderToggle(currentObject);\n        break;\n      case 'New File':\n        this.onCreateFileToggle(currentObject);\n        break;\n      case 'Access Log':\n        this.onAccessLog(currentObject);\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient(currentObject);\n        break;\n      default:\n        break;\n    }\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let dirent = this.state.activeDirent ? this.state.activeDirent : '';\n    let direntPath = Utils.joinPath(this.props.path, dirent.name);\n    this.props.onFileTagChanged(dirent, direntPath);\n  }\n\n  getDirentPath = (dirent) => {\n    let path = this.props.path;\n    return path === '/' ? path + dirent.name : path + '/' + dirent.name;\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  onItemDownload = (currentObject, e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let dirent = currentObject;\n    let repoID = this.props.repoID;\n    let direntPath = this.getDirentPath(dirent);\n    if (dirent.type === 'dir') {\n      this.setState({\n        isZipDialogOpen: true\n      });\n    } else {\n      let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n      location.href = url;\n    }\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({\n      isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow,\n    });\n  }\n\n  onItemRenameToggle = () => {\n    this.setState({\n      isRenameDialogShow: !this.state.isRenameDialogShow,\n    });\n  }\n\n  onItemMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onItemCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onPermissionItem = () => {\n    this.setState({isPermissionDialogOpen: !this.state.isPermissionDialogOpen});\n  }\n\n  onLockItem = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.lockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(currentObject, 'is_locked', true);\n      this.props.updateDirent(currentObject, 'locked_by_me', true);\n      let lockName = username.split('@');\n      this.props.updateDirent(currentObject, 'lock_owner_name', lockName[0]);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnlockItem = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.unlockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(currentObject, 'is_locked', false);\n      this.props.updateDirent(currentObject, 'locked_by_me', false);\n      this.props.updateDirent(currentObject, 'lock_owner_name', '');\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCommentItem = () => {\n    this.props.showDirentDetail('comments');\n  }\n\n  onHistory = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    let url = URLDecorator.getUrl({type: 'file_revisions', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onAccessLog = (currentObject) => {\n    let filePath = this.getDirentPath(currentObject);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  onOpenViaClient = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    let url = URLDecorator.getUrl({type: 'open_via_client', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onItemRename = (newName) => {\n    this.props.onItemRename(this.state.activeDirent, newName);\n  }\n\n  prepareImageItem = (item) => {\n    const useThumbnail = !this.repoEncrypted;\n    const name = item.name;\n\n    const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n    const isGIF = fileExt == 'gif';\n\n    const path = Utils.encodePath(Utils.joinPath(this.props.path, name));\n    const repoID = this.props.repoID;\n    let src;\n    if (useThumbnail && !isGIF) {\n      src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n    } else {\n      src = `${siteRoot}repo/${repoID}/raw${path}`;\n    }\n\n    return {\n      'name': name,\n      'url': `${siteRoot}lib/${repoID}/file${path}`,\n      'src': src\n    };\n  }\n\n  showImagePopup = (curItem) => {\n    let items = this.props.fullDirentList.filter((item) => {\n      return Utils.imageCheck(item.name);\n    });\n\n    const imageItems = items.map((item) => {\n      return this.prepareImageItem(item);\n    });\n\n    this.setState({\n      isImagePopupOpen: true,\n      imageItems: imageItems,\n      imageIndex: items.indexOf(curItem)\n    });\n  }\n\n  closeImagePopup = () => {\n    this.setState({isImagePopupOpen: false});\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  checkDuplicatedName = (newName) => {\n    return Utils.checkDuplicatedNameInList(this.props.direntList, newName);\n  }\n\n  // common contextmenu handle\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onGridContainerMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onGridItemMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  gridContainerClick = () => {\n    if (!this.props.isDirentDetailShow) {\n      this.onGridItemClick(null);\n    }\n  }\n\n  onGridContainerContextMenu = (event) => {\n    event.preventDefault();\n    // Display menu items based on the permissions of the current path\n    let permission = this.props.userPerm;\n    if (permission !== 'admin' && permission !== 'rw') {\n      return;\n    }\n    let id = 'dirent-grid-container-menu';\n    let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n    this.handleContextClick(event, id, menuList);\n  }\n\n  onGridItemContextMenu = (event, dirent) => {\n    // Display menu items according to the current dirent permission\n    let id = 'grid-item-contextmenu';\n    let menuList = this.getDirentItemMenuList(dirent, true);\n    this.handleContextClick(event, id, menuList, dirent);\n    this.props.onGridItemClick && this.props.onGridItemClick(dirent);\n  }\n\n  handleContextClick = (event, id, menuList, currentObject = null) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    this.setState({activeDirent: currentObject});\n\n    let showMenuConfig = {\n      id: id,\n      position: { x, y },\n      target: event.target,\n      currentObject: currentObject,\n      menuList: menuList,\n    };\n\n    if (menuList.length === 0) {\n      return;\n    }\n\n    showMenu(showMenuConfig);\n  }\n\n  getDirentItemMenuList = (dirent, isContextmenu) => {\n    const isRepoOwner = this.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    return Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  }\n\n  render() {\n    let {direntList, path} = this.props;\n    let dirent = this.state.activeDirent ? this.state.activeDirent : '';\n    let direntPath = Utils.joinPath(path, dirent.name);\n\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    return (\n      <Fragment>\n        <ul className=\"grid-view\" onClick={this.gridContainerClick} onContextMenu={this.onGridContainerContextMenu} onMouseDown={this.onGridContainerMouseDown}>\n          {\n            direntList.length !== 0 && direntList.map((dirent, index) => {\n              return (\n                <DirentGridItem\n                  key={index}\n                  dirent={dirent}\n                  repoID={this.props.repoID}\n                  path={this.props.path}\n                  onItemClick={this.props.onItemClick}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  showImagePopup={this.showImagePopup}\n                  onGridItemContextMenu={this.onGridItemContextMenu}\n                  onItemMove={this.props.onItemMove}\n                  onGridItemMouseDown={this.onGridItemMouseDown}\n                  onGridItemClick={this.onGridItemClick}\n                  activeDirent={this.state.activeDirent}\n                />\n              );\n            })\n          }\n        </ul>\n        <ContextMenu\n          id={'grid-item-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n        />\n        <ContextMenu\n          id={'dirent-grid-container-menu'}\n          onMenuItemClick={this.onMenuItemClick}\n        />\n        {this.state.isCreateFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.props.path}\n              onAddFolder={this.onAddFolder}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onCreateFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              onAddFile={this.onAddFile}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFileCancel={this.onCreateFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isMoveDialogShow &&\n          <MoveDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.currentRepoInfo.encrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemMove={this.props.onItemMove}\n            onCancelMove={this.onMoveToggle}\n            dirent={this.state.activeDirent}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n          <ModalPortal>\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={dirent.name}\n              toggleDialog={this.closeZipDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isCopyDialogShow &&\n          <CopyDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.currentRepoInfo.encrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemCopy={this.props.onItemCopy}\n            onCancelCopy={this.onCopyToggle}\n            dirent={this.state.activeDirent}\n          />\n        }\n        {this.state.isEditFileTagShow &&\n          <EditFileTagDialog\n            repoID={this.props.repoID}\n            fileTagList={dirent.file_tags}\n            filePath={direntPath}\n            toggleCancel={this.onEditFileTagToggle}\n            onFileTagChanged={this.onFileTagChanged}\n          />\n        }\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={dirent.type}\n              itemName={dirent.name}\n              itemPath={direntPath}\n              userPerm={dirent.permission}\n              repoID={this.props.repoID}\n              repoEncrypted={false}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.closeSharedDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isRenameDialogShow && (\n          <ModalPortal>\n            <Rename\n              dirent={this.state.activeDirent}\n              onRename={this.onItemRename}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleCancel={this.onItemRenameToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isPermissionDialogOpen &&\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onPermissionItem}\n              repoID={this.props.repoID}\n              folderPath={direntPath}\n              folderName={dirent.name}\n              isDepartmentRepo={this.props.isGroupOwnedRepo}\n            />\n          </ModalPortal>\n        }\n        {this.state.isImagePopupOpen && (\n          <ModalPortal>\n            <ImageDialog\n              imageItems={this.state.imageItems}\n              imageIndex={this.state.imageIndex}\n              closeImagePopup={this.closeImagePopup}\n              moveToPrevImage={this.moveToPrevImage}\n              moveToNextImage={this.moveToNextImage}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirentGridView.propTypes = propTypes;\n\nexport default DirentGridView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport RepoInfoBar from '../../components/repo-info-bar';\nimport DirentGridView from '../../components/dirent-grid-view/dirent-grid-view';\nimport DirentNoneView from '../../components/dirent-list-view/dirent-none-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  usedRepoTags: PropTypes.array.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  direntList: PropTypes.array.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onGridItemClick: PropTypes.func,\n  onAddFile: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  onItemRename: PropTypes.func.isRequired,\n};\n\nclass DirGridView extends React.Component {\n\n  render() {\n    if (this.props.path === '/' && this.props.direntList.length === 0) {\n      return (\n        <DirentNoneView\n          path={this.props.path}\n          isDirentListLoading={this.props.isDirentListLoading}\n          onAddFile={this.props.onAddFile}\n        />\n      );\n    }\n    return (\n      <Fragment>\n        {this.props.isRepoInfoBarShow && (\n          <RepoInfoBar\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            readmeMarkdown={this.props.readmeMarkdown}\n            draftCounts={this.props.draftCounts}\n            usedRepoTags={this.props.usedRepoTags}\n            updateUsedRepoTags={this.props.updateUsedRepoTags}\n            onFileTagChanged={this.props.onFileTagChanged}\n          />\n        )}\n        <DirentGridView\n          path={this.props.path}\n          repoID={this.props.repoID}\n          currentRepoInfo={this.props.currentRepoInfo}\n          isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n          userPerm={this.props.userPerm}\n          enableDirPrivateShare={this.props.enableDirPrivateShare}\n          direntList={this.props.direntList}\n          fullDirentList={this.props.fullDirentList}\n          onAddFile={this.props.onAddFile}\n          onItemClick={this.props.onItemClick}\n          onItemDelete={this.props.onItemDelete}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          isDirentListLoading={this.props.isDirentListLoading}\n          updateDirent={this.props.updateDirent}\n          onRenameNode={this.props.onRenameNode}\n          showDirentDetail={this.props.showDirentDetail}\n          onGridItemClick={this.props.onGridItemClick}\n          isDirentDetailShow={this.props.isDirentDetailShow}\n          onItemRename={this.props.onItemRename}\n          onAddFolder={this.props.onAddFolder}\n          onFileTagChanged={this.props.onFileTagChanged}\n        />\n      </Fragment>\n    );\n  }\n}\n\nDirGridView.propTypes = propTypes;\n\nexport default DirGridView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  currentNode: PropTypes.object,\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentWillMount() {\n    this.setState({newName: this.props.currentNode.object.name});\n  }\n\n  componentDidMount() {\n    let currentNode = this.props.currentNode;\n    this.changeState(currentNode);\n    this.newInput.focus();\n    let type = currentNode.object.type;\n    if (type === 'file') {\n      var endIndex = currentNode.object.name.lastIndexOf('.md');\n      this.newInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.setSelectionRange(0, -1);\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.currentNode);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n      }\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  changeState = (currentNode) => {\n    let name = currentNode.object.name;\n    this.setState({newName: name});\n  }\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  }\n\n  render() {\n    let type = this.props.currentNode.object.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} placeholder=\"newName\" value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport TreeView from '../../components/tree-view/tree-view';\nimport Loading from '../../components/loading';\nimport ModalPortal from '../../components/modal-portal';\nimport Rename from '../../components/dialog/rename-dialog';\nimport Copy from '../../components/dialog/copy-dirent-dialog';\nimport Move from '../../components/dialog/move-dirent-dialog';\nimport CreateFolder from '../../components/dialog/create-folder-dialog';\nimport CreateFile from '../../components/dialog/create-file-dialog';\nimport ImageDialog from '../../components/dialog/image-dialog';\nimport { siteRoot, thumbnailSizeForOriginal } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPath: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n  navRate: PropTypes.number,\n  inResizing: PropTypes.bool.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n};\n\nclass DirColumnNav extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      opNode: null,\n      isAddFileDialogShow: false,\n      isAddFolderDialogShow: false,\n      isRenameDialogShow: false,\n      isNodeImagePopupOpen: false,\n      imageNodeItems: [],\n      imageIndex: 0,\n      isCopyDialogShow: false,\n      isMoveDialogShow: false,\n      isMutipleOperation: false,\n    };\n    this.isNodeMenuShow = true;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({opNode: nextProps.currentNode});\n  }\n\n  onNodeClick = (node) => {\n    this.setState({opNode: node});\n    if (Utils.imageCheck(node.object.name)) {\n      this.showNodeImagePopup(node);\n      return;\n    }\n    this.props.onNodeClick(node);\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.setState({opNode: node});\n    switch (operation) {\n      case 'New Folder':\n        if (!node) {\n          this.onAddFolderToggle('root');\n        } else {\n          this.onAddFolderToggle();\n        }\n        break;\n      case 'New File':\n        if (!node) {\n          this.onAddFileToggle('root');\n        } else {\n          this.onAddFileToggle();\n        }\n        break;\n      case 'Rename':\n        this.onRenameToggle();\n        break;\n      case 'Delete':\n        this.onDeleteNode(node);\n        break;\n      case 'Copy':\n        this.onCopyToggle();\n        break;\n      case 'Move':\n        this.onMoveToggle();\n        break;\n      case 'Open in New Tab':\n        this.onOpenFile(node);\n        break;\n    }\n  }\n\n  onAddFileToggle = (type) => {\n    if (type === 'root') {\n      let root = this.props.treeData.root;\n      this.setState({\n        isAddFileDialogShow: !this.state.isAddFileDialogShow,\n        opNode: root,\n      });\n    } else {\n      this.setState({isAddFileDialogShow: !this.state.isAddFileDialogShow});\n    }\n  }\n\n  onAddFolderToggle = (type) => {\n    if (type === 'root') {\n      let root = this.props.treeData.root;\n      this.setState({\n        isAddFolderDialogShow: !this.state.isAddFolderDialogShow,\n        opNode: root,\n      });\n    } else {\n      this.setState({isAddFolderDialogShow: !this.state.isAddFolderDialogShow});\n    }\n  }\n\n  onRenameToggle = () => {\n    this.setState({isRenameDialogShow: !this.state.isRenameDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onAddFolderNode = (dirPath) => {\n    this.setState({isAddFolderDialogShow: !this.state.isAddFolderDialogShow});\n    this.props.onAddFolderNode(dirPath);\n  }\n\n  onAddFileNode = (filePath, isDraft) => {\n    this.setState({isAddFileDialogShow: !this.state.isAddFileDialogShow});\n    this.props.onAddFileNode(filePath, isDraft);\n  }\n\n  onRenameNode = (newName) => {\n    this.setState({isRenameDialogShow: !this.state.isRenameDialogShow});\n    let node = this.state.opNode;\n    this.props.onRenameNode(node, newName);\n  }\n\n  onDeleteNode = (node) => {\n    this.props.onDeleteNode(node);\n  }\n\n  onOpenFile = (node) => {\n    let newUrl = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(node.path);\n    window.open(newUrl, '_blank');\n  }\n\n  checkDuplicatedName = (newName) => {\n    let node = this.state.opNode;\n    // root node to new node conditions: parentNode is null,\n    let parentNode = node.parentNode ? node.parentNode : node;\n    let childrenObject = parentNode.children.map(item => {\n      return item.object;\n    });\n    let isDuplicated = childrenObject.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  showNodeImagePopup = (node) => {\n    let childrenNode = node.parentNode.children;\n    let items = childrenNode.filter((item) => {\n      return Utils.imageCheck(item.object.name);\n    });\n    let imageNames = items.map((item) => {\n      return item.object.name;\n    });\n    this.setState({\n      isNodeImagePopupOpen: true,\n      imageNodeItems: this.prepareImageItems(node),\n      imageIndex: imageNames.indexOf(node.object.name)\n    });\n  }\n\n  prepareImageItems = (node) => {\n    let childrenNode = node.parentNode.children;\n    let items = childrenNode.filter((item) => {\n      return Utils.imageCheck(item.object.name);\n    });\n\n    const useThumbnail = !this.props.currentRepoInfo.encrypted;\n    let prepareItem = (item) => {\n      const name = item.object.name;\n\n      const path = Utils.encodePath(Utils.joinPath(node.parentNode.path, name));\n      const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n      const isGIF = fileExt === 'gif';\n\n      const repoID = this.props.repoID;\n      let src = '';\n      if (useThumbnail && !isGIF) {\n        src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n      } else {\n        src = `${siteRoot}repo/${repoID}/raw${path}`;\n      }\n\n      return {\n        'name': name,\n        'url': `${siteRoot}lib/${repoID}/file${path}`,\n        'src': src\n      };\n    };\n\n    return items.map((item) => { return prepareItem(item); });\n  }\n\n  closeNodeImagePopup = () => {\n    this.setState({\n      isNodeImagePopupOpen: false\n    });\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageNodeItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageNodeItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  stopTreeScrollPropagation = (e) => {\n    e.stopPropagation();\n  }\n\n  render() {\n    let flex = this.props.navRate ? '0 0 ' + this.props.navRate * 100 + '%' : '0 0 25%';\n    const select = this.props.inResizing ? 'none' : '';\n    return (\n      <Fragment>\n        <div className=\"dir-content-nav\" role=\"navigation\" style={{flex: (flex), userSelect: select}} onScroll={this.stopTreeScrollPropagation}>\n          {this.props.isTreeDataLoading ?\n            (<Loading/>) :\n            (<TreeView\n              userPerm={this.props.userPerm}\n              isNodeMenuShow={this.isNodeMenuShow}\n              treeData={this.props.treeData}\n              currentPath={this.props.currentPath}\n              onNodeClick={this.onNodeClick}\n              onNodeExpanded={this.props.onNodeExpanded}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onMenuItemClick={this.onMenuItemClick}\n              onFreezedItem={this.onFreezedItem}\n              onUnFreezedItem={this.onUnFreezedItem}\n              onItemMove={this.props.onItemMove}\n              currentRepoInfo={this.props.currentRepoInfo}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n            />)\n          }\n        </div>\n        {this.state.isAddFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.state.opNode.path}\n              onAddFolder={this.onAddFolderNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onAddFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isAddFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.state.opNode.path}\n              onAddFile={this.onAddFileNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFileCancel={this.onAddFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isRenameDialogShow && (\n          <ModalPortal>\n            <Rename\n              currentNode={this.state.opNode}\n              onRename={this.onRenameNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleCancel={this.onRenameToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCopyDialogShow && (\n          <ModalPortal>\n            <Copy\n              path={this.state.opNode.parentNode.path}\n              repoID={this.props.repoID}\n              dirent={this.state.opNode.object}\n              onItemCopy={this.props.onItemCopy}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              onCancelCopy={this.onCopyToggle}\n              isMutipleOperation={this.state.isMutipleOperation}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isMoveDialogShow && (\n          <ModalPortal>\n            <Move\n              path={this.state.opNode.parentNode.path}\n              repoID={this.props.repoID}\n              dirent={this.state.opNode.object}\n              onItemMove={this.props.onItemMove}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              onCancelMove={this.onMoveToggle}\n              isMutipleOperation={this.state.isMutipleOperation}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isNodeImagePopupOpen && (\n          <ModalPortal>\n            <ImageDialog\n              imageItems={this.state.imageNodeItems}\n              imageIndex={this.state.imageIndex}\n              closeImagePopup={this.closeNodeImagePopup}\n              moveToPrevImage={this.moveToPrevImage}\n              moveToNextImage={this.moveToNextImage}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirColumnNav.defaultProps={\n  navRate: 0.25\n};\n\nDirColumnNav.propTypes = propTypes;\n\nexport default DirColumnNav;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\nimport WikiMarkdownViewer from '../wiki-markdown-viewer';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool,\n  hasDraft: PropTypes.bool,\n  goDraftPage: PropTypes.func.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n};\n\nclass DirColumnFile extends React.Component {\n\n  componentDidMount() {\n    if (this.props.hash) {\n      let hash = this.props.hash;\n      setTimeout(function() {\n        window.location.hash = hash;\n      }, 500);\n    }\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path) + '?mode=edit';\n    window.open(url);\n  }\n\n  onNewDraft = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    seafileAPI.createDraft(repoID, path).then(res => {\n      window.location.href = siteRoot + 'lib/' + res.data.origin_repo_id + '/file' + res.data.draft_file_path + '?mode=edit';\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onOpenFile = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let newUrl = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path);\n    window.open(newUrl, '_blank');\n  }\n\n  goDraftPage = (e) => {\n    e.preventDefault();\n    this.props.goDraftPage();\n  }\n\n  render() {\n    if (this.props.isFileLoadedErr) {\n      return (\n        <div className=\"message err-tip\">{gettext('File does not exist.')}</div>\n      );\n    }\n    return (\n      <WikiMarkdownViewer\n        isTOCShow={false}\n        isFileLoading={this.props.isFileLoading}\n        markdownContent={this.props.content}\n        lastModified = {this.props.lastModified}\n        latestContributor={this.props.latestContributor}\n        onLinkClick={this.props.onLinkClick}\n        repoID={this.props.repoID}\n        path={this.props.path}\n      >\n        <Fragment>\n          <span className='wiki-open-file position-fixed' onClick={this.onOpenFile}>\n            <i className=\"fas fa-expand-arrows-alt\"></i>\n          </span>\n          {(!this.props.isDraft && this.props.hasDraft) &&\n            <div className='seafile-btn-view-review text-center mt-2'>\n              <div className='tag tag-green'>\n                {gettext('This file is in draft stage.')}\n                <span className=\"ml-2\" onClick={this.goDraftPage}>{gettext('View Draft')}</span>\n              </div>\n            </div>\n          }\n        </Fragment>\n      </WikiMarkdownViewer>\n    );\n  }\n}\n\nDirColumnFile.propTypes = propTypes;\n\nexport default DirColumnFile;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport DirColumnNav from './dir-column-nav';\nimport DirColumnFile from './dir-column-file';\nimport DirListView from './dir-list-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  // repoinfo\n  currentRepoInfo: PropTypes.object.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  // tree\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  // file\n  isViewFile: PropTypes.bool.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  goDraftPage: PropTypes.func.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n  // repo content\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  draftCounts: PropTypes.number.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  // list\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  showDirentDetail: PropTypes.func.isRequired,\n};\n\nclass DirColumnView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      inResizing: false,\n      navRate: 0.25,\n    };\n    this.containerWidth = null;\n  }\n\n  onResizeMouseUp = () => {\n    if (this.state.inResizing) {\n      this.setState({\n        inResizing: false\n      });\n    }\n    this.setCookie('navRate', this.state.navRate);\n  }\n\n  onResizeMouseDown = () => {\n    this.containerWidth = this.refs.viewModeContainer.clientWidth;\n    this.setState({\n      inResizing: true\n    });\n  };\n\n  onResizeMouseMove = (e) => {\n    let sizeNavWidth = this.containerWidth / 0.78 * 0.22 + 3;\n    let rate = (e.nativeEvent.clientX - sizeNavWidth) / this.containerWidth;\n    if (rate < 0.1) {\n      this.setState({\n        inResizing: false,\n        navRate: 0.12,\n      });\n    }\n    else if (rate > 0.4) {\n      this.setState({\n        inResizing: false,\n        navRate: 0.38,\n      });\n    }\n    else {\n      this.setState({\n        navRate: rate\n      });\n    }\n  };\n\n  setCookie = (name, value) => {\n    let cookie = name + '=' + value + ';';\n    document.cookie = cookie;\n  }\n\n  getCookie = (cookiename) => {\n    let name = cookiename + '=';\n    let cookie = document.cookie.split(';');\n    for (let i = 0, len = cookie.length; i < len; i++) {\n      let c = cookie[i].trim();\n      if (c.indexOf(name) == 0) {\n        return c.substring(name.length, c.length) * 1;\n      }\n    }\n    return '';\n  }\n\n  componentWillMount() {\n    let rate = this.getCookie('navRate');\n    if (rate) {\n      this.setState({\n        navRate: rate,\n      });\n    }\n  }\n\n  render() {\n    const onResizeMove = this.state.inResizing ? this.onResizeMouseMove : null;\n    const select = this.state.inResizing ? 'none' : '';\n    const mainFlex = '1 0 ' + (1 - this.state.navRate - 0.05) * 100 + '%';\n    return (\n      <div className=\"dir-colunm-view\" onMouseMove={onResizeMove} onMouseUp={this.onResizeMouseUp} ref=\"viewModeContainer\">\n        <DirColumnNav\n          currentPath={this.props.path}\n          userPerm={this.props.userPerm}\n          isTreeDataLoading={this.props.isTreeDataLoading}\n          treeData={this.props.treeData}\n          currentNode={this.props.currentNode}\n          onNodeClick={this.props.onNodeClick}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onAddFolderNode={this.props.onAddFolderNode}\n          onAddFileNode={this.props.onAddFileNode}\n          onRenameNode={this.props.onRenameNode}\n          onDeleteNode={this.props.onDeleteNode}\n          repoID={this.props.repoID}\n          navRate={this.state.navRate}\n          inResizing={this.state.inResizing}\n          currentRepoInfo={this.props.currentRepoInfo}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          selectedDirentList={this.props.selectedDirentList}\n          onItemsMove={this.props.onItemsMove}\n        />\n        <div className=\"dir-content-resize\" onMouseDown={this.onResizeMouseDown}></div>\n        <div className=\"dir-content-main\" style={{userSelect: select, flex: mainFlex}}>\n          {this.props.isViewFile ? (\n            <DirColumnFile\n              path={this.props.path}\n              repoID={this.props.repoID}\n              hash={this.props.hash}\n              isDraft={this.props.isDraft}\n              hasDraft={this.props.hasDraft}\n              goDraftPage={this.props.goDraftPage}\n              isFileLoading={this.props.isFileLoading}\n              isFileLoadedErr={this.props.isFileLoadedErr}\n              filePermission={this.props.filePermission}\n              content={this.props.content}\n              lastModified={this.props.lastModified}\n              latestContributor={this.props.latestContributor}\n              onLinkClick={this.props.onLinkClick}\n            />\n          ) : (\n            <DirListView\n              path={this.props.path}\n              repoID={this.props.repoID}\n              currentRepoInfo={this.props.currentRepoInfo}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              userPerm={this.props.userPerm}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isRepoInfoBarShow={this.props.isRepoInfoBarShow}\n              usedRepoTags={this.props.usedRepoTags}\n              readmeMarkdown={this.props.readmeMarkdown}\n              draftCounts={this.props.draftCounts}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              isDirentListLoading={this.props.isDirentListLoading}\n              direntList={this.props.direntList}\n              fullDirentList={this.props.fullDirentList}\n              sortBy={this.props.sortBy}\n              sortOrder={this.props.sortOrder}\n              sortItems={this.props.sortItems}\n              onAddFolder={this.props.onAddFolder}\n              onAddFile={this.props.onAddFile}\n              onItemClick={this.props.onItemClick}\n              onItemSelected={this.props.onItemSelected}\n              onItemDelete={this.props.onItemDelete}\n              onItemRename={this.props.onItemRename}\n              onItemMove={this.props.onItemMove}\n              onItemCopy={this.props.onItemCopy}\n              onDirentClick={this.props.onDirentClick}\n              updateDirent={this.props.updateDirent}\n              isAllItemSelected={this.props.isAllItemSelected}\n              onAllItemSelected={this.props.onAllItemSelected}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n              onItemsCopy={this.props.onItemsCopy}\n              onItemsDelete={this.props.onItemsDelete}\n              onFileTagChanged={this.props.onFileTagChanged}\n              showDirentDetail={this.props.showDirentDetail}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nDirColumnView.propTypes = propTypes;\n\nexport default DirColumnView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport CurDirPath from '../../components/cur-dir-path';\nimport DirentDetail from '../../components/dirent-detail/dirent-details';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport DirListView from '../../components/dir-view-mode/dir-list-view';\nimport DirGridView from '../../components/dir-view-mode/dir-grid-view';\nimport DirColumnView from '../../components/dir-view-mode/dir-column-view';\n\nimport '../../css/lib-content-view.css';\n\nconst propTypes = {\n  pathPrefix: PropTypes.array.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  pathExist: PropTypes.bool.isRequired,\n  // repoinfo\n  currentRepoInfo: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  // path func\n  onTabNavClick: PropTypes.func.isRequired,\n  onMainNavBarClick: PropTypes.func.isRequired,\n  // file\n  isViewFile: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  goDraftPage: PropTypes.func.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n  // tree\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  // repo content\n  draftCounts: PropTypes.number,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  // list\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  isDirentSelected: PropTypes.bool.isRequired,\n  isAllDirentSelected: PropTypes.bool.isRequired,\n  onAllDirentSelected: PropTypes.func.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  selectedDirent: PropTypes.object,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  closeDirentDetail: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n  updateDetail: PropTypes.bool.isRequired,\n  onListContainerScroll: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  direntDetailPanelTab: PropTypes.string,\n  loadDirentList: PropTypes.func.isRequired,\n};\n\nclass LibContentContainer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentDirent: null,\n    };\n\n    this.errMessage = (<div className=\"message err-tip\">{gettext('Folder does not exist.')}</div>);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.path !== this.props.path || nextProps.updateDetail !== this.props.updateDetail) {\n      this.setState({currentDirent: null});\n    }\n  }\n\n  onPathClick = (path) => {\n    this.props.onMainNavBarClick(path);\n    this.props.closeDirentDetail();\n  }\n\n  onItemClick = (dirent) => {\n    this.props.onItemClick(dirent);\n    this.props.closeDirentDetail();\n  }\n\n  onGridItemClick = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  // on '<tr>'\n  onDirentClick = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  onItemSelected = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onItemSelected(dirent);\n  }\n\n  onItemDelete = (dirent) => {\n    this.checkCurrentDirent(dirent);\n    this.props.onItemDelete(dirent);\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.checkCurrentDirent(dirent);\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  checkCurrentDirent = (deletedDirent) => {\n    let { currentDirent } = this.state;\n    if (currentDirent && deletedDirent.name === currentDirent.name) {\n      this.setState({currentDirent: null});\n    }\n  }\n\n  onItemsScroll = (e) => {\n    let target = e.target;\n\n    if (target.scrollTop === 0) {\n      return;\n    }\n\n    if (target.scrollTop + target.clientHeight + 1 >= target.scrollHeight) {\n      this.props.onListContainerScroll();\n    }\n  }\n\n  render() {\n    let { path, repoID, usedRepoTags, readmeMarkdown, draftCounts } = this.props;\n    let isRepoInfoBarShow = false;\n    if (path === '/') {\n      if (usedRepoTags.length !== 0 || readmeMarkdown !== null || draftCounts !== 0) {\n        isRepoInfoBarShow = true;\n      }\n    }\n\n    return (\n      <Fragment>\n        <div className=\"cur-view-container\">\n          {this.props.currentRepoInfo.status === 'read-only' &&\n            <div className=\"readonly-tip-message\">\n              {gettext('This library has been set to read-only by admin and cannot be updated.')}\n            </div>\n          }\n          <div className=\"cur-view-path\">\n            <CurDirPath\n              repoID={repoID}\n              repoName={this.props.currentRepoInfo.repo_name}\n              pathPrefix={this.props.pathPrefix}\n              currentPath={this.props.path}\n              userPerm={this.props.userPerm}\n              isViewFile={this.props.isViewFile}\n              onTabNavClick={this.props.onTabNavClick}\n              onPathClick={this.onPathClick}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              fileTags={this.props.fileTags}\n              onDeleteRepoTag={this.props.onDeleteRepoTag}\n              direntList={this.props.direntList}\n              sortBy={this.props.sortBy}\n              sortOrder={this.props.sortOrder}\n              sortItems={this.props.sortItems}\n            />\n          </div>\n          <div className={`cur-view-content lib-content-container ${this.props.currentMode === 'column' ? 'view-mode-container' : ''}`} onScroll={this.onItemsScroll}>\n            {!this.props.pathExist && this.errMessage}\n            {this.props.pathExist && (\n              <Fragment>\n                {this.props.currentMode === 'list' && (\n                  <DirListView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    fullDirentList={this.props.fullDirentList}\n                    sortBy={this.props.sortBy}\n                    sortOrder={this.props.sortOrder}\n                    sortItems={this.props.sortItems}\n                    onAddFolder={this.props.onAddFolder}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemSelected={this.onItemSelected}\n                    onItemDelete={this.onItemDelete}\n                    onItemRename={this.props.onItemRename}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    onDirentClick={this.onDirentClick}\n                    updateDirent={this.props.updateDirent}\n                    isAllItemSelected={this.props.isAllDirentSelected}\n                    onAllItemSelected={this.props.onAllDirentSelected}\n                    selectedDirentList={this.props.selectedDirentList}\n                    onItemsMove={this.props.onItemsMove}\n                    onItemsCopy={this.props.onItemsCopy}\n                    onItemsDelete={this.props.onItemsDelete}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                    showDirentDetail={this.props.showDirentDetail}\n                    loadDirentList={this.props.loadDirentList}\n                  />\n                )}\n                {this.props.currentMode === 'grid' && (\n                  <DirGridView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    onRenameNode={this.props.onRenameNode}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    fullDirentList={this.props.fullDirentList}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemDelete={this.props.onItemDelete}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    updateDirent={this.props.updateDirent}\n                    onAddFolder={this.props.onAddFolder}\n                    showDirentDetail={this.props.showDirentDetail}\n                    onGridItemClick={this.onGridItemClick}\n                    isDirentDetailShow={this.props.isDirentDetailShow}\n                    onItemRename={this.props.onItemRename}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                  />\n                )}\n                {this.props.currentMode === 'column' && (\n                  <DirColumnView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    isTreeDataLoading={this.props.isTreeDataLoading}\n                    treeData={this.props.treeData}\n                    currentNode={this.props.currentNode}\n                    onNodeClick={this.props.onNodeClick}\n                    onNodeCollapse={this.props.onNodeCollapse}\n                    onNodeExpanded={this.props.onNodeExpanded}\n                    onAddFolderNode={this.props.onAddFolder}\n                    onAddFileNode={this.props.onAddFile}\n                    onRenameNode={this.props.onRenameNode}\n                    onDeleteNode={this.props.onDeleteNode}\n                    isViewFile={this.props.isViewFile}\n                    isFileLoading={this.props.isFileLoading}\n                    isFileLoadedErr={this.props.isFileLoadedErr}\n                    hash={this.props.hash}\n                    isDraft={this.props.isDraft}\n                    hasDraft={this.props.hasDraft}\n                    goDraftPage={this.props.goDraftPage}\n                    filePermission={this.props.filePermission}\n                    content={this.props.content}\n                    lastModified={this.props.lastModified}\n                    latestContributor={this.props.latestContributor}\n                    onLinkClick={this.props.onLinkClick}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    fullDirentList={this.props.fullDirentList}\n                    sortBy={this.props.sortBy}\n                    sortOrder={this.props.sortOrder}\n                    sortItems={this.props.sortItems}\n                    onAddFolder={this.props.onAddFolder}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemSelected={this.onItemSelected}\n                    onItemDelete={this.onItemDelete}\n                    onItemRename={this.props.onItemRename}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    onDirentClick={this.onDirentClick}\n                    updateDirent={this.props.updateDirent}\n                    isAllItemSelected={this.props.isAllDirentSelected}\n                    onAllItemSelected={this.props.onAllDirentSelected}\n                    selectedDirentList={this.props.selectedDirentList}\n                    onItemsMove={this.props.onItemsMove}\n                    onItemsCopy={this.props.onItemsCopy}\n                    onItemsDelete={this.props.onItemsDelete}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                    showDirentDetail={this.props.showDirentDetail}\n                  />\n                )}\n              </Fragment>\n            )}\n          </div>\n        </div>\n        {this.props.isDirentDetailShow &&\n          <Fragment>\n            <div className=\"cur-view-detail\">\n              {(this.props.path === '/' && !this.state.currentDirent) ?\n                <LibDetail\n                  currentRepo={this.props.currentRepoInfo}\n                  closeDetails={this.props.closeDirentDetail}\n                /> :\n                <DirentDetail\n                  repoID={repoID}\n                  path={this.props.path}\n                  dirent={this.state.currentDirent}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                  onItemDetailsClose={this.props.closeDirentDetail}\n                  direntDetailPanelTab={this.props.direntDetailPanelTab}\n                />\n              }\n            </div>\n          </Fragment>\n        }\n      </Fragment>\n    );\n  }\n}\n\nLibContentContainer.propTypes = propTypes;\n\nexport default LibContentContainer;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  resumableFile: PropTypes.object.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n};\n\nconst UPLOAD_UPLOADING = 'uploading';\nconst UPLOAD_ERROR = 'error';\nconst UPLOAD_ISSAVING = 'isSaving';\nconst UPLOAD_UPLOADED = 'uploaded';\n\nclass UploadListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      uploadState: UPLOAD_UPLOADING\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { resumableFile } = nextProps;\n    let uploadState = UPLOAD_UPLOADING;\n\n    if (resumableFile.error) {\n      uploadState = UPLOAD_ERROR;\n    } else {\n      if (resumableFile.remainingTime === 0 && !resumableFile.isSaved) {\n        uploadState = UPLOAD_ISSAVING;\n      }\n\n      if (resumableFile.isSaved) {\n        uploadState = UPLOAD_UPLOADED;\n      }\n    }\n\n    this.setState({uploadState: uploadState});\n  }\n\n  onUploadCancel = (e) => {\n    e.preventDefault();\n    this.props.onUploadCancel(this.props.resumableFile);\n  }\n\n  onUploadRetry = (e) => {\n    e.preventDefault();\n    this.props.onUploadRetry(this.props.resumableFile);\n  }\n\n  formatFileSize = (size) => {\n    if (typeof size !== 'number') {\n      return '';\n    }\n    if (size >= 1000 * 1000 * 1000) {\n      return (size / (1000 * 1000 * 1000)).toFixed(1) + ' G';\n    }\n    if (size >= 1000 * 1000) {\n      return (size / (1000 * 1000)).toFixed(1) + ' M';\n    }\n    if (size >= 1000) {\n      return (size / 1000).toFixed(1) + ' K';\n    }\n    return size.toFixed(1) + ' B';\n  }\n\n  render() {\n    let { resumableFile } = this.props;\n    let progress = Math.round(resumableFile.progress() * 100);\n    let error = resumableFile.error;\n\n    const fileName = resumableFile.newFileName;\n    const size = this.formatFileSize(resumableFile.size);\n\n    return (\n      <tr className=\"file-upload-item\">\n        <td className=\"upload-name\">\n          <div className=\"ellipsis\" title={fileName}>{fileName}</div>\n        </td>\n        <td className=\"ellipsis\">\n          <span className=\"file-size\" title={size}>{size}</span>\n        </td>\n        <td className=\"upload-progress ellipsis\">\n          {(this.state.uploadState === UPLOAD_UPLOADING || this.state.uploadState === UPLOAD_ISSAVING) &&\n            <Fragment>\n              {resumableFile.size >= (100 * 1000 * 1000) &&\n                <Fragment>\n                  {resumableFile.isUploading() && (\n                    <div className=\"progress-container\">\n                      <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                      </div>\n                      {(resumableFile.remainingTime === -1) && <div className=\"progress-text\">{gettext('Preparing to upload...')}</div>}\n                      {(resumableFile.remainingTime > 0) && <div className=\"progress-text\">{gettext('Remaining')}{' '}{Utils.formatTime(resumableFile.remainingTime)}</div>}\n                      {(resumableFile.remainingTime === 0) && <div className=\"progress-text\">{gettext('Indexing...')}</div>}\n                    </div>\n                  )}\n                  {!resumableFile.isUploading() && (\n                    <div className=\"progress-container d-flex align-items-center\">\n                      <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                      </div>\n                    </div>\n                  )}\n                </Fragment>\n              }\n              {(resumableFile.size < (100 * 1000 * 1000)) &&\n                <div className=\"progress-container d-flex align-items-center\">\n                  <div className=\"progress\">\n                    <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                  </div>\n                </div>\n              }\n            </Fragment>\n          }\n          {this.state.uploadState === UPLOAD_ERROR && (\n            <div className=\"message err-message ml-0\" dangerouslySetInnerHTML={{__html: error}}></div>\n          )}\n        </td>\n        <td className=\"upload-operation ellipsis\">\n          <Fragment>\n            {this.state.uploadState === UPLOAD_UPLOADING && (\n              <a href=\"#\" onClick={this.onUploadCancel}>{gettext('Cancel')}</a>\n            )}\n            {this.state.uploadState === UPLOAD_ERROR && (\n              <a href=\"#\" onClick={this.onUploadRetry}>{gettext('Retry')}</a>\n            )}\n            {this.state.uploadState === UPLOAD_ISSAVING && (\n              <span className=\"saving\">{gettext('Saving...')}</span>\n            )}\n            {this.state.uploadState === UPLOAD_UPLOADED && (\n              <span className=\"uploaded\">{gettext('Uploaded')}</span>\n            )}\n          </Fragment>\n        </td>\n      </tr>\n    );\n  }\n}\n\nUploadListItem.propTypes = propTypes;\n\nexport default UploadListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, maxUploadFileSize } from '../../utils/constants';\n\nconst propTypes = {\n  file: PropTypes.object,\n};\n\nclass ForbidUploadListItem extends React.Component {\n\n  render() {\n    let { file } = this.props;\n    let msg = gettext('Please upload files less than {placeholder}M').replace('{placeholder}', maxUploadFileSize);\n    return (\n      <tr className=\"file-upload-item\">\n        <td className=\"upload-name\">\n          <div className=\"ellipsis\" title={file.name}>{file.name}</div>\n        </td>\n\n        <td colSpan={3} className=\"error\">{msg}</td>\n      </tr>\n    );\n  }\n}\n\nForbidUploadListItem.propTypes = propTypes;\n\nexport default ForbidUploadListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport UploadListItem from './upload-list-item';\nimport ForbidUploadListItem from './forbid-upload-list-item';\n\nconst propTypes = {\n  uploadBitrate: PropTypes.number.isRequired,\n  totalProgress: PropTypes.number.isRequired,\n  retryFileList: PropTypes.array.isRequired,\n  uploadFileList: PropTypes.array.isRequired,\n  forbidUploadFileList: PropTypes.array.isRequired,\n  onCloseUploadDialog: PropTypes.func.isRequired,\n  onCancelAllUploading: PropTypes.func.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n  onUploadRetryAll: PropTypes.func.isRequired,\n  allFilesUploaded: PropTypes.bool.isRequired,\n};\n\nclass UploadProgressDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMinimized: false\n    };\n  }\n\n  onCancelAllUploading = () => {\n    this.props.onCancelAllUploading();\n  }\n\n  onMinimizeUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({isMinimized: !this.state.isMinimized});\n  }\n\n  onCloseUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onCloseUploadDialog();\n  }\n\n  render() {\n\n    let uploadBitrate = Utils.formatBitRate(this.props.uploadBitrate);\n    let uploadedMessage = gettext('File Upload');\n    let uploadingMessage = gettext('File Uploading...') + ' ' + this.props.totalProgress + '% (' + uploadBitrate + ')';\n\n    let uploadingOptions = (<span className=\"sf2-icon-minus\" onClick={this.onMinimizeUpload}></span>);\n\n    let uploadedOptions = (\n      <Fragment>\n        <span className=\"sf2-icon-minus\" onClick={this.onMinimizeUpload}></span>\n        <span className=\"sf2-icon-x1\" onClick={this.onCloseUpload}></span>\n      </Fragment>\n    );\n\n    let { totalProgress, allFilesUploaded, retryFileList } = this.props;\n\n    return (\n      <div className=\"uploader-list-view mw-100\" style={{height: this.state.isMinimized ? '2.25rem' : '20rem'}}>\n        <div className=\"uploader-list-header\">\n          <div className=\"title\">\n            {totalProgress === 100 ? uploadedMessage : uploadingMessage}\n          </div>\n          <div className=\"uploader-options\">\n            {totalProgress === 100 ||  allFilesUploaded ? uploadedOptions : uploadingOptions}\n          </div>\n        </div>\n        <div className=\"uploader-list-content\">\n          <div className=\"text-right mt-2\">\n            {retryFileList.length > 0 ?\n              <span className=\"cursor-pointer\" onClick={this.props.onUploadRetryAll}>{gettext('Retry All')}</span>\n              :\n              <span className=\"cursor-pointer disabled-link\">{gettext('Retry All')}</span>\n            }\n            {!allFilesUploaded ?\n              <span className=\"cursor-pointer ml-3\" onClick={this.onCancelAllUploading}>{gettext('Cancel All')}</span>\n              :\n              <span className=\"cursor-pointer ml-3 disabled-link\" >{gettext('Cancel All')}</span>\n            }\n          </div>\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr>\n                <th width=\"30%\">{gettext('name')}</th>\n                <th width=\"20%\">{gettext('size')}</th>\n                <th width=\"30%\">{gettext('progress')}</th>\n                <th width=\"20%\">{gettext('state')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                this.props.forbidUploadFileList.map((file, index) => {\n                  return (<ForbidUploadListItem key={index} file={file} />);\n                })\n              }\n              {\n                this.props.uploadFileList.map((resumableFile, index) => {\n                  return (\n                    <UploadListItem\n                      key={index}\n                      resumableFile={resumableFile}\n                      onUploadCancel={this.props.onUploadCancel}\n                      onUploadRetry={this.props.onUploadRetry}\n                    />\n                  );\n                })\n              }\n            </tbody>\n          </table>\n        </div>\n      </div>\n    );\n  }\n}\n\nUploadProgressDialog.propTypes = propTypes;\n\nexport default UploadProgressDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\n\nconst propTypes = {\n  currentResumableFile: PropTypes.object.isRequired,\n  replaceRepetitionFile: PropTypes.func.isRequired,\n  uploadFile: PropTypes.func.isRequired,\n  cancelFileUpload: PropTypes.func.isRequired,\n};\n\nclass UploadRemindDialog extends React.Component {\n\n  toggle = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.cancelFileUpload();\n  }\n\n  replaceRepetitionFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.replaceRepetitionFile();\n  }\n\n  uploadFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.uploadFile();\n  }\n\n  render() {\n    const { fileName } = this.props.currentResumableFile;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>\n          <span>{gettext('Replace file {filename}?').replace('{filename}', fileName)}</span>\n        </ModalHeader>\n        <ModalBody>\n          <p>{gettext('A file with the same name already exists in this folder.')}</p>\n          <p>{gettext('Replacing it will overwrite its content.')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.replaceRepetitionFile}>{gettext('Replace')}</Button>\n          <Button color=\"primary\" onClick={this.uploadFile}>{gettext('Don\\'t replace')}</Button>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nUploadRemindDialog.propTypes = propTypes;\n\nexport default UploadRemindDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Resumablejs from '@seafile/resumablejs';\nimport MD5 from 'MD5';\nimport { resumableUploadFileBlockSize, maxUploadFileSize, maxNumberOfFilesForFileupload } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport UploadProgressDialog from './upload-progress-dialog';\nimport UploadRemindDialog from '../dialog/upload-remind-dialog';\nimport toaster from '../toast';\nimport '../../css/file-uploader.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  direntList: PropTypes.array.isRequired,\n  filetypes: PropTypes.array,\n  chunkSize: PropTypes.number,\n  withCredentials: PropTypes.bool,\n  testMethod: PropTypes.string,\n  testChunks: PropTypes.number,\n  simultaneousUploads: PropTypes.number,\n  fileParameterName: PropTypes.string,\n  minFileSizeErrorCallback: PropTypes.func,\n  fileTypeErrorCallback: PropTypes.func,\n  dragAndDrop: PropTypes.bool.isRequired,\n  path: PropTypes.string.isRequired,\n  onFileUploadSuccess: PropTypes.func.isRequired,\n  isCustomPermission: PropTypes.bool,\n};\n\nclass FileUploader extends React.Component {\n\n  static defaultProps = {\n    isCustomPermission: false\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      retryFileList: [],\n      uploadFileList: [],\n      forbidUploadFileList: [],\n      totalProgress: 0,\n      isUploadProgressDialogShow: false,\n      isUploadRemindDialogShow: false,\n      currentResumableFile: null,\n      uploadBitrate: 0,\n      allFilesUploaded: false,\n    };\n\n    this.uploadInput = React.createRef();\n\n    this.notifiedFolders = [];\n\n    this.timestamp = null;\n    this.loaded = 0;\n    this.bitrateInterval = 500; // Interval in milliseconds to calculate the bitrate\n    window.onbeforeunload = this.onbeforeunload;\n    this.isUploadLinkLoaded = false;\n  }\n\n  componentDidMount() {\n    this.resumable = new Resumablejs({\n      target: '',\n      query: this.setQuery || {},\n      fileType: this.props.filetypes,\n      maxFiles: maxNumberOfFilesForFileupload || undefined,\n      maxFileSize: maxUploadFileSize * 1000 * 1000 || undefined,\n      testMethod: this.props.testMethod || 'post',\n      testChunks: this.props.testChunks || false,\n      headers: this.setHeaders || {},\n      withCredentials: this.props.withCredentials || false,\n      chunkSize: parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1 * 1024 * 1024,\n      simultaneousUploads: this.props.simultaneousUploads || 1,\n      fileParameterName: this.props.fileParameterName,\n      generateUniqueIdentifier: this.generateUniqueIdentifier,\n      forceChunkSize: true,\n      maxChunkRetries: 3,\n      minFileSize: 0,\n    });\n\n    this.resumable.assignBrowse(this.uploadInput.current, true);\n\n    //Enable or Disable DragAnd Drop\n    if (this.props.dragAndDrop === true) {\n      this.resumable.enableDropOnDocument();\n    }\n\n    this.bindCallbackHandler();\n    this.bindEventHandler();\n  }\n\n  componentWillUnmount = () => {\n    window.onbeforeunload = null;\n    if (this.props.dragAndDrop === true) {\n      this.resumable.disableDropOnDocument();\n    }\n  }\n\n  onbeforeunload = () => {\n    if (window.uploader &&\n        window.uploader.isUploadProgressDialogShow &&\n        window.uploader.totalProgress !== 100) {\n      return '';\n    }\n  }\n\n  bindCallbackHandler = () => {\n    let { minFileSizeErrorCallback, fileTypeErrorCallback } = this.props;\n\n    if (this.maxFilesErrorCallback) {\n      this.resumable.opts.maxFilesErrorCallback = this.maxFilesErrorCallback;\n    }\n\n    if (minFileSizeErrorCallback) {\n      this.resumable.opts.minFileSizeErrorCallback = this.props.minFileSizeErrorCallback;\n    }\n\n    if (this.maxFileSizeErrorCallback) {\n      this.resumable.opts.maxFileSizeErrorCallback = this.maxFileSizeErrorCallback;\n    }\n\n    if (fileTypeErrorCallback) {\n      this.resumable.opts.fileTypeErrorCallback = this.props.fileTypeErrorCallback;\n    }\n\n  }\n\n  bindEventHandler = () => {\n    this.resumable.on('chunkingComplete', this.onChunkingComplete.bind(this));\n    this.resumable.on('fileAdded', this.onFileAdded.bind(this));\n    this.resumable.on('filesAddedComplete', this.filesAddedComplete.bind(this));\n    this.resumable.on('fileProgress', this.onFileProgress.bind(this));\n    this.resumable.on('fileSuccess', this.onFileUploadSuccess.bind(this));\n    this.resumable.on('progress', this.onProgress.bind(this));\n    this.resumable.on('complete', this.onComplete.bind(this));\n    this.resumable.on('pause', this.onPause.bind(this));\n    this.resumable.on('fileRetry', this.onFileRetry.bind(this));\n    this.resumable.on('fileError', this.onFileError.bind(this));\n    this.resumable.on('error', this.onError.bind(this));\n    this.resumable.on('beforeCancel', this.onBeforeCancel.bind(this));\n    this.resumable.on('cancel', this.onCancel.bind(this));\n    this.resumable.on('dragstart', this.onDragStart.bind(this));\n  }\n\n  maxFilesErrorCallback = (files, errorCount) => {\n    let maxFiles = maxNumberOfFilesForFileupload;\n    let message = gettext('Please upload no more than {maxFiles} files at a time.');\n    message = message.replace('{maxFiles}', maxFiles);\n    toaster.danger(message);\n  }\n\n  maxFileSizeErrorCallback = (file) => {\n    let { forbidUploadFileList } = this.state;\n    forbidUploadFileList.push(file);\n    this.setState({forbidUploadFileList: forbidUploadFileList});\n  }\n\n  onChunkingComplete = (resumableFile) => {\n\n    let allFilesUploaded = this.state.allFilesUploaded;\n    if (allFilesUploaded === true) {\n      this.setState({allFilesUploaded: false});\n    }\n\n    //get parent_dir relative_path\n    let path = this.props.path === '/' ? '/' : this.props.path + '/';\n    let fileName = resumableFile.fileName;\n    let relativePath = resumableFile.relativePath;\n    let isFile = fileName === relativePath;\n\n    //update formdata\n    resumableFile.formData = {};\n    if (isFile) { // upload file\n      resumableFile.formData  = {\n        parent_dir: path,\n      };\n    } else { // upload folder\n      let relative_path = relativePath.slice(0, relativePath.lastIndexOf('/') + 1);\n      resumableFile.formData  = {\n        parent_dir: path,\n        relative_path: relative_path\n      };\n    }\n  }\n\n  onFileAdded = (resumableFile, files) => {\n    const { isCustomPermission } = this.props;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    // uploading is file and only upload one file\n    if (isFile && files.length === 1) {\n      let hasRepetition = false;\n      if (!isCustomPermission) {\n        let direntList = this.props.direntList;\n        for (let i = 0; i < direntList.length; i++) {\n          if (direntList[i].type === 'file' && direntList[i].name === resumableFile.fileName) {\n            hasRepetition = true;\n            break;\n          }\n        }\n      }\n      if (hasRepetition) {\n        this.setState({\n          isUploadRemindDialogShow: true,\n          currentResumableFile: resumableFile,\n        });\n      } else {\n        this.setUploadFileList(this.resumable.files);\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumableUpload(resumableFile);\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      this.setUploadFileList(this.resumable.files);\n      if (!this.isUploadLinkLoaded) {\n        this.isUploadLinkLoaded = true;\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumable.upload();\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    }\n  }\n\n  resumableUpload = (resumableFile) => {\n    let { repoID, path } = this.props;\n    seafileAPI.getFileUploadedBytes(repoID, path, resumableFile.fileName).then(res => {\n      let uploadedBytes = res.data.uploadedBytes;\n      let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n      let offset = Math.floor(uploadedBytes / blockSize);\n      resumableFile.markChunksCompleted(offset);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  filesAddedComplete = (resumable, files) => {\n    let { forbidUploadFileList } = this.state;\n    if (forbidUploadFileList.length > 0 && files.length === 0) {\n      this.setState({\n        isUploadProgressDialogShow: true,\n        totalProgress: 100\n      });\n    }\n  }\n\n  setUploadFileList = () => {\n    let uploadFileList = this.resumable.files;\n    this.setState({\n      uploadFileList: uploadFileList,\n      isUploadProgressDialogShow: true,\n    });\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n  }\n\n  onFileProgress = (resumableFile) => {\n    let uploadBitrate = this.getBitrate();\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        if (uploadBitrate) {\n          let lastSize = (item.size - (item.size * item.progress())) * 8;\n          let time = Math.floor(lastSize / uploadBitrate);\n          item.remainingTime = time;\n        }\n      }\n      return item;\n    });\n\n    this.setState({\n      uploadBitrate: uploadBitrate,\n      uploadFileList: uploadFileList\n    });\n  }\n\n  getBitrate = () => {\n    let loaded = 0;\n    let uploadBitrate = 0;\n    let now = new Date().getTime();\n\n    this.resumable.files.forEach(file => {\n      loaded += file.progress() * file.size;\n    });\n\n    if (this.timestamp) {\n      let timeDiff = (now - this.timestamp);\n      if (timeDiff < this.bitrateInterval) {\n        return this.state.uploadBitrate;\n      }\n\n      // 1. Cancel will produce loaded greater than this.loaded\n      // 2. reset can make this.loaded to be 0\n      if (loaded < this.loaded || this.loaded === 0) {\n        this.loaded = loaded; //\n      }\n\n      uploadBitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;\n    }\n\n    this.timestamp = now;\n    this.loaded = loaded;\n\n    return uploadBitrate;\n  }\n\n  onProgress = () => {\n    let progress = Math.round(this.resumable.progress() * 100);\n    this.setState({totalProgress: progress});\n    Utils.registerGlobalVariable('uploader', 'totalProgress', progress);\n  }\n\n  onFileUploadSuccess = (resumableFile, message) => {\n    let formData = resumableFile.formData;\n    let currentTime = new Date().getTime()/1000;\n    message = formData.replace ? message : JSON.parse(message)[0];\n    if (formData.relative_path) { // upload folder\n      let relative_path = formData.relative_path;\n      let dir_name = relative_path.slice(0, relative_path.indexOf('/'));\n      let dirent = {\n        id: message.id,\n        name: dir_name,\n        type: 'dir',\n        mtime: currentTime,\n      };\n\n      // update folders cache\n      let isExist = this.notifiedFolders.some(item => {return item.name === dirent.name;});\n      if (!isExist) {\n        this.notifiedFolders.push(dirent);\n        this.props.onFileUploadSuccess(dirent);\n      }\n\n      // update uploadFileList\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = relative_path + message.name;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    if (formData.replace) { // upload file -- replace exist file\n      let fileName = resumableFile.fileName;\n      let dirent = {\n        id: message,\n        name: fileName,\n        type: 'file',\n        mtime: currentTime\n      };\n      this.props.onFileUploadSuccess(dirent); // this contance: just one file\n\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = fileName;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    // upload file -- add files\n    let dirent = {\n      id: message.id,\n      type: 'file',\n      name: message.name,\n      size: message.size,\n      mtime: currentTime,\n    };\n    this.props.onFileUploadSuccess(dirent); // this contance:  no repetition file\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        item.newFileName = message.name;\n        item.isSaved = true;\n      }\n      return item;\n    });\n    this.setState({uploadFileList: uploadFileList});\n  }\n\n  getFileServerErrorMessage = (key) => {\n    const errorMessage = {\n      'File locked by others.': gettext('File is locked by others.'),       // 403\n      'Invalid filename.': gettext('Invalid filename.'),                    // 440\n      'File already exists.': gettext('File already exists.'),              // 441\n      'File size is too large.': gettext('File size is too large.'),        // 442\n      'Out of quota.': gettext('Out of quota.'),                            // 443\n      'Internal error.': gettext('Internal Server Error'),                  // 500\n    };\n    return errorMessage[key] || key;\n  }\n\n  onFileError = (resumableFile, message) => {\n    let error = '';\n    if (!message) {\n      error = gettext('Network error');\n    } else {\n      // eg: '{\"error\": \"Internal error\" \\n }'\n      let errorMessage = message.replace(/\\n/g, '');\n      errorMessage  = JSON.parse(errorMessage);\n      error = this.getFileServerErrorMessage(errorMessage.error);\n    }\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        this.state.retryFileList.push(item);\n        item.error = error;\n      }\n      return item;\n    });\n\n    this.loaded = 0;  // reset loaded data;\n    this.setState({\n      retryFileList: this.state.retryFileList,\n      uploadFileList: uploadFileList\n    });\n\n  }\n\n  onComplete = () => {\n    this.notifiedFolders = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({allFilesUploaded: true});\n  }\n\n  onPause = () => {\n\n  }\n\n  onError = (message) => {\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    // After the error, the user can switch windows\n    Utils.registerGlobalVariable('uploader', 'totalProgress', 100);\n  }\n\n  onFileRetry = () => {\n    // todo, cancel upload file, uploded again;\n  }\n\n  onBeforeCancel = () => {\n    // todo, giving a pop message ?\n  }\n\n  onCancel = () => {\n\n  }\n\n  setHeaders = (resumableFile, resumable) => {\n    let offset = resumable.offset;\n    let chunkSize = resumable.getOpt('chunkSize');\n    let fileSize = resumableFile.size === 0 ? 1 : resumableFile.size;\n    let startByte = offset !== 0 ? offset * chunkSize : 0;\n    let endByte = Math.min(fileSize, (offset + 1) * chunkSize) - 1;\n\n    if (fileSize - resumable.endByte < chunkSize && !resumable.getOpt('forceChunkSize')) {\n      endByte = fileSize;\n    }\n\n    let headers = {\n      'Accept': 'application/json; text/javascript, */*; q=0.01',\n      'Content-Disposition': 'attachment; filename=\"' + encodeURI(resumableFile.fileName) + '\"',\n      'Content-Range': 'bytes ' + startByte + '-' + endByte + '/' + fileSize,\n    };\n\n    return headers;\n  }\n\n  setQuery = (resumableFile) => {\n    let formData = resumableFile.formData;\n    return formData;\n  }\n\n  generateUniqueIdentifier = (file) => {\n    let relativePath = file.webkitRelativePath||file.relativePath||file.fileName||file.name;\n    return MD5(relativePath + new Date()) + relativePath;\n  }\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n  }\n\n  onFileUpload = () => {\n    this.uploadInput.current.removeAttribute('webkitdirectory');\n\n    this.uploadInput.current.click();\n  }\n\n  onFolderUpload = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n    this.uploadInput.current.click();\n  }\n\n  onDragStart = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n  }\n\n  onCloseUploadDialog = () => {\n    this.loaded = 0;\n    this.resumable.files = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({isUploadProgressDialogShow: false, uploadFileList: [], forbidUploadFileList: []});\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', false);\n  }\n\n  onUploadCancel = (uploadingItem) => {\n\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (item.uniqueIdentifier === uploadingItem.uniqueIdentifier) {\n        item.cancel(); // execute cancel function will delete the file at the same time\n        return false;\n      }\n      return true;\n    });\n\n    if (!this.resumable.isUploading()) {\n      this.setState({\n        totalProgress: '100',\n        allFilesUploaded: true,\n      });\n      this.loaded = 0;\n    }\n\n    this.setState({uploadFileList: uploadFileList});\n  }\n\n  onCancelAllUploading = () => {\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (Math.round(item.progress() !== 1)) {\n        item.cancel();\n        return false;\n      }\n      return true;\n    });\n\n    this.loaded = 0;\n\n    this.setState({\n      allFilesUploaded: true,\n      totalProgress: '100',\n      uploadFileList: uploadFileList\n    });\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n  }\n\n  onUploadRetry = (resumableFile) => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n\n      let retryFileList = this.state.retryFileList.filter(item => {\n        return item.uniqueIdentifier !== resumableFile.uniqueIdentifier;\n      });\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.error = null;\n          this.retryUploadFile(item);\n        }\n        return item;\n      });\n\n      this.setState({\n        retryFileList: retryFileList,\n        uploadFileList: uploadFileList\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUploadRetryAll = () => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.state.retryFileList.forEach(item => {\n        item.error = false;\n        this.retryUploadFile(item);\n      });\n\n      let uploadFileList = this.state.uploadFileList.slice(0);\n      this.setState({\n        retryFileList: [],\n        uploadFileList: uploadFileList\n      });\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  retryUploadFile = (resumableFile) => {\n    let { repoID, path } = this.props;\n    let fileName = resumableFile.fileName;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    if (!isFile) {\n      let relative_path = resumableFile.formData.relative_path;\n      let prefix = path === '/' ? (path + relative_path) : (path + '/' + relative_path);\n      fileName = prefix + fileName;\n    }\n\n    resumableFile.bootstrap();\n    var firedRetry = false;\n    resumableFile.resumableObj.on('chunkingComplete', () => {\n      if(!firedRetry) {\n        seafileAPI.getFileUploadedBytes(repoID, path, fileName).then(res => {\n          let uploadedBytes = res.data.uploadedBytes;\n          let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n          let offset = Math.floor(uploadedBytes / blockSize);\n          resumableFile.markChunksCompleted(offset);\n\n          resumableFile.resumableObj.upload();\n\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      firedRetry = true;\n    });\n\n  }\n\n  replaceRepetitionFile = () => {\n    let { repoID, path } = this.props;\n    seafileAPI.getUpdateLink(repoID, path).then(res => {\n      this.resumable.opts.target = res.data;\n\n      let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n      resumableFile.formData['replace'] = 1;\n      resumableFile.formData['target_file'] = resumableFile.formData.parent_dir + resumableFile.fileName;\n      this.setState({isUploadRemindDialogShow: false});\n      this.setUploadFileList(this.resumable.files);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  uploadFile = () => {\n    let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n    let { repoID, path } = this.props;\n    seafileAPI.getFileServerUploadLink(repoID, path).then((res) => {  // get upload link\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.setState({\n        isUploadRemindDialogShow: false,\n        isUploadProgressDialogShow: true,\n        uploadFileList: [...this.state.uploadFileList, resumableFile]\n      }, () => {\n        this.resumable.upload();\n      });\n      Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  cancelFileUpload = () => {\n    this.resumable.files.pop(); //delete latest file；\n    this.setState({isUploadRemindDialogShow: false});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"file-uploader-container\">\n          <div className=\"file-uploader\">\n            <input className=\"upload-input\" type=\"file\" ref={this.uploadInput} onClick={this.onClick}/>\n          </div>\n        </div>\n        {this.state.isUploadRemindDialogShow &&\n          <UploadRemindDialog\n            currentResumableFile={this.state.currentResumableFile}\n            replaceRepetitionFile={this.replaceRepetitionFile}\n            uploadFile={this.uploadFile}\n            cancelFileUpload={this.cancelFileUpload}\n          />\n        }\n        {this.state.isUploadProgressDialogShow &&\n          <UploadProgressDialog\n            retryFileList={this.state.retryFileList}\n            uploadFileList={this.state.uploadFileList}\n            forbidUploadFileList={this.state.forbidUploadFileList}\n            totalProgress={this.state.totalProgress}\n            uploadBitrate={this.state.uploadBitrate}\n            allFilesUploaded={this.state.allFilesUploaded}\n            onCloseUploadDialog={this.onCloseUploadDialog}\n            onCancelAllUploading={this.onCancelAllUploading}\n            onUploadCancel={this.onUploadCancel}\n            onUploadRetry={this.onUploadRetry}\n            onUploadRetryAll={this.onUploadRetryAll}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nFileUploader.propTypes = propTypes;\n\nexport default FileUploader;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  deleteFolder: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass DeleteFolderDialog extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      sharedToUserCount: 0,\n      sharedToGroupCount: 0\n    };\n  }\n\n  componentDidMount() {\n    const { repoID, path } = this.props;\n    seafileAPI.getRepoFolderShareInfo(repoID, path).then((res) => {\n      this.setState({\n        sharedToUserCount: res.data['shared_user_emails'].length,\n        sharedToGroupCount: res.data['shared_group_ids'].length\n      });\n    });\n  }\n\n  deleteFolder = () => {\n    this.props.deleteFolder();\n    this.props.toggleDialog();\n  }\n\n  render() {\n    const { sharedToUserCount, sharedToGroupCount } = this.state;\n    const { path, toggleDialog } = this.props;\n    const folderName = Utils.getFileName(path);\n    const opTarget = '<span class=\"op-target\">' + Utils.HTMLescape(folderName) + '</span>';\n    const message = gettext('Are you sure you want to delete %s ?').replace('%s', opTarget);\n\n    let alert_message = '';\n    if (sharedToUserCount > 0 || sharedToGroupCount > 0) {\n      alert_message = gettext('This folder has been shared to {user_amount} user(s) and {group_amount} group(s).')\n        .replace('{user_amount}', sharedToUserCount)\n        .replace('{group_amount}', sharedToGroupCount);\n    }\n\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Delete Folder')}</ModalHeader>\n        <ModalBody>\n          <p dangerouslySetInnerHTML={{__html: message}}></p>\n          {alert_message && <p className=\"error\">{alert_message}</p>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.deleteFolder}>{gettext('Delete')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nDeleteFolderDialog.propTypes = propTypes;\n\nexport default DeleteFolderDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport moment from 'moment';\nimport { navigate } from '@reach/router';\nimport { gettext, siteRoot, username, isDocs, enableVideoThumbnail } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport collabServer from '../../utils/collab-server';\nimport Dirent from '../../models/dirent';\nimport FileTag from '../../models/file-tag';\nimport RepoTag from '../../models/repo-tag';\nimport RepoInfo from '../../models/repo-info';\nimport TreeNode from '../../components/tree-view/tree-node';\nimport treeHelper from '../../components/tree-view/tree-helper';\nimport toaster from '../../components/toast';\nimport ModalPortal from '../../components/modal-portal';\nimport LibDecryptDialog from '../../components/dialog/lib-decrypt-dialog';\nimport LibContentToolbar from './lib-content-toolbar';\nimport LibContentContainer from './lib-content-container';\nimport FileUploader from '../../components/file-uploader/file-uploader';\nimport CopyMoveDirentProgressDialog from '../../components/dialog/copy-move-dirent-progress-dialog';\nimport DeleteFolderDialog from '../../components/dialog/delete-folder-dialog';\n\nconst propTypes = {\n  pathPrefix: PropTypes.array.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  onMenuClick: PropTypes.func.isRequired,\n  repoID: PropTypes.string,\n};\n\nclass LibContentView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentMode: cookie.load('seafile_view_mode') || 'list',\n      path: '',\n      pathExist: true,\n      isViewFile: false,\n      hash: '',\n      currentRepoInfo: null,\n      repoName: '',\n      repoEncrypted: false,\n      libNeedDecrypt: false,\n      isGroupOwnedRepo: false,\n      userPerm: '',\n      selectedDirentList: [],\n      isDraft: false,\n      hasDraft: false,\n      fileTags: [],\n      draftID: '',\n      draftCounts: 0,\n      usedRepoTags: [],\n      readmeMarkdown: null,\n      isTreeDataLoading: true,\n      treeData: treeHelper.buildTree(),\n      currentNode: null,\n      isFileLoading: true,\n      isFileLoadedErr: false,\n      filePermission: '',\n      content: '',\n      lastModified: '',\n      latestContributor: '',\n      isDirentListLoading: true,\n      direntList: [],\n      isDirentSelected: false,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isAllDirentSelected: false,\n      dirID: '',  // for update dir list\n      errorMsg: '',\n      isDirentDetailShow: false,\n      direntDetailPanelTab: '',\n      updateDetail: false,\n      itemsShowLength: 100,\n      isSessionExpired: false,\n      isCopyMoveProgressDialogShow: false,\n      isDeleteFolderDialogOpen: false,\n      asyncCopyMoveTaskId: '',\n      asyncOperationType: 'move',\n      asyncOperationProgress: 0,\n      asyncOperatedFilesLength: 0,\n    };\n\n    this.oldonpopstate = window.onpopstate;\n    window.onpopstate = this.onpopstate;\n    this.lastModifyTime = new Date();\n    this.isNeedUpdateHistoryState = true; // Load, refresh page, switch mode for the first time, no need to set historyState\n    this.currentMoveItemName = '';\n    this.currentMoveItemPath = '';\n  }\n\n  showDirentDetail = (direntDetailPanelTab) => {\n    if (direntDetailPanelTab) {\n      this.setState({ direntDetailPanelTab: direntDetailPanelTab }, () => {\n        this.setState({ isDirentDetailShow: true });\n      });\n    } else {\n      this.setState({\n        direntDetailPanelTab: '',\n        isDirentDetailShow: true\n      });\n    }\n  }\n\n  toggleDirentDetail = () => {\n    this.setState({\n      direntDetailPanelTab: '',\n      isDirentDetailShow: !this.state.isDirentDetailShow\n    });\n  }\n\n  closeDirentDetail = () => {\n    this.setState({\n      isDirentDetailShow: false,\n      direntDetailPanelTab: '',\n    });\n  }\n\n  componentWillMount() {\n    const hash = window.location.hash;\n    if (hash.slice(0, 1) === '#') {\n      this.setState({hash: hash});\n    }\n  }\n\n  async componentDidMount() {\n    // eg: http://127.0.0.1:8000/library/repo_id/repo_name/**/**/\\\n    let repoID = this.props.repoID;\n    let location = window.location.href.split('#')[0];\n    location = decodeURIComponent(location);\n    let path = location.slice(location.indexOf(repoID) + repoID.length + 1); // get the string after repoID\n    path = path.slice(path.indexOf('/')); // get current path\n\n    try {\n      const repoRes = await seafileAPI.getRepoInfo(repoID);\n      const repoInfo = new RepoInfo(repoRes.data);\n      const isGroupOwnedRepo = repoInfo.owner_email.indexOf('@seafile_group') > -1;\n\n      this.setState({\n        currentRepoInfo: repoInfo,\n      });\n\n      if (repoInfo.permission.startsWith('custom-')) {\n        const permissionID = repoInfo.permission.split('-')[1];\n        const permissionRes = await seafileAPI.getCustomPermission(repoID, permissionID);\n        window.custom_permission = permissionRes.data.permission;\n      }\n\n      this.isNeedUpdateHistoryState = false;\n      this.setState({\n        repoName: repoInfo.repo_name,\n        libNeedDecrypt: repoInfo.lib_need_decrypt,\n        repoEncrypted: repoInfo.encrypted,\n        isGroupOwnedRepo: isGroupOwnedRepo,\n        path: path\n      });\n\n      if (!repoInfo.lib_need_decrypt) {\n        this.loadDirData(path);\n      }\n    } catch (error) {\n      if (error.response) {\n        if (error.response.status == 403) {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Permission denied')\n          });\n\n          let errorMsg = gettext('Permission denied');\n          toaster.danger(errorMsg);\n        } else if (error.response.status == 404) {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Library share permission not found.')\n          });\n        } else {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Error')\n          });\n        }\n      } else {\n        this.setState({\n          isDirentListLoading: false,\n          errorMsg: gettext('Please check the network.')\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    window.onpopstate = this.oldonpopstate;\n    collabServer.unwatchRepo(this.props.repoID, this.onRepoUpdateEvent);\n  }\n\n  componentDidUpdate() {\n    this.lastModifyTime = new Date();\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.key) { // root path\n      if (this.state.path === '/') {\n        return;\n      } else {\n        let path = '/';\n        this.loadDirentList(path);\n        this.setState({\n          path: path,\n          isViewFile: false\n        });\n      }\n    } else if (event.state && event.state.path) { // file path\n      let path = event.state.path;\n      if (this.state.currentMode === 'column') {\n        if (Utils.isMarkdownFile(path)) { // Judging not strict\n          this.showFile(path);\n          return;\n        }\n      }\n      this.loadDirentList(path);\n      this.setState({\n        path: path,\n        isViewFile: false\n      });\n    }\n  }\n\n  onRepoUpdateEvent = () => {\n    let currentTime = new Date();\n    if ((parseFloat(currentTime - this.lastModifyTime)/1000) <= 5) {\n      return;\n    }\n    let repoID = this.props.repoID;\n    let { path, dirID } = this.state;\n\n    if (this.state.currentMode === 'column') {\n      if (this.state.isViewFile) {\n        this.updateColumnMarkdownData(path);\n      } else {\n        seafileAPI.dirMetaData(repoID, path).then((res) => {\n          if (res.data.id !== dirID) {\n            this.loadDirentList(path);\n          }\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      seafileAPI.dirMetaData(repoID, path).then((res) => {\n        if (res.data.id !== dirID) {\n          this.loadDirentList(path);\n        }\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  updateUsedRepoTags = () => {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let usedRepoTags = [];\n      res.data.repo_tags.forEach(item => {\n        let usedRepoTag = new RepoTag(item);\n        if (usedRepoTag.fileCount > 0) {\n          usedRepoTags.push(usedRepoTag);\n        }\n      });\n      this.setState({usedRepoTags: usedRepoTags});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  updateReadmeMarkdown = (direntList) => {\n    this.setState({readmeMarkdown: null});\n    direntList.some(item => {\n      let fileName = item.name.toLowerCase();\n      if (fileName === 'readme.md' || fileName === 'readme.markdown') {\n        this.setState({readmeMarkdown: item});\n        return true;\n      }\n    });\n  }\n\n  updateColumnMarkdownData = (filePath) => {\n    let repoID = this.props.repoID;\n    // update state\n    this.setState({\n      path: filePath,\n      isViewFile: true\n    });\n\n    // update data\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      let { mtime, permission, last_modifier_name, is_draft, has_draft, draft_id } = res.data;\n      seafileAPI.getFileDownloadLink(repoID, filePath).then((res) => {\n        seafileAPI.getFileContent(res.data).then((res) => {\n          if (this.state.content !== res.data) {\n            this.setState({isFileLoading: true});\n          }\n          this.setState({\n            content: res.data,\n            filePermission: permission,\n            latestContributor: last_modifier_name,\n            lastModified: moment.unix(mtime).fromNow(),\n            isFileLoading: false,\n            isFileLoadedErr: false,\n            isDraft: is_draft,\n            hasDraft: has_draft,\n            draftID: draft_id\n          });\n        });\n      });\n    }).catch(() => {\n      this.setState({\n        isFileLoading: false,\n        isFileLoadedErr: true,\n      });\n    });\n  }\n\n  // load data\n  loadDirData = (path) => {\n    let repoID = this.props.repoID;\n\n    // listen current repo\n    collabServer.watchRepo(repoID, this.onRepoUpdateEvent);\n\n    // list used FileTags\n    this.updateUsedRepoTags();\n\n    // list draft counts and review counts\n    if (isDocs) {\n      seafileAPI.getRepoDraftCounts(repoID).then(res => {\n        this.setState({\n          draftCounts: res.data.draft_counts,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n\n    if (Utils.isMarkdownFile(path)) {\n      seafileAPI.getFileInfo(this.props.repoID, path).then(() => {\n        if (this.state.currentMode !== 'column') {\n          cookie.save('seafile_view_mode', 'column');\n          this.setState({currentMode: 'column'});\n        }\n        this.loadSidePanel(path);\n        this.showFile(path);\n      }).catch(() => {\n        if (this.state.currentMode === 'column') { // After an error occurs, follow dir\n          this.loadSidePanel(path);\n          this.showDir(path);\n        } else {\n          this.showDir(path);\n        }\n      });\n    } else {\n      if (this.state.currentMode === 'column') {\n        this.loadSidePanel(path);\n        this.showDir(path);\n      } else {\n        this.showDir(path);\n      }\n    }\n  }\n\n  loadSidePanel = (path) => {\n    let repoID = this.props.repoID;\n    if (path === '/') {\n      seafileAPI.listDir(repoID, '/').then(res => {\n        const { dirent_list, user_perm } = res.data;\n        let tree = this.state.treeData;\n        this.addResponseListToNode(dirent_list, tree.root);\n        this.setState({\n          isTreeDataLoading: false,\n          treeData: tree,\n          userPerm: user_perm,\n        });\n      }).catch(() => {\n        this.setState({isTreeDataLoading: false});\n      });\n    } else {\n      this.loadNodeAndParentsByPath(path);\n    }\n  }\n\n  showDir = (path) => {\n    let repoID = this.props.repoID;\n\n    if (!this.state.isSessionExpired) {\n      // update stste\n      this.setState({\n        isDirentListLoading: true,\n        isViewFile: false,\n        selectedDirentList: [],\n      });\n    }\n\n    // update data\n    this.loadDirentList(path);\n    this.resetShowLength();\n\n    if (!this.isNeedUpdateHistoryState) {\n      this.isNeedUpdateHistoryState = true;\n      return;\n    }\n    // update location\n    let repoInfo = this.state.currentRepoInfo;\n    let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(path);\n    window.history.pushState({url: url, path: path}, path, url);\n  }\n\n  showFile = (filePath) => {\n    let repoID = this.props.repoID;\n\n    if (this.state.currentMode === 'column') {\n      seafileAPI.listFileTags(repoID, filePath).then(res => {\n        let fileTags = res.data.file_tags.map(item => {\n          return new FileTag(item);\n        });\n        this.setState({fileTags: fileTags});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n\n    // update state\n    this.setState({\n      isFileLoading: true,\n      path: filePath,\n      isViewFile: true\n    });\n\n    // update data\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      let { mtime, permission, last_modifier_name, is_draft, has_draft, draft_id } = res.data;\n      seafileAPI.getFileDownloadLink(repoID, filePath).then((res) => {\n        seafileAPI.getFileContent(res.data).then((res) => {\n          this.setState({\n            content: res.data,\n            filePermission: permission,\n            latestContributor: last_modifier_name,\n            lastModified: moment.unix(mtime).fromNow(),\n            isFileLoading: false,\n            isFileLoadedErr: false,\n            isDraft: is_draft,\n            hasDraft: has_draft,\n            draftID: draft_id\n          });\n        });\n      });\n    }).catch((err) => {\n      let errMsg = Utils.getErrorMsg(err, true);\n      if (!err.response || err.response.status !== 403) {\n        toaster.danger(errMsg);\n      }\n      this.setState({\n        isFileLoading: false,\n        isFileLoadedErr: true,\n      });\n    });\n\n    // update location\n    let repoInfo = this.state.currentRepoInfo;\n    let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(filePath);\n    window.history.pushState({url: url, path: filePath}, filePath, url);\n  }\n\n  loadDirentList = (path) => {\n    let repoID = this.props.repoID;\n    seafileAPI.listDir(repoID, path, {'with_thumbnail': true}).then(res => {\n      let direntList = [];\n      let markdownItem = null;\n      res.data.dirent_list.forEach(item => {\n        let fileName = item.name.toLowerCase();\n        if (fileName === 'readme.md' || fileName === 'readme.markdown') {\n          markdownItem = item;\n        }\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n\n      this.setState({\n        pathExist: true,\n        userPerm: res.data.user_perm,\n        isDirentListLoading: false,\n        direntList: Utils.sortDirents(direntList, this.state.sortBy, this.state.sortOrder),\n        dirID: res.data.dir_id,\n        readmeMarkdown: markdownItem,\n        path: path,\n        isSessionExpired: false,\n      });\n\n      if (!this.state.repoEncrypted && direntList.length) {\n        this.getThumbnails(repoID, path, this.state.direntList);\n      }\n    }).catch((err) => {\n      Utils.getErrorMsg(err, true);\n      if (err.response && err.response.status === 403) {\n        this.setState({isDirentListLoading: false});\n        return;\n      }\n      this.setState({\n        isDirentListLoading: false,\n        pathExist: false,\n      });\n    });\n  }\n\n  onListContainerScroll = () => {\n    let itemsShowLength = this.state.itemsShowLength + 100;\n    this.setState({itemsShowLength: itemsShowLength});\n  }\n\n  resetShowLength = () => {\n    this.setState({itemsShowLength: 100});\n  }\n\n  getThumbnails = (repoID, path, direntList) => {\n    let items = direntList.filter((item) => {\n      return (Utils.imageCheck(item.name) || (enableVideoThumbnail && Utils.videoCheck(item.name))) && !item.encoded_thumbnail_src;\n    });\n    if (items.length == 0) {\n      return ;\n    }\n\n    const _this = this;\n    const len = items.length;\n    const thumbnailSize = 48;\n    let getThumbnail = (i) => {\n      const curItem = items[i];\n      const curItemPath = [path, curItem.name].join('/');\n      seafileAPI.createThumbnail(repoID, curItemPath, thumbnailSize).then((res) => {\n        curItem.encoded_thumbnail_src = res.data.encoded_thumbnail_src;\n      }).catch((error) => {\n        // do nothing\n      }).then(() => {\n        if (i < len - 1) {\n          getThumbnail(++i);\n        } else {\n          _this.setState({\n            direntList: direntList\n          });\n        }\n      });\n    };\n    getThumbnail(0);\n  }\n\n  updateMoveCopyTreeNode = (path) => {\n    let repoID = this.props.repoID;\n\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n\n    let nodeChildren = node.children.map(item => item.object);\n    let nodeChildrenNames = nodeChildren.map(item => item.name);\n\n    seafileAPI.listDir(repoID, path).then(res => {\n      let newDirentList = res.data.dirent_list;\n      let newAddedDirents = newDirentList.filter(item => {\n        return !nodeChildrenNames.includes(item.name);\n      });\n      newAddedDirents.map(item => {\n        this.addNodeToTree(item.name, path, item.type);\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  async getAsyncCopyMoveProgress() {\n    let { asyncOperationType, asyncCopyMoveTaskId } = this.state;\n    try {\n      let res = await seafileAPI.queryAsyncOperationProgress(asyncCopyMoveTaskId);\n      let data = res.data;\n      if (data.failed) {\n        let message = gettext('Failed to move files to another library.');\n        if (asyncOperationType === 'copy') {\n          message = gettext('Failed to copy files to another library.');\n        }\n        toaster.danger(message);\n        this.setState({\n          asyncOperationProgress: 0,\n          isCopyMoveProgressDialogShow: false,\n        });\n        return;\n      }\n\n      if (data.successful) {\n        if (asyncOperationType === 'move') {\n          if (this.currentMoveItemName && this.currentMoveItemPath) {\n            if (this.state.currentMode === 'column') {\n              this.deleteTreeNode(this.currentMoveItemPath);\n            }\n            this.moveDirent(this.currentMoveItemName);\n            this.currentMoveItemName = '';\n            this.currentMoveItemPath = '';\n          } else {\n            if (this.state.currentMode === 'column') {\n              let direntPaths = this.getSelectedDirentPaths();\n              this.deleteTreeNodes(direntPaths);\n            }\n            let direntNames = this.getSelectedDirentNames();\n            this.moveDirents(direntNames);\n          }\n        }\n\n        this.setState({isCopyMoveProgressDialogShow: false});\n        let message = gettext('Successfully moved files to another library.');\n        if (asyncOperationType === 'copy') {\n          message = gettext('Successfully copied files to another library.');\n        }\n        toaster.success(message);\n        return;\n      }\n      // init state: total is 0\n      let asyncOperationProgress = !data.total ? 0 : parseInt((data.done/data.total * 100).toFixed(2));\n\n      this.getAsyncCopyMoveProgress();\n      this.setState({asyncOperationProgress: asyncOperationProgress});\n    } catch (error) {\n      this.setState({\n        asyncOperationProgress: 0,\n        isCopyMoveProgressDialogShow: false,\n      });\n    }\n  }\n\n  cancelCopyMoveDirent = () => {\n    let taskId = this.state.asyncCopyMoveTaskId;\n    seafileAPI.cancelCopyMoveOperation(taskId);\n\n    this.currentMoveItemName = '';\n    this.currentMoveItemPath = '';\n    let direntList = this.state.direntList;\n    this.setState({direntList: direntList.slice(0)});\n  }\n\n  onMoveProgressDialogToggle = () => {\n    let { asyncOperationProgress } = this.state;\n    if (asyncOperationProgress !== 100) {\n      this.cancelCopyMoveDirent();\n    }\n\n    this.setState({\n      asyncOperationProgress: 0,\n      isCopyMoveProgressDialogShow: false,\n    });\n  }\n\n  // toolbar operations\n  onMoveItems = (destRepo, destDirentPath) => {\n    let repoID = this.props.repoID;\n    let selectedDirentList = this.state.selectedDirentList;\n    if (repoID !== destRepo.repo_id) {\n      this.setState(() => ({\n        asyncOperatedFilesLength: selectedDirentList.length,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'move',\n        isCopyMoveProgressDialogShow: true\n      }));\n    }\n\n    let dirNames = this.getSelectedDirentNames();\n    let direntPaths = this.getSelectedDirentPaths();\n    seafileAPI.moveDir(repoID, destRepo.repo_id, destDirentPath, this.state.path, dirNames).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          // After moving successfully, delete related files\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.deleteTreeNodes(direntPaths);\n        }\n\n        this.moveDirents(dirNames);\n\n        // 2. tow columns mode need update left tree\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(destDirentPath);\n        }\n\n        // show tip message if move to current repo\n        let message =  Utils.getMoveSuccessMessage(dirNames);\n        toaster.success(message);\n      }\n\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = Utils.getMoveFailedMessage(dirNames);\n      }\n      this.setState({\n        asyncOperationProgress: 0,\n        isCopyMoveProgressDialogShow: false,\n      });\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCopyItems = (destRepo, destDirentPath) => {\n    let repoID = this.props.repoID;\n    let selectedDirentList = this.state.selectedDirentList;\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: selectedDirentList.length,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'copy',\n        isCopyMoveProgressDialogShow: true\n      });\n    }\n\n    let dirNames = this.getSelectedDirentNames();\n    seafileAPI.copyDir(repoID, destRepo.repo_id, destDirentPath, this.state.path, dirNames).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(destDirentPath);\n        }\n\n        if (destDirentPath === this.state.path) {\n          this.loadDirentList(this.state.path);\n        }\n\n        // show tip message if copy to current repo\n        let message =  Utils.getCopySuccessfulMessage(dirNames);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = Utils.getCopyFailedMessage(dirNames);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDeleteItems = () => {\n    let repoID = this.props.repoID;\n    let direntPaths = this.getSelectedDirentPaths();\n    let dirNames = this.getSelectedDirentNames();\n\n    this.setState({updateDetail: !this.state.updateDetail});\n    seafileAPI.deleteMutipleDirents(repoID, this.state.path, dirNames).then(res => {\n      if (this.state.currentMode === 'column') {\n        this.deleteTreeNodes(direntPaths);\n      }\n\n      this.deleteDirents(dirNames);\n\n      let msg = '';\n      if (direntPaths.length > 1) {\n        msg = gettext('Successfully deleted {name} and other {n} items.');\n        msg = msg.replace('{name}', dirNames[0]);\n        msg = msg.replace('{n}', dirNames.length - 1);\n      } else {\n        msg = gettext('Successfully deleted {name}.');\n        msg = msg.replace('{name}', dirNames[0]);\n      }\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to delete {name} and other {n} items.');\n        errMessage = errMessage.replace('{name}', dirNames[0]);\n        errMessage = errMessage.replace('{n}', dirNames.length - 1);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onAddFolder = (dirPath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.createDir(repoID, dirPath).then(() => {\n      let name = Utils.getFileName(dirPath);\n      let parentPath = Utils.getDirName(dirPath);\n\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(name, parentPath, 'dir');\n      }\n\n      if (parentPath === this.state.path && !this.state.isViewFile) {\n        this.addDirent(name, 'dir');\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    let repoID = this.props.repoID;\n    seafileAPI.createFile(repoID, filePath, isDraft).then(res => {\n      let name = Utils.getFileName(filePath);\n      let parentPath = Utils.getDirName(filePath);\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(name, parentPath, 'file');\n      }\n      if (parentPath === this.state.path && !this.state.isViewFile) {\n        this.addDirent(name, 'file', res.data.size);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  switchViewMode = (mode) => {\n    if (mode === this.state.currentMode) {\n      return;\n    }\n    if (mode === 'detail') {\n      this.toggleDirentDetail();\n      return;\n    }\n    cookie.save('seafile_view_mode', mode);\n    let path = this.state.path;\n    if (this.state.currentMode === 'column' && this.state.isViewFile) {\n      path = Utils.getDirName(path);\n      this.setState({\n        path: path,\n        isViewFile: false,\n      });\n      let repoInfo = this.state.currentRepoInfo;\n\n      let url = siteRoot + 'library/' + repoInfo.repo_id + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(path);\n      window.history.pushState({url: url, path: path}, path, url);\n    }\n\n    if (mode === 'column') {\n      this.loadSidePanel(this.state.path);\n    }\n    this.isNeedUpdateHistoryState = false;\n    this.setState({currentMode: mode});\n    this.showDir(path);\n  }\n\n  onSearchedClick = (item) => {\n    let path = item.is_dir ? item.path.slice(0, item.path.length - 1) : item.path;\n    if (this.state.currentPath === path) {\n      return;\n    }\n    if (this.state.currentMode === 'column') {\n      // load sidePanel\n      let index = -1;\n      let paths = Utils.getPaths(path);\n      for (let i = 0; i < paths.length; i++) {\n        let node = this.state.treeData.getNodeByPath(node);\n        if (!node) {\n          index = i;\n          break;\n        }\n      }\n      if (index === -1) { // all the data has been loaded already.\n        let node = this.state.treeData.getNodeByPath(path);\n        this.setState({currentNode: node});\n      } else {\n        this.loadNodeAndParentsByPath(path);\n      }\n\n      // load mainPanel\n      if (item.is_dir) {\n        this.showDir(path);\n      } else {\n        if (Utils.isMarkdownFile(path)) {\n          this.showFile(path);\n        } else {\n          let url = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(path);\n          let isWeChat = Utils.isWeChat();\n          if (!isWeChat) {\n            let newWindow = window.open('about:blank');\n            newWindow.location.href = url;\n          } else {\n            location.href = url;\n          }\n        }\n      }\n    } else {\n      if (item.is_dir) {\n        this.showDir(path);\n      } else {\n        let url = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(path);\n        let isWeChat = Utils.isWeChat();\n        if (!isWeChat) {\n          let newWindow = window.open('about:blank');\n          newWindow.location.href = url;\n        } else {\n          location.href = url;\n        }\n      }\n    }\n  }\n\n  onMainNavBarClick = (nodePath) => {\n    //just for dir\n    this.resetSelected();\n    if (this.state.currentMode === 'column') {\n      let tree = this.state.treeData.clone();\n      let node = tree.getNodeByPath(nodePath);\n      tree.expandNode(node);\n      this.setState({treeData: tree, currentNode: node});\n    }\n\n    this.showDir(nodePath);\n  }\n\n  onLinkClick = (link) => {\n    const url = link;\n    let repoID = this.props.repoID;\n    if (Utils.isInternalMarkdownLink(url, repoID)) {\n      let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n      this.showFile(path);\n    } else if (Utils.isInternalDirLink(url, repoID)) {\n      let path = Utils.getPathFromInternalDirLink(url, repoID);\n      this.showDir(path);\n    } else {\n      window.open(url);\n    }\n  }\n\n  // list&tree operations\n  onMainPanelItemRename = (dirent, newName) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    this.renameItem(path, dirent.isDir(), newName);\n  }\n\n  onMainPanelItemDelete = (dirent) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    this.deleteItem(path, dirent.isDir());\n  }\n\n  onRenameTreeNode = (node, newName) => {\n    this.renameItem(node.path, node.object.isDir(), newName);\n  }\n\n  onDeleteTreeNode = (node) => {\n    this.deleteItem(node.path, node.object.isDir());\n  }\n\n  renameItem = (path, isDir, newName) => {\n    let repoID = this.props.repoID;\n    if (isDir) {\n      seafileAPI.renameDir(repoID, path, newName).then(() => {\n        this.renameItemAjaxCallback(path, newName);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Renaming {name} failed').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.renameFile(repoID, path, newName).then(() => {\n        this.renameItemAjaxCallback(path, newName);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Renaming {name} failed').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  renameItemAjaxCallback(path, newName) {\n    if (this.state.currentMode === 'column') {\n      this.renameTreeNode(path, newName);\n    }\n    this.renameDirent(path, newName);\n  }\n\n  toggleDeleteFolderDialog = () => {\n    this.setState({isDeleteFolderDialogOpen: !this.state.isDeleteFolderDialogOpen});\n  }\n\n  deleteFolder = () => {\n    const { repoID } = this.props;\n    const { folderToDelete: path } = this.state;\n    seafileAPI.deleteDir(repoID, path).then(() => {\n      this.deleteItemAjaxCallback(path, true);\n      let name = Utils.getFileName(path);\n      var msg = gettext('Successfully deleted {name}').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = Utils.getFileName(path);\n        errMessage = gettext('Failed to delete {name}').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteItem(path, isDir) {\n    let repoID = this.props.repoID;\n    if (isDir) {\n      this.setState({ folderToDelete: path }, () => {\n        this.toggleDeleteFolderDialog();\n      });\n    } else {\n      seafileAPI.deleteFile(repoID, path).then(() => {\n        this.deleteItemAjaxCallback(path, isDir);\n        let name = Utils.getFileName(path);\n        var msg = gettext('Successfully deleted {name}').replace('{name}', name);\n        toaster.success(msg);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Failed to delete {name}').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  deleteItemAjaxCallback(path) {\n    if (this.state.currentMode === 'column') {\n      this.deleteTreeNode(path);\n    }\n    this.deleteDirent(path);\n  }\n\n  // list operations\n  onMoveItem = (destRepo, dirent, moveToDirentPath, nodeParentPath) => {\n    let repoID = this.props.repoID;\n    //just for view list state\n    let dirName = dirent.name;\n    if (!nodeParentPath) {\n      nodeParentPath = this.state.path;\n    }\n    let direntPath = Utils.joinPath(nodeParentPath, dirName);\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: 1,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'move',\n        isCopyMoveProgressDialogShow: true,\n      });\n    }\n\n    seafileAPI.moveDir(repoID, destRepo.repo_id, moveToDirentPath, nodeParentPath, dirName).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({asyncCopyMoveTaskId: res.data.task_id}, () => {\n          this.currentMoveItemName = dirName;\n          this.currentMoveItemPath = direntPath;\n          this.getAsyncCopyMoveProgress(dirName, direntPath);\n        });\n      }\n\n      if (this.state.currentMode === 'column') {\n        this.deleteTreeNode(direntPath);\n      }\n\n      // 1. move to current repo\n      // 2. tow columns mode need update left tree\n      if (repoID === destRepo.repo_id && this.state.currentMode === 'column') {\n        this.updateMoveCopyTreeNode(moveToDirentPath);\n      }\n\n      this.moveDirent(direntPath, moveToDirentPath);\n\n      // show tip message if move to current repo\n      if (repoID === destRepo.repo_id) {\n        let message = gettext('Successfully moved {name}.');\n        message = message.replace('{name}', dirName);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to move {name}.');\n        errMessage = errMessage.replace('{name}', dirName);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCopyItem = (destRepo, dirent, copyToDirentPath, nodeParentPath) => {\n    let repoID = this.props.repoID;\n    //just for view list state\n    let dirName = dirent.name;\n    if (!nodeParentPath) {\n      nodeParentPath = this.state.path;\n    }\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: 1,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'copy',\n        isCopyMoveProgressDialogShow: true\n      });\n    }\n\n    seafileAPI.copyDir(repoID, destRepo.repo_id, copyToDirentPath, nodeParentPath, dirName).then(res => {\n\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(copyToDirentPath);\n        }\n\n        if (copyToDirentPath === nodeParentPath) {\n          this.loadDirentList(this.state.path);\n        }\n\n        let message = gettext('Successfully copied %(name)s.');\n        message = message.replace('%(name)s', dirName);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to copy %(name)s');\n        errMessage = errMessage.replace('%(name)s', dirName);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDirentClick = (dirent) => {\n    let direntList = this.state.direntList.map(dirent => {\n      dirent.isSelected = false;\n      return dirent;\n    });\n    if (dirent) {\n      // dirent.isSelected = true;\n      this.setState({\n        direntList: direntList,\n        isDirentSelected: true,\n        selectedDirentList: [dirent],\n      });\n    } else {\n      this.setState({\n        direntList: direntList,\n        isDirentSelected: false,\n        selectedDirentList: [],\n      });\n    }\n  }\n\n  onItemClick = (dirent) => {\n    this.resetSelected();\n    let repoID = this.props.repoID;\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (dirent.isDir()) {  // is dir\n      if (this.state.currentMode === 'column') {\n        this.loadTreeNodeByPath(direntPath);\n      }\n      this.showDir(direntPath);\n    } else {  // is file\n      if (this.state.currentMode === 'column' && Utils.isMarkdownFile(direntPath)) {\n        this.showColumnMarkdownFile(direntPath);\n      } else {\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(direntPath);\n\n        let isWeChat = Utils.isWeChat();\n        if (!isWeChat) {\n          window.open(url);\n        } else {\n          location.href = url;\n        }\n      }\n    }\n  }\n\n  onDirentSelected = (dirent) => {\n    let direntList = this.state.direntList.map(item => {\n      if (item.name === dirent.name) {\n        item.isSelected = !item.isSelected;\n      }\n      return item;\n    });\n    let selectedDirentList = direntList.filter(item => {\n      return item.isSelected;\n    });\n\n    if (selectedDirentList.length) {\n      this.setState({isDirentSelected: true});\n      if (selectedDirentList.length === direntList.length) {\n        this.setState({\n          isAllDirentSelected: true,\n          direntList: direntList,\n          selectedDirentList: selectedDirentList,\n        });\n      } else {\n        this.setState({\n          isAllDirentSelected: false,\n          direntList: direntList,\n          selectedDirentList: selectedDirentList\n        });\n      }\n    } else {\n      this.setState({\n        isDirentSelected: false,\n        isAllDirentSelected: false,\n        direntList: direntList,\n        selectedDirentList: []\n      });\n    }\n  }\n\n  onAllDirentSelected = () => {\n    if (this.state.isAllDirentSelected) {\n      let direntList = this.state.direntList.map(item => {\n        item.isSelected = false;\n        return item;\n      });\n      this.setState({\n        isDirentSelected: false,\n        isAllDirentSelected: false,\n        direntList: direntList,\n        selectedDirentList: [],\n      });\n    } else {\n      let direntList = this.state.direntList.map(item => {\n        item.isSelected = true;\n        return item;\n      });\n      this.setState({\n        isDirentSelected: true,\n        isAllDirentSelected: true,\n        direntList: direntList,\n        selectedDirentList: direntList,\n      });\n    }\n  }\n\n  onFileTagChanged = (dirent, direntPath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.listFileTags(repoID, direntPath).then(res => {\n      let fileTags = res.data.file_tags.map(item => {\n        return new FileTag(item);\n      });\n      this.updateDirent(dirent, 'file_tags', fileTags);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n\n    this.updateUsedRepoTags();\n  }\n\n  onFileUploadSuccess = (direntObject) => {\n    let isExist = this.state.direntList.some(item => {\n      return item.name === direntObject.name && item.type === direntObject.type;\n    });\n    if (isExist) {\n      let direntList = this.state.direntList;\n      for (let i = 0; i < direntList.length; i++) {\n        let dirent = direntList[i];\n        if (dirent.name === direntObject.name && dirent.type === direntObject.type) {\n          let mtime = moment.unix(direntObject.mtime).fromNow();\n          this.updateDirent(dirent, 'mtime', mtime);  // todo file size is need update too, api is not return;\n          break;\n        }\n      }\n    } else {\n      // use current dirent parent's permission as it's permission\n      direntObject.permission = this.state.userPerm;\n      let dirent = new Dirent(direntObject);\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(dirent.name, this.state.path, dirent.type);\n      }\n      if (direntObject.type === 'dir') {\n        this.setState({direntList: [dirent, ...this.state.direntList]});\n      } else {\n        this.setState({direntList: [...this.state.direntList, dirent]});\n        this.updateReadmeMarkdown(this.state.direntList);\n      }\n    }\n  }\n\n  addDirent = (name, type, size) => {\n    let item = this.createDirent(name, type, size);\n    let direntList = this.state.direntList;\n    if (type === 'dir') {\n      direntList.unshift(item);\n    } else {\n      // there will be there conditions;\n      // first: direntList.length === 0;\n      // second: all the direntList's items are dir;\n      // third: direntList has dir and file;\n      let length = direntList.length;\n      if (length === 0 || direntList[length - 1].type === 'dir') {\n        direntList.push(item);\n      } else {\n        let index = 0;\n        for (let i = 0; i <= length; i++) {\n          if (direntList[i].type === 'file') {\n            index = i;\n            break;\n          }\n        }\n        direntList.splice(index, 0, item);\n      }\n    }\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  renameDirent = (direntPath, newName) => {\n    let repoID = this.props.repoID;\n    let parentPath = Utils.getDirName(direntPath);\n    let newDirentPath = Utils.joinPath(parentPath, newName);\n    if (direntPath === this.state.path) {\n      // the renamed item is current viewed item\n      // example: direntPath = /A/B/C, state.path = /A/B/C\n\n      this.setState({ path: newDirentPath });\n      let repoInfo = this.state.currentRepoInfo;\n      let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + newDirentPath;\n      window.history.replaceState({ url: url, path: newDirentPath}, newDirentPath, url);\n    } else if (Utils.isChildPath(direntPath, this.state.path)) {\n      // example: direntPath = /A/B/C/D, state.path = /A/B/C\n      let oldName = Utils.getFileName(direntPath);\n      let direntList = this.state.direntList.map(item => {\n        if (item.name === oldName) {\n          item.name = newName;\n        }\n        return item;\n      });\n      this.setState({ direntList: direntList });\n      this.updateReadmeMarkdown(direntList);\n    } else if (Utils.isAncestorPath(direntPath, this.state.path)) {\n      // example: direntPath = /A/B, state.path = /A/B/C\n      let newPath = Utils.renameAncestorPath(this.state.path, direntPath, newDirentPath);\n      this.setState({ path: newPath });\n\n      let repoInfo = this.state.currentRepoInfo;\n      let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + newPath;\n      window.history.replaceState({ url: url, path: newPath}, newPath, url);\n    }\n  }\n\n  deleteDirent(direntPath) {\n    if (direntPath === this.state.path) {\n      // The deleted item is current item\n      let parentPath = Utils.getDirName(direntPath);\n      this.showDir(parentPath);\n    } else if (Utils.isChildPath(direntPath, this.state.path)) {\n      // The deleted item is inside current path\n      let name = Utils.getFileName(direntPath);\n      let direntList = this.state.direntList.filter(item => {\n        return item.name !== name;\n      });\n\n      // Recalculate the state of the selection\n      this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n      this.setState({direntList: direntList});\n      this.updateReadmeMarkdown(direntList);\n    } else if (Utils.isAncestorPath(direntPath, this.state.path)) {\n      // the deleted item is ancester of the current item\n      let parentPath = Utils.getDirName(direntPath);\n      this.showDir(parentPath);\n    }\n    // else do nothing\n  }\n\n  // only one scence: The deleted items are inside current path\n  deleteDirents = (direntNames) => {\n    let direntList = this.state.direntList.filter(item => {\n      return direntNames.indexOf(item.name) === -1;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  moveDirent = (direntPath, moveToDirentPath = null) => {\n    let name = Utils.getFileName(direntPath);\n    if (moveToDirentPath === this.state.path) {\n      this.loadDirentList(this.state.path);\n      return;\n    }\n    let direntList = this.state.direntList.filter(item => {\n      return item.name !== name;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  // only one scence: The moved items are inside current path\n  moveDirents = (direntNames) => {\n    let direntList = this.state.direntList.filter(item => {\n      return direntNames.indexOf(item.name) === -1;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  updateDirent = (dirent, paramKey, paramValue) => {\n    let newDirentList = this.state.direntList.map(item => {\n      if (item.name === dirent.name) {\n        item[paramKey] = paramValue;\n      }\n      return item;\n    });\n    this.setState({direntList: newDirentList});\n  }\n\n  // tree operations\n  loadTreeNodeByPath = (path) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n    if (!node.isLoaded) {\n      seafileAPI.listDir(repoID, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        let parentNode = tree.getNodeByPath(node.parentNode.path);\n        parentNode.isExpanded = true;\n        this.setState({\n          treeData: tree,\n          currentNode: node\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      let parentNode = tree.getNodeByPath(node.parentNode.path);\n      parentNode.isExpanded = true;\n      this.setState({treeData: tree, currentNode: node}); //tree\n    }\n  }\n\n  loadNodeAndParentsByPath = (path) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    if (Utils.isMarkdownFile(path)) {\n      path = Utils.getDirName(path);\n    }\n    seafileAPI.listDir(repoID, path, {with_parents: true}).then(res => {\n      const { dirent_list: direntList, user_perm } = res.data;\n      let results = {};\n      for (let i = 0; i < direntList.length; i++) {\n        let object = direntList[i];\n        let parentDir = object.parent_dir;\n        let key = parentDir === '/' ?  '/' : parentDir.slice(0, parentDir.length - 1);\n        if (!results[key]) {\n          results[key] = [];\n        }\n        results[key].push(object);\n      }\n      for (let key in results) {\n        let node = tree.getNodeByPath(key);\n        if (!node.isLoaded) {\n          this.addResponseListToNode(results[key], node);\n        }\n      }\n      this.setState({\n        isTreeDataLoading: false,\n        treeData: tree,\n        userPerm: user_perm,\n      });\n    }).catch(() => {\n      this.setState({isLoadFailed: true});\n    });\n  }\n\n  onTreeNodeClick = (node) => {\n    this.resetSelected();\n    let repoID = this.props.repoID;\n    if (!this.state.pathExist) {\n      this.setState({pathExist: true});\n    }\n\n    if (node.object.isDir()) {\n      let isLoaded = node.isLoaded;\n      if (!node.isLoaded) {\n        let tree = this.state.treeData.clone();\n        node = tree.getNodeByPath(node.path);\n        seafileAPI.listDir(repoID, node.path).then(res => {\n          this.addResponseListToNode(res.data.dirent_list, node);\n          tree.collapseNode(node);\n          this.setState({treeData: tree});\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      if (isLoaded && node.path === this.state.path) {\n        if (node.isExpanded) {\n          let tree = treeHelper.collapseNode(this.state.treeData, node);\n          this.setState({treeData: tree});\n        } else {\n          let tree = this.state.treeData.clone();\n          node = tree.getNodeByPath(node.path);\n          tree.expandNode(node);\n          this.setState({treeData: tree});\n        }\n      }\n    }\n\n    if (node.path === this.state.path ) {\n      return;\n    }\n\n    if (node.object.isDir()) {  // isDir\n      this.showDir(node.path);\n    } else {\n      if (Utils.isMarkdownFile(node.path)) {\n        if (node.path !== this.state.path) {\n          this.showColumnMarkdownFile(node.path);\n        }\n      } else {\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(node.path);\n        window.open(url);\n      }\n    }\n  }\n\n  showColumnMarkdownFile = (filePath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      if (res.data.size === 0) {\n        // loading of asynchronously obtained data may be blocked\n        const w = window.open('about:blank');\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(filePath);\n        w.location.href = url;\n      } else {\n        this.showFile(filePath);\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onTreeNodeCollapse = (node) => {\n    let tree = treeHelper.collapseNode(this.state.treeData, node);\n    this.setState({treeData: tree});\n  }\n\n  onTreeNodeExpanded = (node) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    node = tree.getNodeByPath(node.path);\n    if (!node.isLoaded) {\n      seafileAPI.listDir(repoID, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        this.setState({treeData: tree});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      tree.expandNode(node);\n      this.setState({treeData: tree});\n    }\n  }\n\n  addNodeToTree = (name, parentPath, type) => {\n    let node = this.createTreeNode(name, type);\n    let tree = treeHelper.addNodeToParentByPath(this.state.treeData, node, parentPath);\n    this.setState({treeData: tree});\n  }\n\n  renameTreeNode = (path, newName) => {\n    let tree = treeHelper.renameNodeByPath(this.state.treeData, path, newName);\n    this.setState({treeData: tree});\n  }\n\n  deleteTreeNode = (path) => {\n    let tree = treeHelper.deleteNodeByPath(this.state.treeData, path);\n    this.setState({treeData: tree});\n  }\n\n  deleteTreeNodes = (paths) => {\n    let tree = treeHelper.deleteNodeListByPaths(this.state.treeData, paths);\n    this.setState({treeData: tree});\n  }\n\n  moveTreeNode = (nodePath, moveToPath, moveToRepo, nodeName) => {\n    let repoID = this.props.repoID;\n    if (repoID !== moveToRepo.repo_id) {\n      let tree = treeHelper.deleteNodeByPath(this.state.treeData, nodePath);\n      this.setState({treeData: tree});\n      return;\n    }\n    let tree = treeHelper.moveNodeByPath(this.state.treeData, nodePath, moveToPath, nodeName);\n    this.setState({treeData: tree});\n  }\n\n  copyTreeNode = (nodePath, copyToPath, destRepo, nodeName) => {\n    let repoID = this.props.repoID;\n    if (repoID !== destRepo.repo_id) {\n      return;\n    }\n    let tree = treeHelper.copyNodeByPath(this.state.treeData, nodePath, copyToPath, nodeName);\n    this.setState({treeData: tree});\n  }\n\n  createTreeNode(name, type) {\n    let object = this.createDirent(name, type);\n    return new TreeNode({object});\n  }\n\n  createDirent(name, type, size) {\n    // use current dirent parent's permission as it's permission\n    const { userPerm: permission } = this.state;\n    let mtime = new Date().getTime()/1000;\n    let dirent = new Dirent({name, type, mtime, size, permission});\n    return dirent;\n  }\n\n  addResponseListToNode = (list, node) => {\n    node.isLoaded = true;\n    node.isExpanded = true;\n    let direntList = list.map(item => {\n      return new Dirent(item);\n    });\n    direntList = Utils.sortDirents(direntList, 'name', 'asc');\n\n    let nodeList = direntList.map(object => {\n      return new TreeNode({object});\n    });\n    node.addChildren(nodeList);\n  }\n\n  getSelectedDirentPaths = () => {\n    let paths = [];\n    this.state.selectedDirentList.forEach(selectedDirent => {\n      paths.push(Utils.joinPath(this.state.path, selectedDirent.name));\n    });\n    return paths;\n  }\n\n  getSelectedDirentNames = () => {\n    let names = [];\n    this.state.selectedDirentList.forEach(selectedDirent => {\n      names.push(selectedDirent.name);\n    });\n    return names;\n  }\n\n  resetSelected = () => {\n    this.setState({\n      isDirentSelected: false,\n      isAllDirentSelected: false,\n    });\n  }\n\n  recaculateSelectedStateAfterDirentDeleted = (name, newDirentList) => {\n    let selectedDirentList = this.state.selectedDirentList.slice(0);\n    if (selectedDirentList.length > 0) {\n      selectedDirentList = selectedDirentList.filter(item => {\n        return item.name !== name;\n      });\n    }\n    this.setState({\n      selectedDirentList: selectedDirentList,\n      isDirentSelected: selectedDirentList.length > 0,\n      isAllDirentSelected: selectedDirentList.length === newDirentList.length,\n    });\n  }\n\n  onLibDecryptDialog = () => {\n    this.setState({libNeedDecrypt: false});\n    this.loadDirData(this.state.path);\n  }\n\n  goDraftPage = () => {\n    window.open(siteRoot + 'drafts/' + this.state.draftID + '/');\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortDirents(this.state.direntList, sortBy, sortOrder)\n    });\n  }\n\n  onUploadFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.uploader.onFileUpload();\n  }\n\n  onUploadFolder = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.uploader.onFolderUpload();\n  }\n\n  onToolbarFileTagChanged = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.state.path;\n    seafileAPI.listFileTags(repoID, filePath).then(res => {\n      let fileTags = res.data.file_tags.map(item => {\n        return new FileTag(item);\n      });\n\n      this.setState({fileTags: fileTags});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unSelectDirent = () => {\n    this.setState({\n      isDirentSelected: false,\n      selectedDirentList: []\n    });\n    const dirent = {};\n    this.onDirentSelected(dirent);\n  }\n\n  onDeleteRepoTag = (deletedTagID) => {\n    let direntList = this.state.direntList.map(dirent => {\n      if (dirent.file_tags) {\n        let fileTags = dirent.file_tags.filter(item => {\n          return item.repo_tag_id !== deletedTagID;\n        });\n        dirent.file_tags = fileTags;\n      }\n      return dirent;\n    });\n    this.setState({direntList: direntList});\n    this.updateUsedRepoTags();\n  }\n\n\n  handleSubmit = (e) => {\n    let options = {\n      'share_type': 'personal',\n      'from': this.state.currentRepoInfo.owner_email\n    };\n    seafileAPI.leaveShareRepo(this.props.repoID, options).then(res => {\n      navigate(siteRoot + 'shared-libs/');\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error, true);\n      toaster.danger(errorMsg);\n    });\n\n    e.preventDefault();\n  }\n\n  render() {\n    if (this.state.libNeedDecrypt) {\n      return (\n        <ModalPortal>\n          <LibDecryptDialog\n            repoID={this.props.repoID}\n            onLibDecryptDialog={this.onLibDecryptDialog}\n          />\n        </ModalPortal>\n      );\n    }\n\n    if (this.state.errorMsg) {\n      return (\n        <Fragment>\n          <p className=\"error mt-6 text-center\">{this.state.errorMsg}</p>\n          <button type=\"submit\" className=\"btn btn-primary submit\" onClick={this.handleSubmit}>{gettext('Leave Share')}</button>\n        </Fragment>\n      );\n    }\n\n    if (!this.state.currentRepoInfo) {\n      return '';\n    }\n\n    let enableDirPrivateShare = false;\n    let { currentRepoInfo, userPerm, isCopyMoveProgressDialogShow, isDeleteFolderDialogOpen } = this.state;\n    let showShareBtn = Utils.isHasPermissionToShare(currentRepoInfo, userPerm);\n    let isRepoOwner = currentRepoInfo.owner_email === username;\n    let isVirtual = currentRepoInfo.is_virtual;\n    let isAdmin = currentRepoInfo.is_admin;\n    if (!isVirtual && (isRepoOwner || isAdmin)) {\n      enableDirPrivateShare = true;\n    }\n    let direntItemsList = this.state.direntList.filter((item, index) => {\n      return index < this.state.itemsShowLength;\n    });\n\n    let canUpload = true;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { upload } = customPermission.permission;\n      canUpload = upload;\n    }\n\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <LibContentToolbar\n            isViewFile={this.state.isViewFile}\n            filePermission={this.state.filePermission}\n            isDraft={this.state.isDraft}\n            hasDraft={this.state.hasDraft}\n            fileTags={this.state.fileTags}\n            onFileTagChanged={this.onToolbarFileTagChanged}\n            onSideNavMenuClick={this.props.onMenuClick}\n            repoID={this.props.repoID}\n            path={this.state.path}\n            isDirentSelected={this.state.isDirentSelected}\n            selectedDirentList={this.state.selectedDirentList}\n            onItemsMove={this.onMoveItems}\n            onItemsCopy={this.onCopyItems}\n            onItemsDelete={this.onDeleteItems}\n            onItemRename={this.onMainPanelItemRename}\n            direntList={this.state.direntList}\n            repoName={this.state.repoName}\n            repoEncrypted={this.state.repoEncrypted}\n            isGroupOwnedRepo={this.state.isGroupOwnedRepo}\n            userPerm={this.state.userPerm}\n            showShareBtn={showShareBtn}\n            enableDirPrivateShare={enableDirPrivateShare}\n            onAddFile={this.onAddFile}\n            onAddFolder={this.onAddFolder}\n            onUploadFile={this.onUploadFile}\n            onUploadFolder={this.onUploadFolder}\n            currentMode={this.state.currentMode}\n            switchViewMode={this.switchViewMode}\n            onSearchedClick={this.onSearchedClick}\n            isRepoOwner={isRepoOwner}\n            currentRepoInfo={this.state.currentRepoInfo}\n            updateDirent={this.updateDirent}\n            onDirentSelected={this.onDirentSelected}\n            showDirentDetail={this.showDirentDetail}\n            unSelectDirent={this.unSelectDirent}\n            onFilesTagChanged={this.onFileTagChanged}\n          />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <LibContentContainer\n            pathPrefix={this.props.pathPrefix}\n            currentMode={this.state.currentMode}\n            path={this.state.path}\n            pathExist={this.state.pathExist}\n            currentRepoInfo={this.state.currentRepoInfo}\n            repoID={this.props.repoID}\n            enableDirPrivateShare={enableDirPrivateShare}\n            userPerm={userPerm}\n            isGroupOwnedRepo={this.state.isGroupOwnedRepo}\n            onTabNavClick={this.props.onTabNavClick}\n            onMainNavBarClick={this.onMainNavBarClick}\n            isViewFile={this.state.isViewFile}\n            hash={this.state.hash}\n            isDraft={this.state.isDraft}\n            hasDraft={this.state.hasDraft}\n            fileTags={this.state.fileTags}\n            goDraftPage={this.goDraftPage}\n            isFileLoading={this.state.isFileLoading}\n            isFileLoadedErr={this.state.isFileLoadedErr}\n            filePermission={this.state.filePermission}\n            content={this.state.content}\n            lastModified={this.state.lastModified}\n            latestContributor={this.state.latestContributor}\n            onLinkClick={this.onLinkClick}\n            isTreeDataLoading={this.state.isTreeDataLoading}\n            treeData={this.state.treeData}\n            currentNode={this.state.currentNode}\n            onNodeClick={this.onTreeNodeClick}\n            onNodeCollapse={this.onTreeNodeCollapse}\n            onNodeExpanded={this.onTreeNodeExpanded}\n            onAddFolderNode={this.onAddFolder}\n            onAddFileNode={this.onAddFile}\n            onRenameNode={this.onRenameTreeNode}\n            onDeleteNode={this.onDeleteTreeNode}\n            draftCounts={this.state.draftCounts}\n            usedRepoTags={this.state.usedRepoTags}\n            readmeMarkdown={this.state.readmeMarkdown}\n            updateUsedRepoTags={this.updateUsedRepoTags}\n            isDirentListLoading={this.state.isDirentListLoading}\n            direntList={direntItemsList}\n            fullDirentList={this.state.direntList}\n            sortBy={this.state.sortBy}\n            sortOrder={this.state.sortOrder}\n            sortItems={this.sortItems}\n            updateDirent={this.updateDirent}\n            onDirentClick={this.onDirentClick}\n            onItemClick={this.onItemClick}\n            onItemSelected={this.onDirentSelected}\n            onItemDelete={this.onMainPanelItemDelete}\n            onItemRename={this.onMainPanelItemRename}\n            onItemMove={this.onMoveItem}\n            onItemCopy={this.onCopyItem}\n            onAddFolder={this.onAddFolder}\n            onAddFile={this.onAddFile}\n            onFileTagChanged={this.onFileTagChanged}\n            isDirentSelected={this.state.isDirentSelected}\n            isAllDirentSelected={this.state.isAllDirentSelected}\n            onAllDirentSelected={this.onAllDirentSelected}\n            isDirentDetailShow={this.state.isDirentDetailShow}\n            selectedDirent={this.state.selectedDirentList && this.state.selectedDirentList[0]}\n            selectedDirentList={this.state.selectedDirentList}\n            onItemsMove={this.onMoveItems}\n            onItemsCopy={this.onCopyItems}\n            onItemsDelete={this.onDeleteItems}\n            closeDirentDetail={this.closeDirentDetail}\n            showDirentDetail={this.showDirentDetail}\n            direntDetailPanelTab={this.state.direntDetailPanelTab}\n            onDeleteRepoTag={this.onDeleteRepoTag}\n            onToolbarFileTagChanged={this.onToolbarFileTagChanged}\n            updateDetail={this.state.updateDetail}\n            onListContainerScroll={this.onListContainerScroll}\n            loadDirentList={this.loadDirentList}\n          />\n          {canUpload && this.state.pathExist && !this.state.isViewFile && (\n            <FileUploader\n              ref={uploader => this.uploader = uploader}\n              dragAndDrop={true}\n              path={this.state.path}\n              repoID={this.props.repoID}\n              direntList={this.state.direntList}\n              onFileUploadSuccess={this.onFileUploadSuccess}\n              isCustomPermission={isCustomPermission}\n            />\n          )}\n        </div>\n        {isCopyMoveProgressDialogShow && (\n          <CopyMoveDirentProgressDialog\n            type={this.state.asyncOperationType}\n            asyncOperatedFilesLength={this.state.asyncOperatedFilesLength}\n            asyncOperationProgress={this.state.asyncOperationProgress}\n            toggleDialog={this.onMoveProgressDialogToggle}\n          />\n        )}\n        {isDeleteFolderDialogOpen && (\n          <DeleteFolderDialog\n            repoID={this.props.repoID}\n            path={this.state.folderToDelete}\n            deleteFolder={this.deleteFolder}\n            toggleDialog={this.toggleDeleteFolderDialog}\n          />\n        )}\n      </Fragment>\n    );\n  }\n}\n\nLibContentView.propTypes = propTypes;\n\nexport default LibContentView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nclass DismissGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  dismissGroup = () => {\n    let that = this;\n    seafileAPI.deleteGroup(this.props.groupID).then((res)=> {\n      that.props.onGroupChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showDismissGroupDialog} toggle={this.props.toggleDismissGroupDialog}>\n        <ModalHeader>{gettext('Delete Group')}</ModalHeader>\n        <ModalBody>\n          <span>{gettext('Really want to delete this group?')}</span>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDismissGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.dismissGroup}>{gettext('Delete')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst DismissGroupDialogPropTypes = {\n  showDismissGroupDialog: PropTypes.bool.isRequired,\n  toggleDismissGroupDialog: PropTypes.func.isRequired,\n  loadGroup: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n};\n\nDismissGroupDialog.propTypes = DismissGroupDialogPropTypes;\n\nexport default DismissGroupDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, maxFileName } from '../../utils/constants';\n\nconst propTypes = {\n  onCreateRepo: PropTypes.func.isRequired,\n  onCreateToggle: PropTypes.func.isRequired\n};\n\nclass CreateDepartmentRepoDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      repoName: e.target.value,\n    });\n  }\n\n  handleSubmit = () => {\n    let isValid = this.validateRepoName();\n    if (isValid) {\n      let repo = this.createRepo(this.state.repoName);\n      this.props.onCreateRepo(repo, 'department');\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.onCreateToggle();\n  }\n\n  componentDidMount = () => {\n    this.newInput.focus();\n  }\n\n  validateRepoName = () => {\n    let errMessage = '';\n    let repoName = this.state.repoName.trim();\n    if (!repoName.length) {\n      errMessage = gettext('Name is required');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (repoName.indexOf('/') > -1) {\n      errMessage = gettext('Name should not include \\'/\\'.');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n\n    return true;\n  }\n\n  createRepo = (repoName) => {\n    let repo = { repo_name: repoName };\n    return repo;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Department Library')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"repo-name\">{gettext('Name')}</Label>\n              <Input\n                id=\"repo-name\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={input => {this.newInput = input;}}\n                value={this.state.repoName}\n                onChange={this.handleChange}\n                maxLength={maxFileName}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateDepartmentRepoDialog.propTypes = propTypes;\n\nexport default CreateDepartmentRepoDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\n\nclass RenameGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newGroupName: this.props.currentGroupName,\n      isSubmitBtnActive: false,\n    };\n  }\n\n  handleGroupNameChange = (event) => {\n    if (!event.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    let name = event.target.value;\n    this.setState({\n      newGroupName: name\n    });\n  }\n\n  renameGroup = () => {\n    let name = this.state.newGroupName.trim();\n    if (name) {\n      let that = this;\n      seafileAPI.renameGroup(this.props.groupID, name).then((res)=> {\n        that.props.loadGroup(this.props.groupID);\n        that.props.onGroupChanged(res.data.id);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.setState({\n      newGroupName: '',\n    });\n    this.props.toggleRenameGroupDialog();\n  }\n\n  handleKeyDown = (event) => {\n    if (event.keyCode === 13) {\n      this.renameGroup();\n    }\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showRenameGroupDialog} toggle={this.props.toggleRenameGroupDialog}>\n        <ModalHeader>{gettext('Rename Group')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"newGroupName\">{gettext('Rename group to')}</label>\n          <Input type=\"text\" id=\"newGroupName\" value={this.state.newGroupName}\n            onChange={this.handleGroupNameChange} onKeyDown={this.handleKeyDown}/>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleRenameGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.renameGroup} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst RenameGroupDialogPropTypes = {\n  showRenameGroupDialog: PropTypes.bool.isRequired,\n  toggleRenameGroupDialog: PropTypes.func.isRequired,\n  loadGroup: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  currentGroupName: PropTypes.string.isRequired,\n};\n\nRenameGroupDialog.propTypes = RenameGroupDialogPropTypes;\n\nexport default RenameGroupDialog;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport UserSelect from '../user-select';\nimport { Utils } from '../../utils/utils';\n\nimport '../../css/transfer-group-dialog.css';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  toggleTransferGroupDialog: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired\n};\n\nclass TransferGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedOption: null,\n      errMessage: '',\n    };\n    this.options = [];\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({\n      selectedOption: option,\n      errMessage: '',\n    });\n    this.options = [];\n  }\n\n  transferGroup = () => {\n    const email = this.state.selectedOption && this.state.selectedOption.email;\n    if (email) {\n      seafileAPI.transferGroup(this.props.groupID, email).then((res) => {\n        this.props.toggleTransferGroupDialog();\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        this.setState({errMessage: errMessage});\n      });\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleTransferGroupDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Transfer Group')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Transfer group to')}</p>\n          <UserSelect\n            ref=\"userSelect\"\n            isMulti={false}\n            className=\"reviewer-select\"\n            placeholder={gettext('Please enter 1 or more character')}\n            onSelectChange={this.handleSelectChange}\n          />\n          <div className=\"error\">{this.state.errMessage}</div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n          <Button color=\"primary\" onClick={this.transferGroup}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nTransferGroupDialog.propTypes = propTypes;\n\nexport default TransferGroupDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Alert, Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext, siteRoot, groupImportMembersExtraMsg } from '../../utils/constants';\n\nconst propTypes = {\n  toggleImportMembersDialog: PropTypes.func.isRequired,\n  importMembersInBatch: PropTypes.func.isRequired,\n};\n\nclass ImportMembersDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.fileInputRef = React.createRef();\n    this.state = {\n      errorMsg: ''\n    };\n  }\n\n  toggle = () => {\n    this.props.toggleImportMembersDialog();\n  }\n\n  openFileInput = () => {\n    this.fileInputRef.current.click();\n  }\n\n  uploadFile = (e) => {\n    // no file selected\n    if (!this.fileInputRef.current.files.length) {\n      return;\n    }\n    // check file extension\n    let fileName = this.fileInputRef.current.files[0].name;\n    if(fileName.substr(fileName.lastIndexOf('.') + 1) != 'xlsx') {\n      this.setState({\n        errorMsg: gettext('Please choose a .xlsx file.')\n      });\n      return;\n    }\n    const file = this.fileInputRef.current.files[0];\n    this.props.importMembersInBatch(file);\n    this.toggle();\n  }\n\n  render() {\n    let { errorMsg } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Import members from a .xlsx file')}</ModalHeader>\n\n        <ModalBody>\n          <p>{groupImportMembersExtraMsg}</p>\n          <p><a className=\"text-secondary small\" href={`${siteRoot}api/v2.1/group-members-import-example/`}>{gettext('Download an example file')}</a></p>\n          <button className=\"btn btn-outline-primary\" onClick={this.openFileInput}>{gettext('Upload file')}</button>\n          <input className=\"d-none\" type=\"file\" onChange={this.uploadFile} ref={this.fileInputRef} />\n          {errorMsg && <Alert color=\"danger\">{errorMsg}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nImportMembersDialog.propTypes = propTypes;\n\nexport default ImportMembersDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Table } from 'reactstrap';\nimport { Utils } from '../utils/utils';\nimport { gettext } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport RoleEditor from './select-editor/role-editor';\nimport toaster from './toast';\nimport OpIcon from './op-icon';\n\nconst propTypes = {\n  groupMembers: PropTypes.array.isRequired,\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  toggleItemFreezed: PropTypes.func.isRequired,\n  changeMember: PropTypes.func.isRequired,\n  deleteMember: PropTypes.func.isRequired\n};\n\nclass GroupMembers extends React.Component {\n\n  render() {\n    const { groupMembers, changeMember, deleteMember, groupID, isOwner, isItemFreezed, toggleItemFreezed } = this.props;\n    return (\n      <Table size=\"sm\" className=\"manage-members-table\">\n        <thead>\n          <tr>\n            <th width=\"15%\"></th>\n            <th width=\"45%\">{gettext('Name')}</th>\n            <th width=\"30%\">{gettext('Role')}</th>\n            <th width=\"10%\"></th>\n          </tr>\n        </thead>\n        <tbody>\n          {groupMembers.map((item, index) => {\n            return (\n              <Member\n                key={index}\n                item={item}\n                changeMember={changeMember}\n                deleteMember={deleteMember}\n                groupID={groupID}\n                isOwner={isOwner}\n                isItemFreezed={isItemFreezed}\n                toggleItemFreezed={toggleItemFreezed}\n              />\n            );\n          })\n          }\n        </tbody>\n      </Table>\n    );\n  }\n}\n\nGroupMembers.propTypes = propTypes;\n\nconst MemberPropTypes = {\n  item: PropTypes.object.isRequired,\n  changeMember: PropTypes.func.isRequired,\n  deleteMember: PropTypes.func.isRequired,\n  toggleItemFreezed: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired\n};\n\nclass Member extends React.PureComponent {\n\n  constructor(props) {\n    super(props);\n    this.roles = ['Admin', 'Member'];\n    this.state = ({\n      highlight: false,\n    });\n  }\n\n  onChangeUserRole = (role) => {\n    let isAdmin = role === 'Admin' ? 'True' : 'False';\n    seafileAPI.setGroupAdmin(this.props.groupID, this.props.item.email, isAdmin).then((res) => {\n      this.props.changeMember(res.data);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteMember = () => {\n    const { item } = this.props;\n    seafileAPI.deleteGroupMember(this.props.groupID, item.email).then((res) => {\n      this.props.deleteMember(item);\n      toaster.success(gettext('Successfully deleted {name}.').replace('{name}', item.name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleMouseOver = () => {\n    if (this.props.isItemFreezed) return;\n    this.setState({\n      highlight: true,\n    });\n  }\n\n  handleMouseLeave = () => {\n    if (this.props.isItemFreezed) return;\n    this.setState({\n      highlight: false,\n    });\n  }\n\n  translateRole = (role) => {\n    if (role === 'Admin') {\n      return gettext('Admin');\n    }\n    else if (role === 'Member') {\n      return gettext('Member');\n    }\n    else if (role === 'Owner') {\n      return gettext('Owner');\n    }\n  }\n\n  render() {\n    const { item, isOwner } = this.props;\n    const deleteAuthority = (item.role !== 'Owner' && isOwner === true) || (item.role === 'Member' && isOwner === false);\n    return(\n      <tr onMouseOver={this.handleMouseOver} onMouseLeave={this.handleMouseLeave} className={this.state.highlight ? 'tr-highlight' : ''} tabIndex=\"0\" onFocus={this.handleMouseOver}>\n        <th scope=\"row\"><img className=\"avatar\" src={item.avatar_url} alt=\"\"/></th>\n        <td>{item.name}</td>\n        <td>\n          {((isOwner === false) || (isOwner === true && item.role === 'Owner')) &&\n            <span className=\"group-admin\">{this.translateRole(item.role)}</span>\n          }\n          {(isOwner === true && item.role !== 'Owner') &&\n            <RoleEditor\n              isTextMode={true}\n              isEditIconShow={this.state.highlight}\n              currentRole={item.role}\n              roles={this.roles}\n              onRoleChanged={this.onChangeUserRole}\n              toggleItemFreezed={this.props.toggleItemFreezed}\n            />\n          }\n        </td>\n        <td>\n          {(deleteAuthority && this.state.highlight) &&\n          <OpIcon\n            className=\"action-icon sf2-icon-x3\"\n            title={gettext('Delete')}\n            op={this.deleteMember}\n          />\n          }\n        </td>\n      </tr>\n    );\n  }\n}\n\nMember.propTypes = MemberPropTypes;\n\n\nexport default GroupMembers;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button } from 'reactstrap';\nimport { Utils } from '../utils/utils';\nimport { gettext } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport UserSelect from './user-select';\nimport toaster from './toast';\nimport Loading from './loading';\nimport GroupMembers from './group-members';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  changeMode: PropTypes.func.isRequired\n};\n\nclass ManageMembersDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true, // first loading\n      isLoadingMore: false,\n      groupMembers: [],\n      page: 1,\n      perPage: 100,\n      hasNextPage: false,\n      selectedOption: null,\n      errMessage: [],\n      isItemFreezed: false\n    };\n  }\n\n  componentDidMount() {\n    this.listGroupMembers(this.state.page);\n  }\n\n  listGroupMembers = (page) => {\n    const { groupID } = this.props;\n    const { perPage, groupMembers } = this.state;\n    seafileAPI.listGroupMembers(groupID, page, perPage).then((res) => {\n      const members = res.data;\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        page: page,\n        hasNextPage: members.length < perPage ? false : true,\n        groupMembers: groupMembers.concat(members)\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        hasNextPage: false\n      });\n    });\n  }\n\n  onSelectChange = (option) => {\n    this.setState({\n      selectedOption: option,\n      errMessage: [],\n    });\n  }\n\n  addGroupMember = () => {\n    let emails = [];\n    for (let i = 0; i < this.state.selectedOption.length; i++) {\n      emails.push(this.state.selectedOption[i].email);\n    }\n    seafileAPI.addGroupMembers(this.props.groupID, emails).then((res) => {\n      const newMembers = res.data.success;\n      this.setState({\n        groupMembers: [].concat(newMembers, this.state.groupMembers),\n        selectedOption: null,\n      });\n      this.refs.userSelect.clearSelect();\n      if (res.data.failed.length > 0) {\n        this.setState({\n          errMessage: res.data.failed\n        });\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleItemFreezed = (isFreezed) => {\n    this.setState({\n      isItemFreezed: isFreezed\n    });\n  }\n\n  handleScroll = (event) => {\n    // isLoadingMore: to avoid repeated request\n    const { page, hasNextPage, isLoadingMore } = this.state;\n    if (hasNextPage && !isLoadingMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.listGroupMembers(page + 1);\n        });\n      }\n    }\n  }\n\n  changeMember = (targetMember) => {\n    this.setState({\n      groupMembers: this.state.groupMembers.map((item) => {\n        if (item.email == targetMember.email) {\n          item = targetMember;\n        }\n        return item;\n      })\n    });\n  }\n\n  deleteMember = (targetMember) => {\n    const groupMembers = this.state.groupMembers;\n    groupMembers.splice(groupMembers.indexOf(targetMember), 1);\n    this.setState({\n      groupMembers: groupMembers\n    });\n  }\n\n  render() {\n    const { isLoading, hasNextPage, groupMembers } = this.state;\n    return (\n      <Fragment>\n        <p className=\"mb-2\">{gettext('Add group member')}</p>\n        <div className='add-members'>\n          <UserSelect\n            placeholder={gettext('Search users...')}\n            onSelectChange={this.onSelectChange}\n            ref=\"userSelect\"\n            isMulti={true}\n            className=\"add-members-select\"\n          />\n          {this.state.selectedOption ?\n            <Button color=\"secondary\" onClick={this.addGroupMember}>{gettext('Submit')}</Button> :\n            <Button color=\"secondary\" disabled>{gettext('Submit')}</Button>\n          }\n        </div>\n        {\n          this.state.errMessage.length > 0 &&\n            this.state.errMessage.map((item, index = 0) => {\n              return (\n                <div className=\"group-error error\" key={index}>{item.error_msg}</div>\n              );\n            })\n        }\n        {groupMembers.length > 10 &&\n          <button className=\"btn btn-secondary btn-block search-group-members-btn text-left border-0\" onClick={this.props.changeMode}>\n            <i className=\"fas fa-search mr-1\" aria-hidden={true}></i>\n            {gettext('Search group members')}\n          </button>\n        }\n        <div className=\"manage-members\" onScroll={this.handleScroll}>\n          {isLoading ? <Loading /> : (\n            <Fragment>\n              <GroupMembers\n                groupMembers={groupMembers}\n                changeMember={this.changeMember}\n                deleteMember={this.deleteMember}\n                groupID={this.props.groupID}\n                isOwner={this.props.isOwner}\n                isItemFreezed={this.state.isItemFreezed}\n                toggleItemFreezed={this.toggleItemFreezed}\n              />\n              {hasNextPage && <Loading />}\n            </Fragment>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nManageMembersDialog.propTypes = propTypes;\n\nexport default ManageMembersDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Input, Button } from 'reactstrap';\nimport { Utils } from '../utils/utils';\nimport { gettext } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport Loading from './loading';\nimport GroupMembers from './group-members';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired\n};\n\nclass SearchGroupMembers extends React.Component {\n\n  // pagination is not needed\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: false,\n      q: '', // query\n      groupMembers: [],\n      errMessage: [],\n      isItemFreezed: false\n    };\n    this.isInit = true;\n  }\n\n  toggleItemFreezed = (isFreezed) => {\n    this.setState({\n      isItemFreezed: isFreezed\n    });\n  }\n\n  changeMember = (targetMember) => {\n    this.setState({\n      groupMembers: this.state.groupMembers.map((item) => {\n        if (item.email == targetMember.email) {\n          item = targetMember;\n        }\n        return item;\n      })\n    });\n  }\n\n  deleteMember = (targetMember) => {\n    const groupMembers = this.state.groupMembers;\n    groupMembers.splice(groupMembers.indexOf(targetMember), 1);\n    this.setState({\n      groupMembers: groupMembers\n    });\n  }\n\n  submit = () => {\n    let { q } = this.state;\n    q = q.trim();\n    if (!q) {\n      return;\n    }\n    this.setState({\n      isLoading: true\n    });\n    seafileAPI.searchGroupMember(this.props.groupID, q).then((res) => {\n      this.isInit = false;\n      this.setState({\n        isLoading: false,\n        groupMembers: res.data,\n        errorMsg: ''\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errMessage\n      });\n    });\n  }\n\n  onInputChange = (e) => {\n    this.setState({\n      q: e.target.value\n    });\n  }\n\n  onInputKeyDown = (e) => {\n    if (e.key == 'Enter') {\n      this.submit();\n    }\n  }\n\n  render() {\n    const { isLoading, q, errorMsg, groupMembers } = this.state;\n    return (\n      <Fragment>\n        <div className=\"d-flex justifiy-content-between\">\n          <Input\n            type=\"text\"\n            id=\"search-member\"\n            className=\"form-control search-members-input mr-2\"\n            value={q}\n            onChange={this.onInputChange}\n            onKeyDown={this.onInputKeyDown}\n          />\n          <Button type=\"button\" color=\"secondary\" className=\"flex-shrink-0\" onClick={this.submit} disabled={!q.trim()}>{gettext('Submit')}</Button>\n        </div>\n        {errorMsg && <p className=\"error\">{errorMsg}</p>}\n        <div className=\"manage-members\">\n          {isLoading ? <Loading /> : (\n            <Fragment>\n              {groupMembers.length === 0 && !this.isInit && <div className=\"mx-2 my-4\">{gettext('No members')}</div>}\n              {groupMembers.length > 0 && (\n                <GroupMembers\n                  groupMembers={groupMembers}\n                  changeMember={this.changeMember}\n                  deleteMember={this.deleteMember}\n                  groupID={this.props.groupID}\n                  isOwner={this.props.isOwner}\n                  isItemFreezed={this.state.isItemFreezed}\n                  toggleItemFreezed={this.toggleItemFreezed}\n                />\n              )}\n            </Fragment>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nSearchGroupMembers.propTypes = propTypes;\n\nexport default SearchGroupMembers;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport ListAndAddGroupMembers from '../list-and-add-group-members';\nimport SearchGroupMembers from '../search-group-members';\n\nimport '../../css/manage-members-dialog.css';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n  toggleManageMembersDialog: PropTypes.func.isRequired\n};\n\nconst MANAGEMENT_MODE= {\n  LIST_AND_ADD: 'list_and_add',\n  SEARCH: 'search'\n};\n\nclass ManageMembersDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentMode: MANAGEMENT_MODE.LIST_AND_ADD\n    };\n  }\n\n  changeMode = () => {\n    this.setState({\n      currentMode: this.state.currentMode == MANAGEMENT_MODE.LIST_AND_ADD ?\n        MANAGEMENT_MODE.SEARCH : MANAGEMENT_MODE.LIST_AND_ADD\n    });\n  }\n\n  render() {\n    const { currentMode } = this.state;\n    const { groupID, isOwner, toggleManageMembersDialog: toggle } = this.props;\n    return (\n      <Modal isOpen={true} toggle={toggle} className=\"group-manage-members-dialog\">\n        <ModalHeader toggle={toggle}>\n          {currentMode == MANAGEMENT_MODE.LIST_AND_ADD ?\n            gettext('Manage group members') : (\n              <Fragment>\n                <button className=\"fa fa-arrow-left back-icon border-0 bg-transparent mr-2 p-0\" onClick={this.changeMode} title={gettext('Back')} aria-label={gettext('Back')}></button>\n                <span>{gettext('Search group members')}</span>\n              </Fragment>\n            )\n          }\n        </ModalHeader>\n        <ModalBody className=\"pb-0\">\n          {currentMode == MANAGEMENT_MODE.LIST_AND_ADD ?\n            <ListAndAddGroupMembers\n              groupID={groupID}\n              isOwner={isOwner}\n              changeMode={this.changeMode}\n            /> :\n            <SearchGroupMembers groupID={groupID} isOwner={isOwner} />\n          }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nManageMembersDialog.propTypes = propTypes;\n\nexport default ManageMembersDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext, username } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nclass LeaveGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  leaveGroup = () => {\n    seafileAPI.quitGroup(this.props.groupID, username).then((res)=> {\n      this.props.onGroupChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return(\n      <Modal isOpen={true} toggle={this.props.toggleLeaveGroupDialog}>\n        <ModalHeader toggle={this.props.toggleLeaveGroupDialog}>{gettext('Leave Group')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Really want to leave this group?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleLeaveGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.leaveGroup}>{gettext('Leave')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst LeaveGroupDialogPropTypes = {\n  toggleLeaveGroupDialog: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n};\n\nLeaveGroupDialog.propTypes = LeaveGroupDialogPropTypes;\n\nexport default LeaveGroupDialog;\n","import React,{ Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport { gettext, siteRoot, username, canAddRepo } from '../../utils/constants';\nimport { Link } from '@reach/router';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport ModalPortal from '../../components/modal-portal';\nimport Group from '../../models/group';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport OpIcon from '../../components/op-icon';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport CreateRepoDialog from '../../components/dialog/create-repo-dialog';\nimport CreateDepartmentRepoDialog from '../../components/dialog/create-department-repo-dialog';\nimport DismissGroupDialog from '../../components/dialog/dismiss-group-dialog';\nimport RenameGroupDialog from '../../components/dialog/rename-group-dialog';\nimport TransferGroupDialog from '../../components/dialog/transfer-group-dialog';\nimport ImportMembersDialog from '../../components/dialog/import-members-dialog';\nimport ManageMembersDialog from '../../components/dialog/manage-members-dialog';\nimport LeaveGroupDialog from '../../components/dialog/leave-group-dialog';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nimport '../../css/group-view.css';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  groupID: PropTypes.string,\n};\n\nclass GroupView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true, // first loading\n      isLoadingMore: false,\n      errMessage: '',\n      emptyTip: null,\n      currentGroup: null,\n      currentRepo: null,\n      isStaff: false,\n      isOwner: false,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false,\n      repoList: [],\n      currentPage: 1,\n      perPage: 50,\n      hasNextPage: false,\n      libraryType: 'group',\n      isCreateRepoDialogShow: false,\n      isDepartmentGroup: false,\n      showGroupDropdown: false,\n      showGroupMembersPopover: false,\n      showRenameGroupDialog: false,\n      showDismissGroupDialog: false,\n      showTransferGroupDialog: false,\n      showImportMembersDialog: false,\n      showManageMembersDialog: false,\n      groupMembers: [],\n      isShowDetails: false,\n      isLeaveGroupDialogOpen: false,\n    };\n  }\n\n  componentDidMount() {\n    let groupID = this.props.groupID;\n    this.loadGroup(groupID);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.groupID !== this.props.groupID) {\n      this.loadGroup(nextProps.groupID);\n    }\n  }\n\n  loadGroup = (groupID) => {\n    seafileAPI.getGroup(groupID).then((res) => {\n      let currentGroup = new Group(res.data);\n      let emptyTip = this.getEmptyTip(currentGroup);\n      let isStaff  = currentGroup.admins.indexOf(username) > -1;  //for item operations\n      let isOwner = currentGroup.owner === username ? true : false;\n      let isDepartmentGroup = currentGroup.parent_group_id !== 0;\n      this.setState({\n        emptyTip: emptyTip,\n        currentGroup: currentGroup,\n        isStaff: isStaff,\n        isDepartmentGroup: isDepartmentGroup,\n        isOwner: isOwner,\n        currentPage: 1,\n        repoList: []  // empty it for the current group\n      }, () => {\n        this.loadRepos(this.state.currentPage);\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errMessage: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  loadRepos = (page) => {\n    const { perPage } = this.state;\n    seafileAPI.listGroupRepos(this.props.groupID, page, perPage).then((res) => {\n      let hasNextPage = true;\n      if (res.data.length < perPage) {\n        hasNextPage = false;\n      }\n      let repoList = this.state.repoList;\n      let newRepoList = res.data.map(item => {\n        let repo = new Repo(item);\n        return repo;\n      });\n      if (newRepoList.length) {\n        repoList = repoList.concat(newRepoList);\n      }\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        currentPage: page,\n        hasNextPage: hasNextPage,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        errMessage: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  getEmptyTip = (currentGroup) => {\n    let emptyTip = null;\n    if (currentGroup) {\n      if (currentGroup.parent_group_id === 0) {\n        emptyTip = (\n          <EmptyTip>\n            <h2>{gettext('No libraries shared with this group')}</h2>\n            <p>{gettext('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in \"My Libraries\". You can also create a new library to be shared with this group by clicking the \"New Library\" button in the menu bar.')}</p>\n          </EmptyTip>\n        );\n      } else {\n        if (currentGroup.admins.indexOf(username) == -1) {  // is a member of this group\n          emptyTip = (\n            <EmptyTip>\n              <h2>{gettext('No libraries')}</h2>\n            </EmptyTip>\n          );\n        } else {\n          emptyTip = (\n            <EmptyTip>\n              <h2>{gettext('No libraries')}</h2>\n              <p>{gettext('You can create libraries by clicking the \"New Library\" button above.')}</p>\n            </EmptyTip>\n          );\n        }\n      }\n    }\n    return emptyTip;\n  }\n\n  onCreateRepoToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  onCreateRepo = (repo, groupOwnerType) => {\n    let groupId = this.props.groupID;\n    if (groupOwnerType && groupOwnerType === 'department') {\n      seafileAPI.createGroupOwnedLibrary(groupId, repo).then(res => { //need modify endpoint api\n        let object = {\n          repo_id: res.data.id,\n          repo_name: res.data.name,\n          owner_name: res.data.group_name,\n          owner_email: res.data.owner,\n          permission: res.data.permission,\n          mtime: res.data.mtime,\n          size: res.data.size,\n          encrypted: res.data.encrypted,\n        };\n        let repo = new Repo(object);\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n\n    } else {\n      seafileAPI.createGroupRepo(groupId, repo).then(res => {\n        let repo = new Repo(res.data);\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.onCreateRepoToggle();\n  }\n\n  onItemDelete = (repo) => {\n    let groupID = this.props.groupID;\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n    this.loadGroup(groupID);\n  }\n\n  addRepoItem = (repo) => {\n    let newRepoList = this.state.repoList.map(item => {return item;});\n    newRepoList.unshift(repo);\n    return newRepoList;\n  }\n\n  onItemUnshare = (repo) => {\n    let group = this.state.currentGroup;\n    seafileAPI.unshareRepoToGroup(repo.repo_id, group.id).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n      this.loadGroup(group.id);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemRename = (repo, newName) => {\n    seafileAPI.renameGroupOwnedLibrary(this.props.groupID, repo.repo_id, newName).then(res => {\n      let repoList = this.state.repoList.map(item => {\n        if (item.repo_id === repo.repo_id) {\n          item.repo_name = newName;\n        }\n        return item;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onTabNavClick = (tabName) => {\n    this.props.onTabNavClick(tabName);\n  }\n\n  toggleGroupDropdown = () => {\n    this.setState({\n      showGroupDropdown: !this.state.showGroupDropdown\n    });\n  }\n\n  toggleDismissGroupDialog = () => {\n    this.setState({\n      showDismissGroupDialog: !this.state.showDismissGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleRenameGroupDialog = () => {\n    this.setState({\n      showRenameGroupDialog: !this.state.showRenameGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleTransferGroupDialog = () => {\n    this.setState({\n      showTransferGroupDialog: !this.state.showTransferGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleImportMembersDialog= () => {\n    this.setState({\n      showImportMembersDialog: !this.state.showImportMembersDialog\n    });\n  }\n\n  importMembersInBatch= (file) => {\n    toaster.notify(gettext('It may take some time, please wait.'));\n    seafileAPI.importGroupMembersViaFile(this.state.currentGroup.id, file).then((res) => {\n      res.data.failed.map(item => {\n        const msg = `${item.email}: ${item.error_msg}`;\n        toaster.danger(msg);\n      });\n    }).catch((error) => {\n      let errMsg = Utils.getErrorMsg(error);\n      toaster.danger(errMsg);\n    });\n  }\n\n  toggleManageMembersDialog = () => {\n    this.setState({\n      showManageMembersDialog: !this.state.showManageMembersDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleLeaveGroupDialog = () => {\n    this.setState({\n      isLeaveGroupDialogOpen: !this.state.isLeaveGroupDialogOpen,\n      showGroupDropdown: false,\n    });\n  }\n\n  listGroupMembers = () => {\n    seafileAPI.listGroupMembers(this.props.groupID).then((res) => {\n      this.setState({\n        groupMembers: res.data\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleGroupMembersPopover = (state) => {\n    if (state === 'open') {\n      this.listGroupMembers();\n      this.setState({\n        showGroupMembersPopover: true\n      });\n    } else {\n      this.setState({\n        showGroupMembersPopover: false\n      });\n    }\n  }\n\n  onItemDetails = (repo) => {\n    this.setState({\n      isShowDetails: true,\n      currentRepo: repo,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: false});\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  translateRole = (role) => {\n    if (role === 'Admin') {\n      return gettext('Admin');\n    }\n    else if (role === 'Member') {\n      return gettext('Member');\n    }\n    else if (role === 'Owner') {\n      return gettext('Owner');\n    }\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  handleScroll = (event) => {\n    // isLoadingMore: to avoid repeated request\n    const { currentPage, hasNextPage, isLoadingMore } = this.state;\n    if (hasNextPage && !isLoadingMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.loadRepos(currentPage + 1);\n        });\n      }\n    }\n  }\n\n  render() {\n    let { errMessage, emptyTip, currentGroup, isDepartmentGroup, isStaff } = this.state;\n    let isShowSettingIcon = false;\n    if (currentGroup) { // group message is loaded\n      if (currentGroup.parent_group_id === 0) {\n        isShowSettingIcon = true;\n      } else {\n        if (currentGroup.admins.indexOf(username) > -1) {\n          isShowSettingIcon = true;\n        }\n      }\n    }\n    let useRate = 0;\n    if (isDepartmentGroup && currentGroup.group_quota) {\n      useRate = currentGroup.group_quota_usage / currentGroup.group_quota * 100 + '%';\n    }\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n            <div className=\"operation\">\n              {((!isDepartmentGroup && canAddRepo) || (isDepartmentGroup && isStaff)) && (\n                Utils.isDesktop() ? (\n                  <button className=\"btn btn-secondary operation-item\" title={gettext('New Library')} onClick={this.onCreateRepoToggle}>\n                    <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Library')}\n                  </button>\n                ) : (\n                  <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Library')} onClick={this.onCreateRepoToggle}></span>\n                )\n              )}\n            </div>\n          </div>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              {currentGroup && (\n                <Fragment>\n                  <div className=\"path-container\">\n                    <Link to={`${siteRoot}groups/`} onClick={() => this.onTabNavClick('groups')}>{gettext('Groups')}</Link>\n                    <span className=\"path-split\">/</span>\n                    <span>{currentGroup.name}</span>\n                    {isDepartmentGroup && (\n                      <Fragment>\n                        <span className=\"department-group-icon fas fa-building\" title={gettext('This is a special group representing a department.')}></span>\n                        {currentGroup.group_quota > 0 &&\n                          <span className=\"department-usage-container\">\n                            <div className=\"department-usage\">\n                              <span id=\"quota-bar\" className=\"department-quota-bar\"><span id=\"quota-usage\" className=\"usage\" style={{width: useRate}}></span></span>\n                              <span className=\"department-quota-info\">{Utils.bytesToSize(currentGroup.group_quota_usage)} / {Utils.bytesToSize(currentGroup.group_quota)}</span>\n                            </div>\n                          </span>\n                        }\n                      </Fragment>\n                    )}\n                  </div>\n                  <div className=\"path-tool\">\n                    { isShowSettingIcon &&\n                    <React.Fragment>\n                      <OpIcon\n                        className=\"sf2-icon-cog1 action-icon group-top-action-icon\"\n                        title={gettext('Settings')}\n                        op={this.toggleGroupDropdown}\n                      />\n                      {this.state.showGroupDropdown &&\n                        <div className=\"sf-popover\" id=\"group-setting-popover\">\n                          <div className=\"sf-popover-hd sf-popover-title\">\n                            <span>{gettext('Settings')}</span>\n                            <a href=\"#\" className=\"sf-popover-close js-close sf2-icon-x1 action-icon\"\n                              role=\"button\"\n                              aria-label={gettext('Close')}\n                              onClick={this.toggleGroupDropdown}></a>\n                          </div>\n                          <div className=\"sf-popover-con\">\n                            {(this.state.isStaff || this.state.isOwner) &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleRenameGroupDialog}>{gettext('Rename')}</a></li>\n                              {\n                                this.state.isOwner &&\n                                <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleTransferGroupDialog} >{gettext('Transfer')}</a></li>\n                              }\n                            </ul>\n                            }\n                            {(this.state.isStaff || this.state.isOwner) &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleImportMembersDialog} >{gettext('Import Members')}</a></li>\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleManageMembersDialog} >{gettext('Manage Members')}</a></li>\n                            </ul>\n                            }\n                            {\n                              this.state.isOwner &&\n                              <ul className=\"sf-popover-list\">\n                                <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleDismissGroupDialog}>{gettext('Delete Group')}</a></li>\n                              </ul>\n                            }\n                            {/* gourp owner only can dissmiss group, admin could not quit, department member could not quit */}\n                            {(!this.state.isOwner && !isDepartmentGroup) &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleLeaveGroupDialog}>{gettext('Leave Group')}</a></li>\n                            </ul>\n                            }\n                          </div>\n                        </div>}\n                    </React.Fragment>\n                    }\n                    <a href=\"#\"\n                      className=\"sf2-icon-user2 action-icon group-top-action-icon\"\n                      title={gettext('Members')} id=\"groupMembers\"\n                      onClick={() => this.toggleGroupMembersPopover('open')}>\n                    </a>\n                    {this.state.showGroupMembersPopover &&\n                    <div className=\"sf-popover\" id=\"group-members-popover\">\n                      <div className=\"sf-popover-hd sf-popover-title group-member-list-header\">\n                        <span>{gettext('Members')}</span>\n                        <a href=\"#\" className=\"sf-popover-close js-close sf2-icon-x1 action-icon\"\n                          onClick={this.toggleGroupMembersPopover}></a>\n                      </div>\n                      <div className=\"sf-popover-con\">\n                        <ul className=\"sf-popover-list group-member-list\">\n                          {this.state.groupMembers.map((item, index) => {\n                            return (\n                              <li key={index}>\n                                <a href=\"#\" className=\"sf-popover-item user-item d-flex\">\n                                  <img src={item.avatar_url} alt=\"\" className=\"group-member-avatar avatar\"/>\n                                  <span className=\"txt-item ellipsis d-flex\">\n                                    <span className=\"group-member-name ellipsis\">{item.name}</span>\n                                    <span className=\"group-member-admin\">{this.translateRole(item.role)}</span>\n                                  </span>\n                                </a>\n                              </li>\n                            );\n                          })}\n                        </ul>\n                      </div>\n                    </div>}\n                    {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n                    {this.state.isSortOptionsDialogOpen &&\n                    <SortOptionsDialog\n                      toggleDialog={this.toggleSortOptionsDialog}\n                      sortBy={this.state.sortBy}\n                      sortOrder={this.state.sortOrder}\n                      sortItems={this.sortItems}\n                    />\n                    }\n                  </div>\n                </Fragment>\n              )}\n            </div>\n            <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && errMessage) && <div className=\"error text-center mt-2\">{errMessage}</div>}\n              {(!this.state.isLoading && this.state.repoList.length === 0) && emptyTip}\n              {(!this.state.isLoading && this.state.repoList.length > 0) &&\n                <SharedRepoListView\n                  repoList={this.state.repoList}\n                  hasNextPage={this.state.hasNextPage}\n                  currentGroup={this.state.currentGroup}\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  sortItems={this.sortItems}\n                  onItemUnshare={this.onItemUnshare}\n                  onItemDelete={this.onItemDelete}\n                  onItemDetails={this.onItemDetails}\n                  onItemRename={this.onItemRename}\n                />\n              }\n            </div>\n          </div>\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail currentRepo={this.state.currentRepo} closeDetails={this.closeDetails}/>\n            </div>\n          )}\n        </div>\n        {this.state.isCreateRepoDialogShow && !this.state.isDepartmentGroup && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.state.libraryType}\n              onCreateToggle={this.onCreateRepoToggle}\n              onCreateRepo={this.onCreateRepo}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateRepoDialogShow && this.state.isDepartmentGroup &&\n          <CreateRepoDialog\n            isAdmin={this.state.isAdmin}\n            onCreateToggle={this.onCreateRepoToggle}\n            onCreateRepo={this.onCreateRepo}\n            libraryType='department'\n          />\n        }\n        {this.state.showRenameGroupDialog &&\n          <RenameGroupDialog\n            showRenameGroupDialog={this.state.showRenameGroupDialog}\n            toggleRenameGroupDialog={this.toggleRenameGroupDialog}\n            loadGroup={this.loadGroup}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n            currentGroupName={currentGroup.name}\n          />\n        }\n        {this.state.showDismissGroupDialog &&\n          <DismissGroupDialog\n            showDismissGroupDialog={this.state.showDismissGroupDialog}\n            toggleDismissGroupDialog={this.toggleDismissGroupDialog}\n            loadGroup={this.loadGroup}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n        {this.state.showTransferGroupDialog &&\n          <TransferGroupDialog\n            toggleTransferGroupDialog={this.toggleTransferGroupDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n        { this.state.showImportMembersDialog &&\n          <ImportMembersDialog\n            toggleImportMembersDialog={this.toggleImportMembersDialog}\n            importMembersInBatch={this.importMembersInBatch}\n          />\n        }\n        {this.state.showManageMembersDialog &&\n          <ManageMembersDialog\n            toggleManageMembersDialog={this.toggleManageMembersDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n            isOwner={this.state.isOwner}\n          />\n        }\n        {this.state.isLeaveGroupDialogOpen &&\n          <LeaveGroupDialog\n            toggleLeaveGroupDialog={this.toggleLeaveGroupDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nGroupView.propTypes = propTypes;\n\nexport default GroupView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport CommonToolbar from './common-toolbar';\nimport { Button } from 'reactstrap';\nimport { gettext, canAddGroup } from '../../utils/constants';\n\nconst propTypes = {\n  searchPlaceholder: PropTypes.string,\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  toggleAddGroupModal: PropTypes.func.isRequired,\n};\n\nclass GroupsToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\"></span>\n          {canAddGroup && (\n            <div className=\"operation\">\n              <MediaQuery query=\"(min-width: 768px)\">\n                <Button color=\"btn btn-secondary operation-item\" onClick={this.props.toggleAddGroupModal}>\n                  <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Group')}\n                </Button>\n              </MediaQuery>\n              <MediaQuery query=\"(max-width: 767.8px)\">\n                <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Group')} onClick={this.props.toggleAddGroupModal}></span>\n              </MediaQuery>\n            </div>\n          )}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick}/>\n      </div>\n    );\n  }\n}\n\nGroupsToolbar.propTypes = propTypes;\n\nexport default GroupsToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nclass CreateGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      groupName: '',\n      errorMsg: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0, 0);\n  }\n\n  handleGroupChange = (event) => {\n    let name = event.target.value;\n\n    if (!name.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n    this.setState({\n      groupName: name\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }\n\n  handleSubmitGroup = () => {\n    let name = this.state.groupName.trim();\n    if (name) {\n      let that = this;\n      seafileAPI.createGroup(name).then((res)=> {\n        that.props.onCreateGroup();\n      }).catch((error) => {\n        let errorMsg = Utils.getErrorMsg(error);\n        this.setState({errorMsg: errorMsg});\n      });\n    } else {\n      this.setState({\n        errorMsg: gettext('Name is required')\n      });\n    }\n    this.setState({\n      groupName: '',\n    });\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      this.handleSubmitGroup();\n      e.preventDefault();\n    }\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showAddGroupModal} toggle={this.props.toggleAddGroupModal}>\n        <ModalHeader toggle={this.props.toggleAddGroupModal}>{gettext('New Group')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"groupName\">{gettext('Name')}</label>\n          <Input\n            innerRef={input => {this.newInput = input;}}\n            type=\"text\"\n            id=\"groupName\"\n            value={this.state.groupName}\n            onChange={this.handleGroupChange}\n            onKeyDown={this.handleKeyDown}\n          />\n          <span className=\"error\">{this.state.errorMsg}</span>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleAddGroupModal}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmitGroup} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst CreateGroupDialogPropTypes = {\n  toggleAddGroupModal: PropTypes.func.isRequired,\n  onCreateGroup: PropTypes.func.isRequired,\n  showAddGroupModal: PropTypes.bool.isRequired,\n};\n\nCreateGroupDialog.propTypes = CreateGroupDialogPropTypes;\n\nexport default CreateGroupDialog;","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, siteRoot, canAddGroup } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Group from '../../models/group';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport GroupsToolbar from '../../components/toolbar/groups-toolbar';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport CreateGroupDialog from '../../components/dialog/create-group-dialog';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport EmptyTip from '../../components/empty-tip';\n\nimport '../../css/groups.css';\n\nconst propTypes = {\n  group: PropTypes.object.isRequired,\n  onItemDetails: PropTypes.func.isRequired,\n};\n\n\nclass RepoListViewPanel extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoList: [],\n    };\n  }\n\n  componentDidMount() {\n    let group = this.props.group;\n    let repoList = group.repos.map(item => {\n      let repo = new Repo(item);\n      return repo;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onItemUnshare = (repo) => {\n    let group = this.props.group;\n    seafileAPI.unshareRepoToGroup(repo.repo_id, group.id).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemDelete = (repo) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onItemRename = (repo, newName) => {\n    let group = this.props.group;\n    seafileAPI.renameGroupOwnedLibrary(group.id, repo.repo_id, newName).then(res => {\n      let repoList = this.state.repoList.map(item => {\n        if (item.repo_id === repo.repo_id) {\n          item.repo_name = newName;\n        }\n        return item;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let group = this.props.group;\n    const emptyTip = <p className=\"group-item-empty-tip\">{gettext('No libraries')}</p>;\n    return (\n      <div className=\"group-list-panel\">\n        <h4 className=\"group-item-heading ellipsis\">\n          <a href={`${siteRoot}group/${group.id}/`} title={group.name}>{group.name}</a>\n        </h4>\n        {this.state.repoList.length === 0 ?\n          emptyTip :\n          <SharedRepoListView\n            isShowTableThread={false}\n            isShowRepoOwner={false}\n            currentGroup={this.props.group}\n            repoList={this.state.repoList}\n            onItemUnshare={this.onItemUnshare}\n            onItemDelete={this.onItemDelete}\n            onItemDetails={this.props.onItemDetails}\n            onItemRename={this.onItemRename}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nRepoListViewPanel.propTypes = propTypes;\n\nclass GroupsView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      groupList: [],\n      showAddGroupModal: false,\n      isShowDetails: false,\n      currentRepo: null,\n    };\n  }\n\n  listGroups = () => {\n    seafileAPI.listGroups(true).then((res) => {\n      // `{'with_repos': 1}`: list repos of every group\n      // res: {data: [...], status: 200, statusText: \"OK\", headers: {…}, config: {…}, …}\n      let groupList = res.data.map(item => {\n        let group = new Group(item);\n        return group;\n      });\n      this.setState({\n        isLoading: false,\n        groupList: groupList.sort((a, b) => {\n          return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        })\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  toggleAddGroupModal = () => {\n    this.setState({\n      showAddGroupModal: !this.state.showAddGroupModal\n    });\n  }\n\n  onCreateGroup = () => {\n    this.setState({\n      showAddGroupModal: false,\n      isLoading: true,\n      groupList: [],\n    });\n    this.listGroups();\n  }\n\n  componentDidMount() {\n    this.listGroups();\n  }\n\n  onItemDetails = (repo) => {\n    this.setState({\n      isShowDetails: true,\n      currentRepo: repo,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: false});\n  }\n\n  render() {\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No groups')}</h2>\n        {canAddGroup ?\n          <p>{gettext('You are not in any groups. Groups allow multiple people to collaborate on libraries. You can create a group by clicking the \"New Group\" button in the menu bar.')}</p> :\n          <p>{gettext('You are not in any groups. Groups allow multiple people to collaborate on libraries. Groups you join will be listed here.')}</p>\n        }\n      </EmptyTip>\n    );\n\n    return (\n      <Fragment>\n        <GroupsToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n          toggleAddGroupModal={this.toggleAddGroupModal}\n        />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('My Groups')}</h3>\n            </div>\n            <div className=\"cur-view-content cur-view-content-groups\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && this.state.errorMsg) && <div className=\"error text-center mt-2\">{this.state.errorMsg}</div>}\n              {(!this.state.isLoading && !this.state.errorMsg && this.state.groupList.length == 0) && emptyTip}\n              {!this.state.isLoading && this.state.groupList.map((group, index) => {\n                return (\n                  <RepoListViewPanel\n                    key={index}\n                    group={group}\n                    onItemDetails={this.onItemDetails}\n                  />\n                );\n              })}\n            </div>\n          </div>\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail currentRepo={this.state.currentRepo} closeDetails={this.closeDetails}/>\n            </div>\n          )}\n        </div>\n        { this.state.showAddGroupModal &&\n          <CreateGroupDialog\n            toggleAddGroupModal={this.toggleAddGroupModal}\n            onCreateGroup={this.onCreateGroup}\n            showAddGroupModal={this.state.showAddGroupModal}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst GroupsViewPropTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nGroupsView.propTypes = GroupsViewPropTypes;\n\nexport default GroupsView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\nimport { Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  toggleInvitePeopleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitationsToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { onShowSidePanel, onSearchedClick, toggleInvitePeopleDialog } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\">\n          </span>\n          {Utils.isDesktop() ? (\n            <div className=\"operation\">\n              <Button color=\"btn btn-secondary operation-item\" onClick={toggleInvitePeopleDialog}>\n                <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Invite Guest')}\n              </Button>\n            </div>\n          ) : (\n            <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('Invite Guest')} onClick={toggleInvitePeopleDialog}></span>\n          )}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick}/>\n      </div>\n    );\n  }\n}\n\nInvitationsToolbar.propTypes = propTypes;\n\nexport default InvitationsToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\nimport Loading from '../loading';\n\nconst InvitePeopleDialogPropTypes = {\n  onInvitePeople: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitePeopleDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      emails: '',\n      errorMsg: '',\n      isSubmitting: false\n    };\n  }\n\n  handleInputChange = (e) => {\n    let emails = e.target.value;\n    this.setState({\n      emails: emails\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.handleSubmitInvite();\n    }\n  }\n\n  handleSubmitInvite = () => {\n    let emails = this.state.emails.trim();\n    if (!emails) {\n      this.setState({\n        errorMsg: gettext('It is required.')\n      });\n      return false;\n    }\n\n    let emailsArray = [];\n    emails = emails.split(',');\n    for (let i = 0, len = emails.length; i < len; i++) {\n      let email = emails[i].trim();\n      if (email) {\n        emailsArray.push(email);\n      }\n    }\n\n    if (!emailsArray.length) {\n      this.setState({\n        errorMsg: gettext('Email is invalid.')\n      });\n      return false;\n    }\n\n    this.setState({\n      isSubmitting: true\n    });\n    seafileAPI.invitePeople(emailsArray).then((res) => {\n      this.props.toggleDialog();\n      const success = res.data.success;\n      if (success.length) {\n        let successMsg = '';\n        if (success.length == 1) {\n          successMsg = gettext('Successfully invited %(email).')\n            .replace('%(email)', success[0].accepter);\n        } else {\n          successMsg = gettext('Successfully invited %(email) and %(num) other people.')\n            .replace('%(email)', success[0].accepter)\n            .replace('%(num)', success.length - 1);\n        }\n        toaster.success(successMsg);\n        this.props.onInvitePeople(success);\n      }\n      const failed = res.data.failed;\n      if (failed.length) {\n        for (let i = 0, len = failed.length; i < len; i++) {\n          let failedMsg = failed[i].email + ': ' + failed[i].error_msg;\n          toaster.danger(failedMsg);\n        }\n      }\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  }\n\n  render() {\n    const { isSubmitting } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Invite Guest')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"emails\">{gettext('Emails')}</label>\n          <Input\n            type=\"text\"\n            id=\"emails\"\n            placeholder={gettext('Emails, separated by \\',\\'')}\n            value={this.state.emails}\n            onChange={this.handleInputChange}\n            onKeyDown={this.handleKeyDown}\n          />\n          <p className=\"error mt-2\">{this.state.errorMsg}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.handleSubmitInvite} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitePeopleDialog.propTypes = InvitePeopleDialogPropTypes;\n\nexport default InvitePeopleDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  accepter: PropTypes.string.isRequired,\n  token: PropTypes.string.isRequired,\n  revokeInvitation: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass InvitationRevokeDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSubmitting: false\n    };\n  }\n\n  onRevokeInvitation = () => {\n    this.setState({\n      isSubmitting: true,\n    });\n\n    seafileAPI.revokeInvitation(this.props.token).then((res) => {\n      this.props.revokeInvitation();\n      this.props.toggleDialog();\n      const msg = gettext('Successfully revoked access of user {placeholder}.').replace('{placeholder}', this.props.accepter);\n      toaster.success(msg);\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  };\n\n  render() {\n    const { accepter, toggleDialog } = this.props;\n    const { isSubmitting } = this.state;\n    const email = '<span class=\"op-target\">' + Utils.HTMLescape(this.props.accepter) + '</span>';\n    const content = gettext('Are you sure to revoke access of user {placeholder} ?').replace('{placeholder}', email);\n\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Revoke Access')}</ModalHeader>\n        <ModalBody>\n          <p dangerouslySetInnerHTML={{__html: content}}></p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.onRevokeInvitation} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitationRevokeDialog.propTypes = propTypes;\n\nexport default InvitationRevokeDialog;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport InvitationsToolbar from '../../components/toolbar/invitations-toolbar';\nimport InvitePeopleDialog from '../../components/dialog/invite-people-dialog';\nimport InvitationRevokeDialog from '../../components/dialog/invitation-revoke-dialog';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\n\nimport '../../css/invitations.css';\n\nclass Item extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isRevokeDialogOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  deleteItem = (e) => {\n    e.preventDefault();\n    // make the icon avoid being clicked repeatedly\n    this.setState({\n      isOpIconShown: false\n    });\n    const token = this.props.invitation.token;\n    seafileAPI.deleteInvitation(token).then((res) => {\n      this.setState({deleted: true});\n      toaster.success(gettext('Successfully deleted 1 item.'));\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.setState({\n        isOpIconShown: true\n      });\n    });\n  }\n\n  revokeItem = () => {\n    this.setState({deleted: true});\n  }\n\n  toggleRevokeDialog = (e) => {\n    e.preventDefault();\n    this.setState({\n      isRevokeDialogOpen: !this.state.isRevokeDialogOpen\n    });\n  }\n\n  render() {\n    const { isOpIconShown, deleted, isRevokeDialogOpen } = this.state;\n\n    if (deleted) {\n      return null;\n    }\n\n    const item = this.props.invitation;\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter} tabIndex=\"0\">\n        <td>{item.accepter}</td>\n        <td>{moment(item.invite_time).format('YYYY-MM-DD')}</td>\n        <td>{moment(item.expire_time).format('YYYY-MM-DD')}</td>\n        <td>{item.accept_time && <i className=\"sf2-icon-tick invite-accept-icon\"></i>}</td>\n        <td>\n          {isOpIconShown && (\n            item.accept_time ?\n              <a href=\"#\"\n                role=\"button\"\n                className=\"action-icon sf3-font sf3-font-cancel-invitation\"\n                title={gettext('Revoke Access')}\n                aria-label={gettext('Revoke Access')}\n                onClick={this.toggleRevokeDialog}>\n              </a> :\n              <a href=\"#\"\n                role=\"button\"\n                className=\"action-icon sf2-icon-x3\"\n                title={gettext('Delete')}\n                aria-label={gettext('Delete')}\n                onClick={this.deleteItem}>\n              </a>\n          )}\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td>\n          {item.accepter}<br />\n          <span className=\"item-meta-info\">{moment(item.invite_time).format('YYYY-MM-DD')}<span className=\"small\">({gettext('Invite Time')})</span></span>\n          <span className=\"item-meta-info\">{moment(item.expire_time).format('YYYY-MM-DD')}<span className=\"small\">({gettext('Expiration')})</span></span>\n          <span className=\"item-meta-info\">{item.accept_time && gettext('Accepted')}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {item.accept_time ?\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.toggleRevokeDialog}>{gettext('Revoke Access')}</DropdownItem> :\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.deleteItem}>{gettext('Delete')}</DropdownItem>\n                }\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isRevokeDialogOpen &&\n        <InvitationRevokeDialog\n          accepter={item.accepter}\n          token={item.token}\n          revokeInvitation={this.revokeItem}\n          toggleDialog={this.toggleRevokeDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst ItemPropTypes = {\n  invitation: PropTypes.object.isRequired,\n};\n\nItem.propTypes = ItemPropTypes;\n\nclass Content extends Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const {\n      loading, errorMsg, invitationsList\n    } = this.props.data;\n\n    if (loading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error text-center mt-2\">{errorMsg}</p>;\n    }\n\n    if (!invitationsList.length) {\n      return (\n        <EmptyTip>\n          <h2>{gettext('No guest invitations')}</h2>\n          <p>{gettext('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the \"Invite Guest\" button in the menu bar.')}</p>\n        </EmptyTip>\n      );\n    }\n\n    const isDesktop = Utils.isDesktop();\n    return (\n      <table className={`table-hover${isDesktop ? '': ' table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ?\n            <tr>\n              <th width=\"25%\">{gettext('Email')}</th>\n              <th width=\"20%\">{gettext('Invite Time')}</th>\n              <th width=\"20%\">{gettext('Expiration')}</th>\n              <th width=\"18%\">{gettext('Accepted')}</th>\n              <th width=\"7%\"></th>\n            </tr>\n            :\n            <tr>\n              <th width=\"92%\"></th>\n              <th width=\"8%\"></th>\n            </tr>\n          }\n        </thead>\n        <tbody>\n          {invitationsList.map((invitation, index) => {\n            return (\n              <Item\n                key={index}\n                isDesktop={isDesktop}\n                invitation={invitation}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass InvitationsView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      invitationsList: [],\n      isInvitePeopleDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listInvitations().then((res) => {\n      this.setState({\n        invitationsList: res.data,\n        loading: false\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onInvitePeople = (invitationsArray) => {\n    invitationsArray.push.apply(invitationsArray, this.state.invitationsList);\n    this.setState({\n      invitationsList: invitationsArray,\n    });\n  }\n\n  toggleInvitePeopleDialog = () => {\n    this.setState({\n      isInvitePeopleDialogOpen: !this.state.isInvitePeopleDialogOpen\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <InvitationsToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n          toggleInvitePeopleDialog={this.toggleInvitePeopleDialog}\n        />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('Invite Guest')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content data={this.state} />\n            </div>\n          </div>\n        </div>\n        {this.state.isInvitePeopleDialogOpen &&\n        <InvitePeopleDialog\n          onInvitePeople={this.onInvitePeople}\n          toggleDialog={this.toggleInvitePeopleDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst InvitationsViewPropTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nInvitationsView.propTypes = InvitationsViewPropTypes;\n\nexport default InvitationsView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired,\n};\n\nclass NewWikiDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isExist: false,\n      name: '',\n      repoID: '',\n      isSubmitBtnActive: false,\n    };\n    this.newName = React.createRef();\n  }\n\n  componentDidMount() {\n    this.newName.focus();\n    this.newName.setSelectionRange(0, -1);\n  }\n\n  inputNewName = (e) => {\n    if (!event.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      name: e.target.value,\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  handleSubmit = () => {\n    let { isExist, name, repoID } = this.state;\n    this.props.addWiki(isExist, name, repoID);\n    this.props.toggleCancel();\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Wiki')}</ModalHeader>\n        <ModalBody>\n          <label className=\"form-label\">{gettext('Name')}</label>\n          <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newName = input;}} value={this.state.name} onChange={this.inputNewName}/>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nNewWikiDialog.propTypes = propTypes;\n\nexport default NewWikiDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport Repo from '../../models/repo';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired\n};\n\nclass WikiSelectDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n      repoID: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos().then(res => {\n      let repoList = res.data.repos\n        .filter(item => {\n          switch (item.type) {\n            case 'mine': // my libraries\n              return !item.encrypted;\n            case 'shared': // libraries shared with me\n              // 'is_admin': the library is shared with 'admin' permission\n              return !item.encrypted && item.is_admin;\n            case 'group':\n            default:\n              return !item.encrypted && !res.data.repos.some(repo => {\n                // just remove the duplicated libraries\n                return repo.type != item.type && repo.repo_id == item.repo_id;\n              });\n          }\n        })\n        .map(item => {\n          let repo = new Repo(item);\n          return repo;\n        });\n      repoList = Utils.sortRepos(repoList, 'name', 'asc');\n      this.setState({repos: repoList});\n    });\n  }\n\n  onChange = (repo) => {\n    this.setState({\n      repoID: repo.repo_id,\n    });\n  }\n\n  handleSubmit = () => {\n    let { repoID } = this.state;\n    this.props.addWiki(repoID);\n    this.props.toggleCancel();\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Publish a Library')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='6%'>{/* select */}</th>\n                <th width='9%'>{/* icon */}</th>\n                <th width='55%'>{gettext('Name')}</th>\n                <th width='30%'>{gettext('Last Update')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repos.map((repo, index) => {\n                return (\n                  <tr key={index}>\n                    <td className=\"text-center\"><input type=\"radio\" className=\"vam\" name=\"repo\" value={repo.repo_id} onChange={this.onChange.bind(this, repo)} /></td>\n                    <td className=\"text-center\"><img src={Utils.getLibIconUrl(repo, false)} width=\"24\" title={Utils.getLibIconTitle(repo)} alt={Utils.getLibIconTitle(repo)} /></td>\n                    <td>{repo.repo_name}</td>\n                    <td>{moment(repo.last_modified).fromNow()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          {this.state.repoID ?\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>:\n            <Button color=\"primary\" disabled>{gettext('Submit')}</Button>\n          }\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiSelectDialog.propTypes = propTypes;\n\nexport default WikiSelectDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  handleSubmit: PropTypes.func.isRequired,\n};\n\nclass WikiDeleteDialog extends React.Component {\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Unpublish Library')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to unpublish this library?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.props.handleSubmit}>{gettext('Unpublish')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiDeleteDialog.propTypes = propTypes;\n\nexport default WikiDeleteDialog;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n// import { seafileAPI } from '../../utils/seafile-api';\n// import Toast from '../toast';\nimport ModalPortal from '../modal-portal';\nimport WikiDeleteDialog from '../dialog/wiki-delete-dialog';\n// import Rename from '../rename';\n\nconst propTypes = {\n  wiki: PropTypes.object.isRequired,\n  // renameWiki: PropTypes.func.isRequired,\n  deleteWiki: PropTypes.func.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n};\n\nclass WikiListItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpMenuOpen: false, // for mobile\n      isShowDeleteDialog: false,\n      // isRenameing: false,\n      highlight: false,\n      // permission: this.props.wiki.permission,\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  // clickMenuToggle = (e) => {\n  //   e.preventDefault();\n  //   this.onMenuToggle(e);\n  // }\n\n  // onMenuToggle = (e) => {\n  //   let targetType = e.target.dataset.toggle;\n  //   if (targetType !== 'item') {\n  //     if (this.props.isItemFreezed) {\n  //       this.setState({\n  //         highlight: false,\n  //         isShowMenuControl: false,\n  //         isShowWikiMenu: !this.state.isShowWikiMenu\n  //       });\n  //       this.props.onUnfreezedItem();\n  //     } else {\n  //       this.setState({\n  //         isShowWikiMenu: !this.state.isShowWikiMenu\n  //       });\n  //       this.props.onFreezedItem();\n  //     }\n  //   }\n  // }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({ highlight: true });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({ highlight: false });\n    }\n  }\n\n  // changePerm = (permission) => {\n  //   let wiki = this.props.wiki;\n  //   seafileAPI.updateWikiPermission(wiki.slug, permission).then(() => {\n  //     this.setState({permission: permission});\n  //   }).catch((error) => {\n  //     if(error.response) {\n  //       let errorMsg = error.response.data.error_msg;\n  //       Toast.danger(errorMsg);\n  //     }\n  //   });\n  // }\n\n  // onRenameToggle = (e) => {\n  //   this.props.onFreezedItem();\n  //   this.setState({\n  //     isShowWikiMenu: false,\n  //     isShowMenuControl: false,\n  //     isRenameing: true,\n  //   });\n  // }\n\n  // onRenameConfirm = (newName) => {\n  //   this.renameWiki(newName);\n  //   this.onRenameCancel();\n  // }\n\n  // onRenameCancel = () => {\n  //   this.props.onUnfreezedItem();\n  //   this.setState({isRenameing: false});\n  // }\n\n  onDeleteToggle = (e) => {\n    e.preventDefault();\n    this.props.onUnfreezedItem();\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  onDeleteCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  // renameWiki = (newName) => {\n  //   let wiki = this.props.wiki;\n  //   this.props.renameWiki(wiki, newName);\n  // }\n\n  deleteWiki = () => {\n    let wiki = this.props.wiki;\n    this.props.deleteWiki(wiki);\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  render() {\n    let wiki = this.props.wiki;\n    let userProfileURL = `${siteRoot}profile/${encodeURIComponent(wiki.owner)}/`;\n    let fileIconUrl = Utils.getDefaultLibIconUrl(false);\n    let deleteIcon = `action-icon sf2-icon-x3 ${this.state.highlight ? '' : 'invisible'}`;\n\n    const desktopItem = (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        <td><img src={fileIconUrl} width=\"24\" alt=\"\" /></td>\n        <td className=\"name\">\n          <a href={wiki.link}>{wiki.name}</a>\n          {/*this.state.isRenameing ?\n              <Rename wiki={wiki} name={wiki.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/> :\n              <a href={wiki.link}>{wiki.name}</a>\n            */}\n        </td>\n        <td><a href={userProfileURL} target='_blank'>{wiki.owner_nickname}</a></td>\n        <td>{moment(wiki.updated_at).fromNow()}</td>\n        <td className=\"text-center cursor-pointer\">\n          <a href=\"#\" role=\"button\" aria-label={gettext('Unpublish')} title={gettext('Unpublish')} className={deleteIcon} onClick={this.onDeleteToggle}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><img src={fileIconUrl} width=\"24\" alt=\"\" /></td>\n        <td>\n          <a href={wiki.link}>{wiki.name}</a><br />\n          <a href={userProfileURL} target='_blank' className=\"item-meta-info\">{wiki.owner_nickname}</a>\n          <span className=\"item-meta-info\">{moment(wiki.updated_at).fromNow()}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.onDeleteToggle}>{gettext('Unpublish')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {Utils.isDesktop() ? desktopItem : mobileItem}\n        {this.state.isShowDeleteDialog &&\n          <ModalPortal>\n            <WikiDeleteDialog\n              toggleCancel={this.onDeleteCancel}\n              handleSubmit={this.deleteWiki}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nWikiListItem.propTypes = propTypes;\n\nexport default WikiListItem;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport WikiListItem from './wiki-list-item';\nimport LibsMobileThead from '../libs-mobile-thead';\n\nconst propTypes = {\n  data: PropTypes.object.isRequired,\n  renameWiki: PropTypes.func.isRequired,\n  deleteWiki: PropTypes.func.isRequired,\n};\n\nclass WikiListView extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  render() {\n    let { loading, errorMsg, wikis } = this.props.data;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const isDesktop = Utils.isDesktop();\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"36%\">{gettext('Name')}</th>\n            <th width=\"25%\">{gettext('Owner')}</th>\n            <th width=\"25%\">{gettext('Last Update')}</th>\n            <th width=\"10%\">{/* operation */}</th>\n          </tr>\n        </thead>\n      );\n      return (\n        <table className={isDesktop ? '' : 'table-thead-hidden'}>\n          {isDesktop ? desktopThead : <LibsMobileThead />}\n          <tbody>\n            {wikis.map((wiki, index) => {\n              return (\n                <WikiListItem\n                  key={index}\n                  wiki={wiki}\n                  renameWiki={this.props.renameWiki}\n                  deleteWiki={this.props.deleteWiki}\n                  isItemFreezed={this.state.isItemFreezed}\n                  onFreezedItem={this.onFreezedItem}\n                  onUnfreezedItem={this.onUnfreezedItem}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n      );\n    }\n  }\n}\n\nWikiListView.propTypes = propTypes;\n\nexport default WikiListView;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button } from 'reactstrap';\nimport MediaQuery from 'react-responsive';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport ModalPortal from '../../components/modal-portal';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport NewWikiDialog from '../../components/dialog/new-wiki-dialog';\nimport WikiSelectDialog from '../../components/dialog/wiki-select-dialog';\nimport WikiListView from '../../components/wiki-list-view/wiki-list-view';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass Wikis extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      wikis: [],\n      isShowAddWikiMenu: false,\n      isShowSelectDialog: false,\n      isShowCreateDialog: false,\n    };\n  }\n\n  componentDidMount() {\n    this.getWikis();\n  }\n\n  getWikis = () => {\n    seafileAPI.listWikis().then(res => {\n      this.setState({\n        loading: false,\n        wikis: res.data.data\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  clickMenuToggle = (e) => {\n    e.preventDefault();\n    this.onMenuToggle();\n  }\n\n  onMenuToggle = () => {\n    this.setState({isShowAddWikiMenu: !this.state.isShowAddWikiMenu});\n  }\n\n  onSelectToggle = () => {\n    this.setState({isShowSelectDialog: !this.state.isShowSelectDialog});\n  }\n\n  onCreateToggle = () => {\n    this.setState({isShowCreateDialog: !this.state.isShowCreateDialog});\n  }\n\n  addWiki = (repoID) => {\n    seafileAPI.addWiki(repoID).then((res) => {\n      this.state.wikis.push(res.data);\n      this.setState({wikis: this.state.wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  renameWiki = (wiki, newName) => {\n    seafileAPI.renameWiki(wiki.slug, newName).then((res) => {\n      let wikis = this.state.wikis.map((item) => {\n        if (item.name === wiki.name) {\n          item = res.data;\n        }\n        return item;\n      });\n      this.setState({wikis: wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  deleteWiki = (wiki) => {\n    seafileAPI.deleteWiki(wiki.slug).then(() => {\n      let wikis = this.state.wikis.filter(item => {\n        return item.name !== wiki.name;\n      });\n      this.setState({wikis: wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n            <div className=\"operation\">\n              <Fragment>\n                <MediaQuery query=\"(min-width: 768px)\">\n                  <Button className=\"btn btn-secondary operation-item\" onClick={this.onSelectToggle}>{gettext('Publish a Library')}</Button>\n                </MediaQuery>\n                <MediaQuery query=\"(max-width: 767.8px)\">\n                  <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('Publish a Library')} onClick={this.onSelectToggle}></span>\n                </MediaQuery>\n              </Fragment>\n            </div>\n          </div>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\" id=\"wikis\">\n            <div className=\"cur-view-path\">\n              <div className=\"path-container\">\n                <h3 className=\"sf-heading m-0\">{gettext('Published Libraries')}</h3>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {(this.state.loading || this.state.wikis.length !== 0) &&\n                <WikiListView\n                  data={this.state}\n                  renameWiki={this.renameWiki}\n                  deleteWiki={this.deleteWiki}\n                />\n              }\n              {(!this.state.loading && this.state.wikis.length === 0) &&\n                <EmptyTip>\n                  <h2>{gettext('No published libraries')}</h2>\n                  <p>{gettext('You have not published any libraries yet. A published library can be accessed by anyone, not only users, via its URL. You can publish a library by clicking the \"Publish a Library\" button in the menu bar.')}</p>\n                </EmptyTip>\n              }\n            </div>\n          </div>\n        </div>\n        {this.state.isShowCreateDialog && (\n          <ModalPortal>\n            <NewWikiDialog\n              toggleCancel={this.onCreateToggle}\n              addWiki={this.addWiki}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isShowSelectDialog && (\n          <ModalPortal>\n            <WikiSelectDialog\n              toggleCancel={this.onSelectToggle}\n              addWiki={this.addWiki}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nWikis.propTypes = propTypes;\n\nexport default Wikis;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\n\nconst propTypes = {\n  searchPlaceholder: PropTypes.string,\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass GeneralToolbar extends React.Component {\n\n  render() {\n    // todo get repoID?\n    let { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north\">\n        <div className=\"cur-view-toolbar\">\n          <span\n            className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\"\n            title=\"Side Nav Menu\"\n            onClick={onShowSidePanel}>\n          </span>\n        </div>\n        <CommonToolbar\n          searchPlaceholder={this.props.searchPlaceholder}\n          onSearchedClick={onSearchedClick}\n        />\n      </div>\n    );\n  }\n}\n\nGeneralToolbar.propTypes = propTypes;\n\nexport default GeneralToolbar;\n","import React, { Fragment } from 'react';\nimport GeneralToolBar from './toolbar/general-toolbar';\n\nconst MainContentWrapper = (WrapperedComponent) => {\n  return class Wrapper extends React.Component {\n\n    constructor(props) {\n      super(props);\n    }\n\n    render() {\n      return (\n        <Fragment>\n          <GeneralToolBar {...this.props} />\n          <WrapperedComponent {...this.props} />\n        </Fragment>\n      );\n    }\n  };\n};\n\nexport default MainContentWrapper;\n","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router, navigate } from '@reach/router';\nimport MediaQuery from 'react-responsive';\nimport { Modal } from 'reactstrap';\nimport { siteRoot, canAddRepo, isDocs } from './utils/constants';\nimport { Utils } from './utils/utils';\nimport SystemNotification from './components/system-notification';\nimport SidePanel from './components/side-panel';\nimport MainPanel from './components/main-panel';\nimport DraftsView from './pages/drafts/drafts-view';\nimport DraftContent from './pages/drafts/draft-content';\nimport FilesActivities from './pages/dashboard/files-activities';\nimport Starred from './pages/starred/starred';\nimport LinkedDevices from './pages/linked-devices/linked-devices';\nimport editUtilities from './utils/editor-utilities';\nimport ShareAdminLibraries from './pages/share-admin/libraries';\nimport ShareAdminFolders from './pages/share-admin/folders';\nimport ShareAdminShareLinks from './pages/share-admin/share-links';\nimport ShareAdminUploadLinks from './pages/share-admin/upload-links';\nimport SharedLibraries from './pages/shared-libs/shared-libs';\nimport ShareWithOCM from './pages/share-with-ocm/shared-with-ocm';\nimport OCMViaWebdav from './pages/ocm-via-webdav/ocm-via-webdav';\nimport OCMRepoDir from './pages/share-with-ocm/remote-dir-view';\nimport MyLibraries from './pages/my-libs/my-libs';\nimport MyLibDeleted from './pages/my-libs/my-libs-deleted';\nimport PublicSharedView from './pages/shared-with-all/public-shared-view';\nimport LibContentView from './pages/lib-content-view/lib-content-view';\nimport Group from './pages/groups/group-view';\nimport Groups from './pages/groups/groups-view';\nimport InvitationsView from './pages/invitations/invitations-view';\nimport Wikis from './pages/wikis/wikis';\nimport MainContentWrapper from './components/main-content-wrapper';\n\nimport './css/layout.css';\nimport './css/toolbar.css';\nimport './css/search.css';\n\nconst FilesActivitiesWrapper = MainContentWrapper(FilesActivities);\nconst DraftsViewWrapper = MainContentWrapper(DraftsView);\nconst StarredWrapper = MainContentWrapper(Starred);\nconst LinkedDevicesWrapper = MainContentWrapper(LinkedDevices);\nconst SharedLibrariesWrapper = MainContentWrapper(SharedLibraries);\nconst SharedWithOCMWrapper = MainContentWrapper(ShareWithOCM);\nconst OCMViaWebdavWrapper = MainContentWrapper(OCMViaWebdav);\nconst ShareAdminLibrariesWrapper = MainContentWrapper(ShareAdminLibraries);\nconst ShareAdminFoldersWrapper = MainContentWrapper(ShareAdminFolders);\nconst ShareAdminShareLinksWrapper = MainContentWrapper(ShareAdminShareLinks);\nconst ShareAdminUploadLinksWrapper = MainContentWrapper(ShareAdminUploadLinks);\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: false,\n      isSidePanelClosed: false,\n      draftCounts: 0,\n      draftList:[],\n      isLoadingDraft: true,\n      currentTab: '/',\n      pathPrefix: [],\n    };\n    this.dirViewPanels = ['my-libs', 'shared-libs', 'org']; // and group\n    window.onpopstate = this.onpopstate;\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.currentTab && event.state.pathPrefix) {\n      let { currentTab, pathPrefix } = event.state;\n      this.setState({currentTab, pathPrefix});\n    }\n  }\n\n  componentWillMount() {\n    if (!Utils.isDesktop()) {\n      this.setState({\n        isSidePanelClosed: true\n      });\n    }\n  }\n\n  navigateClientUrlToLib = () =>{\n    if(window.location.hash && window.location.hash.indexOf('common/lib') != -1){\n      let splitUrlArray = window.location.hash.split('/');\n      let repoID = splitUrlArray[splitUrlArray.length - 2];\n      let url = siteRoot + 'library/' + repoID + '/';\n      navigate(url, {repalce: true});\n    }\n  }\n\n  componentDidMount() {\n    // url from client  e.g. http://127.0.0.1:8000/#common/lib/34e7fb92-e91d-499d-bcde-c30ea8af9828/\n    // navigate to library page http://127.0.0.1:8000/library/34e7fb92-e91d-499d-bcde-c30ea8af9828/\n    this.navigateClientUrlToLib();\n\n    // e.g.  from http://127.0.0.1:8000/drafts/reviews/\n    // get reviews\n    // TODO: need refactor later\n    let href = window.location.href.split('/');\n    if (isDocs) {\n      this.getDrafts();\n    }\n    this.setState({currentTab: href[href.length - 2]});\n  }\n\n  getDrafts = () => {\n    editUtilities.listDrafts().then(res => {\n      this.setState({\n        draftCounts: res.data.draft_counts,\n        draftList: res.data.data,\n        isLoadingDraft: false,\n      });\n    });\n  }\n\n  updateDraftsList = (draft_id) => {\n    this.setState({\n      draftCounts: this.state.draftCounts - 1,\n      draftList: this.state.draftList.filter(draft => draft.id != draft_id),\n    });\n  }\n\n  onCloseSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  onShowSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      this.setState({currentTab: '', pathPrefix: []});\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let isWeChat = Utils.isWeChat();\n      if (!isWeChat) {\n        let newWindow = window.open('about:blank');\n        newWindow.location.href = url;\n      } else {\n        location.href = url;\n      }\n    }\n  }\n\n  onGroupChanged = (groupID) => {\n    setTimeout(function(){\n      let url;\n      if (groupID) {\n        url = siteRoot + 'group/' + groupID + '/';\n      }\n      else {\n        url = siteRoot + 'groups/';\n      }\n      window.location = url.toString();\n    }, 1);\n  }\n\n  tabItemClick = (tabName, groupID) => {\n    let pathPrefix = [];\n    if (groupID || this.dirViewPanels.indexOf(tabName) > -1) {\n      pathPrefix = this.generatorPrefix(tabName, groupID);\n    }\n    this.setState({\n      currentTab: tabName,\n      pathPrefix: pathPrefix\n    }, () => {\n      let { currentTab, pathPrefix } = this.state;\n      window.history.replaceState({currentTab: currentTab, pathPrefix: pathPrefix}, null);\n    });\n    if (!Utils.isDesktop() && !this.state.isSidePanelClosed) {\n      this.setState({ isSidePanelClosed: true });\n    }\n  }\n\n  generatorPrefix = (tabName, groupID) => {\n    let pathPrefix = [];\n    if (groupID) {\n      let navTab1 = {\n        url: siteRoot + 'groups/',\n        showName: 'Groups',\n        name: 'groups',\n        id: null,\n      };\n      let navTab2 = {\n        url: siteRoot + 'group/' + groupID + '/',\n        showName: tabName,\n        name: tabName,\n        id: groupID,\n      };\n      pathPrefix.push(navTab1);\n      pathPrefix.push(navTab2);\n    } else {\n      let navTab = {\n        url: siteRoot + tabName + '/',\n        showName: this.getTabShowName(tabName),\n        name: tabName,\n        id: null,\n      };\n      pathPrefix.push(navTab);\n    }\n    return pathPrefix;\n  }\n\n  getTabShowName = (tabName) => {\n    if (tabName === 'my-libs') {\n      return 'Libraries';\n    }\n    if (tabName === 'shared-libs') {\n      return 'Shared with me';\n    }\n    if (tabName === 'org') {\n      return 'Shared with all';\n    }\n  }\n\n  toggleSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  render() {\n    let { currentTab, isSidePanelClosed } = this.state;\n\n    const home = canAddRepo ?\n      <MyLibraries path={ siteRoot } onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} /> :\n      <SharedLibrariesWrapper path={ siteRoot } onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />;\n\n    return (\n      <React.Fragment>\n        <SystemNotification />\n        <div id=\"main\">\n          <SidePanel isSidePanelClosed={this.state.isSidePanelClosed} onCloseSidePanel={this.onCloseSidePanel} currentTab={currentTab} tabItemClick={this.tabItemClick} draftCounts={this.state.draftCounts} />\n          <MainPanel>\n            <Router className=\"reach-router\">\n              {home}\n              <FilesActivitiesWrapper path={siteRoot + 'dashboard'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <DraftsViewWrapper path={siteRoot + 'drafts'}\n                onShowSidePanel={this.onShowSidePanel}\n                onSearchedClick={this.onSearchedClick}\n              >\n                <DraftContent\n                  path='/'\n                  getDrafts={this.getDrafts}\n                  isLoadingDraft={this.state.isLoadingDraft}\n                  draftList={this.state.draftList}\n                  updateDraftsList={this.updateDraftsList}\n                />\n              </DraftsViewWrapper>\n              <StarredWrapper path={siteRoot + 'starred'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <LinkedDevicesWrapper path={siteRoot + 'linked-devices'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminLibrariesWrapper path={siteRoot + 'share-admin-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminFoldersWrapper path={siteRoot + 'share-admin-folders'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminShareLinksWrapper path={siteRoot + 'share-admin-share-links'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminUploadLinksWrapper path={siteRoot + 'share-admin-upload-links'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <SharedLibrariesWrapper path={siteRoot + 'shared-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <SharedWithOCMWrapper path={siteRoot + 'shared-with-ocm'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <OCMViaWebdavWrapper path={siteRoot + 'ocm-via-webdav'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <MyLibraries path={siteRoot + 'my-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <MyLibDeleted path={siteRoot + 'my-libs/deleted/'} onSearchedClick={this.onSearchedClick} />\n              <LibContentView path={siteRoot + 'library/:repoID/*'} pathPrefix={this.state.pathPrefix} onMenuClick={this.onShowSidePanel} onTabNavClick={this.tabItemClick}/>\n              <OCMRepoDir path={siteRoot + 'remote-library/:providerID/:repoID/*'} pathPrefix={this.state.pathPrefix} onMenuClick={this.onShowSidePanel} onTabNavClick={this.tabItemClick}/>\n              <Groups path={siteRoot + 'groups'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick}/>\n              <Group\n                path={siteRoot + 'group/:groupID'}\n                onShowSidePanel={this.onShowSidePanel}\n                onSearchedClick={this.onSearchedClick}\n                onTabNavClick={this.tabItemClick}\n                onGroupChanged={this.onGroupChanged}\n              />\n              <Wikis path={siteRoot + 'published'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick}/>\n              <PublicSharedView path={siteRoot + 'org/'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} onTabNavClick={this.tabItemClick}/>\n              <InvitationsView path={siteRoot + 'invitations/'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n            </Router>\n          </MainPanel>\n          <MediaQuery query=\"(max-width: 767.8px)\">\n            <Modal zIndex=\"1030\" isOpen={!isSidePanelClosed} toggle={this.toggleSidePanel} contentClassName=\"d-none\"></Modal>\n          </MediaQuery>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nReactDOM.render(\n  <App />,\n  document.getElementById('wrapper')\n);\n","\n/**\n * Module dependencies.\n */\n\nvar debug = require('debug')('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar binary = require('./binary');\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = 4;\n\n/**\n * Packet types.\n *\n * @api public\n */\n\nexports.types = [\n  'CONNECT',\n  'DISCONNECT',\n  'EVENT',\n  'ACK',\n  'ERROR',\n  'BINARY_EVENT',\n  'BINARY_ACK'\n];\n\n/**\n * Packet type `connect`.\n *\n * @api public\n */\n\nexports.CONNECT = 0;\n\n/**\n * Packet type `disconnect`.\n *\n * @api public\n */\n\nexports.DISCONNECT = 1;\n\n/**\n * Packet type `event`.\n *\n * @api public\n */\n\nexports.EVENT = 2;\n\n/**\n * Packet type `ack`.\n *\n * @api public\n */\n\nexports.ACK = 3;\n\n/**\n * Packet type `error`.\n *\n * @api public\n */\n\nexports.ERROR = 4;\n\n/**\n * Packet type 'binary event'\n *\n * @api public\n */\n\nexports.BINARY_EVENT = 5;\n\n/**\n * Packet type `binary ack`. For acks with binary arguments.\n *\n * @api public\n */\n\nexports.BINARY_ACK = 6;\n\n/**\n * Encoder constructor.\n *\n * @api public\n */\n\nexports.Encoder = Encoder;\n\n/**\n * Decoder constructor.\n *\n * @api public\n */\n\nexports.Decoder = Decoder;\n\n/**\n * A socket.io Encoder instance\n *\n * @api public\n */\n\nfunction Encoder() {}\n\nvar ERROR_PACKET = exports.ERROR + '\"encode error\"';\n\n/**\n * Encode a packet as a single string if non-binary, or as a\n * buffer sequence, depending on packet type.\n *\n * @param {Object} obj - packet object\n * @param {Function} callback - function to handle encodings (likely engine.write)\n * @return Calls callback with Array of encodings\n * @api public\n */\n\nEncoder.prototype.encode = function(obj, callback){\n  debug('encoding packet %j', obj);\n\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    encodeAsBinary(obj, callback);\n  } else {\n    var encoding = encodeAsString(obj);\n    callback([encoding]);\n  }\n};\n\n/**\n * Encode packet as string.\n *\n * @param {Object} packet\n * @return {String} encoded\n * @api private\n */\n\nfunction encodeAsString(obj) {\n\n  // first is type\n  var str = '' + obj.type;\n\n  // attachments if we have them\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    str += obj.attachments + '-';\n  }\n\n  // if we have a namespace other than `/`\n  // we append it followed by a comma `,`\n  if (obj.nsp && '/' !== obj.nsp) {\n    str += obj.nsp + ',';\n  }\n\n  // immediately followed by the id\n  if (null != obj.id) {\n    str += obj.id;\n  }\n\n  // json data\n  if (null != obj.data) {\n    var payload = tryStringify(obj.data);\n    if (payload !== false) {\n      str += payload;\n    } else {\n      return ERROR_PACKET;\n    }\n  }\n\n  debug('encoded %j as %s', obj, str);\n  return str;\n}\n\nfunction tryStringify(str) {\n  try {\n    return JSON.stringify(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Encode packet as 'buffer sequence' by removing blobs, and\n * deconstructing packet into object with placeholders and\n * a list of buffers.\n *\n * @param {Object} packet\n * @return {Buffer} encoded\n * @api private\n */\n\nfunction encodeAsBinary(obj, callback) {\n\n  function writeEncoding(bloblessData) {\n    var deconstruction = binary.deconstructPacket(bloblessData);\n    var pack = encodeAsString(deconstruction.packet);\n    var buffers = deconstruction.buffers;\n\n    buffers.unshift(pack); // add packet info to beginning of data list\n    callback(buffers); // write all the buffers\n  }\n\n  binary.removeBlobs(obj, writeEncoding);\n}\n\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n * @api public\n */\n\nfunction Decoder() {\n  this.reconstructor = null;\n}\n\n/**\n * Mix in `Emitter` with Decoder.\n */\n\nEmitter(Decoder.prototype);\n\n/**\n * Decodes an encoded packet string into packet JSON.\n *\n * @param {String} obj - encoded packet\n * @return {Object} packet\n * @api public\n */\n\nDecoder.prototype.add = function(obj) {\n  var packet;\n  if (typeof obj === 'string') {\n    packet = decodeString(obj);\n    if (exports.BINARY_EVENT === packet.type || exports.BINARY_ACK === packet.type) { // binary packet's json\n      this.reconstructor = new BinaryReconstructor(packet);\n\n      // no attachments, labeled binary but no binary data to follow\n      if (this.reconstructor.reconPack.attachments === 0) {\n        this.emit('decoded', packet);\n      }\n    } else { // non-binary full packet\n      this.emit('decoded', packet);\n    }\n  } else if (isBuf(obj) || obj.base64) { // raw binary data\n    if (!this.reconstructor) {\n      throw new Error('got binary data when not reconstructing a packet');\n    } else {\n      packet = this.reconstructor.takeBinaryData(obj);\n      if (packet) { // received final buffer\n        this.reconstructor = null;\n        this.emit('decoded', packet);\n      }\n    }\n  } else {\n    throw new Error('Unknown type: ' + obj);\n  }\n};\n\n/**\n * Decode a packet String (JSON data)\n *\n * @param {String} str\n * @return {Object} packet\n * @api private\n */\n\nfunction decodeString(str) {\n  var i = 0;\n  // look up type\n  var p = {\n    type: Number(str.charAt(0))\n  };\n\n  if (null == exports.types[p.type]) {\n    return error('unknown packet type ' + p.type);\n  }\n\n  // look up attachments if type binary\n  if (exports.BINARY_EVENT === p.type || exports.BINARY_ACK === p.type) {\n    var start = i + 1;\n    while (str.charAt(++i) !== '-' && i != str.length) {}\n    var buf = str.substring(start, i);\n    if (buf != Number(buf) || str.charAt(i) !== '-') {\n      throw new Error('Illegal attachments');\n    }\n    p.attachments = Number(buf);\n  }\n\n  // look up namespace (if any)\n  if ('/' === str.charAt(i + 1)) {\n    var start = i + 1;\n    while (++i) {\n      var c = str.charAt(i);\n      if (',' === c) break;\n      if (i === str.length) break;\n    }\n    p.nsp = str.substring(start, i);\n  } else {\n    p.nsp = '/';\n  }\n\n  // look up id\n  var next = str.charAt(i + 1);\n  if ('' !== next && Number(next) == next) {\n    var start = i + 1;\n    while (++i) {\n      var c = str.charAt(i);\n      if (null == c || Number(c) != c) {\n        --i;\n        break;\n      }\n      if (i === str.length) break;\n    }\n    p.id = Number(str.substring(start, i + 1));\n  }\n\n  // look up json data\n  if (str.charAt(++i)) {\n    var payload = tryParse(str.substr(i));\n    var isPayloadValid = payload !== false && (p.type === exports.ERROR || isArray(payload));\n    if (isPayloadValid) {\n      p.data = payload;\n    } else {\n      return error('invalid payload');\n    }\n  }\n\n  debug('decoded %s as %j', str, p);\n  return p;\n}\n\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Deallocates a parser's resources\n *\n * @api public\n */\n\nDecoder.prototype.destroy = function() {\n  if (this.reconstructor) {\n    this.reconstructor.finishedReconstruction();\n  }\n};\n\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n * @api private\n */\n\nfunction BinaryReconstructor(packet) {\n  this.reconPack = packet;\n  this.buffers = [];\n}\n\n/**\n * Method to be called when binary data received from connection\n * after a BINARY_EVENT packet.\n *\n * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n * @return {null | Object} returns null if more binary data is expected or\n *   a reconstructed packet object if all buffers have been received.\n * @api private\n */\n\nBinaryReconstructor.prototype.takeBinaryData = function(binData) {\n  this.buffers.push(binData);\n  if (this.buffers.length === this.reconPack.attachments) { // done with buffer list\n    var packet = binary.reconstructPacket(this.reconPack, this.buffers);\n    this.finishedReconstruction();\n    return packet;\n  }\n  return null;\n};\n\n/**\n * Cleans up binary packet reconstruction variables.\n *\n * @api private\n */\n\nBinaryReconstructor.prototype.finishedReconstruction = function() {\n  this.reconPack = null;\n  this.buffers = [];\n};\n\nfunction error(msg) {\n  return {\n    type: exports.ERROR,\n    data: 'parser error: ' + msg\n  };\n}\n","// browser shim for xmlhttprequest module\n\nvar hasCORS = require('has-cors');\nvar globalThis = require('./globalThis');\n\nmodule.exports = function (opts) {\n  var xdomain = opts.xdomain;\n\n  // scheme must be same when usign XDomainRequest\n  // http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx\n  var xscheme = opts.xscheme;\n\n  // XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.\n  // https://github.com/Automattic/engine.io-client/pull/217\n  var enablesXDR = opts.enablesXDR;\n\n  // XMLHttpRequest can be disabled on IE\n  try {\n    if ('undefined' !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n      return new XMLHttpRequest();\n    }\n  } catch (e) { }\n\n  // Use XDomainRequest for IE8 if enablesXDR is true\n  // because loading bar keeps flashing when using jsonp-polling\n  // https://github.com/yujiosaka/socke.io-ie8-loading-example\n  try {\n    if ('undefined' !== typeof XDomainRequest && !xscheme && enablesXDR) {\n      return new XDomainRequest();\n    }\n  } catch (e) { }\n\n  if (!xdomain) {\n    try {\n      return new globalThis[['Active'].concat('Object').join('X')]('Microsoft.XMLHTTP');\n    } catch (e) { }\n  }\n};\n","module.exports = (function () {\n  if (typeof self !== 'undefined') {\n    return self;\n  } else if (typeof window !== 'undefined') {\n    return window;\n  } else {\n    return Function('return this')(); // eslint-disable-line no-new-func\n  }\n})();\n","/**\n * Module dependencies.\n */\n\nvar parser = require('engine.io-parser');\nvar Emitter = require('component-emitter');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Transport;\n\n/**\n * Transport abstract constructor.\n *\n * @param {Object} options.\n * @api private\n */\n\nfunction Transport (opts) {\n  this.path = opts.path;\n  this.hostname = opts.hostname;\n  this.port = opts.port;\n  this.secure = opts.secure;\n  this.query = opts.query;\n  this.timestampParam = opts.timestampParam;\n  this.timestampRequests = opts.timestampRequests;\n  this.readyState = '';\n  this.agent = opts.agent || false;\n  this.socket = opts.socket;\n  this.enablesXDR = opts.enablesXDR;\n  this.withCredentials = opts.withCredentials;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n  this.forceNode = opts.forceNode;\n\n  // results of ReactNative environment detection\n  this.isReactNative = opts.isReactNative;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n  this.localAddress = opts.localAddress;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Transport.prototype);\n\n/**\n * Emits an error.\n *\n * @param {String} str\n * @return {Transport} for chaining\n * @api public\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  var err = new Error(msg);\n  err.type = 'TransportError';\n  err.description = desc;\n  this.emit('error', err);\n  return this;\n};\n\n/**\n * Opens the transport.\n *\n * @api public\n */\n\nTransport.prototype.open = function () {\n  if ('closed' === this.readyState || '' === this.readyState) {\n    this.readyState = 'opening';\n    this.doOpen();\n  }\n\n  return this;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.doClose();\n    this.onClose();\n  }\n\n  return this;\n};\n\n/**\n * Sends multiple packets.\n *\n * @param {Array} packets\n * @api private\n */\n\nTransport.prototype.send = function (packets) {\n  if ('open' === this.readyState) {\n    this.write(packets);\n  } else {\n    throw new Error('Transport not open');\n  }\n};\n\n/**\n * Called upon open\n *\n * @api private\n */\n\nTransport.prototype.onOpen = function () {\n  this.readyState = 'open';\n  this.writable = true;\n  this.emit('open');\n};\n\n/**\n * Called with data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  var packet = parser.decodePacket(data, this.socket.binaryType);\n  this.onPacket(packet);\n};\n\n/**\n * Called with a decoded packet.\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  onRepoTagCreated: PropTypes.func,\n  toggleCancel: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n};\n\nclass CreateTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagName: '',\n      tagColor: '',\n      newTag: {},\n      errorMsg: '',\n      colorList: ['#FBD44A', '#EAA775', '#F4667C', '#DC82D2', '#9860E5', '#9F8CF1', '#59CB74', '#ADDF84', '#89D2EA', '#4ECCCB', '#46A1FD', '#C2C2C2'],\n    };\n    this.newInput = React.createRef();\n  }\n\n  inputNewName = (e) => {\n    this.setState({\n      tagName: e.target.value,\n    });\n    if (this.state.errorMsg) {\n      this.setState({errorMsg: ''});\n    }\n  }\n\n  selectTagcolor = (e) => {\n    this.setState({\n      tagColor: e.target.value,\n    });\n  }\n\n  createTag = () => {\n    let name = this.state.tagName;\n    let color = this.state.tagColor;\n    let repoID = this.props.repoID;\n    seafileAPI.createRepoTag(repoID, name, color).then((res) => {\n      let repoTagID = res.data.repo_tag.repo_tag_id;\n      if (this.props.onRepoTagCreated) this.props.onRepoTagCreated(repoTagID);\n      this.props.toggleCancel();\n    }).catch((error) => {\n      let errMessage;\n      if (error.response.status === 500) {\n        errMessage = gettext('Internal Server Error');\n      } else if (error.response.status === 400) {\n        errMessage = gettext('Tag \"{name}\" already exists.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(name));\n      }\n      this.setState({errorMsg: errMessage});\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.createTag();\n    }\n  }\n\n  componentDidMount() {\n    this.setState({\n      tagColor: this.state.colorList[0]\n    });\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0, 0);\n  }\n\n  render() {\n    let colorList = this.state.colorList;\n    let canSave = this.state.tagName.trim() ? true : false;\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.onClose}>\n          <span className=\"tag-dialog-back fas fa-sm fa-arrow-left\" onClick={this.props.toggleCancel} aria-label={gettext('Back')}></span>\n          {gettext('New Tag')}\n        </ModalHeader>\n        <ModalBody>\n          <div role=\"form\" className=\"tag-create\">\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Name')}</label>\n              <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} value={this.state.tagName} onChange={this.inputNewName}/>\n              <div className=\"mt-2\"><span className=\"error\">{this.state.errorMsg}</span></div>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Select a color')}</label>\n              <div className=\"d-flex justify-content-between\">\n                {colorList.map((item, index)=>{\n                  return (\n                    <div key={index} className=\"tag-color-option\" onChange={this.selectTagcolor}>\n                      <label className=\"colorinput\">\n                        {index===0 ?\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" defaultChecked onClick={this.selectTagcolor}></input> :\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" onClick={this.selectTagcolor}></input>}\n                        <span className=\"colorinput-color rounded-circle d-flex align-items-center justify-content-center\" style={{backgroundColor:item}}>\n                          <i className=\"fas fa-check color-selected\"></i>\n                        </span>\n                      </label>\n                    </div>\n                  );\n                })\n                }\n              </div>\n            </div>\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Cancel')}</Button>\n          {canSave ?\n            <Button color=\"primary\" onClick={this.createTag}>{gettext('Save')}</Button> :\n            <Button color=\"primary\" disabled>{gettext('Save')}</Button>\n          }\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nCreateTagDialog.propTypes = propTypes;\n\nexport default CreateTagDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport copy from '../copy-to-clipboard';\nimport { gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\n\nconst propTypes = {\n  link: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ShareAdminLink extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n copyToClipboard = () => {\n   copy(this.props.link);\n   this.props.toggleDialog();\n   toaster.success(gettext('The link is copied to the clipboard.')), {duration: 2};\n }\n\n render() {\n   const { link, toggleDialog } = this.props;\n   return (\n     <Modal isOpen={true} toggle={toggleDialog}>\n       <ModalHeader toggle={toggleDialog}>{gettext('Link')}</ModalHeader>\n       <ModalBody>\n         <a href={link}>{link}</a>\n       </ModalBody>\n       <ModalFooter>\n         <Button color=\"primary\" onClick={this.copyToClipboard}>{gettext('Copy')}</Button>\n         <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Close')}</Button>\n       </ModalFooter>\n     </Modal>\n   );\n }\n}\n\nShareAdminLink.propTypes = propTypes;\n\nexport default ShareAdminLink;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport moment from 'moment';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  currentTag: PropTypes.object.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  updateUsedRepoTags: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  shareLinkToken: PropTypes.string,\n  enableFileDownload: PropTypes.bool\n};\n\nclass ListTaggedFilesDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      taggedFileList: [],\n    };\n  }\n\n  onFileTagChanged = (TaggedFile) => {\n    const path = TaggedFile.parent_path;\n    const dirent = {name: TaggedFile.filename};\n    let direntPath = path === '/' ? path + TaggedFile.filename : path + '/' + TaggedFile.filename;\n    this.props.onFileTagChanged(dirent, direntPath);\n  }\n\n  onDeleteTaggedFile = (taggedFile) => {\n    let repoID = this.props.repoID;\n    let fileTagID = taggedFile.file_tag_id;\n    seafileAPI.deleteFileTag(repoID, fileTagID).then(res => {\n      this.getTaggedFiles();\n      this.props.updateUsedRepoTags();\n      if ((this.props.onFileTagChanged) && !taggedFile.file_deleted) this.onFileTagChanged(taggedFile);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  componentDidMount() {\n    this.getTaggedFiles();\n  }\n\n  getTaggedFiles = () => {\n    let { repoID, currentTag, shareLinkToken } = this.props;\n    let request = shareLinkToken ?\n      seafileAPI.getShareLinkTaggedFiles(shareLinkToken, currentTag.id) :\n      seafileAPI.listTaggedFiles(repoID, currentTag.id);\n    request.then(res => {\n      let taggedFileList = [];\n      res.data.tagged_files !== undefined &&\n      res.data.tagged_files.forEach(file => {\n        let taggedFile = file;\n        taggedFileList.push(taggedFile);\n      });\n      this.setState({\n        taggedFileList: taggedFileList,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let taggedFileList = this.state.taggedFileList;\n    return (\n      <Modal isOpen={true} style={{maxWidth: '678px'}}>\n        <ModalHeader toggle={this.props.onClose}>{gettext('Tagged Files')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='50%' className=\"ellipsis\">{gettext('Name')}</th>\n                <th width='20%'>{gettext('Size')}</th>\n                <th width='22%'>{gettext('Last Update')}</th>\n                <th width='8%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {taggedFileList.map((taggedFile, index) => {\n                return (\n                  <TaggedFile\n                    key={index}\n                    repoID={this.props.repoID}\n                    taggedFile={taggedFile}\n                    onDeleteTaggedFile={this.onDeleteTaggedFile}\n                    shareLinkToken={this.props.shareLinkToken}\n                    enableFileDownload={this.props.enableFileDownload}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListTaggedFilesDialog.propTypes = propTypes;\n\nexport default ListTaggedFilesDialog;\n\nconst TaggedFilePropTypes = {\n  repoID: PropTypes.string.isRequired,\n  taggedFile: PropTypes.object,\n  onDeleteTaggedFile: PropTypes.func.isRequired,\n  shareLinkToken: PropTypes.string,\n  enableFileDownload: PropTypes.bool\n};\n\nclass TaggedFile extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  deleteFile = (e) => {\n    e.preventDefault();\n    this.props.onDeleteTaggedFile(this.props.taggedFile);\n  }\n\n  render() {\n    const { taggedFile, shareLinkToken, enableFileDownload } = this.props;\n\n    let path = taggedFile.parent_path ? Utils.joinPath(taggedFile.parent_path, taggedFile.filename) : '';\n    let href = shareLinkToken ?\n      siteRoot + 'd/' + shareLinkToken + '/files/?p=' + Utils.encodePath(path) :\n      siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(path);\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onFocus={this.onMouseEnter}>\n        {taggedFile.file_deleted ?\n          <Fragment>\n            <td colSpan='3' className=\"name\">{taggedFile.filename}{' '}\n              <span style={{color:'red'}}>{gettext('deleted')}</span>\n            </td>\n          </Fragment>\n          :\n          <Fragment>\n            <td><a href={href} target='_blank' className=\"d-inline-block w-100 ellipsis\" title={taggedFile.filename} rel=\"noreferrer\">{taggedFile.filename}</a></td>\n            <td>{Utils.bytesToSize(taggedFile.size)}</td>\n            <td>{moment.unix(taggedFile.mtime).fromNow()}</td>\n          </Fragment>\n        }\n        <td>\n          {!shareLinkToken &&\n            <a href=\"#\" role=\"button\" aria-label={gettext('Delete')} title={gettext('Delete')} className={`action-icon sf2-icon-x3${this.state.active ? '' : ' invisible'}`} onClick={this.deleteFile}></a>\n          }\n          {(shareLinkToken && enableFileDownload) &&\n            <a className={`action-icon sf2-icon-download${this.state.active ? '' : ' invisible'}`} href={`${href}&dl=1`} title={gettext('Download')} aria-label={gettext('Download')}></a>\n          }\n        </td>\n      </tr>\n    );\n  }\n}\n\nTaggedFile.propTypes = TaggedFilePropTypes;\n","import moment from 'moment';\n\nclass Draft {\n\n  constructor(item) {\n    this.created = item.created_at;\n    this.createdStr = moment((new Date(item.created_at)).getTime()).format('YYYY-MM-DD HH:mm');\n    this.id = item.id;\n    this.ownerNickname = item.owner_nickname;\n    this.originRepoID = item.origin_repo_id;\n    this.draftFilePath = item.draft_file_path;\n  }\n}\n\nexport default Draft;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport editorUtilities from '../../utils/editor-utilities';\nimport toaster from '../../components/toast';\nimport { Utils } from '../../utils/utils';\nimport Draft from '../../models/draft';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  toggle: PropTypes.func.isRequired,\n};\n\nclass ListRepoDraftsDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      drafts: [],\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepoDrafts(this.props.repoID).then(res => {\n      let drafts = res.data.drafts.map(item => {\n        let draft = new Draft(item);\n        return draft;\n      });\n      this.setState({\n        drafts: drafts\n      });\n    });\n  }\n\n  onDeleteDraftItem = (draft) => {\n    editorUtilities.deleteDraft(draft.id).then(() => {\n      let drafts = this.state.drafts.filter(item => {\n        return item.id !== draft.id;\n      });\n      this.setState({drafts: drafts});\n      let msg = gettext('Successfully deleted draft %(draft)s.');\n      msg = msg.replace('%(draft)s', draft.draftFilePath);\n      toaster.success(msg);\n    }).catch(() => {\n      let msg = gettext('Failed to delete draft %(draft)s.');\n      msg = msg.replace('%(draft)s', draft.draftFilePath);\n      toaster.danger(msg);\n    });\n  }\n\n  toggle = () => {\n    this.props.toggle();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Drafts')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='50%' className=\"ellipsis\">{gettext('Name')}</th>\n                <th width='20%'>{gettext('Owner')}</th>\n                <th width='20%'>{gettext('Last Update')}</th>\n                <th width='10%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.drafts.map((item, index) => {\n                return (\n                  <DraftItem\n                    key={index}\n                    draftItem={item}\n                    onDeleteDraftItem={this.onDeleteDraftItem}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListRepoDraftsDialog.propTypes = propTypes;\n\nexport default ListRepoDraftsDialog;\n\nconst DraftItemPropTypes = {\n  draftItem: PropTypes.object,\n  onDeleteDraftItem: PropTypes.func.isRequired,\n};\n\nclass DraftItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  render() {\n    const draftItem = this.props.draftItem;\n    let href = siteRoot + 'drafts/' + draftItem.id + '/';\n    let className = this.state.active ? 'action-icon sf2-icon-x3' : 'action-icon vh sf2-icon-x3';\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"name\">\n          <a href={href} target='_blank'>{Utils.getFileName(draftItem.draftFilePath)}</a>\n        </td>\n        <td>{draftItem.ownerNickname}</td>\n        <td>{moment(draftItem.createdStr).fromNow()}</td>\n        <td>\n          <i className={className} onClick={this.props.onDeleteDraftItem.bind(this, draftItem)}></i>\n        </td>\n      </tr>\n    );\n  }\n}\n\nDraftItem.propTypes = DraftItemPropTypes;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { MarkdownViewer } from '@seafile/seafile-editor';\nimport Loading from '../../components/loading';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, mediaUrl } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileName: PropTypes.string.isRequired,\n  href: PropTypes.string,\n  toggleCancel: PropTypes.func.isRequired,\n};\n\nclass ReadmeDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      readmeContent: null,\n      isLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getFileDownloadLink(this.props.repoID, this.props.filePath).then(res => {\n      seafileAPI.getFileContent(res.data).then(res => {\n        this.setState({\n          readmeContent: res.data,\n          isLoading: false,\n        });\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleCancel} className=\"readme-dialog\" size=\"lg\">\n        <ModalHeader>{this.props.fileName}\n          <a className=\"readme-dialog-edit\" href={this.props.href} target='_blank'><i className=\"fa fa-pencil-alt\"></i></a>\n        </ModalHeader>\n        <ModalBody>\n          {this.state.isLoading ?\n            <Loading />:\n            <MarkdownViewer\n              markdownContent={this.state.readmeContent}\n              showTOC={false}\n              scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n            />\n          }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nReadmeDialog.propTypes = propTypes;\n\nexport default ReadmeDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ModalPortal from './modal-portal';\nimport ListTaggedFilesDialog from './dialog/list-taggedfiles-dialog';\nimport ListRepoDraftsDialog from './dialog/list-repo-drafts-dialog';\nimport ReadmeDialog from './dialog/readme-dialog';\nimport { siteRoot, gettext } from '../utils/constants';\nimport { Utils } from '../utils/utils';\n\nimport '../css/repo-info-bar.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  updateUsedRepoTags: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  className: PropTypes.string,\n  shareLinkToken: PropTypes.string,\n  enableFileDownload: PropTypes.bool\n};\n\nclass RepoInfoBar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentTag: null,\n      isListTaggedFileShow: false,\n      showRepoDrafts: false,\n      showReadmeDialog: false,\n    };\n  }\n\n  onListTaggedFiles = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListTaggedFileShow: !this.state.isListTaggedFileShow,\n    });\n  }\n\n  onCloseDialog = () => {\n    this.setState({\n      isListTaggedFileShow: false\n    });\n  }\n\n  toggleDrafts = () => {\n    this.setState({\n      showRepoDrafts: !this.state.showRepoDrafts\n    });\n  }\n\n  toggleReadme = () => {\n    this.setState({\n      showReadmeDialog: !this.state.showReadmeDialog\n    });\n  }\n\n  render() {\n    let { repoID, currentPath, usedRepoTags, readmeMarkdown, draftCounts, className } = this.props;\n\n    // to be compatible with the existing code\n    if (readmeMarkdown === undefined) {\n      readmeMarkdown = null;\n    }\n    if (draftCounts === undefined) {\n      draftCounts = 0;\n    }\n\n    let href = readmeMarkdown !== null ? siteRoot + 'lib/' + repoID + '/file' + Utils.joinPath(currentPath, readmeMarkdown.name) +  '?mode=edit' : '';\n    let filePath = readmeMarkdown !== null ? currentPath + readmeMarkdown.name : '';\n    return (\n      <div className={`repo-info-bar ${className ? className : ''}`}>\n        {usedRepoTags.length > 0 && (\n          <ul className=\"used-tag-list\">\n            {usedRepoTags.map((usedRepoTag) => {\n              return (\n                <li key={usedRepoTag.id} className=\"used-tag-item\">\n                  <span className=\"used-tag\" style={{backgroundColor:usedRepoTag.color}}></span>\n                  <span className=\"used-tag-name\" title={usedRepoTag.name}>{usedRepoTag.name}</span>\n                  <button type=\"button\" className=\"used-tag-files border-0 bg-transparent\" onClick={this.onListTaggedFiles.bind(this, usedRepoTag)}>\n                    {usedRepoTag.fileCount > 1 ? usedRepoTag.fileCount + ' files' : usedRepoTag.fileCount + ' file'}\n                  </button>\n                </li>\n              );\n            })}\n          </ul>\n        )}\n        <div className={(usedRepoTags.length > 0 && readmeMarkdown) ? 'file-info-list mt-1' : 'file-info-list'}>\n          {(readmeMarkdown !== null && parseInt(readmeMarkdown.size) > 1) &&\n            <span className=\"file-info\" onClick={this.toggleReadme}>\n              <span className=\"info-icon sf2-icon-readme\"></span>\n              <span className=\"used-tag-name\">{readmeMarkdown.name}</span>\n            </span>\n          }\n          {(readmeMarkdown !== null && parseInt(readmeMarkdown.size) < 2) &&\n            <span className=\"file-info\">\n              <span className=\"info-icon sf2-icon-readme\"></span>\n              <a className=\"used-tag-name\" href={href} target='_blank' rel=\"noreferrer\">{readmeMarkdown.name}</a>\n            </span>\n          }\n          {draftCounts > 0 &&\n            <span className=\"file-info\">\n              <span className=\"info-icon sf2-icon-drafts\"></span>\n              <span className=\"used-tag-name\">{gettext('draft')}</span>\n              <button type=\"button\" className=\"used-tag-files border-0 bg-transparent\" onClick={this.toggleDrafts}>\n                {draftCounts > 1 ? draftCounts + ' files' : draftCounts + ' file'}\n              </button>\n            </span>\n          }\n        </div>\n        {this.state.isListTaggedFileShow && (\n          <ModalPortal>\n            <ListTaggedFilesDialog\n              repoID={repoID}\n              currentTag={this.state.currentTag}\n              onClose={this.onCloseDialog}\n              toggleCancel={this.onListTaggedFiles}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              onFileTagChanged={this.props.onFileTagChanged}\n              shareLinkToken={this.props.shareLinkToken}\n              enableFileDownload={this.props.enableFileDownload}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.showRepoDrafts && (\n          <ModalPortal>\n            <ListRepoDraftsDialog\n              toggle={this.toggleDrafts}\n              repoID={this.props.repoID}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.showReadmeDialog && (\n          <ModalPortal>\n            <ReadmeDialog\n              toggleCancel={this.toggleReadme}\n              repoID={repoID}\n              filePath={filePath}\n              href={href}\n              fileName={readmeMarkdown.name}\n            />\n          </ModalPortal>\n        )}\n      </div>\n    );\n  }\n}\n\nRepoInfoBar.propTypes = propTypes;\n\nexport default RepoInfoBar;\n","/**\n * Parses an URI\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\n\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\n\nvar parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\n\nmodule.exports = function parseuri(str) {\n    var src = str,\n        b = str.indexOf('['),\n        e = str.indexOf(']');\n\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n\n    var m = re.exec(str || ''),\n        uri = {},\n        i = 14;\n\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n\n    return uri;\n};\n\nfunction pathNames(obj, path) {\n    var regx = /\\/{2,9}/g,\n        names = path.replace(regx, \"/\").split(\"/\");\n\n    if (path.substr(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.substr(path.length - 1, 1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n\n    return names;\n}\n\nfunction queryKey(uri, query) {\n    var data = {};\n\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n\n    return data;\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","\nmodule.exports = isBuf;\n\nvar withNativeBuffer = typeof Buffer === 'function' && typeof Buffer.isBuffer === 'function';\nvar withNativeArrayBuffer = typeof ArrayBuffer === 'function';\n\nvar isView = function (obj) {\n  return typeof ArrayBuffer.isView === 'function' ? ArrayBuffer.isView(obj) : (obj.buffer instanceof ArrayBuffer);\n};\n\n/**\n * Returns true if obj is a buffer or an arraybuffer.\n *\n * @api private\n */\n\nfunction isBuf(obj) {\n  return (withNativeBuffer && Buffer.isBuffer(obj)) ||\n          (withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj)));\n}\n","\n/**\n * Module dependencies.\n */\n\nvar eio = require('engine.io-client');\nvar Socket = require('./socket');\nvar Emitter = require('component-emitter');\nvar parser = require('socket.io-parser');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:manager');\nvar indexOf = require('indexof');\nvar Backoff = require('backo2');\n\n/**\n * IE6+ hasOwnProperty\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager (uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' === typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n  var _parser = opts.parser || parser;\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : (nsp + '#')) + this.engine.id;\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    if (timeout === 0) {\n      openSub.destroy(); // prevents a race condition with the 'open' event\n    }\n\n    // set timer\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function () {\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting () {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n\n  var subsLength = this.subs.length;\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};\n","/**\n * Module dependencies\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar XHR = require('./polling-xhr');\nvar JSONP = require('./polling-jsonp');\nvar websocket = require('./websocket');\n\n/**\n * Export transports.\n */\n\nexports.polling = polling;\nexports.websocket = websocket;\n\n/**\n * Polling transport polymorphic constructor.\n * Decides on xhr vs jsonp based on feature detection.\n *\n * @api private\n */\n\nfunction polling (opts) {\n  var xhr;\n  var xd = false;\n  var xs = false;\n  var jsonp = false !== opts.jsonp;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    xd = opts.hostname !== location.hostname || port !== opts.port;\n    xs = opts.secure !== isSSL;\n  }\n\n  opts.xdomain = xd;\n  opts.xscheme = xs;\n  xhr = new XMLHttpRequest(opts);\n\n  if ('open' in xhr && !opts.forceJSONP) {\n    return new XHR(opts);\n  } else {\n    if (!jsonp) throw new Error('JSONP disabled');\n    return new JSONP(opts);\n  }\n}\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parseqs = require('parseqs');\nvar parser = require('engine.io-parser');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:polling');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Polling;\n\n/**\n * Is XHR2 supported?\n */\n\nvar hasXHR2 = (function () {\n  var XMLHttpRequest = require('xmlhttprequest-ssl');\n  var xhr = new XMLHttpRequest({ xdomain: false });\n  return null != xhr.responseType;\n})();\n\n/**\n * Polling interface.\n *\n * @param {Object} opts\n * @api private\n */\n\nfunction Polling (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (!hasXHR2 || forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(Polling, Transport);\n\n/**\n * Transport name.\n */\n\nPolling.prototype.name = 'polling';\n\n/**\n * Opens the socket (triggers polling). We write a PING message to determine\n * when the transport is open.\n *\n * @api private\n */\n\nPolling.prototype.doOpen = function () {\n  this.poll();\n};\n\n/**\n * Pauses polling.\n *\n * @param {Function} callback upon buffers are flushed and transport is paused\n * @api private\n */\n\nPolling.prototype.pause = function (onPause) {\n  var self = this;\n\n  this.readyState = 'pausing';\n\n  function pause () {\n    debug('paused');\n    self.readyState = 'paused';\n    onPause();\n  }\n\n  if (this.polling || !this.writable) {\n    var total = 0;\n\n    if (this.polling) {\n      debug('we are currently polling - waiting to pause');\n      total++;\n      this.once('pollComplete', function () {\n        debug('pre-pause polling complete');\n        --total || pause();\n      });\n    }\n\n    if (!this.writable) {\n      debug('we are currently writing - waiting to pause');\n      total++;\n      this.once('drain', function () {\n        debug('pre-pause writing complete');\n        --total || pause();\n      });\n    }\n  } else {\n    pause();\n  }\n};\n\n/**\n * Starts polling cycle.\n *\n * @api public\n */\n\nPolling.prototype.poll = function () {\n  debug('polling');\n  this.polling = true;\n  this.doPoll();\n  this.emit('poll');\n};\n\n/**\n * Overloads onData to detect payloads.\n *\n * @api private\n */\n\nPolling.prototype.onData = function (data) {\n  var self = this;\n  debug('polling got data %s', data);\n  var callback = function (packet, index, total) {\n    // if its the first message we consider the transport open\n    if ('opening' === self.readyState && packet.type === 'open') {\n      self.onOpen();\n    }\n\n    // if its a close packet, we close the ongoing requests\n    if ('close' === packet.type) {\n      self.onClose();\n      return false;\n    }\n\n    // otherwise bypass onData and handle the message\n    self.onPacket(packet);\n  };\n\n  // decode payload\n  parser.decodePayload(data, this.socket.binaryType, callback);\n\n  // if an event did not trigger closing\n  if ('closed' !== this.readyState) {\n    // if we got data we're not polling\n    this.polling = false;\n    this.emit('pollComplete');\n\n    if ('open' === this.readyState) {\n      this.poll();\n    } else {\n      debug('ignoring poll - transport state \"%s\"', this.readyState);\n    }\n  }\n};\n\n/**\n * For polling, send a close packet.\n *\n * @api private\n */\n\nPolling.prototype.doClose = function () {\n  var self = this;\n\n  function close () {\n    debug('writing close packet');\n    self.write([{ type: 'close' }]);\n  }\n\n  if ('open' === this.readyState) {\n    debug('transport open - closing');\n    close();\n  } else {\n    // in case we're trying to close while\n    // handshaking is in progress (GH-164)\n    debug('transport not open - deferring close');\n    this.once('open', close);\n  }\n};\n\n/**\n * Writes a packets payload.\n *\n * @param {Array} data packets\n * @param {Function} drain callback\n * @api private\n */\n\nPolling.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n  var callbackfn = function () {\n    self.writable = true;\n    self.emit('drain');\n  };\n\n  parser.encodePayload(packets, this.supportsBinary, function (data) {\n    self.doWrite(data, callbackfn);\n  });\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nPolling.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'https' : 'http';\n  var port = '';\n\n  // cache busting is forced\n  if (false !== this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  if (!this.supportsBinary && !query.sid) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // avoid port if default for schema\n  if (this.port && (('https' === schema && Number(this.port) !== 443) ||\n     ('http' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n","/* global Blob File */\n\n/*\n * Module requirements.\n */\n\nvar isArray = require('isarray');\n\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' ||\n                        typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof File === 'function' ||\n                        typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]';\n\n/**\n * Module exports.\n */\n\nmodule.exports = hasBinary;\n\n/**\n * Checks for binary data.\n *\n * Supports Buffer, ArrayBuffer, Blob and File.\n *\n * @param {Object} anything\n * @api public\n */\n\nfunction hasBinary (obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  if (isArray(obj)) {\n    for (var i = 0, l = obj.length; i < l; i++) {\n      if (hasBinary(obj[i])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if ((typeof Buffer === 'function' && Buffer.isBuffer && Buffer.isBuffer(obj)) ||\n    (typeof ArrayBuffer === 'function' && obj instanceof ArrayBuffer) ||\n    (withNativeBlob && obj instanceof Blob) ||\n    (withNativeFile && obj instanceof File)\n  ) {\n    return true;\n  }\n\n  // see: https://github.com/Automattic/has-binary/pull/4\n  if (obj.toJSON && typeof obj.toJSON === 'function' && arguments.length === 1) {\n    return hasBinary(obj.toJSON(), true);\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","'use strict';\n\nvar alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split('')\n  , length = 64\n  , map = {}\n  , seed = 0\n  , i = 0\n  , prev;\n\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nfunction encode(num) {\n  var encoded = '';\n\n  do {\n    encoded = alphabet[num % length] + encoded;\n    num = Math.floor(num / length);\n  } while (num > 0);\n\n  return encoded;\n}\n\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nfunction decode(str) {\n  var decoded = 0;\n\n  for (i = 0; i < str.length; i++) {\n    decoded = decoded * length + map[str.charAt(i)];\n  }\n\n  return decoded;\n}\n\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nfunction yeast() {\n  var now = encode(+new Date());\n\n  if (now !== prev) return seed = 0, prev = now;\n  return now +'.'+ encode(seed++);\n}\n\n//\n// Map each character to its index.\n//\nfor (; i < length; i++) map[alphabet[i]] = i;\n\n//\n// Expose the `yeast`, `encode` and `decode` functions.\n//\nyeast.encode = encode;\nyeast.decode = decode;\nmodule.exports = yeast;\n","\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};","\n/**\n * Module dependencies.\n */\n\nvar parser = require('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar toArray = require('to-array');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:socket');\nvar parseqs = require('parseqs');\nvar hasBin = require('has-binary2');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Internal events (blacklisted).\n * These events can't be emitted by the user.\n *\n * @api private\n */\n\nvar events = {\n  connect: 1,\n  connect_error: 1,\n  connect_timeout: 1,\n  connecting: 1,\n  disconnect: 1,\n  error: 1,\n  reconnect: 1,\n  reconnect_attempt: 1,\n  reconnect_failed: 1,\n  reconnect_error: 1,\n  reconnecting: 1,\n  ping: 1,\n  pong: 1\n};\n\n/**\n * Shortcut to `Emitter#emit`.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * `Socket` constructor.\n *\n * @api public\n */\n\nfunction Socket (io, nsp, opts) {\n  this.io = io;\n  this.nsp = nsp;\n  this.json = this; // compat\n  this.ids = 0;\n  this.acks = {};\n  this.receiveBuffer = [];\n  this.sendBuffer = [];\n  this.connected = false;\n  this.disconnected = true;\n  this.flags = {};\n  if (opts && opts.query) {\n    this.query = opts.query;\n  }\n  if (this.io.autoConnect) this.open();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Subscribe to open, close and packet events\n *\n * @api private\n */\n\nSocket.prototype.subEvents = function () {\n  if (this.subs) return;\n\n  var io = this.io;\n  this.subs = [\n    on(io, 'open', bind(this, 'onopen')),\n    on(io, 'packet', bind(this, 'onpacket')),\n    on(io, 'close', bind(this, 'onclose'))\n  ];\n};\n\n/**\n * \"Opens\" the socket.\n *\n * @api public\n */\n\nSocket.prototype.open =\nSocket.prototype.connect = function () {\n  if (this.connected) return this;\n\n  this.subEvents();\n  if (!this.io.reconnecting) this.io.open(); // ensure open\n  if ('open' === this.io.readyState) this.onopen();\n  this.emit('connecting');\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = function () {\n  var args = toArray(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Override `emit`.\n * If the event is in `events`, it's emitted normally.\n *\n * @param {String} event name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (events.hasOwnProperty(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = toArray(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  packet.options = {};\n  packet.options.compress = !this.flags || false !== this.flags.compress;\n\n  // event ack callback\n  if ('function' === typeof args[args.length - 1]) {\n    debug('emitting packet with ack id %d', this.ids);\n    this.acks[this.ids] = args.pop();\n    packet.id = this.ids++;\n  }\n\n  if (this.connected) {\n    this.packet(packet);\n  } else {\n    this.sendBuffer.push(packet);\n  }\n\n  this.flags = {};\n\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.packet = function (packet) {\n  packet.nsp = this.nsp;\n  this.io.packet(packet);\n};\n\n/**\n * Called upon engine `open`.\n *\n * @api private\n */\n\nSocket.prototype.onopen = function () {\n  debug('transport is open - connecting');\n\n  // write connect packet if necessary\n  if ('/' !== this.nsp) {\n    if (this.query) {\n      var query = typeof this.query === 'object' ? parseqs.encode(this.query) : this.query;\n      debug('sending connect packet with query %s', query);\n      this.packet({type: parser.CONNECT, query: query});\n    } else {\n      this.packet({type: parser.CONNECT});\n    }\n  }\n};\n\n/**\n * Called upon engine `close`.\n *\n * @param {String} reason\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  debug('close (%s)', reason);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.id;\n  this.emit('disconnect', reason);\n};\n\n/**\n * Called with socket packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  var sameNamespace = packet.nsp === this.nsp;\n  var rootNamespaceError = packet.type === parser.ERROR && packet.nsp === '/';\n\n  if (!sameNamespace && !rootNamespaceError) return;\n\n  switch (packet.type) {\n    case parser.CONNECT:\n      this.onconnect();\n      break;\n\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n      break;\n  }\n};\n\n/**\n * Called upon a server event.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  if (this.connected) {\n    emit.apply(this, args);\n  } else {\n    this.receiveBuffer.push(args);\n  }\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    sent = true;\n    var args = toArray(arguments);\n    debug('sending ack %j', args);\n\n    self.packet({\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      id: id,\n      data: args\n    });\n  };\n};\n\n/**\n * Called upon a server acknowlegement.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' === typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon server connect.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  this.connected = true;\n  this.disconnected = false;\n  this.emit('connect');\n  this.emitBuffered();\n};\n\n/**\n * Emit buffered events (received and emitted).\n *\n * @api private\n */\n\nSocket.prototype.emitBuffered = function () {\n  var i;\n  for (i = 0; i < this.receiveBuffer.length; i++) {\n    emit.apply(this, this.receiveBuffer[i]);\n  }\n  this.receiveBuffer = [];\n\n  for (i = 0; i < this.sendBuffer.length; i++) {\n    this.packet(this.sendBuffer[i]);\n  }\n  this.sendBuffer = [];\n};\n\n/**\n * Called upon server disconnect.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('server disconnect (%s)', this.nsp);\n  this.destroy();\n  this.onclose('io server disconnect');\n};\n\n/**\n * Called upon forced client/server side disconnections,\n * this method ensures the manager stops tracking us and\n * that reconnections don't get triggered for this.\n *\n * @api private.\n */\n\nSocket.prototype.destroy = function () {\n  if (this.subs) {\n    // clean subscriptions to avoid reconnections\n    for (var i = 0; i < this.subs.length; i++) {\n      this.subs[i].destroy();\n    }\n    this.subs = null;\n  }\n\n  this.io.destroy(this);\n};\n\n/**\n * Disconnects the socket manually.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.close =\nSocket.prototype.disconnect = function () {\n  if (this.connected) {\n    debug('performing disconnect (%s)', this.nsp);\n    this.packet({ type: parser.DISCONNECT });\n  }\n\n  // remove socket from pool\n  this.destroy();\n\n  if (this.connected) {\n    // fire events\n    this.onclose('io client disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} whether the emitted data contains binary\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.binary = function (binary) {\n  this.flags.binary = binary;\n  return this;\n};\n","\n/**\n * Module exports.\n */\n\nmodule.exports = on;\n\n/**\n * Helper for subscriptions.\n *\n * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`\n * @param {String} event name\n * @param {Function} callback\n * @api public\n */\n\nfunction on (obj, ev, fn) {\n  obj.on(ev, fn);\n  return {\n    destroy: function () {\n      obj.removeListener(ev, fn);\n    }\n  };\n}\n","/**\n * Slice reference.\n */\n\nvar slice = [].slice;\n\n/**\n * Bind `obj` to `fn`.\n *\n * @param {Object} obj\n * @param {Function|String} fn or string\n * @return {Function}\n * @api public\n */\n\nmodule.exports = function(obj, fn){\n  if ('string' == typeof fn) fn = obj[fn];\n  if ('function' != typeof fn) throw new Error('bind() requires a function');\n  var args = slice.call(arguments, 2);\n  return function(){\n    return fn.apply(obj, args.concat(slice.call(arguments)));\n  }\n};\n","\n/**\n * Module dependencies.\n */\n\nvar url = require('./url');\nvar parser = require('socket.io-parser');\nvar Manager = require('./manager');\nvar debug = require('debug')('socket.io-client');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = lookup;\n\n/**\n * Managers cache.\n */\n\nvar cache = exports.managers = {};\n\n/**\n * Looks up an existing `Manager` for multiplexing.\n * If the user summons:\n *\n *   `io('http://localhost/a');`\n *   `io('http://localhost/b');`\n *\n * We reuse the existing instance based on same scheme/port/host,\n * and we initialize sockets for each namespace.\n *\n * @api public\n */\n\nfunction lookup (uri, opts) {\n  if (typeof uri === 'object') {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n\n  var parsed = url(uri);\n  var source = parsed.source;\n  var id = parsed.id;\n  var path = parsed.path;\n  var sameNamespace = cache[id] && path in cache[id].nsps;\n  var newConnection = opts.forceNew || opts['force new connection'] ||\n                      false === opts.multiplex || sameNamespace;\n\n  var io;\n\n  if (newConnection) {\n    debug('ignoring socket cache for %s', source);\n    io = Manager(source, opts);\n  } else {\n    if (!cache[id]) {\n      debug('new io instance for %s', source);\n      cache[id] = Manager(source, opts);\n    }\n    io = cache[id];\n  }\n  if (parsed.query && !opts.query) {\n    opts.query = parsed.query;\n  }\n  return io.socket(parsed.path, opts);\n}\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = parser.protocol;\n\n/**\n * `connect`.\n *\n * @param {String} uri\n * @api public\n */\n\nexports.connect = lookup;\n\n/**\n * Expose constructors for standalone build.\n *\n * @api public\n */\n\nexports.Manager = require('./manager');\nexports.Socket = require('./socket');\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { MarkdownViewer } from '@seafile/seafile-editor';\nimport { gettext, repoID, slug, serviceURL, isPublicWiki, sharedToken, mediaUrl } from '../utils/constants';\nimport Loading from './loading';\nimport { Utils } from '../utils/utils';\n\nconst propTypes = {\n  children: PropTypes.object,\n  isFileLoading: PropTypes.bool.isRequired,\n  markdownContent: PropTypes.string.isRequired,\n  latestContributor: PropTypes.string.isRequired,\n  lastModified: PropTypes.string.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n  isWiki: PropTypes.bool,\n  isTOCShow: PropTypes.bool,\n  // for dir-column-file component(import repoID is undefined)\n  repoID: PropTypes.string,\n  path: PropTypes.string,\n};\n\nconst contentClass = 'wiki-page-content';\n\nclass WikiMarkdownViewer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTitleIndex: 0,\n    };\n    this.markdownContainer = React.createRef();\n    this.links = [];\n    this.titlesInfo = [];\n  }\n\n  componentDidMount() {\n    // Bind event when first loaded\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n\n    this.getTitlesInfo();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.markdownContent === nextProps.markdownContent) {\n      return;\n    }\n    // Unbound event when updating\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  componentDidUpdate() {\n    // Update completed, rebind event\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n    if (this.titlesInfo.length === 0) {\n      this.getTitlesInfo();\n    }\n  }\n\n  componentWillUnmount() {\n    // Unbound events when the component is destroyed\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  getTitlesInfo = () => {\n    let titlesInfo = [];\n    const titleDom = document.querySelectorAll('h1[id^=\"user-content\"]')[0];\n    if (titleDom) {\n      const id = titleDom.getAttribute('id');\n      let content = id && id.replace('user-content-', '');\n      content = content ? `${content} - ${slug}` : slug;\n      Utils.updateTabTitle(content);\n    }\n    let headingList = document.querySelectorAll('h2[id^=\"user-content\"], h3[id^=\"user-content\"]');\n    for (let i = 0; i < headingList.length; i++) {\n      titlesInfo.push(headingList[i].offsetTop);\n    }\n    this.titlesInfo = titlesInfo;\n  }\n\n  onLinkClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    let link = '';\n    if (event.target.tagName !== 'A') {\n      let target = event.target.parentNode;\n      while (target.tagName !== 'A') {\n        target = target.parentNode;\n      }\n      link = target.href;\n    } else {\n      link = event.target.href;\n    }\n    this.props.onLinkClick(link);\n  }\n\n  onScrollHandler = () => {\n    const contentScrollTop = this.markdownContainer.current.scrollTop + 180;\n    let titlesLength = this.titlesInfo.length;\n    let activeTitleIndex;\n    if (contentScrollTop <= this.titlesInfo[0]) {\n      activeTitleIndex = 0;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    if (contentScrollTop > this.titlesInfo[titlesLength - 1]) {\n      activeTitleIndex = this.titlesInfo.length - 1;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    for (let i = 0; i < titlesLength; i++) {\n      if (contentScrollTop > this.titlesInfo[i]) {\n        continue;\n      } else {\n        activeTitleIndex = i - 1;\n        break;\n      }\n    }\n    this.setState({activeTitleIndex: activeTitleIndex});\n  }\n\n  changeInlineNode = (item) => {\n    let url, imagePath;\n\n    if (item.type == 'image' && isPublicWiki) { // change image url\n      url = item.data.src;\n      const re = new RegExp(serviceURL + '/lib/' + repoID +'/file.*raw=1');\n      // different repo\n      if (re.test(url)) {\n        // get image path\n        let index = url.indexOf('/file');\n        let index2 = url.indexOf('?');\n        imagePath = url.substring(index + 5, index2);\n      } else if (/^\\.\\.\\/*/.test(url) || /^\\.\\/*/.test(url)) {\n        const path = this.props.path;\n        const originalPath = path.slice(0, path.lastIndexOf('/')) + '/' + url;\n        imagePath = Utils.pathNormalize(originalPath);\n      } else {\n        return;\n      }\n      item.data.src = serviceURL + '/view-image-via-public-wiki/?slug=' + slug + '&path=' + imagePath;\n    } else if (item.type == 'link') { // change link url\n      url = item.data.href;\n      if (Utils.isInternalFileLink(url, repoID)) { // change file url\n        if (Utils.isInternalMarkdownLink(url, repoID)) {\n          let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n          // replace url\n          item.data.href = serviceURL + '/published/' + slug + path;\n        } else {\n          item.data.href = url.replace(/(.*)lib\\/([-0-9a-f]{36})\\/file(.*)/g, (match, p1, p2, p3) => {\n            return `${p1}d/${sharedToken}/files/?p=${p3}&dl=1`;\n          });\n        }\n      } else if (Utils.isInternalDirLink(url, repoID)) { // change dir url\n        let path = Utils.getPathFromInternalDirLink(url, repoID);\n        // replace url\n        item.data.href = serviceURL + '/published/' + slug + path;\n      }\n    }\n\n    return item;\n  }\n\n  modifyValueBeforeRender = (value) => {\n    let newNodes = Utils.changeMarkdownNodes(value, this.changeInlineNode);\n    return newNodes;\n  }\n\n  renderMarkdown = () => {\n    let isTOCShow = true;\n    if (this.props.isTOCShow === false) {\n      isTOCShow = false;\n    }\n    if (this.props.isWiki) {\n      return (\n        <MarkdownViewer\n          showTOC={isTOCShow}\n          scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n          markdownContent={this.props.markdownContent}\n          activeTitleIndex={this.state.activeTitleIndex}\n          modifyValueBeforeRender={this.modifyValueBeforeRender}\n        />\n      );\n    }\n\n    return (\n      <MarkdownViewer\n        showTOC={isTOCShow}\n        scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n        markdownContent={this.props.markdownContent}\n        activeTitleIndex={this.state.activeTitleIndex}\n      />\n    );\n  }\n\n  render() {\n    if (this.props.isFileLoading) {\n      return <Loading />;\n    }\n    // In dir-column-file repoID is one of props, width is 100%; In wiki-viewer repoID is not props, width isn't 100%\n    let contentClassName = `${this.props.repoID ? contentClass + ' w-100' : contentClass}`;\n    return (\n      <div ref={this.markdownContainer} className=\"wiki-page-container\" onScroll={this.onScrollHandler.bind(this)}>\n        <div className={contentClassName}>\n          {this.props.children}\n          {this.renderMarkdown()}\n          <p id=\"wiki-page-last-modified\">{gettext('Last modified by')} {this.props.latestContributor}, <span>{this.props.lastModified}</span></p>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst defaultProps = {\n  isWiki: false,\n};\n\nWikiMarkdownViewer.propTypes = propTypes;\nMarkdownViewer.defaultProps = defaultProps;\n\nexport default WikiMarkdownViewer;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Modal from 'react-modal';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\n/**\n * Placeholder for future translate functionality\n */\nfunction translate(str) {\n  var replaceStrings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!str) {\n    return '';\n  }\n\n  var translated = str;\n\n  if (replaceStrings) {\n    Object.keys(replaceStrings).forEach(function (placeholder) {\n      translated = translated.replace(placeholder, replaceStrings[placeholder]);\n    });\n  }\n\n  return translated;\n}\nfunction getWindowWidth() {\n  return typeof global.window !== 'undefined' ? global.window.innerWidth : 0;\n}\nfunction getWindowHeight() {\n  return typeof global.window !== 'undefined' ? global.window.innerHeight : 0;\n} // Get the highest window context that isn't cross-origin\n// (When in an iframe)\n\nfunction getHighestSafeWindowContext() {\n  var self = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : global.window.self;\n  var referrer = self.document.referrer; // If we reached the top level, return self\n\n  if (self === global.window.top || !referrer) {\n    return self;\n  }\n\n  var getOrigin = function getOrigin(href) {\n    return href.match(/(.*\\/\\/.*?)(\\/|$)/)[1];\n  }; // If parent is the same origin, we can move up one context\n  // Reference: https://stackoverflow.com/a/21965342/1601953\n\n\n  if (getOrigin(self.location.href) === getOrigin(referrer)) {\n    return getHighestSafeWindowContext(self.parent);\n  } // If a different origin, we consider the current level\n  // as the top reachable one\n\n\n  return self;\n}\n\n// Min image zoom level\nvar MIN_ZOOM_LEVEL = 0; // Max image zoom level\n\nvar MAX_ZOOM_LEVEL = 300; // Size ratio between previous and next zoom levels\n\nvar ZOOM_RATIO = 1.007; // How much to increase/decrease the zoom level when the zoom buttons are clicked\n\nvar ZOOM_BUTTON_INCREMENT_SIZE = 100; // Used to judge the amount of horizontal scroll needed to initiate a image move\n\nvar WHEEL_MOVE_Y_THRESHOLD = 1;\nvar KEYS = {\n  ESC: 27,\n  LEFT_ARROW: 37,\n  RIGHT_ARROW: 39\n}; // Actions\n\nvar ACTION_NONE = 0;\nvar ACTION_MOVE = 1;\nvar ACTION_SWIPE = 2;\nvar ACTION_PINCH = 3;\n\nvar SOURCE_ANY = 0;\nvar SOURCE_MOUSE = 1;\nvar SOURCE_TOUCH = 2;\nvar SOURCE_POINTER = 3; // Minimal swipe distance\n\nvar MIN_SWIPE_DISTANCE = 200;\n\nvar ReactImageLightbox =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ReactImageLightbox, _Component);\n\n  _createClass(ReactImageLightbox, null, [{\n    key: \"isTargetMatchImage\",\n    value: function isTargetMatchImage(target) {\n      return target && /ril-image-current/.test(target.className);\n    }\n  }, {\n    key: \"parseMouseEvent\",\n    value: function parseMouseEvent(mouseEvent) {\n      return {\n        id: 'mouse',\n        source: SOURCE_MOUSE,\n        x: parseInt(mouseEvent.clientX, 10),\n        y: parseInt(mouseEvent.clientY, 10)\n      };\n    }\n  }, {\n    key: \"parseTouchPointer\",\n    value: function parseTouchPointer(touchPointer) {\n      return {\n        id: touchPointer.identifier,\n        source: SOURCE_TOUCH,\n        x: parseInt(touchPointer.clientX, 10),\n        y: parseInt(touchPointer.clientY, 10)\n      };\n    }\n  }, {\n    key: \"parsePointerEvent\",\n    value: function parsePointerEvent(pointerEvent) {\n      return {\n        id: pointerEvent.pointerId,\n        source: SOURCE_POINTER,\n        x: parseInt(pointerEvent.clientX, 10),\n        y: parseInt(pointerEvent.clientY, 10)\n      };\n    } // Request to transition to the previous image\n\n  }, {\n    key: \"getTransform\",\n    value: function getTransform(_ref) {\n      var _ref$x = _ref.x,\n          x = _ref$x === void 0 ? 0 : _ref$x,\n          _ref$y = _ref.y,\n          y = _ref$y === void 0 ? 0 : _ref$y,\n          _ref$zoom = _ref.zoom,\n          zoom = _ref$zoom === void 0 ? 1 : _ref$zoom,\n          width = _ref.width,\n          targetWidth = _ref.targetWidth;\n      var nextX = x;\n      var windowWidth = getWindowWidth();\n\n      if (width > windowWidth) {\n        nextX += (windowWidth - width) / 2;\n      }\n\n      var scaleFactor = zoom * (targetWidth / width);\n      return {\n        transform: \"translate3d(\".concat(nextX, \"px,\").concat(y, \"px,0) scale3d(\").concat(scaleFactor, \",\").concat(scaleFactor, \",1)\")\n      };\n    }\n  }]);\n\n  function ReactImageLightbox(props) {\n    var _this;\n\n    _classCallCheck(this, ReactImageLightbox);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReactImageLightbox).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleWheel\", function (event) {\n      event.preventDefault();\n    });\n\n    _this.state = {\n      //-----------------------------\n      // Animation\n      //-----------------------------\n      // Lightbox is closing\n      // When Lightbox is mounted, if animation is enabled it will open with the reverse of the closing animation\n      isClosing: !props.animationDisabled,\n      // Component parts should animate (e.g., when images are moving, or image is being zoomed)\n      shouldAnimate: false,\n      //-----------------------------\n      // Zoom settings\n      //-----------------------------\n      // Zoom level of image\n      zoomLevel: MIN_ZOOM_LEVEL,\n      //-----------------------------\n      // Image position settings\n      //-----------------------------\n      // Horizontal offset from center\n      offsetX: 0,\n      // Vertical offset from center\n      offsetY: 0,\n      // image load error for srcType\n      loadErrorStatus: {}\n    }; // Refs\n\n    _this.outerEl = React.createRef();\n    _this.zoomInBtn = React.createRef();\n    _this.zoomOutBtn = React.createRef();\n    _this.caption = React.createRef();\n    _this.closeIfClickInner = _this.closeIfClickInner.bind(_assertThisInitialized(_this));\n    _this.handleImageDoubleClick = _this.handleImageDoubleClick.bind(_assertThisInitialized(_this));\n    _this.handleImageMouseWheel = _this.handleImageMouseWheel.bind(_assertThisInitialized(_this));\n    _this.handleKeyInput = _this.handleKeyInput.bind(_assertThisInitialized(_this));\n    _this.handleMouseUp = _this.handleMouseUp.bind(_assertThisInitialized(_this));\n    _this.handleMouseDown = _this.handleMouseDown.bind(_assertThisInitialized(_this));\n    _this.handleMouseMove = _this.handleMouseMove.bind(_assertThisInitialized(_this));\n    _this.handleOuterMousewheel = _this.handleOuterMousewheel.bind(_assertThisInitialized(_this));\n    _this.handleTouchStart = _this.handleTouchStart.bind(_assertThisInitialized(_this));\n    _this.handleTouchMove = _this.handleTouchMove.bind(_assertThisInitialized(_this));\n    _this.handleTouchEnd = _this.handleTouchEnd.bind(_assertThisInitialized(_this));\n    _this.handlePointerEvent = _this.handlePointerEvent.bind(_assertThisInitialized(_this));\n    _this.handleCaptionMousewheel = _this.handleCaptionMousewheel.bind(_assertThisInitialized(_this));\n    _this.handleWindowResize = _this.handleWindowResize.bind(_assertThisInitialized(_this));\n    _this.handleZoomInButtonClick = _this.handleZoomInButtonClick.bind(_assertThisInitialized(_this));\n    _this.handleZoomOutButtonClick = _this.handleZoomOutButtonClick.bind(_assertThisInitialized(_this));\n    _this.requestClose = _this.requestClose.bind(_assertThisInitialized(_this));\n    _this.requestMoveNext = _this.requestMoveNext.bind(_assertThisInitialized(_this));\n    _this.requestMovePrev = _this.requestMovePrev.bind(_assertThisInitialized(_this));\n    return _this;\n  } // eslint-disable-next-line camelcase\n\n\n  _createClass(ReactImageLightbox, [{\n    key: \"UNSAFE_componentWillMount\",\n    value: function UNSAFE_componentWillMount() {\n      // Timeouts - always clear it before umount\n      this.timeouts = []; // Current action\n\n      this.currentAction = ACTION_NONE; // Events source\n\n      this.eventsSource = SOURCE_ANY; // Empty pointers list\n\n      this.pointerList = []; // Prevent inner close\n\n      this.preventInnerClose = false;\n      this.preventInnerCloseTimeout = null; // Used to disable animation when changing props.mainSrc|nextSrc|prevSrc\n\n      this.keyPressed = false; // Used to store load state / dimensions of images\n\n      this.imageCache = {}; // Time the last keydown event was called (used in keyboard action rate limiting)\n\n      this.lastKeyDownTime = 0; // Used for debouncing window resize event\n\n      this.resizeTimeout = null; // Used to determine when actions are triggered by the scroll wheel\n\n      this.wheelActionTimeout = null;\n      this.resetScrollTimeout = null;\n      this.scrollX = 0;\n      this.scrollY = 0; // Used in panning zoomed images\n\n      this.moveStartX = 0;\n      this.moveStartY = 0;\n      this.moveStartOffsetX = 0;\n      this.moveStartOffsetY = 0; // Used to swipe\n\n      this.swipeStartX = 0;\n      this.swipeStartY = 0;\n      this.swipeEndX = 0;\n      this.swipeEndY = 0; // Used to pinch\n\n      this.pinchTouchList = null;\n      this.pinchDistance = 0; // Used to differentiate between images with identical src\n\n      this.keyCounter = 0; // Used to detect a move when all src's remain unchanged (four or more of the same image in a row)\n\n      this.moveRequested = false;\n\n      if (!this.props.animationDisabled) {\n        // Make opening animation play\n        this.setState({\n          isClosing: false\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // Prevents cross-origin errors when using a cross-origin iframe\n      this.windowContext = getHighestSafeWindowContext();\n      this.listeners = {\n        resize: this.handleWindowResize,\n        mouseup: this.handleMouseUp,\n        touchend: this.handleTouchEnd,\n        touchcancel: this.handleTouchEnd,\n        pointerdown: this.handlePointerEvent,\n        pointermove: this.handlePointerEvent,\n        pointerup: this.handlePointerEvent,\n        pointercancel: this.handlePointerEvent\n      };\n      Object.keys(this.listeners).forEach(function (type) {\n        _this2.windowContext.addEventListener(type, _this2.listeners[type]);\n      });\n      document.addEventListener('wheel', this.handleWheel, {\n        passive: false\n      });\n      this.loadAllImages();\n    } // eslint-disable-next-line camelcase\n\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      var _this3 = this;\n\n      // Iterate through the source types for prevProps and nextProps to\n      //  determine if any of the sources changed\n      var sourcesChanged = false;\n      var prevSrcDict = {};\n      var nextSrcDict = {};\n      this.getSrcTypes().forEach(function (srcType) {\n        if (_this3.props[srcType.name] !== nextProps[srcType.name]) {\n          sourcesChanged = true;\n          prevSrcDict[_this3.props[srcType.name]] = true;\n          nextSrcDict[nextProps[srcType.name]] = true;\n        }\n      });\n\n      if (sourcesChanged || this.moveRequested) {\n        // Reset the loaded state for images not rendered next\n        Object.keys(prevSrcDict).forEach(function (prevSrc) {\n          if (!(prevSrc in nextSrcDict) && prevSrc in _this3.imageCache) {\n            _this3.imageCache[prevSrc].loaded = false;\n          }\n        });\n        this.moveRequested = false; // Load any new images\n\n        this.loadAllImages(nextProps);\n      }\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate() {\n      // Wait for move...\n      return !this.moveRequested;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this4 = this;\n\n      this.didUnmount = true;\n      Object.keys(this.listeners).forEach(function (type) {\n        _this4.windowContext.removeEventListener(type, _this4.listeners[type]);\n      });\n      document.removeEventListener('wheel', this.handleWheel, {\n        passive: false\n      });\n      this.timeouts.forEach(function (tid) {\n        return clearTimeout(tid);\n      });\n    }\n  }, {\n    key: \"setTimeout\",\n    value: function (_setTimeout) {\n      function setTimeout(_x, _x2) {\n        return _setTimeout.apply(this, arguments);\n      }\n\n      setTimeout.toString = function () {\n        return _setTimeout.toString();\n      };\n\n      return setTimeout;\n    }(function (func, time) {\n      var _this5 = this;\n\n      var id = setTimeout(function () {\n        _this5.timeouts = _this5.timeouts.filter(function (tid) {\n          return tid !== id;\n        });\n        func();\n      }, time);\n      this.timeouts.push(id);\n      return id;\n    })\n  }, {\n    key: \"setPreventInnerClose\",\n    value: function setPreventInnerClose() {\n      var _this6 = this;\n\n      if (this.preventInnerCloseTimeout) {\n        this.clearTimeout(this.preventInnerCloseTimeout);\n      }\n\n      this.preventInnerClose = true;\n      this.preventInnerCloseTimeout = this.setTimeout(function () {\n        _this6.preventInnerClose = false;\n        _this6.preventInnerCloseTimeout = null;\n      }, 100);\n    } // Get info for the best suited image to display with the given srcType\n\n  }, {\n    key: \"getBestImageForType\",\n    value: function getBestImageForType(srcType) {\n      var imageSrc = this.props[srcType];\n      var fitSizes = {};\n\n      if (this.isImageLoaded(imageSrc)) {\n        // Use full-size image if available\n        fitSizes = this.getFitSizes(this.imageCache[imageSrc].width, this.imageCache[imageSrc].height);\n      } else if (this.isImageLoaded(this.props[\"\".concat(srcType, \"Thumbnail\")])) {\n        // Fall back to using thumbnail if the image has not been loaded\n        imageSrc = this.props[\"\".concat(srcType, \"Thumbnail\")];\n        fitSizes = this.getFitSizes(this.imageCache[imageSrc].width, this.imageCache[imageSrc].height, true);\n      } else {\n        return null;\n      }\n\n      return {\n        src: imageSrc,\n        height: this.imageCache[imageSrc].height,\n        width: this.imageCache[imageSrc].width,\n        targetHeight: fitSizes.height,\n        targetWidth: fitSizes.width\n      };\n    } // Get sizing for when an image is larger than the window\n\n  }, {\n    key: \"getFitSizes\",\n    value: function getFitSizes(width, height, stretch) {\n      var boxSize = this.getLightboxRect();\n      var maxHeight = boxSize.height - this.props.imagePadding * 2;\n      var maxWidth = boxSize.width - this.props.imagePadding * 2;\n\n      if (!stretch) {\n        maxHeight = Math.min(maxHeight, height);\n        maxWidth = Math.min(maxWidth, width);\n      }\n\n      var maxRatio = maxWidth / maxHeight;\n      var srcRatio = width / height;\n\n      if (maxRatio > srcRatio) {\n        // height is the constraining dimension of the photo\n        return {\n          width: width * maxHeight / height,\n          height: maxHeight\n        };\n      }\n\n      return {\n        width: maxWidth,\n        height: height * maxWidth / width\n      };\n    }\n  }, {\n    key: \"getMaxOffsets\",\n    value: function getMaxOffsets() {\n      var zoomLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.state.zoomLevel;\n      var currentImageInfo = this.getBestImageForType('mainSrc');\n\n      if (currentImageInfo === null) {\n        return {\n          maxX: 0,\n          minX: 0,\n          maxY: 0,\n          minY: 0\n        };\n      }\n\n      var boxSize = this.getLightboxRect();\n      var zoomMultiplier = this.getZoomMultiplier(zoomLevel);\n      var maxX = 0;\n\n      if (zoomMultiplier * currentImageInfo.width - boxSize.width < 0) {\n        // if there is still blank space in the X dimension, don't limit except to the opposite edge\n        maxX = (boxSize.width - zoomMultiplier * currentImageInfo.width) / 2;\n      } else {\n        maxX = (zoomMultiplier * currentImageInfo.width - boxSize.width) / 2;\n      }\n\n      var maxY = 0;\n\n      if (zoomMultiplier * currentImageInfo.height - boxSize.height < 0) {\n        // if there is still blank space in the Y dimension, don't limit except to the opposite edge\n        maxY = (boxSize.height - zoomMultiplier * currentImageInfo.height) / 2;\n      } else {\n        maxY = (zoomMultiplier * currentImageInfo.height - boxSize.height) / 2;\n      }\n\n      return {\n        maxX: maxX,\n        maxY: maxY,\n        minX: -1 * maxX,\n        minY: -1 * maxY\n      };\n    } // Get image src types\n\n  }, {\n    key: \"getSrcTypes\",\n    value: function getSrcTypes() {\n      return [{\n        name: 'mainSrc',\n        keyEnding: \"i\".concat(this.keyCounter)\n      }, {\n        name: 'mainSrcThumbnail',\n        keyEnding: \"t\".concat(this.keyCounter)\n      }, {\n        name: 'nextSrc',\n        keyEnding: \"i\".concat(this.keyCounter + 1)\n      }, {\n        name: 'nextSrcThumbnail',\n        keyEnding: \"t\".concat(this.keyCounter + 1)\n      }, {\n        name: 'prevSrc',\n        keyEnding: \"i\".concat(this.keyCounter - 1)\n      }, {\n        name: 'prevSrcThumbnail',\n        keyEnding: \"t\".concat(this.keyCounter - 1)\n      }];\n    }\n    /**\n     * Get sizing when the image is scaled\n     */\n\n  }, {\n    key: \"getZoomMultiplier\",\n    value: function getZoomMultiplier() {\n      var zoomLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.state.zoomLevel;\n      return Math.pow(ZOOM_RATIO, zoomLevel);\n    }\n    /**\n     * Get the size of the lightbox in pixels\n     */\n\n  }, {\n    key: \"getLightboxRect\",\n    value: function getLightboxRect() {\n      if (this.outerEl.current) {\n        return this.outerEl.current.getBoundingClientRect();\n      }\n\n      return {\n        width: getWindowWidth(),\n        height: getWindowHeight(),\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0\n      };\n    }\n  }, {\n    key: \"clearTimeout\",\n    value: function (_clearTimeout) {\n      function clearTimeout(_x3) {\n        return _clearTimeout.apply(this, arguments);\n      }\n\n      clearTimeout.toString = function () {\n        return _clearTimeout.toString();\n      };\n\n      return clearTimeout;\n    }(function (id) {\n      this.timeouts = this.timeouts.filter(function (tid) {\n        return tid !== id;\n      });\n      clearTimeout(id);\n    }) // Change zoom level\n\n  }, {\n    key: \"changeZoom\",\n    value: function changeZoom(zoomLevel, clientX, clientY) {\n      // Ignore if zoom disabled\n      if (!this.props.enableZoom) {\n        return;\n      } // Constrain zoom level to the set bounds\n\n\n      var nextZoomLevel = Math.max(MIN_ZOOM_LEVEL, Math.min(MAX_ZOOM_LEVEL, zoomLevel)); // Ignore requests that don't change the zoom level\n\n      if (nextZoomLevel === this.state.zoomLevel) {\n        return;\n      }\n\n      if (nextZoomLevel === MIN_ZOOM_LEVEL) {\n        // Snap back to center if zoomed all the way out\n        this.setState({\n          zoomLevel: nextZoomLevel,\n          offsetX: 0,\n          offsetY: 0\n        });\n        return;\n      }\n\n      var imageBaseSize = this.getBestImageForType('mainSrc');\n\n      if (imageBaseSize === null) {\n        return;\n      }\n\n      var currentZoomMultiplier = this.getZoomMultiplier();\n      var nextZoomMultiplier = this.getZoomMultiplier(nextZoomLevel); // Default to the center of the image to zoom when no mouse position specified\n\n      var boxRect = this.getLightboxRect();\n      var pointerX = typeof clientX !== 'undefined' ? clientX - boxRect.left : boxRect.width / 2;\n      var pointerY = typeof clientY !== 'undefined' ? clientY - boxRect.top : boxRect.height / 2;\n      var currentImageOffsetX = (boxRect.width - imageBaseSize.width * currentZoomMultiplier) / 2;\n      var currentImageOffsetY = (boxRect.height - imageBaseSize.height * currentZoomMultiplier) / 2;\n      var currentImageRealOffsetX = currentImageOffsetX - this.state.offsetX;\n      var currentImageRealOffsetY = currentImageOffsetY - this.state.offsetY;\n      var currentPointerXRelativeToImage = (pointerX - currentImageRealOffsetX) / currentZoomMultiplier;\n      var currentPointerYRelativeToImage = (pointerY - currentImageRealOffsetY) / currentZoomMultiplier;\n      var nextImageRealOffsetX = pointerX - currentPointerXRelativeToImage * nextZoomMultiplier;\n      var nextImageRealOffsetY = pointerY - currentPointerYRelativeToImage * nextZoomMultiplier;\n      var nextImageOffsetX = (boxRect.width - imageBaseSize.width * nextZoomMultiplier) / 2;\n      var nextImageOffsetY = (boxRect.height - imageBaseSize.height * nextZoomMultiplier) / 2;\n      var nextOffsetX = nextImageOffsetX - nextImageRealOffsetX;\n      var nextOffsetY = nextImageOffsetY - nextImageRealOffsetY; // When zooming out, limit the offset so things don't get left askew\n\n      if (this.currentAction !== ACTION_PINCH) {\n        var maxOffsets = this.getMaxOffsets();\n\n        if (this.state.zoomLevel > nextZoomLevel) {\n          nextOffsetX = Math.max(maxOffsets.minX, Math.min(maxOffsets.maxX, nextOffsetX));\n          nextOffsetY = Math.max(maxOffsets.minY, Math.min(maxOffsets.maxY, nextOffsetY));\n        }\n      }\n\n      this.setState({\n        zoomLevel: nextZoomLevel,\n        offsetX: nextOffsetX,\n        offsetY: nextOffsetY\n      });\n    }\n  }, {\n    key: \"closeIfClickInner\",\n    value: function closeIfClickInner(event) {\n      if (!this.preventInnerClose && event.target.className.search(/\\bril-inner\\b/) > -1) {\n        this.requestClose(event);\n      }\n    }\n    /**\n     * Handle user keyboard actions\n     */\n\n  }, {\n    key: \"handleKeyInput\",\n    value: function handleKeyInput(event) {\n      event.stopPropagation(); // Ignore key input during animations\n\n      if (this.isAnimating()) {\n        return;\n      } // Allow slightly faster navigation through the images when user presses keys repeatedly\n\n\n      if (event.type === 'keyup') {\n        this.lastKeyDownTime -= this.props.keyRepeatKeyupBonus;\n        return;\n      }\n\n      var keyCode = event.which || event.keyCode; // Ignore key presses that happen too close to each other (when rapid fire key pressing or holding down the key)\n      // But allow it if it's a lightbox closing action\n\n      var currentTime = new Date();\n\n      if (currentTime.getTime() - this.lastKeyDownTime < this.props.keyRepeatLimit && keyCode !== KEYS.ESC) {\n        return;\n      }\n\n      this.lastKeyDownTime = currentTime.getTime();\n\n      switch (keyCode) {\n        // ESC key closes the lightbox\n        case KEYS.ESC:\n          event.preventDefault();\n          this.requestClose(event);\n          break;\n        // Left arrow key moves to previous image\n\n        case KEYS.LEFT_ARROW:\n          if (!this.props.prevSrc) {\n            return;\n          }\n\n          event.preventDefault();\n          this.keyPressed = true;\n          this.requestMovePrev(event);\n          break;\n        // Right arrow key moves to next image\n\n        case KEYS.RIGHT_ARROW:\n          if (!this.props.nextSrc) {\n            return;\n          }\n\n          event.preventDefault();\n          this.keyPressed = true;\n          this.requestMoveNext(event);\n          break;\n      }\n    }\n    /**\n     * Handle a mouse wheel event over the lightbox container\n     */\n\n  }, {\n    key: \"handleOuterMousewheel\",\n    value: function handleOuterMousewheel(event) {\n      var _this7 = this;\n\n      // Prevent scrolling of the background\n      event.stopPropagation();\n      this.clearTimeout(this.resetScrollTimeout);\n      this.resetScrollTimeout = this.setTimeout(function () {\n        _this7.scrollX = 0;\n        _this7.scrollY = 0;\n      }, 300);\n    }\n  }, {\n    key: \"handleImageMouseWheel\",\n    value: function handleImageMouseWheel(event) {\n      // when gesture move up/down/left/right, event.deltaY is integer, move image\n      if (parseInt(event.deltaY) === parseFloat(event.deltaY)) {\n        if (Math.abs(event.deltaY) > Math.abs(event.deltaX)) {\n          var newOffsetY = this.state.offsetY + event.deltaY;\n          this.setState({\n            offsetY: newOffsetY\n          });\n        } else {\n          var newOffsetX = this.state.offsetX + event.deltaX;\n          this.setState({\n            offsetX: newOffsetX\n          });\n        }\n\n        return;\n      } // when gesture zoom in or zoom out, event.deltaY is decimal, zoom image\n\n\n      var yThreshold = WHEEL_MOVE_Y_THRESHOLD;\n\n      if (Math.abs(event.deltaY) >= Math.abs(event.deltaX)) {\n        event.stopPropagation(); // If the vertical scroll amount was large enough, perform a zoom\n\n        if (Math.abs(event.deltaY) < yThreshold) {\n          return;\n        }\n\n        this.scrollX = 0;\n        this.scrollY += event.deltaY;\n        this.changeZoom(this.state.zoomLevel - event.deltaY, event.clientX, event.clientY);\n      }\n    }\n    /**\n     * Handle a double click on the current image\n     */\n\n  }, {\n    key: \"handleImageDoubleClick\",\n    value: function handleImageDoubleClick(event) {\n      if (this.state.zoomLevel > MIN_ZOOM_LEVEL) {\n        // A double click when zoomed in zooms all the way out\n        this.changeZoom(MIN_ZOOM_LEVEL, event.clientX, event.clientY);\n      } else {\n        // A double click when zoomed all the way out zooms in\n        this.changeZoom(this.state.zoomLevel + ZOOM_BUTTON_INCREMENT_SIZE, event.clientX, event.clientY);\n      }\n    }\n  }, {\n    key: \"shouldHandleEvent\",\n    value: function shouldHandleEvent(source) {\n      if (this.eventsSource === source) {\n        return true;\n      }\n\n      if (this.eventsSource === SOURCE_ANY) {\n        this.eventsSource = source;\n        return true;\n      }\n\n      switch (source) {\n        case SOURCE_MOUSE:\n          return false;\n\n        case SOURCE_TOUCH:\n          this.eventsSource = SOURCE_TOUCH;\n          this.filterPointersBySource();\n          return true;\n\n        case SOURCE_POINTER:\n          if (this.eventsSource === SOURCE_MOUSE) {\n            this.eventsSource = SOURCE_POINTER;\n            this.filterPointersBySource();\n            return true;\n          }\n\n          return false;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"addPointer\",\n    value: function addPointer(pointer) {\n      this.pointerList.push(pointer);\n    }\n  }, {\n    key: \"removePointer\",\n    value: function removePointer(pointer) {\n      this.pointerList = this.pointerList.filter(function (_ref2) {\n        var id = _ref2.id;\n        return id !== pointer.id;\n      });\n    }\n  }, {\n    key: \"filterPointersBySource\",\n    value: function filterPointersBySource() {\n      var _this8 = this;\n\n      this.pointerList = this.pointerList.filter(function (_ref3) {\n        var source = _ref3.source;\n        return source === _this8.eventsSource;\n      });\n    }\n  }, {\n    key: \"handleMouseDown\",\n    value: function handleMouseDown(event) {\n      if (this.shouldHandleEvent(SOURCE_MOUSE) && ReactImageLightbox.isTargetMatchImage(event.target)) {\n        this.addPointer(ReactImageLightbox.parseMouseEvent(event));\n        this.multiPointerStart(event);\n      }\n    }\n  }, {\n    key: \"handleMouseMove\",\n    value: function handleMouseMove(event) {\n      if (this.shouldHandleEvent(SOURCE_MOUSE)) {\n        this.multiPointerMove(event, [ReactImageLightbox.parseMouseEvent(event)]);\n      }\n    }\n  }, {\n    key: \"handleMouseUp\",\n    value: function handleMouseUp(event) {\n      if (this.shouldHandleEvent(SOURCE_MOUSE)) {\n        this.removePointer(ReactImageLightbox.parseMouseEvent(event));\n        this.multiPointerEnd(event);\n      }\n    }\n  }, {\n    key: \"handlePointerEvent\",\n    value: function handlePointerEvent(event) {\n      if (this.shouldHandleEvent(SOURCE_POINTER)) {\n        switch (event.type) {\n          case 'pointerdown':\n            if (ReactImageLightbox.isTargetMatchImage(event.target)) {\n              this.addPointer(ReactImageLightbox.parsePointerEvent(event));\n              this.multiPointerStart(event);\n            }\n\n            break;\n\n          case 'pointermove':\n            this.multiPointerMove(event, [ReactImageLightbox.parsePointerEvent(event)]);\n            break;\n\n          case 'pointerup':\n          case 'pointercancel':\n            this.removePointer(ReactImageLightbox.parsePointerEvent(event));\n            this.multiPointerEnd(event);\n            break;\n        }\n      }\n    }\n  }, {\n    key: \"handleTouchStart\",\n    value: function handleTouchStart(event) {\n      var _this9 = this;\n\n      if (this.shouldHandleEvent(SOURCE_TOUCH) && ReactImageLightbox.isTargetMatchImage(event.target)) {\n        [].forEach.call(event.changedTouches, function (eventTouch) {\n          return _this9.addPointer(ReactImageLightbox.parseTouchPointer(eventTouch));\n        });\n        this.multiPointerStart(event);\n      }\n    }\n  }, {\n    key: \"handleTouchMove\",\n    value: function handleTouchMove(event) {\n      if (this.shouldHandleEvent(SOURCE_TOUCH)) {\n        this.multiPointerMove(event, [].map.call(event.changedTouches, function (eventTouch) {\n          return ReactImageLightbox.parseTouchPointer(eventTouch);\n        }));\n      }\n    }\n  }, {\n    key: \"handleTouchEnd\",\n    value: function handleTouchEnd(event) {\n      var _this10 = this;\n\n      if (this.shouldHandleEvent(SOURCE_TOUCH)) {\n        [].map.call(event.changedTouches, function (touch) {\n          return _this10.removePointer(ReactImageLightbox.parseTouchPointer(touch));\n        });\n        this.multiPointerEnd(event);\n      }\n    }\n  }, {\n    key: \"decideMoveOrSwipe\",\n    value: function decideMoveOrSwipe(pointer) {\n      if (this.state.zoomLevel <= MIN_ZOOM_LEVEL) {\n        this.handleSwipeStart(pointer);\n      } else {\n        this.handleMoveStart(pointer);\n      }\n    }\n  }, {\n    key: \"multiPointerStart\",\n    value: function multiPointerStart(event) {\n      this.handleEnd(null);\n\n      switch (this.pointerList.length) {\n        case 1:\n          {\n            event.preventDefault();\n            this.decideMoveOrSwipe(this.pointerList[0]);\n            break;\n          }\n\n        case 2:\n          {\n            event.preventDefault();\n            this.handlePinchStart(this.pointerList);\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"multiPointerMove\",\n    value: function multiPointerMove(event, pointerList) {\n      switch (this.currentAction) {\n        case ACTION_MOVE:\n          {\n            event.preventDefault();\n            this.handleMove(pointerList[0]);\n            break;\n          }\n\n        case ACTION_SWIPE:\n          {\n            event.preventDefault();\n            this.handleSwipe(pointerList[0]);\n            break;\n          }\n\n        case ACTION_PINCH:\n          {\n            event.preventDefault();\n            this.handlePinch(pointerList);\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"multiPointerEnd\",\n    value: function multiPointerEnd(event) {\n      if (this.currentAction !== ACTION_NONE) {\n        this.setPreventInnerClose();\n        this.handleEnd(event);\n      }\n\n      switch (this.pointerList.length) {\n        case 0:\n          {\n            this.eventsSource = SOURCE_ANY;\n            break;\n          }\n\n        case 1:\n          {\n            event.preventDefault();\n            this.decideMoveOrSwipe(this.pointerList[0]);\n            break;\n          }\n\n        case 2:\n          {\n            event.preventDefault();\n            this.handlePinchStart(this.pointerList);\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"handleEnd\",\n    value: function handleEnd(event) {\n      switch (this.currentAction) {\n        case ACTION_MOVE:\n          this.handleMoveEnd(event);\n          break;\n\n        case ACTION_SWIPE:\n          this.handleSwipeEnd(event);\n          break;\n\n        case ACTION_PINCH:\n          this.handlePinchEnd(event);\n          break;\n      }\n    } // Handle move start over the lightbox container\n    // This happens:\n    // - On a mouseDown event\n    // - On a touchstart event\n\n  }, {\n    key: \"handleMoveStart\",\n    value: function handleMoveStart(_ref4) {\n      var clientX = _ref4.x,\n          clientY = _ref4.y;\n\n      if (!this.props.enableZoom) {\n        return;\n      }\n\n      this.currentAction = ACTION_MOVE;\n      this.moveStartX = clientX;\n      this.moveStartY = clientY;\n      this.moveStartOffsetX = this.state.offsetX;\n      this.moveStartOffsetY = this.state.offsetY;\n    } // Handle dragging over the lightbox container\n    // This happens:\n    // - After a mouseDown and before a mouseUp event\n    // - After a touchstart and before a touchend event\n\n  }, {\n    key: \"handleMove\",\n    value: function handleMove(_ref5) {\n      var clientX = _ref5.x,\n          clientY = _ref5.y;\n      var newOffsetX = this.moveStartX - clientX + this.moveStartOffsetX;\n      var newOffsetY = this.moveStartY - clientY + this.moveStartOffsetY;\n\n      if (this.state.offsetX !== newOffsetX || this.state.offsetY !== newOffsetY) {\n        this.setState({\n          offsetX: newOffsetX,\n          offsetY: newOffsetY\n        });\n      }\n    }\n  }, {\n    key: \"handleMoveEnd\",\n    value: function handleMoveEnd() {\n      var _this11 = this;\n\n      this.currentAction = ACTION_NONE;\n      this.moveStartX = 0;\n      this.moveStartY = 0;\n      this.moveStartOffsetX = 0;\n      this.moveStartOffsetY = 0; // Snap image back into frame if outside max offset range\n\n      var maxOffsets = this.getMaxOffsets();\n      var nextOffsetX = Math.max(maxOffsets.minX, Math.min(maxOffsets.maxX, this.state.offsetX));\n      var nextOffsetY = Math.max(maxOffsets.minY, Math.min(maxOffsets.maxY, this.state.offsetY));\n\n      if (nextOffsetX !== this.state.offsetX || nextOffsetY !== this.state.offsetY) {\n        this.setState({\n          offsetX: nextOffsetX,\n          offsetY: nextOffsetY,\n          shouldAnimate: true\n        });\n        this.setTimeout(function () {\n          _this11.setState({\n            shouldAnimate: false\n          });\n        }, this.props.animationDuration);\n      }\n    }\n  }, {\n    key: \"handleSwipeStart\",\n    value: function handleSwipeStart(_ref6) {\n      var clientX = _ref6.x,\n          clientY = _ref6.y;\n      this.currentAction = ACTION_SWIPE;\n      this.swipeStartX = clientX;\n      this.swipeStartY = clientY;\n      this.swipeEndX = clientX;\n      this.swipeEndY = clientY;\n    }\n  }, {\n    key: \"handleSwipe\",\n    value: function handleSwipe(_ref7) {\n      var clientX = _ref7.x,\n          clientY = _ref7.y;\n      this.swipeEndX = clientX;\n      this.swipeEndY = clientY;\n    }\n  }, {\n    key: \"handleSwipeEnd\",\n    value: function handleSwipeEnd(event) {\n      var xDiff = this.swipeEndX - this.swipeStartX;\n      var xDiffAbs = Math.abs(xDiff);\n      var yDiffAbs = Math.abs(this.swipeEndY - this.swipeStartY);\n      this.currentAction = ACTION_NONE;\n      this.swipeStartX = 0;\n      this.swipeStartY = 0;\n      this.swipeEndX = 0;\n      this.swipeEndY = 0;\n\n      if (!event || this.isAnimating() || xDiffAbs < yDiffAbs * 1.5) {\n        return;\n      }\n\n      if (xDiffAbs < MIN_SWIPE_DISTANCE) {\n        var boxRect = this.getLightboxRect();\n\n        if (xDiffAbs < boxRect.width / 4) {\n          return;\n        }\n      }\n\n      if (xDiff > 0 && this.props.prevSrc) {\n        event.preventDefault();\n        this.requestMovePrev();\n      } else if (xDiff < 0 && this.props.nextSrc) {\n        event.preventDefault();\n        this.requestMoveNext();\n      }\n    }\n  }, {\n    key: \"calculatePinchDistance\",\n    value: function calculatePinchDistance() {\n      var _ref8 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.pinchTouchList,\n          _ref9 = _slicedToArray(_ref8, 2),\n          a = _ref9[0],\n          b = _ref9[1];\n\n      return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));\n    }\n  }, {\n    key: \"calculatePinchCenter\",\n    value: function calculatePinchCenter() {\n      var _ref10 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.pinchTouchList,\n          _ref11 = _slicedToArray(_ref10, 2),\n          a = _ref11[0],\n          b = _ref11[1];\n\n      return {\n        x: a.x - (a.x - b.x) / 2,\n        y: a.y - (a.y - b.y) / 2\n      };\n    }\n  }, {\n    key: \"handlePinchStart\",\n    value: function handlePinchStart(pointerList) {\n      if (!this.props.enableZoom) {\n        return;\n      }\n\n      this.currentAction = ACTION_PINCH;\n      this.pinchTouchList = pointerList.map(function (_ref12) {\n        var id = _ref12.id,\n            x = _ref12.x,\n            y = _ref12.y;\n        return {\n          id: id,\n          x: x,\n          y: y\n        };\n      });\n      this.pinchDistance = this.calculatePinchDistance();\n    }\n  }, {\n    key: \"handlePinch\",\n    value: function handlePinch(pointerList) {\n      this.pinchTouchList = this.pinchTouchList.map(function (oldPointer) {\n        for (var i = 0; i < pointerList.length; i += 1) {\n          if (pointerList[i].id === oldPointer.id) {\n            return pointerList[i];\n          }\n        }\n\n        return oldPointer;\n      });\n      var newDistance = this.calculatePinchDistance();\n      var zoomLevel = this.state.zoomLevel + newDistance - this.pinchDistance;\n      this.pinchDistance = newDistance;\n\n      var _this$calculatePinchC = this.calculatePinchCenter(this.pinchTouchList),\n          clientX = _this$calculatePinchC.x,\n          clientY = _this$calculatePinchC.y;\n\n      this.changeZoom(zoomLevel, clientX, clientY);\n    }\n  }, {\n    key: \"handlePinchEnd\",\n    value: function handlePinchEnd() {\n      this.currentAction = ACTION_NONE;\n      this.pinchTouchList = null;\n      this.pinchDistance = 0;\n    } // Handle the window resize event\n\n  }, {\n    key: \"handleWindowResize\",\n    value: function handleWindowResize() {\n      this.clearTimeout(this.resizeTimeout);\n      this.resizeTimeout = this.setTimeout(this.forceUpdate.bind(this), 100);\n    }\n  }, {\n    key: \"handleZoomInButtonClick\",\n    value: function handleZoomInButtonClick() {\n      var nextZoomLevel = this.state.zoomLevel + ZOOM_BUTTON_INCREMENT_SIZE;\n      this.changeZoom(nextZoomLevel);\n\n      if (nextZoomLevel === MAX_ZOOM_LEVEL) {\n        this.zoomOutBtn.current.focus();\n      }\n    }\n  }, {\n    key: \"handleZoomOutButtonClick\",\n    value: function handleZoomOutButtonClick() {\n      var nextZoomLevel = this.state.zoomLevel - ZOOM_BUTTON_INCREMENT_SIZE;\n      this.changeZoom(nextZoomLevel);\n\n      if (nextZoomLevel === MIN_ZOOM_LEVEL) {\n        this.zoomInBtn.current.focus();\n      }\n    }\n  }, {\n    key: \"handleCaptionMousewheel\",\n    value: function handleCaptionMousewheel(event) {\n      event.stopPropagation();\n\n      if (!this.caption.current) {\n        return;\n      }\n\n      var _this$caption$current = this.caption.current.getBoundingClientRect(),\n          height = _this$caption$current.height;\n\n      var _this$caption$current2 = this.caption.current,\n          scrollHeight = _this$caption$current2.scrollHeight,\n          scrollTop = _this$caption$current2.scrollTop;\n\n      if (event.deltaY > 0 && height + scrollTop >= scrollHeight || event.deltaY < 0 && scrollTop <= 0) {\n        event.preventDefault();\n      }\n    } // Detach key and mouse input events\n\n  }, {\n    key: \"isAnimating\",\n    value: function isAnimating() {\n      return this.state.shouldAnimate || this.state.isClosing;\n    } // Check if image is loaded\n\n  }, {\n    key: \"isImageLoaded\",\n    value: function isImageLoaded(imageSrc) {\n      return imageSrc && imageSrc in this.imageCache && this.imageCache[imageSrc].loaded;\n    } // Load image from src and call callback with image width and height on load\n\n  }, {\n    key: \"loadImage\",\n    value: function loadImage(srcType, imageSrc, done) {\n      var _this12 = this;\n\n      // Return the image info if it is already cached\n      if (this.isImageLoaded(imageSrc)) {\n        this.setTimeout(function () {\n          done();\n        }, 1);\n        return;\n      }\n\n      var inMemoryImage = new global.Image();\n\n      if (this.props.imageCrossOrigin) {\n        inMemoryImage.crossOrigin = this.props.imageCrossOrigin;\n      }\n\n      inMemoryImage.onerror = function (errorEvent) {\n        _this12.props.onImageLoadError(imageSrc, srcType, errorEvent); // failed to load so set the state loadErrorStatus\n\n\n        _this12.setState(function (prevState) {\n          return {\n            loadErrorStatus: _objectSpread2({}, prevState.loadErrorStatus, _defineProperty({}, srcType, true))\n          };\n        });\n\n        done(errorEvent);\n      };\n\n      inMemoryImage.onload = function () {\n        _this12.props.onImageLoad(imageSrc, srcType, inMemoryImage);\n\n        _this12.imageCache[imageSrc] = {\n          loaded: true,\n          width: inMemoryImage.width,\n          height: inMemoryImage.height\n        };\n        done();\n      };\n\n      inMemoryImage.src = imageSrc;\n    } // Load all images and their thumbnails\n\n  }, {\n    key: \"loadAllImages\",\n    value: function loadAllImages() {\n      var _this13 = this;\n\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n\n      var generateLoadDoneCallback = function generateLoadDoneCallback(srcType, imageSrc) {\n        return function (err) {\n          // Give up showing image on error\n          if (err) {\n            return;\n          } // Don't rerender if the src is not the same as when the load started\n          // or if the component has unmounted\n\n\n          if (_this13.props[srcType] !== imageSrc || _this13.didUnmount) {\n            return;\n          } // Force rerender with the new image\n\n\n          _this13.forceUpdate();\n        };\n      }; // Load the images\n\n\n      this.getSrcTypes().forEach(function (srcType) {\n        var type = srcType.name; // there is no error when we try to load it initially\n\n        if (props[type] && _this13.state.loadErrorStatus[type]) {\n          _this13.setState(function (prevState) {\n            return {\n              loadErrorStatus: _objectSpread2({}, prevState.loadErrorStatus, _defineProperty({}, type, false))\n            };\n          });\n        } // Load unloaded images\n\n\n        if (props[type] && !_this13.isImageLoaded(props[type])) {\n          _this13.loadImage(type, props[type], generateLoadDoneCallback(type, props[type]));\n        }\n      });\n    } // Request that the lightbox be closed\n\n  }, {\n    key: \"requestClose\",\n    value: function requestClose(event) {\n      var _this14 = this;\n\n      // Call the parent close request\n      var closeLightbox = function closeLightbox() {\n        return _this14.props.onCloseRequest(event);\n      };\n\n      if (this.props.animationDisabled || event.type === 'keydown' && !this.props.animationOnKeyInput) {\n        // No animation\n        closeLightbox();\n        return;\n      } // With animation\n      // Start closing animation\n\n\n      this.setState({\n        isClosing: true\n      }); // Perform the actual closing at the end of the animation\n\n      this.setTimeout(closeLightbox, this.props.animationDuration);\n    }\n  }, {\n    key: \"requestMove\",\n    value: function requestMove(direction, event) {\n      var _this15 = this;\n\n      // Reset the zoom level on image move\n      var nextState = {\n        zoomLevel: MIN_ZOOM_LEVEL,\n        offsetX: 0,\n        offsetY: 0\n      }; // Enable animated states\n\n      if (!this.props.animationDisabled && (!this.keyPressed || this.props.animationOnKeyInput)) {\n        nextState.shouldAnimate = true;\n        this.setTimeout(function () {\n          return _this15.setState({\n            shouldAnimate: false\n          });\n        }, this.props.animationDuration);\n      }\n\n      this.keyPressed = false;\n      this.moveRequested = true;\n\n      if (direction === 'prev') {\n        this.keyCounter -= 1;\n        this.setState(nextState);\n        this.props.onMovePrevRequest(event);\n      } else {\n        this.keyCounter += 1;\n        this.setState(nextState);\n        this.props.onMoveNextRequest(event);\n      }\n    } // Request to transition to the next image\n\n  }, {\n    key: \"requestMoveNext\",\n    value: function requestMoveNext(event) {\n      this.requestMove('next', event);\n    } // Request to transition to the previous image\n\n  }, {\n    key: \"requestMovePrev\",\n    value: function requestMovePrev(event) {\n      this.requestMove('prev', event);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this16 = this;\n\n      var _this$props = this.props,\n          animationDisabled = _this$props.animationDisabled,\n          animationDuration = _this$props.animationDuration,\n          clickOutsideToClose = _this$props.clickOutsideToClose,\n          discourageDownloads = _this$props.discourageDownloads,\n          enableZoom = _this$props.enableZoom,\n          imageTitle = _this$props.imageTitle,\n          nextSrc = _this$props.nextSrc,\n          prevSrc = _this$props.prevSrc,\n          toolbarButtons = _this$props.toolbarButtons,\n          reactModalStyle = _this$props.reactModalStyle,\n          _onAfterOpen = _this$props.onAfterOpen,\n          imageCrossOrigin = _this$props.imageCrossOrigin,\n          reactModalProps = _this$props.reactModalProps;\n      var _this$state = this.state,\n          zoomLevel = _this$state.zoomLevel,\n          offsetX = _this$state.offsetX,\n          offsetY = _this$state.offsetY,\n          isClosing = _this$state.isClosing,\n          loadErrorStatus = _this$state.loadErrorStatus;\n      var boxSize = this.getLightboxRect();\n      var transitionStyle = {}; // Transition settings for sliding animations\n\n      if (!animationDisabled && this.isAnimating()) {\n        transitionStyle = _objectSpread2({}, transitionStyle, {\n          transition: \"transform \".concat(animationDuration, \"ms\")\n        });\n      } // Key endings to differentiate between images with the same src\n\n\n      var keyEndings = {};\n      this.getSrcTypes().forEach(function (_ref13) {\n        var name = _ref13.name,\n            keyEnding = _ref13.keyEnding;\n        keyEndings[name] = keyEnding;\n      }); // Images to be displayed\n\n      var images = [];\n\n      var addImage = function addImage(srcType, imageClass, transforms) {\n        // Ignore types that have no source defined for their full size image\n        if (!_this16.props[srcType]) {\n          return;\n        }\n\n        var bestImageInfo = _this16.getBestImageForType(srcType);\n\n        var imageStyle = _objectSpread2({}, transitionStyle, {}, ReactImageLightbox.getTransform(_objectSpread2({}, transforms, {}, bestImageInfo)));\n\n        if (zoomLevel > MIN_ZOOM_LEVEL) {\n          imageStyle.cursor = 'move';\n        } // support IE 9 and 11\n\n\n        var hasTrueValue = function hasTrueValue(object) {\n          return Object.keys(object).some(function (key) {\n            return object[key];\n          });\n        }; // when error on one of the loads then push custom error stuff\n\n\n        if (bestImageInfo === null && hasTrueValue(loadErrorStatus)) {\n          images.push(React.createElement(\"div\", {\n            className: \"\".concat(imageClass, \" ril__image ril-errored\"),\n            style: imageStyle,\n            key: _this16.props[srcType] + keyEndings[srcType]\n          }, React.createElement(\"div\", {\n            className: \"ril__errorContainer\"\n          }, _this16.props.imageLoadErrorMessage)));\n          return;\n        }\n\n        if (bestImageInfo === null) {\n          var loadingIcon = React.createElement(\"div\", {\n            className: \"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon\"\n          }, _toConsumableArray(new Array(12)).map(function (_, index) {\n            return React.createElement(\"div\", {\n              // eslint-disable-next-line react/no-array-index-key\n              key: index,\n              className: \"ril-loading-circle-point ril__loadingCirclePoint\"\n            });\n          })); // Fall back to loading icon if the thumbnail has not been loaded\n\n          images.push(React.createElement(\"div\", {\n            className: \"\".concat(imageClass, \" ril__image ril-not-loaded\"),\n            style: imageStyle,\n            key: _this16.props[srcType] + keyEndings[srcType]\n          }, React.createElement(\"div\", {\n            className: \"ril__loadingContainer\"\n          }, loadingIcon)));\n          return;\n        }\n\n        var imageSrc = bestImageInfo.src;\n\n        if (discourageDownloads) {\n          imageStyle.backgroundImage = \"url('\".concat(imageSrc, \"')\");\n          images.push(React.createElement(\"div\", {\n            className: \"\".concat(imageClass, \" ril__image ril__imageDiscourager\"),\n            onDoubleClick: _this16.handleImageDoubleClick,\n            onWheel: _this16.handleImageMouseWheel,\n            style: imageStyle,\n            key: imageSrc + keyEndings[srcType]\n          }, React.createElement(\"div\", {\n            className: \"ril-download-blocker ril__downloadBlocker\"\n          })));\n        } else {\n          images.push(React.createElement(\"img\", _extends({}, imageCrossOrigin ? {\n            crossOrigin: imageCrossOrigin\n          } : {}, {\n            className: \"\".concat(imageClass, \" ril__image\"),\n            onDoubleClick: _this16.handleImageDoubleClick,\n            onWheel: _this16.handleImageMouseWheel,\n            onDragStart: function onDragStart(e) {\n              return e.preventDefault();\n            },\n            style: imageStyle,\n            src: imageSrc,\n            key: imageSrc + keyEndings[srcType],\n            alt: typeof imageTitle === 'string' ? imageTitle : translate('Image'),\n            draggable: false\n          })));\n        }\n      };\n\n      var zoomMultiplier = this.getZoomMultiplier(); // Next Image (displayed on the right)\n\n      addImage('nextSrc', 'ril-image-next ril__imageNext', {\n        x: boxSize.width\n      }); // Main Image\n\n      addImage('mainSrc', 'ril-image-current', {\n        x: -1 * offsetX,\n        y: -1 * offsetY,\n        zoom: zoomMultiplier\n      }); // Previous Image (displayed on the left)\n\n      addImage('prevSrc', 'ril-image-prev ril__imagePrev', {\n        x: -1 * boxSize.width\n      });\n      var modalStyle = {\n        overlay: _objectSpread2({\n          zIndex: 1000,\n          backgroundColor: 'transparent'\n        }, reactModalStyle.overlay),\n        content: _objectSpread2({\n          backgroundColor: 'transparent',\n          overflow: 'hidden',\n          // Needed, otherwise keyboard shortcuts scroll the page\n          border: 'none',\n          borderRadius: 0,\n          padding: 0,\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0\n        }, reactModalStyle.content)\n      };\n      return React.createElement(Modal, _extends({\n        isOpen: true,\n        onRequestClose: clickOutsideToClose ? this.requestClose : undefined,\n        onAfterOpen: function onAfterOpen() {\n          // Focus on the div with key handlers\n          if (_this16.outerEl.current) {\n            _this16.outerEl.current.focus();\n          }\n\n          _onAfterOpen();\n        },\n        style: modalStyle,\n        contentLabel: translate('Lightbox'),\n        appElement: typeof global.window !== 'undefined' ? global.window.document.body : undefined\n      }, reactModalProps), React.createElement(\"div\", {\n        // eslint-disable-line jsx-a11y/no-static-element-interactions\n        // Floating modal with closing animations\n        className: \"ril-outer ril__outer ril__outerAnimating \".concat(this.props.wrapperClassName, \" \").concat(isClosing ? 'ril-closing ril__outerClosing' : ''),\n        style: {\n          transition: \"opacity \".concat(animationDuration, \"ms\"),\n          animationDuration: \"\".concat(animationDuration, \"ms\"),\n          animationDirection: isClosing ? 'normal' : 'reverse'\n        },\n        ref: this.outerEl,\n        onWheel: this.handleOuterMousewheel,\n        onMouseMove: this.handleMouseMove,\n        onMouseDown: this.handleMouseDown,\n        onTouchStart: this.handleTouchStart,\n        onTouchMove: this.handleTouchMove,\n        tabIndex: \"-1\" // Enables key handlers on div\n        ,\n        onKeyDown: this.handleKeyInput,\n        onKeyUp: this.handleKeyInput\n      }, React.createElement(\"div\", {\n        // eslint-disable-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events\n        // Image holder\n        className: \"ril-inner ril__inner\",\n        onClick: clickOutsideToClose ? this.closeIfClickInner : undefined\n      }, images), prevSrc && React.createElement(\"button\", {\n        // Move to previous image button\n        type: \"button\",\n        className: \"ril-prev-button ril__navButtons ril__navButtonPrev\",\n        key: \"prev\",\n        \"aria-label\": this.props.prevLabel,\n        onClick: !this.isAnimating() ? this.requestMovePrev : undefined // Ignore clicks during animation\n\n      }), nextSrc && React.createElement(\"button\", {\n        // Move to next image button\n        type: \"button\",\n        className: \"ril-next-button ril__navButtons ril__navButtonNext\",\n        key: \"next\",\n        \"aria-label\": this.props.nextLabel,\n        onClick: !this.isAnimating() ? this.requestMoveNext : undefined // Ignore clicks during animation\n\n      }), React.createElement(\"div\", {\n        // Lightbox toolbar\n        className: \"ril-toolbar ril__toolbar\"\n      }, React.createElement(\"ul\", {\n        className: \"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide\"\n      }, React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"span\", {\n        className: \"ril-toolbar__item__child ril__toolbarItemChild\"\n      }, imageTitle))), React.createElement(\"ul\", {\n        className: \"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide\"\n      }, toolbarButtons && toolbarButtons.map(function (button, i) {\n        return React.createElement(\"li\", {\n          key: \"button_\".concat(i + 1),\n          className: \"ril-toolbar__item ril__toolbarItem\"\n        }, button);\n      }), enableZoom && React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"button\", {\n        // Lightbox zoom in button\n        type: \"button\",\n        key: \"zoom-in\",\n        \"aria-label\": this.props.zoomInLabel,\n        className: ['ril-zoom-in', 'ril__toolbarItemChild', 'ril__builtinButton', 'ril__zoomInButton'].concat(_toConsumableArray(zoomLevel === MAX_ZOOM_LEVEL ? ['ril__builtinButtonDisabled'] : [])).join(' '),\n        ref: this.zoomInBtn,\n        disabled: this.isAnimating() || zoomLevel === MAX_ZOOM_LEVEL,\n        onClick: !this.isAnimating() && zoomLevel !== MAX_ZOOM_LEVEL ? this.handleZoomInButtonClick : undefined\n      })), enableZoom && React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"button\", {\n        // Lightbox zoom out button\n        type: \"button\",\n        key: \"zoom-out\",\n        \"aria-label\": this.props.zoomOutLabel,\n        className: ['ril-zoom-out', 'ril__toolbarItemChild', 'ril__builtinButton', 'ril__zoomOutButton'].concat(_toConsumableArray(zoomLevel === MIN_ZOOM_LEVEL ? ['ril__builtinButtonDisabled'] : [])).join(' '),\n        ref: this.zoomOutBtn,\n        disabled: this.isAnimating() || zoomLevel === MIN_ZOOM_LEVEL,\n        onClick: !this.isAnimating() && zoomLevel !== MIN_ZOOM_LEVEL ? this.handleZoomOutButtonClick : undefined\n      })), React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"button\", {\n        // Lightbox close button\n        type: \"button\",\n        key: \"close\",\n        \"aria-label\": this.props.closeLabel,\n        className: \"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton\",\n        onClick: !this.isAnimating() ? this.requestClose : undefined // Ignore clicks during animation\n\n      })))), this.props.imageCaption && // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n      React.createElement(\"div\", {\n        // Image caption\n        onWheel: this.handleCaptionMousewheel,\n        onMouseDown: function onMouseDown(event) {\n          return event.stopPropagation();\n        },\n        className: \"ril-caption ril__caption\",\n        ref: this.caption\n      }, React.createElement(\"div\", {\n        className: \"ril-caption-content ril__captionContent\"\n      }, this.props.imageCaption))));\n    }\n  }]);\n\n  return ReactImageLightbox;\n}(Component);\n\nReactImageLightbox.propTypes = {\n  //-----------------------------\n  // Image sources\n  //-----------------------------\n  // Main display image url\n  mainSrc: PropTypes.string.isRequired,\n  // eslint-disable-line react/no-unused-prop-types\n  // Previous display image url (displayed to the left)\n  // If left undefined, movePrev actions will not be performed, and the button not displayed\n  prevSrc: PropTypes.string,\n  // Next display image url (displayed to the right)\n  // If left undefined, moveNext actions will not be performed, and the button not displayed\n  nextSrc: PropTypes.string,\n  //-----------------------------\n  // Image thumbnail sources\n  //-----------------------------\n  // Thumbnail image url corresponding to props.mainSrc\n  mainSrcThumbnail: PropTypes.string,\n  // eslint-disable-line react/no-unused-prop-types\n  // Thumbnail image url corresponding to props.prevSrc\n  prevSrcThumbnail: PropTypes.string,\n  // eslint-disable-line react/no-unused-prop-types\n  // Thumbnail image url corresponding to props.nextSrc\n  nextSrcThumbnail: PropTypes.string,\n  // eslint-disable-line react/no-unused-prop-types\n  //-----------------------------\n  // Event Handlers\n  //-----------------------------\n  // Close window event\n  // Should change the parent state such that the lightbox is not rendered\n  onCloseRequest: PropTypes.func.isRequired,\n  // Move to previous image event\n  // Should change the parent state such that props.prevSrc becomes props.mainSrc,\n  //  props.mainSrc becomes props.nextSrc, etc.\n  onMovePrevRequest: PropTypes.func,\n  // Move to next image event\n  // Should change the parent state such that props.nextSrc becomes props.mainSrc,\n  //  props.mainSrc becomes props.prevSrc, etc.\n  onMoveNextRequest: PropTypes.func,\n  // Called when an image fails to load\n  // (imageSrc: string, srcType: string, errorEvent: object): void\n  onImageLoadError: PropTypes.func,\n  // Called when image successfully loads\n  onImageLoad: PropTypes.func,\n  // Open window event\n  onAfterOpen: PropTypes.func,\n  //-----------------------------\n  // Download discouragement settings\n  //-----------------------------\n  // Enable download discouragement (prevents [right-click -> Save Image As...])\n  discourageDownloads: PropTypes.bool,\n  //-----------------------------\n  // Animation settings\n  //-----------------------------\n  // Disable all animation\n  animationDisabled: PropTypes.bool,\n  // Disable animation on actions performed with keyboard shortcuts\n  animationOnKeyInput: PropTypes.bool,\n  // Animation duration (ms)\n  animationDuration: PropTypes.number,\n  //-----------------------------\n  // Keyboard shortcut settings\n  //-----------------------------\n  // Required interval of time (ms) between key actions\n  // (prevents excessively fast navigation of images)\n  keyRepeatLimit: PropTypes.number,\n  // Amount of time (ms) restored after each keyup\n  // (makes rapid key presses slightly faster than holding down the key to navigate images)\n  keyRepeatKeyupBonus: PropTypes.number,\n  //-----------------------------\n  // Image info\n  //-----------------------------\n  // Image title\n  imageTitle: PropTypes.node,\n  // Image caption\n  imageCaption: PropTypes.node,\n  // Optional crossOrigin attribute\n  imageCrossOrigin: PropTypes.string,\n  //-----------------------------\n  // Lightbox style\n  //-----------------------------\n  // Set z-index style, etc., for the parent react-modal (format: https://github.com/reactjs/react-modal#styles )\n  reactModalStyle: PropTypes.object,\n  // Padding (px) between the edge of the window and the lightbox\n  imagePadding: PropTypes.number,\n  wrapperClassName: PropTypes.string,\n  //-----------------------------\n  // Other\n  //-----------------------------\n  // Array of custom toolbar buttons\n  toolbarButtons: PropTypes.arrayOf(PropTypes.node),\n  // When true, clicks outside of the image close the lightbox\n  clickOutsideToClose: PropTypes.bool,\n  // Set to false to disable zoom functionality and hide zoom buttons\n  enableZoom: PropTypes.bool,\n  // Override props set on react-modal (https://github.com/reactjs/react-modal)\n  reactModalProps: PropTypes.shape({}),\n  // Aria-labels\n  nextLabel: PropTypes.string,\n  prevLabel: PropTypes.string,\n  zoomInLabel: PropTypes.string,\n  zoomOutLabel: PropTypes.string,\n  closeLabel: PropTypes.string,\n  imageLoadErrorMessage: PropTypes.node\n};\nReactImageLightbox.defaultProps = {\n  imageTitle: null,\n  imageCaption: null,\n  toolbarButtons: null,\n  reactModalProps: {},\n  animationDisabled: false,\n  animationDuration: 300,\n  animationOnKeyInput: false,\n  clickOutsideToClose: true,\n  closeLabel: 'Close lightbox',\n  discourageDownloads: false,\n  enableZoom: true,\n  imagePadding: 10,\n  imageCrossOrigin: null,\n  keyRepeatKeyupBonus: 40,\n  keyRepeatLimit: 180,\n  mainSrcThumbnail: null,\n  nextLabel: 'Next image',\n  nextSrc: null,\n  nextSrcThumbnail: null,\n  onAfterOpen: function onAfterOpen() {},\n  onImageLoadError: function onImageLoadError() {},\n  onImageLoad: function onImageLoad() {},\n  onMoveNextRequest: function onMoveNextRequest() {},\n  onMovePrevRequest: function onMovePrevRequest() {},\n  prevLabel: 'Previous image',\n  prevSrc: null,\n  prevSrcThumbnail: null,\n  reactModalStyle: {},\n  wrapperClassName: '',\n  zoomInLabel: 'Zoom in',\n  zoomOutLabel: 'Zoom out',\n  imageLoadErrorMessage: 'This image failed to load'\n};\n\nexport default ReactImageLightbox;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  type: PropTypes.oneOf(['move', 'copy']).isRequired,\n  asyncOperatedFilesLength: PropTypes.number.isRequired,\n  asyncOperationProgress: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass CopyMoveDirentProgressDialog extends React.Component {\n\n  render() {\n\n    let { type , asyncOperationProgress, asyncOperatedFilesLength } = this.props;\n    let title = type === 'move' ? gettext('Move {num} items') : gettext('Copy {num} items');\n    title = title.replace('{num}', asyncOperatedFilesLength);\n    let progressStyle = {\n      width: asyncOperationProgress + '%',\n      lineHeight: '40px',\n      textAlign: 'left',\n    };\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>{title}</ModalHeader>\n        <ModalBody style={{minHeight: '80px'}}>\n          <div className=\"progress\" style={{height: '40px'}}>\n            <div\n              className=\"progress-bar pl-2\"\n              role=\"progressbar\"\n              style={progressStyle}\n              aria-valuenow={asyncOperationProgress}\n              aria-valuemin=\"0\"\n              aria-valuemax=\"100\"\n            >\n              {asyncOperationProgress + '%'}\n            </div>\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nCopyMoveDirentProgressDialog.propTypes = propTypes;\n\nexport default CopyMoveDirentProgressDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { permission } from '../../utils/constants';\nimport TextTranslation from '../../utils/text-translation';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  node: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  paddingLeft: PropTypes.number.isRequired,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeDragStart: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeDragMove: PropTypes.func,\n  onNodeDrop: PropTypes.func,\n  handleContextClick: PropTypes.func.isRequired,\n  onNodeDragEnter: PropTypes.func.isRequired,\n  onNodeDragLeave:PropTypes.func.isRequired,\n};\n\nclass TreeNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHighlight: false,\n      isShowOperationMenu: false,\n      isNodeDropShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrag = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrag = modify;\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onNodeClick = () => {\n    const { node } = this.props;\n    const { object } = node;\n    if (object.isDir()) {\n      this.props.onNodeClick(this.props.node);\n      return;\n    }\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(object.permission);\n    if (isCustomPermission) {\n      const { preview: canPreview, modify: canModify } = customPermission.permission;\n      if (!canPreview && !canModify) return;\n    } \n    this.props.onNodeClick(this.props.node);\n  }\n\n  onLoadToggle = (e) => {\n    e.stopPropagation();\n    let { node } = this.props;\n    if (node.isExpanded) {\n      this.props.onNodeCollapse(node);\n    } else {\n      this.props.onNodeExpanded(node);\n    }\n  }\n\n  onNodeDragStart = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.props.onNodeDragStart(e, this.props.node);\n  }\n\n  onNodeDragEnter = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    if (this.props.node.object.type === 'dir') {\n      this.setState({isNodeDropShow: true});\n    }\n    this.props.onNodeDragEnter(e, this.props.node);\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.props.onNodeDragMove(e);\n  }\n\n  onNodeDragLeave = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDragLeave(e, this.props.node);\n  }\n\n  onNodeDrop = (e) => {\n    if (Utils.isIEBrower() || !this.canDrag) {\n      return false;\n    }\n    e.stopPropagation();\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDrop(e, this.props.node);\n  }\n\n  unfreezeItem = () => {\n    this.setState({isShowOperationMenu: false});\n    this.props.unfreezeItem();\n  }\n\n  onMenuItemClick = (operation, event, node) => {\n    this.props.onMenuItemClick(operation, node);\n  }\n\n  onItemMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onItemContextMenu = (event) => {\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event) => {\n    this.props.handleContextClick(event, this.props.node);\n    this.setState({isShowOperationMenu: false});\n  }\n\n  getNodeTypeAndIcon = () => {\n    let { node } = this.props;\n    let icon = '';\n    let type = '';\n    if (node.object.type === 'dir') {\n      icon = <i className=\"far fa-folder\"></i>;\n      type = 'dir';\n    } else {\n      let index = node.object.name.lastIndexOf('.');\n      if (index === -1) {\n        icon = <i className=\"far fa-file\"></i>;\n        type = 'file';\n      } else {\n        let suffix = node.object.name.slice(index).toLowerCase();\n        if (suffix === '.png' || suffix === '.jpg' || suffix === '.jpeg' || suffix === '.gif' || suffix === '.bmp') {\n          icon = <i className=\"far fa-image\"></i>;\n          type = 'image';\n        }\n        else if (suffix === '.md' || suffix === '.markdown') {\n          icon = <i className=\"far fa-file-alt\"></i>;\n          type = 'file';\n        }\n        else {\n          icon = <i className=\"far fa-file\"></i>;\n          type = 'file';\n        }\n      }\n    }\n    return {icon, type};\n  }\n\n  calculateMenuList = (node) => {\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT} =  TextTranslation;\n\n    let menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') { \n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  }\n\n  renderChildren = () => {\n    let { node, paddingLeft } = this.props;\n    if (!node.hasChildren()) {\n      return '';\n    }\n    return (\n      <div className=\"children\" style={{paddingLeft: paddingLeft}}>\n        {node.children.map(item => {\n          return (\n            <TreeNodeView\n              key={item.path}\n              node={item}\n              paddingLeft={paddingLeft}\n              userPerm={this.props.userPerm}\n              currentPath={this.props.currentPath}\n              isNodeMenuShow={this.props.isNodeMenuShow}\n              isItemFreezed={this.props.isItemFreezed}\n              onNodeClick={this.props.onNodeClick}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onNodeExpanded={this.props.onNodeExpanded}\n              freezeItem={this.props.freezeItem}\n              onMenuItemClick={this.props.onMenuItemClick}\n              unfreezeItem={this.unfreezeItem}\n              onNodeDragStart={this.props.onNodeDragStart}\n              onNodeDragMove={this.props.onNodeDragMove}\n              onNodeDrop={this.props.onNodeDrop}\n              onNodeDragEnter={this.props.onNodeDragEnter}\n              onNodeDragLeave={this.props.onNodeDragLeave}\n              handleContextClick={this.props.handleContextClick}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n\n  render() {\n    let { currentPath, node, isNodeMenuShow, userPerm } = this.props;\n    let { type, icon } = this.getNodeTypeAndIcon();\n    let hlClass = this.state.isHighlight ? 'tree-node-inner-hover ' : '';\n    if (node.path === currentPath) {\n      hlClass = 'tree-node-hight-light';\n    }\n\n    const { isCustomPermission } = Utils.getUserPermission(userPerm)\n    return (\n      <div className=\"tree-node\">\n        <div\n          type={type}\n          className={`tree-node-inner text-nowrap ${hlClass} ${node.path === '/'? 'hide': ''} ${this.state.isNodeDropShow ? 'tree-node-drop' : ''}`}\n          title={node.object.name}\n          onMouseEnter={this.onMouseEnter}\n          onMouseOver={this.onMouseOver}\n          onMouseLeave={this.onMouseLeave}\n          onMouseDown={this.onItemMouseDown}\n          onContextMenu={this.onItemContextMenu}\n          onClick={this.onNodeClick}\n        >\n          <div className=\"tree-node-text\" draggable={this.canDrag} onDragStart={this.onNodeDragStart} onDragEnter={this.onNodeDragEnter} onDragLeave={this.onNodeDragLeave} onDragOver={this.onNodeDragMove} onDrop={this.onNodeDrop}>{node.object.name}</div>\n          <div className=\"left-icon\">\n            {type === 'dir' && (!node.isLoaded ||  (node.isLoaded && node.hasChildren())) && (\n              <i\n                className={`folder-toggle-icon fa ${node.isExpanded ? 'fa-caret-down' : 'fa-caret-right'}`}\n                onMouseDown={e => e.stopPropagation()}\n                onClick={this.onLoadToggle}\n              ></i>\n            )}\n            <i className=\"tree-node-icon\">{icon}</i>\n          </div>\n          {isNodeMenuShow && (\n            <div className=\"right-icon\">\n              {((userPerm === 'rw' || permission || isCustomPermission) && this.state.isShowOperationMenu) && (\n                <ItemDropdownMenu\n                  item={this.props.node}\n                  toggleClass={'fas fa-ellipsis-v'}\n                  getMenuList={this.calculateMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  freezeItem={this.props.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                />\n              )}\n            </div>\n          )}\n        </div>\n        {node.isExpanded && this.renderChildren()}\n      </div>\n    );\n  }\n}\n\nTreeNodeView.propTypes = propTypes;\n\nexport default TreeNodeView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextTranslation from '../../utils/text-translation';\nimport TreeNodeView from './tree-node-view';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  userPerm: PropTypes.string,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  onItemsMove: PropTypes.func,\n};\n\nconst PADDING_LEFT = 20;\n\nclass TreeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isTreeViewDropTipShow: false,\n    };\n    const { userPerm } = props;\n    this.canDrop = userPerm === 'rw';\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (isCustomPermission) {\n      const { modify } = customPermission.permission;\n      this.canDrop = modify;\n    }\n  }\n\n  onItemMove = (repo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(repo, dirent, selectedPath, currentPath);\n  }\n\n  onNodeDragStart = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    let dragStartNodeData = {nodeDirent: node.object, nodeParentPath: node.parentNode.path, nodeRootPath: node.path};\n    dragStartNodeData = JSON.stringify(dragStartNodeData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartNodeData);\n  }\n\n  onNodeDragEnter = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.persist();\n    if (e.target.className === 'tree-view tree ') {\n      this.setState({\n        isTreeViewDropTipShow: true,\n      });\n    }\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onNodeDragLeave = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.target.className === 'tree-view tree tree-view-drop') {\n      this.setState({\n        isTreeViewDropTipShow: false,\n      });\n    }\n  }\n\n  onNodeDrop = (e, node) => {\n    if (Utils.isIEBrower() || !this.canDrop) {\n      return false;\n    }\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartNodeData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartNodeData = JSON.parse(dragStartNodeData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartNodeData;\n    let dropNodeData = node;\n\n    if (Array.isArray(dragStartNodeData)) { //move items\n      if (!dropNodeData) { //move items to root\n        if (dragStartNodeData[0].nodeParentPath === '/') {\n          this.setState({isTreeViewDropTipShow: false});\n          return;\n        }\n        this.props.onItemsMove(this.props.currentRepoInfo, '/');\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onMoveItems(dragStartNodeData, dropNodeData, this.props.currentRepoInfo, dropNodeData.path);\n      return;\n    }\n\n    if (!dropNodeData) {\n      if (nodeParentPath === '/') {\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onItemMove(this.props.currentRepoInfo, nodeDirent, '/', nodeParentPath);\n      this.setState({isTreeViewDropTipShow: false});\n      return;\n    }\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    if (nodeParentPath === dropNodeData.path) {\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (nodeParentPath === dropNodeData.parentNode.path) {\n      if (dropNodeData.object.name === nodeDirent.name) {\n        return;\n      }\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropNodeData.object.type === 'dir' && nodeDirent.type === 'dir') {\n      if (dropNodeData.parentNode.path !== nodeParentPath) {\n        let paths = Utils.getPaths(dropNodeData.path);\n        if (paths.includes(nodeRootPath)) {\n          return;\n        }\n      }\n    }\n\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, dropNodeData.path, nodeParentPath);\n  }\n\n  onMoveItems = (dragStartNodeData, dropNodeData, destRepo, destDirentPath) => {\n    let direntPaths = [];\n    let paths = Utils.getPaths(destDirentPath);\n    dragStartNodeData.forEach(dirent => {\n      let path = dirent.nodeRootPath;\n      direntPaths.push(path);\n    });\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === destDirentPath;})) {\n      return;\n    }\n\n    // move dirents to current path\n    if (dragStartNodeData[0].nodeParentPath && dragStartNodeData[0].nodeParentPath === dropNodeData.path ) {\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let isChildPath = direntPaths.some(direntPath => {\n      return paths.includes(direntPath);\n    });\n    if (isChildPath) {\n      return;\n    }\n\n    this.props.onItemsMove(destRepo, destDirentPath);\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.props.onMenuItemClick(operation, node);\n    hideMenu();\n  }\n\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n\n    let currentRepoInfo = this.props.currentRepoInfo;\n    if (currentRepoInfo.permission !== 'admin' && currentRepoInfo.permission !== 'rw') {\n      return '';\n    }\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event, node) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!this.props.isNodeMenuShow) {\n      return;\n    }\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let menuList = this.getMenuList(node);\n\n    let showMenuConfig = {\n      id: 'tree-node-contextmenu',\n      position: { x, y },\n      target: event.target,\n      currentObject: node,\n      menuList: menuList,\n    };\n\n    showMenu(showMenuConfig);\n  }\n\n  getMenuList = (node) => {\n    let menuList = [];\n\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT } = TextTranslation;\n\n    if (!node) {\n      return [NEW_FOLDER, NEW_FILE];\n    }\n\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    } else {\n      menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    }\n\n    const { userPerm } = this.props;\n    const { isCustomPermission, customPermission } = Utils.getUserPermission(userPerm);\n    if (!isCustomPermission) {\n      return menuList;\n    }\n\n    menuList = [];\n\n    const { create: canCreate, modify: canModify, delete: canDelete, copy: canCopy } = customPermission.permission;\n    if (!node) {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n      return menuList;\n    }\n\n    if (node.object.type === 'dir') {\n      canCreate && menuList.push(NEW_FOLDER, NEW_FILE);\n    }\n\n    canCopy && menuList.push(COPY);\n    canModify && menuList.push(MOVE, RENAME);\n    canDelete && menuList.push(DELETE);\n\n    if (node.object.type !== 'dir') { \n      menuList.push(OPEN_VIA_CLIENT);\n    }\n\n    return menuList;\n  }\n\n  onShowMenu = () => {\n    this.freezeItem();\n  }\n\n  onHideMenu = () => {\n    this.unfreezeItem();\n  }\n\n  render() {\n    return (\n      <div\n        className={`tree-view tree ${(this.state.isTreeViewDropTipShow && this.canDrop) ? 'tree-view-drop' : ''}`}\n        onDrop={this.onNodeDrop}\n        onDragEnter={this.onNodeDragEnter}\n        onDragLeave={this.onNodeDragLeave}\n        onMouseDown={this.onMouseDown}\n        onContextMenu={this.onContextMenu}\n      >\n        <TreeNodeView\n          userPerm={this.props.userPerm}\n          node={this.props.treeData.root}\n          currentPath={this.props.currentPath}\n          paddingLeft={PADDING_LEFT}\n          isNodeMenuShow={this.props.isNodeMenuShow}\n          isItemFreezed={this.state.isItemFreezed}\n          onNodeClick={this.props.onNodeClick}\n          onMenuItemClick={this.props.onMenuItemClick}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeDragStart={this.onNodeDragStart}\n          freezeItem={this.freezeItem}\n          unfreezeItem={this.unfreezeItem}\n          onNodeDragMove={this.onNodeDragMove}\n          onNodeDrop={this.onNodeDrop}\n          onNodeDragEnter={this.onNodeDragEnter}\n          onNodeDragLeave={this.onNodeDragLeave}\n          handleContextClick={this.handleContextClick}\n        />\n        <ContextMenu\n          id={'tree-node-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n          onHideMenu={this.onHideMenu}\n          onShowMenu={this.onShowMenu}\n        />\n      </div>\n    );\n  }\n}\n\nTreeView.propTypes = propTypes;\n\nexport default TreeView;\n","\n/**\n * Module dependencies.\n */\n\nvar parseuri = require('parseuri');\nvar debug = require('debug')('socket.io-client:url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = url;\n\n/**\n * URL parser.\n *\n * @param {String} url\n * @param {Object} An object meant to mimic window.location.\n *                 Defaults to window.location.\n * @api public\n */\n\nfunction url (uri, loc) {\n  var obj = uri;\n\n  // default to window.location\n  loc = loc || (typeof location !== 'undefined' && location);\n  if (null == uri) uri = loc.protocol + '//' + loc.host;\n\n  // relative path support\n  if ('string' === typeof uri) {\n    if ('/' === uri.charAt(0)) {\n      if ('/' === uri.charAt(1)) {\n        uri = loc.protocol + uri;\n      } else {\n        uri = loc.host + uri;\n      }\n    }\n\n    if (!/^(https?|wss?):\\/\\//.test(uri)) {\n      debug('protocol-less url %s', uri);\n      if ('undefined' !== typeof loc) {\n        uri = loc.protocol + '//' + uri;\n      } else {\n        uri = 'https://' + uri;\n      }\n    }\n\n    // parse\n    debug('parse %s', uri);\n    obj = parseuri(uri);\n  }\n\n  // make sure we treat `localhost:80` and `localhost` equally\n  if (!obj.port) {\n    if (/^(http|ws)$/.test(obj.protocol)) {\n      obj.port = '80';\n    } else if (/^(http|ws)s$/.test(obj.protocol)) {\n      obj.port = '443';\n    }\n  }\n\n  obj.path = obj.path || '/';\n\n  var ipv6 = obj.host.indexOf(':') !== -1;\n  var host = ipv6 ? '[' + obj.host + ']' : obj.host;\n\n  // define unique id\n  obj.id = obj.protocol + '://' + host + ':' + obj.port;\n  // define href\n  obj.href = obj.protocol + '://' + host + (loc && loc.port === obj.port ? '' : (':' + obj.port));\n\n  return obj;\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' || (typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]');\nvar withNativeFile = typeof File === 'function' || (typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]');\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = { _placeholder: true, num: buffers.length };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n    return newData;\n  }\n  return data;\n}\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder) {\n    return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n","\nmodule.exports = require('./socket');\n\n/**\n * Exports parser\n *\n * @api public\n *\n */\nmodule.exports.parser = require('engine.io-parser');\n","/**\n * Module dependencies.\n */\n\nvar transports = require('./transports/index');\nvar Emitter = require('component-emitter');\nvar debug = require('debug')('engine.io-client:socket');\nvar index = require('indexof');\nvar parser = require('engine.io-parser');\nvar parseuri = require('parseuri');\nvar parseqs = require('parseqs');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Socket;\n\n/**\n * Socket constructor.\n *\n * @param {String|Object} uri or options\n * @param {Object} options\n * @api public\n */\n\nfunction Socket (uri, opts) {\n  if (!(this instanceof Socket)) return new Socket(uri, opts);\n\n  opts = opts || {};\n\n  if (uri && 'object' === typeof uri) {\n    opts = uri;\n    uri = null;\n  }\n\n  if (uri) {\n    uri = parseuri(uri);\n    opts.hostname = uri.host;\n    opts.secure = uri.protocol === 'https' || uri.protocol === 'wss';\n    opts.port = uri.port;\n    if (uri.query) opts.query = uri.query;\n  } else if (opts.host) {\n    opts.hostname = parseuri(opts.host).host;\n  }\n\n  this.secure = null != opts.secure ? opts.secure\n    : (typeof location !== 'undefined' && 'https:' === location.protocol);\n\n  if (opts.hostname && !opts.port) {\n    // if no port is specified manually, use the protocol default\n    opts.port = this.secure ? '443' : '80';\n  }\n\n  this.agent = opts.agent || false;\n  this.hostname = opts.hostname ||\n    (typeof location !== 'undefined' ? location.hostname : 'localhost');\n  this.port = opts.port || (typeof location !== 'undefined' && location.port\n      ? location.port\n      : (this.secure ? 443 : 80));\n  this.query = opts.query || {};\n  if ('string' === typeof this.query) this.query = parseqs.decode(this.query);\n  this.upgrade = false !== opts.upgrade;\n  this.path = (opts.path || '/engine.io').replace(/\\/$/, '') + '/';\n  this.forceJSONP = !!opts.forceJSONP;\n  this.jsonp = false !== opts.jsonp;\n  this.forceBase64 = !!opts.forceBase64;\n  this.enablesXDR = !!opts.enablesXDR;\n  this.withCredentials = false !== opts.withCredentials;\n  this.timestampParam = opts.timestampParam || 't';\n  this.timestampRequests = opts.timestampRequests;\n  this.transports = opts.transports || ['polling', 'websocket'];\n  this.transportOptions = opts.transportOptions || {};\n  this.readyState = '';\n  this.writeBuffer = [];\n  this.prevBufferLen = 0;\n  this.policyPort = opts.policyPort || 843;\n  this.rememberUpgrade = opts.rememberUpgrade || false;\n  this.binaryType = null;\n  this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;\n  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || {}) : false;\n\n  if (true === this.perMessageDeflate) this.perMessageDeflate = {};\n  if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {\n    this.perMessageDeflate.threshold = 1024;\n  }\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx || undefined;\n  this.key = opts.key || undefined;\n  this.passphrase = opts.passphrase || undefined;\n  this.cert = opts.cert || undefined;\n  this.ca = opts.ca || undefined;\n  this.ciphers = opts.ciphers || undefined;\n  this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;\n  this.forceNode = !!opts.forceNode;\n\n  // detect ReactNative environment\n  this.isReactNative = (typeof navigator !== 'undefined' && typeof navigator.product === 'string' && navigator.product.toLowerCase() === 'reactnative');\n\n  // other options for Node.js or ReactNative client\n  if (typeof self === 'undefined' || this.isReactNative) {\n    if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {\n      this.extraHeaders = opts.extraHeaders;\n    }\n\n    if (opts.localAddress) {\n      this.localAddress = opts.localAddress;\n    }\n  }\n\n  // set on handshake\n  this.id = null;\n  this.upgrades = null;\n  this.pingInterval = null;\n  this.pingTimeout = null;\n\n  // set on heartbeat\n  this.pingIntervalTimer = null;\n  this.pingTimeoutTimer = null;\n\n  this.open();\n}\n\nSocket.priorWebsocketSuccess = false;\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nSocket.protocol = parser.protocol; // this is an int\n\n/**\n * Expose deps for legacy compatibility\n * and standalone browser access.\n */\n\nSocket.Socket = Socket;\nSocket.Transport = require('./transport');\nSocket.transports = require('./transports/index');\nSocket.parser = require('engine.io-parser');\n\n/**\n * Creates transport of the given type.\n *\n * @param {String} transport name\n * @return {Transport}\n * @api private\n */\n\nSocket.prototype.createTransport = function (name) {\n  debug('creating transport \"%s\"', name);\n  var query = clone(this.query);\n\n  // append engine.io protocol identifier\n  query.EIO = parser.protocol;\n\n  // transport name\n  query.transport = name;\n\n  // per-transport options\n  var options = this.transportOptions[name] || {};\n\n  // session id if we already have one\n  if (this.id) query.sid = this.id;\n\n  var transport = new transports[name]({\n    query: query,\n    socket: this,\n    agent: options.agent || this.agent,\n    hostname: options.hostname || this.hostname,\n    port: options.port || this.port,\n    secure: options.secure || this.secure,\n    path: options.path || this.path,\n    forceJSONP: options.forceJSONP || this.forceJSONP,\n    jsonp: options.jsonp || this.jsonp,\n    forceBase64: options.forceBase64 || this.forceBase64,\n    enablesXDR: options.enablesXDR || this.enablesXDR,\n    withCredentials: options.withCredentials || this.withCredentials,\n    timestampRequests: options.timestampRequests || this.timestampRequests,\n    timestampParam: options.timestampParam || this.timestampParam,\n    policyPort: options.policyPort || this.policyPort,\n    pfx: options.pfx || this.pfx,\n    key: options.key || this.key,\n    passphrase: options.passphrase || this.passphrase,\n    cert: options.cert || this.cert,\n    ca: options.ca || this.ca,\n    ciphers: options.ciphers || this.ciphers,\n    rejectUnauthorized: options.rejectUnauthorized || this.rejectUnauthorized,\n    perMessageDeflate: options.perMessageDeflate || this.perMessageDeflate,\n    extraHeaders: options.extraHeaders || this.extraHeaders,\n    forceNode: options.forceNode || this.forceNode,\n    localAddress: options.localAddress || this.localAddress,\n    requestTimeout: options.requestTimeout || this.requestTimeout,\n    protocols: options.protocols || void (0),\n    isReactNative: this.isReactNative\n  });\n\n  return transport;\n};\n\nfunction clone (obj) {\n  var o = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      o[i] = obj[i];\n    }\n  }\n  return o;\n}\n\n/**\n * Initializes transport to use and starts probe.\n *\n * @api private\n */\nSocket.prototype.open = function () {\n  var transport;\n  if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') !== -1) {\n    transport = 'websocket';\n  } else if (0 === this.transports.length) {\n    // Emit error on next tick so it can be listened to\n    var self = this;\n    setTimeout(function () {\n      self.emit('error', 'No transports available');\n    }, 0);\n    return;\n  } else {\n    transport = this.transports[0];\n  }\n  this.readyState = 'opening';\n\n  // Retry with the next transport if the transport is disabled (jsonp: false)\n  try {\n    transport = this.createTransport(transport);\n  } catch (e) {\n    this.transports.shift();\n    this.open();\n    return;\n  }\n\n  transport.open();\n  this.setTransport(transport);\n};\n\n/**\n * Sets the current transport. Disables the existing one (if any).\n *\n * @api private\n */\n\nSocket.prototype.setTransport = function (transport) {\n  debug('setting transport %s', transport.name);\n  var self = this;\n\n  if (this.transport) {\n    debug('clearing existing transport %s', this.transport.name);\n    this.transport.removeAllListeners();\n  }\n\n  // set up transport\n  this.transport = transport;\n\n  // set up transport listeners\n  transport\n  .on('drain', function () {\n    self.onDrain();\n  })\n  .on('packet', function (packet) {\n    self.onPacket(packet);\n  })\n  .on('error', function (e) {\n    self.onError(e);\n  })\n  .on('close', function () {\n    self.onClose('transport close');\n  });\n};\n\n/**\n * Probes a transport.\n *\n * @param {String} transport name\n * @api private\n */\n\nSocket.prototype.probe = function (name) {\n  debug('probing transport \"%s\"', name);\n  var transport = this.createTransport(name, { probe: 1 });\n  var failed = false;\n  var self = this;\n\n  Socket.priorWebsocketSuccess = false;\n\n  function onTransportOpen () {\n    if (self.onlyBinaryUpgrades) {\n      var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;\n      failed = failed || upgradeLosesBinary;\n    }\n    if (failed) return;\n\n    debug('probe transport \"%s\" opened', name);\n    transport.send([{ type: 'ping', data: 'probe' }]);\n    transport.once('packet', function (msg) {\n      if (failed) return;\n      if ('pong' === msg.type && 'probe' === msg.data) {\n        debug('probe transport \"%s\" pong', name);\n        self.upgrading = true;\n        self.emit('upgrading', transport);\n        if (!transport) return;\n        Socket.priorWebsocketSuccess = 'websocket' === transport.name;\n\n        debug('pausing current transport \"%s\"', self.transport.name);\n        self.transport.pause(function () {\n          if (failed) return;\n          if ('closed' === self.readyState) return;\n          debug('changing transport and sending upgrade packet');\n\n          cleanup();\n\n          self.setTransport(transport);\n          transport.send([{ type: 'upgrade' }]);\n          self.emit('upgrade', transport);\n          transport = null;\n          self.upgrading = false;\n          self.flush();\n        });\n      } else {\n        debug('probe transport \"%s\" failed', name);\n        var err = new Error('probe error');\n        err.transport = transport.name;\n        self.emit('upgradeError', err);\n      }\n    });\n  }\n\n  function freezeTransport () {\n    if (failed) return;\n\n    // Any callback called by transport should be ignored since now\n    failed = true;\n\n    cleanup();\n\n    transport.close();\n    transport = null;\n  }\n\n  // Handle any error that happens while probing\n  function onerror (err) {\n    var error = new Error('probe error: ' + err);\n    error.transport = transport.name;\n\n    freezeTransport();\n\n    debug('probe transport \"%s\" failed because of error: %s', name, err);\n\n    self.emit('upgradeError', error);\n  }\n\n  function onTransportClose () {\n    onerror('transport closed');\n  }\n\n  // When the socket is closed while we're probing\n  function onclose () {\n    onerror('socket closed');\n  }\n\n  // When the socket is upgraded while we're probing\n  function onupgrade (to) {\n    if (transport && to.name !== transport.name) {\n      debug('\"%s\" works - aborting \"%s\"', to.name, transport.name);\n      freezeTransport();\n    }\n  }\n\n  // Remove all listeners on the transport and on self\n  function cleanup () {\n    transport.removeListener('open', onTransportOpen);\n    transport.removeListener('error', onerror);\n    transport.removeListener('close', onTransportClose);\n    self.removeListener('close', onclose);\n    self.removeListener('upgrading', onupgrade);\n  }\n\n  transport.once('open', onTransportOpen);\n  transport.once('error', onerror);\n  transport.once('close', onTransportClose);\n\n  this.once('close', onclose);\n  this.once('upgrading', onupgrade);\n\n  transport.open();\n};\n\n/**\n * Called when connection is deemed open.\n *\n * @api public\n */\n\nSocket.prototype.onOpen = function () {\n  debug('socket open');\n  this.readyState = 'open';\n  Socket.priorWebsocketSuccess = 'websocket' === this.transport.name;\n  this.emit('open');\n  this.flush();\n\n  // we check for `readyState` in case an `open`\n  // listener already closed the socket\n  if ('open' === this.readyState && this.upgrade && this.transport.pause) {\n    debug('starting upgrade probes');\n    for (var i = 0, l = this.upgrades.length; i < l; i++) {\n      this.probe(this.upgrades[i]);\n    }\n  }\n};\n\n/**\n * Handles a packet.\n *\n * @api private\n */\n\nSocket.prototype.onPacket = function (packet) {\n  if ('opening' === this.readyState || 'open' === this.readyState ||\n      'closing' === this.readyState) {\n    debug('socket receive: type \"%s\", data \"%s\"', packet.type, packet.data);\n\n    this.emit('packet', packet);\n\n    // Socket is live - any packet counts\n    this.emit('heartbeat');\n\n    switch (packet.type) {\n      case 'open':\n        this.onHandshake(JSON.parse(packet.data));\n        break;\n\n      case 'pong':\n        this.setPing();\n        this.emit('pong');\n        break;\n\n      case 'error':\n        var err = new Error('server error');\n        err.code = packet.data;\n        this.onError(err);\n        break;\n\n      case 'message':\n        this.emit('data', packet.data);\n        this.emit('message', packet.data);\n        break;\n    }\n  } else {\n    debug('packet received with socket readyState \"%s\"', this.readyState);\n  }\n};\n\n/**\n * Called upon handshake completion.\n *\n * @param {Object} handshake obj\n * @api private\n */\n\nSocket.prototype.onHandshake = function (data) {\n  this.emit('handshake', data);\n  this.id = data.sid;\n  this.transport.query.sid = data.sid;\n  this.upgrades = this.filterUpgrades(data.upgrades);\n  this.pingInterval = data.pingInterval;\n  this.pingTimeout = data.pingTimeout;\n  this.onOpen();\n  // In case open handler closes socket\n  if ('closed' === this.readyState) return;\n  this.setPing();\n\n  // Prolong liveness of socket on heartbeat\n  this.removeListener('heartbeat', this.onHeartbeat);\n  this.on('heartbeat', this.onHeartbeat);\n};\n\n/**\n * Resets ping timeout.\n *\n * @api private\n */\n\nSocket.prototype.onHeartbeat = function (timeout) {\n  clearTimeout(this.pingTimeoutTimer);\n  var self = this;\n  self.pingTimeoutTimer = setTimeout(function () {\n    if ('closed' === self.readyState) return;\n    self.onClose('ping timeout');\n  }, timeout || (self.pingInterval + self.pingTimeout));\n};\n\n/**\n * Pings server every `this.pingInterval` and expects response\n * within `this.pingTimeout` or closes connection.\n *\n * @api private\n */\n\nSocket.prototype.setPing = function () {\n  var self = this;\n  clearTimeout(self.pingIntervalTimer);\n  self.pingIntervalTimer = setTimeout(function () {\n    debug('writing ping packet - expecting pong within %sms', self.pingTimeout);\n    self.ping();\n    self.onHeartbeat(self.pingTimeout);\n  }, self.pingInterval);\n};\n\n/**\n* Sends a ping packet.\n*\n* @api private\n*/\n\nSocket.prototype.ping = function () {\n  var self = this;\n  this.sendPacket('ping', function () {\n    self.emit('ping');\n  });\n};\n\n/**\n * Called on `drain` event\n *\n * @api private\n */\n\nSocket.prototype.onDrain = function () {\n  this.writeBuffer.splice(0, this.prevBufferLen);\n\n  // setting prevBufferLen = 0 is very important\n  // for example, when upgrading, upgrade packet is sent over,\n  // and a nonzero prevBufferLen could cause problems on `drain`\n  this.prevBufferLen = 0;\n\n  if (0 === this.writeBuffer.length) {\n    this.emit('drain');\n  } else {\n    this.flush();\n  }\n};\n\n/**\n * Flush write buffers.\n *\n * @api private\n */\n\nSocket.prototype.flush = function () {\n  if ('closed' !== this.readyState && this.transport.writable &&\n    !this.upgrading && this.writeBuffer.length) {\n    debug('flushing %d packets in socket', this.writeBuffer.length);\n    this.transport.send(this.writeBuffer);\n    // keep track of current length of writeBuffer\n    // splice writeBuffer and callbackBuffer on `drain`\n    this.prevBufferLen = this.writeBuffer.length;\n    this.emit('flush');\n  }\n};\n\n/**\n * Sends a message.\n *\n * @param {String} message.\n * @param {Function} callback function.\n * @param {Object} options.\n * @return {Socket} for chaining.\n * @api public\n */\n\nSocket.prototype.write =\nSocket.prototype.send = function (msg, options, fn) {\n  this.sendPacket('message', msg, options, fn);\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {String} packet type.\n * @param {String} data.\n * @param {Object} options.\n * @param {Function} callback function.\n * @api private\n */\n\nSocket.prototype.sendPacket = function (type, data, options, fn) {\n  if ('function' === typeof data) {\n    fn = data;\n    data = undefined;\n  }\n\n  if ('function' === typeof options) {\n    fn = options;\n    options = null;\n  }\n\n  if ('closing' === this.readyState || 'closed' === this.readyState) {\n    return;\n  }\n\n  options = options || {};\n  options.compress = false !== options.compress;\n\n  var packet = {\n    type: type,\n    data: data,\n    options: options\n  };\n  this.emit('packetCreate', packet);\n  this.writeBuffer.push(packet);\n  if (fn) this.once('flush', fn);\n  this.flush();\n};\n\n/**\n * Closes the connection.\n *\n * @api private\n */\n\nSocket.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.readyState = 'closing';\n\n    var self = this;\n\n    if (this.writeBuffer.length) {\n      this.once('drain', function () {\n        if (this.upgrading) {\n          waitForUpgrade();\n        } else {\n          close();\n        }\n      });\n    } else if (this.upgrading) {\n      waitForUpgrade();\n    } else {\n      close();\n    }\n  }\n\n  function close () {\n    self.onClose('forced close');\n    debug('socket closing - telling transport to close');\n    self.transport.close();\n  }\n\n  function cleanupAndClose () {\n    self.removeListener('upgrade', cleanupAndClose);\n    self.removeListener('upgradeError', cleanupAndClose);\n    close();\n  }\n\n  function waitForUpgrade () {\n    // wait for upgrade to finish since we can't send packets while pausing a transport\n    self.once('upgrade', cleanupAndClose);\n    self.once('upgradeError', cleanupAndClose);\n  }\n\n  return this;\n};\n\n/**\n * Called upon transport error\n *\n * @api private\n */\n\nSocket.prototype.onError = function (err) {\n  debug('socket error %j', err);\n  Socket.priorWebsocketSuccess = false;\n  this.emit('error', err);\n  this.onClose('transport error', err);\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nSocket.prototype.onClose = function (reason, desc) {\n  if ('opening' === this.readyState || 'open' === this.readyState || 'closing' === this.readyState) {\n    debug('socket close with reason: \"%s\"', reason);\n    var self = this;\n\n    // clear timers\n    clearTimeout(this.pingIntervalTimer);\n    clearTimeout(this.pingTimeoutTimer);\n\n    // stop event from firing again for transport\n    this.transport.removeAllListeners('close');\n\n    // ensure transport won't stay open\n    this.transport.close();\n\n    // ignore further transport communication\n    this.transport.removeAllListeners();\n\n    // set ready state\n    this.readyState = 'closed';\n\n    // clear session id\n    this.id = null;\n\n    // emit close event\n    this.emit('close', reason, desc);\n\n    // clean buffers after, so users can still\n    // grab the buffers on `close` event\n    self.writeBuffer = [];\n    self.prevBufferLen = 0;\n  }\n};\n\n/**\n * Filters upgrades, returning only those matching client transports.\n *\n * @param {Array} server upgrades\n * @api private\n *\n */\n\nSocket.prototype.filterUpgrades = function (upgrades) {\n  var filteredUpgrades = [];\n  for (var i = 0, j = upgrades.length; i < j; i++) {\n    if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);\n  }\n  return filteredUpgrades;\n};\n","\n/**\n * Module exports.\n *\n * Logic borrowed from Modernizr:\n *\n *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js\n */\n\ntry {\n  module.exports = typeof XMLHttpRequest !== 'undefined' &&\n    'withCredentials' in new XMLHttpRequest();\n} catch (err) {\n  // if XMLHttp support is disabled in IE then it will throw\n  // when trying to create\n  module.exports = false;\n}\n","/* global attachEvent */\n\n/**\n * Module requirements.\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar Polling = require('./polling');\nvar Emitter = require('component-emitter');\nvar inherit = require('component-inherit');\nvar debug = require('debug')('engine.io-client:polling-xhr');\nvar globalThis = require('../globalThis');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\nmodule.exports.Request = Request;\n\n/**\n * Empty function\n */\n\nfunction empty () {}\n\n/**\n * XHR Polling constructor.\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction XHR (opts) {\n  Polling.call(this, opts);\n  this.requestTimeout = opts.requestTimeout;\n  this.extraHeaders = opts.extraHeaders;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    this.xd = (typeof location !== 'undefined' && opts.hostname !== location.hostname) ||\n      port !== opts.port;\n    this.xs = opts.secure !== isSSL;\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(XHR, Polling);\n\n/**\n * XHR supports binary\n */\n\nXHR.prototype.supportsBinary = true;\n\n/**\n * Creates a request.\n *\n * @param {String} method\n * @api private\n */\n\nXHR.prototype.request = function (opts) {\n  opts = opts || {};\n  opts.uri = this.uri();\n  opts.xd = this.xd;\n  opts.xs = this.xs;\n  opts.agent = this.agent || false;\n  opts.supportsBinary = this.supportsBinary;\n  opts.enablesXDR = this.enablesXDR;\n  opts.withCredentials = this.withCredentials;\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  opts.requestTimeout = this.requestTimeout;\n\n  // other options for Node.js client\n  opts.extraHeaders = this.extraHeaders;\n\n  return new Request(opts);\n};\n\n/**\n * Sends data.\n *\n * @param {String} data to send.\n * @param {Function} called upon flush.\n * @api private\n */\n\nXHR.prototype.doWrite = function (data, fn) {\n  var isBinary = typeof data !== 'string' && data !== undefined;\n  var req = this.request({ method: 'POST', data: data, isBinary: isBinary });\n  var self = this;\n  req.on('success', fn);\n  req.on('error', function (err) {\n    self.onError('xhr post error', err);\n  });\n  this.sendXhr = req;\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nXHR.prototype.doPoll = function () {\n  debug('xhr poll');\n  var req = this.request();\n  var self = this;\n  req.on('data', function (data) {\n    self.onData(data);\n  });\n  req.on('error', function (err) {\n    self.onError('xhr poll error', err);\n  });\n  this.pollXhr = req;\n};\n\n/**\n * Request constructor\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Request (opts) {\n  this.method = opts.method || 'GET';\n  this.uri = opts.uri;\n  this.xd = !!opts.xd;\n  this.xs = !!opts.xs;\n  this.async = false !== opts.async;\n  this.data = undefined !== opts.data ? opts.data : null;\n  this.agent = opts.agent;\n  this.isBinary = opts.isBinary;\n  this.supportsBinary = opts.supportsBinary;\n  this.enablesXDR = opts.enablesXDR;\n  this.withCredentials = opts.withCredentials;\n  this.requestTimeout = opts.requestTimeout;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n\n  this.create();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Creates the XHR object and sends the request.\n *\n * @api private\n */\n\nRequest.prototype.create = function () {\n  var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n\n  var xhr = this.xhr = new XMLHttpRequest(opts);\n  var self = this;\n\n  try {\n    debug('xhr open %s: %s', this.method, this.uri);\n    xhr.open(this.method, this.uri, this.async);\n    try {\n      if (this.extraHeaders) {\n        xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n        for (var i in this.extraHeaders) {\n          if (this.extraHeaders.hasOwnProperty(i)) {\n            xhr.setRequestHeader(i, this.extraHeaders[i]);\n          }\n        }\n      }\n    } catch (e) {}\n\n    if ('POST' === this.method) {\n      try {\n        if (this.isBinary) {\n          xhr.setRequestHeader('Content-type', 'application/octet-stream');\n        } else {\n          xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n        }\n      } catch (e) {}\n    }\n\n    try {\n      xhr.setRequestHeader('Accept', '*/*');\n    } catch (e) {}\n\n    // ie6 check\n    if ('withCredentials' in xhr) {\n      xhr.withCredentials = this.withCredentials;\n    }\n\n    if (this.requestTimeout) {\n      xhr.timeout = this.requestTimeout;\n    }\n\n    if (this.hasXDR()) {\n      xhr.onload = function () {\n        self.onLoad();\n      };\n      xhr.onerror = function () {\n        self.onError(xhr.responseText);\n      };\n    } else {\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 2) {\n          try {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (self.supportsBinary && contentType === 'application/octet-stream' || contentType === 'application/octet-stream; charset=UTF-8') {\n              xhr.responseType = 'arraybuffer';\n            }\n          } catch (e) {}\n        }\n        if (4 !== xhr.readyState) return;\n        if (200 === xhr.status || 1223 === xhr.status) {\n          self.onLoad();\n        } else {\n          // make sure the `error` event handler that's user-set\n          // does not throw in the same tick and gets caught here\n          setTimeout(function () {\n            self.onError(typeof xhr.status === 'number' ? xhr.status : 0);\n          }, 0);\n        }\n      };\n    }\n\n    debug('xhr data %s', this.data);\n    xhr.send(this.data);\n  } catch (e) {\n    // Need to defer since .create() is called directly fhrom the constructor\n    // and thus the 'error' event can only be only bound *after* this exception\n    // occurs.  Therefore, also, we cannot throw here at all.\n    setTimeout(function () {\n      self.onError(e);\n    }, 0);\n    return;\n  }\n\n  if (typeof document !== 'undefined') {\n    this.index = Request.requestsCount++;\n    Request.requests[this.index] = this;\n  }\n};\n\n/**\n * Called upon successful response.\n *\n * @api private\n */\n\nRequest.prototype.onSuccess = function () {\n  this.emit('success');\n  this.cleanup();\n};\n\n/**\n * Called if we have data.\n *\n * @api private\n */\n\nRequest.prototype.onData = function (data) {\n  this.emit('data', data);\n  this.onSuccess();\n};\n\n/**\n * Called upon error.\n *\n * @api private\n */\n\nRequest.prototype.onError = function (err) {\n  this.emit('error', err);\n  this.cleanup(true);\n};\n\n/**\n * Cleans up house.\n *\n * @api private\n */\n\nRequest.prototype.cleanup = function (fromError) {\n  if ('undefined' === typeof this.xhr || null === this.xhr) {\n    return;\n  }\n  // xmlhttprequest\n  if (this.hasXDR()) {\n    this.xhr.onload = this.xhr.onerror = empty;\n  } else {\n    this.xhr.onreadystatechange = empty;\n  }\n\n  if (fromError) {\n    try {\n      this.xhr.abort();\n    } catch (e) {}\n  }\n\n  if (typeof document !== 'undefined') {\n    delete Request.requests[this.index];\n  }\n\n  this.xhr = null;\n};\n\n/**\n * Called upon load.\n *\n * @api private\n */\n\nRequest.prototype.onLoad = function () {\n  var data;\n  try {\n    var contentType;\n    try {\n      contentType = this.xhr.getResponseHeader('Content-Type');\n    } catch (e) {}\n    if (contentType === 'application/octet-stream' || contentType === 'application/octet-stream; charset=UTF-8') {\n      data = this.xhr.response || this.xhr.responseText;\n    } else {\n      data = this.xhr.responseText;\n    }\n  } catch (e) {\n    this.onError(e);\n  }\n  if (null != data) {\n    this.onData(data);\n  }\n};\n\n/**\n * Check if it has XDomainRequest.\n *\n * @api private\n */\n\nRequest.prototype.hasXDR = function () {\n  return typeof XDomainRequest !== 'undefined' && !this.xs && this.enablesXDR;\n};\n\n/**\n * Aborts the request.\n *\n * @api public\n */\n\nRequest.prototype.abort = function () {\n  this.cleanup();\n};\n\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\n\nRequest.requestsCount = 0;\nRequest.requests = {};\n\nif (typeof document !== 'undefined') {\n  if (typeof attachEvent === 'function') {\n    attachEvent('onunload', unloadHandler);\n  } else if (typeof addEventListener === 'function') {\n    var terminationEvent = 'onpagehide' in globalThis ? 'pagehide' : 'unload';\n    addEventListener(terminationEvent, unloadHandler, false);\n  }\n}\n\nfunction unloadHandler () {\n  for (var i in Request.requests) {\n    if (Request.requests.hasOwnProperty(i)) {\n      Request.requests[i].abort();\n    }\n  }\n}\n","\n/**\n * Gets the keys for an object.\n *\n * @return {Array} keys\n * @api private\n */\n\nmodule.exports = Object.keys || function keys (obj){\n  var arr = [];\n  var has = Object.prototype.hasOwnProperty;\n\n  for (var i in obj) {\n    if (has.call(obj, i)) {\n      arr.push(i);\n    }\n  }\n  return arr;\n};\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/**\n * An abstraction for slicing an arraybuffer even when\n * ArrayBuffer.prototype.slice is not supported\n *\n * @api public\n */\n\nmodule.exports = function(arraybuffer, start, end) {\n  var bytes = arraybuffer.byteLength;\n  start = start || 0;\n  end = end || bytes;\n\n  if (arraybuffer.slice) { return arraybuffer.slice(start, end); }\n\n  if (start < 0) { start += bytes; }\n  if (end < 0) { end += bytes; }\n  if (end > bytes) { end = bytes; }\n\n  if (start >= bytes || start >= end || bytes === 0) {\n    return new ArrayBuffer(0);\n  }\n\n  var abv = new Uint8Array(arraybuffer);\n  var result = new Uint8Array(end - start);\n  for (var i = start, ii = 0; i < end; i++, ii++) {\n    result[ii] = abv[i];\n  }\n  return result.buffer;\n};\n","module.exports = after\n\nfunction after(count, callback, err_cb) {\n    var bail = false\n    err_cb = err_cb || noop\n    proxy.count = count\n\n    return (count === 0) ? callback() : proxy\n\n    function proxy(err, result) {\n        if (proxy.count <= 0) {\n            throw new Error('after called too many times')\n        }\n        --proxy.count\n\n        // after first error, rest are passed to err_cb\n        if (err) {\n            bail = true\n            callback(err)\n            // future error callbacks will go to error handler\n            callback = err_cb\n        } else if (proxy.count === 0 && !bail) {\n            callback(null, result)\n        }\n    }\n}\n\nfunction noop() {}\n","/*! https://mths.be/utf8js v2.1.2 by @mathias */\n\nvar stringFromCharCode = String.fromCharCode;\n\n// Taken from https://mths.be/punycode\nfunction ucs2decode(string) {\n\tvar output = [];\n\tvar counter = 0;\n\tvar length = string.length;\n\tvar value;\n\tvar extra;\n\twhile (counter < length) {\n\t\tvalue = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// high surrogate, and there is a next character\n\t\t\textra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n// Taken from https://mths.be/punycode\nfunction ucs2encode(array) {\n\tvar length = array.length;\n\tvar index = -1;\n\tvar value;\n\tvar output = '';\n\twhile (++index < length) {\n\t\tvalue = array[index];\n\t\tif (value > 0xFFFF) {\n\t\t\tvalue -= 0x10000;\n\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t}\n\t\toutput += stringFromCharCode(value);\n\t}\n\treturn output;\n}\n\nfunction checkScalarValue(codePoint, strict) {\n\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\tif (strict) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\treturn true;\n}\n/*--------------------------------------------------------------------------*/\n\nfunction createByte(codePoint, shift) {\n\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n}\n\nfunction encodeCodePoint(codePoint, strict) {\n\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\treturn stringFromCharCode(codePoint);\n\t}\n\tvar symbol = '';\n\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t}\n\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\tif (!checkScalarValue(codePoint, strict)) {\n\t\t\tcodePoint = 0xFFFD;\n\t\t}\n\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\tsymbol += createByte(codePoint, 12);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\treturn symbol;\n}\n\nfunction utf8encode(string, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tvar codePoints = ucs2decode(string);\n\tvar length = codePoints.length;\n\tvar index = -1;\n\tvar codePoint;\n\tvar byteString = '';\n\twhile (++index < length) {\n\t\tcodePoint = codePoints[index];\n\t\tbyteString += encodeCodePoint(codePoint, strict);\n\t}\n\treturn byteString;\n}\n\n/*--------------------------------------------------------------------------*/\n\nfunction readContinuationByte() {\n\tif (byteIndex >= byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\tif ((continuationByte & 0xC0) == 0x80) {\n\t\treturn continuationByte & 0x3F;\n\t}\n\n\t// If we end up here, it’s not a continuation byte\n\tthrow Error('Invalid continuation byte');\n}\n\nfunction decodeSymbol(strict) {\n\tvar byte1;\n\tvar byte2;\n\tvar byte3;\n\tvar byte4;\n\tvar codePoint;\n\n\tif (byteIndex > byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tif (byteIndex == byteCount) {\n\t\treturn false;\n\t}\n\n\t// Read first byte\n\tbyte1 = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\t// 1-byte sequence (no continuation bytes)\n\tif ((byte1 & 0x80) == 0) {\n\t\treturn byte1;\n\t}\n\n\t// 2-byte sequence\n\tif ((byte1 & 0xE0) == 0xC0) {\n\t\tbyte2 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\tif (codePoint >= 0x80) {\n\t\t\treturn codePoint;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 3-byte sequence (may include unpaired surrogates)\n\tif ((byte1 & 0xF0) == 0xE0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\tif (codePoint >= 0x0800) {\n\t\t\treturn checkScalarValue(codePoint, strict) ? codePoint : 0xFFFD;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 4-byte sequence\n\tif ((byte1 & 0xF8) == 0xF0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tbyte4 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0C) |\n\t\t\t(byte3 << 0x06) | byte4;\n\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\treturn codePoint;\n\t\t}\n\t}\n\n\tthrow Error('Invalid UTF-8 detected');\n}\n\nvar byteArray;\nvar byteCount;\nvar byteIndex;\nfunction utf8decode(byteString, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tbyteArray = ucs2decode(byteString);\n\tbyteCount = byteArray.length;\n\tbyteIndex = 0;\n\tvar codePoints = [];\n\tvar tmp;\n\twhile ((tmp = decodeSymbol(strict)) !== false) {\n\t\tcodePoints.push(tmp);\n\t}\n\treturn ucs2encode(codePoints);\n}\n\nmodule.exports = {\n\tversion: '2.1.2',\n\tencode: utf8encode,\n\tdecode: utf8decode\n};\n","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(chars){\n  \"use strict\";\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = chars.indexOf(base64[i]);\n      encoded2 = chars.indexOf(base64[i+1]);\n      encoded3 = chars.indexOf(base64[i+2]);\n      encoded4 = chars.indexOf(base64[i+3]);\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\");\n","/**\r\n * Create a blob builder even when vendor prefixes exist\r\n */\r\n\r\nvar BlobBuilder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\r\n  typeof WebKitBlobBuilder !== 'undefined' ? WebKitBlobBuilder :\r\n  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\r\n  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : \r\n  false;\r\n\r\n/**\r\n * Check if Blob constructor is supported\r\n */\r\n\r\nvar blobSupported = (function() {\r\n  try {\r\n    var a = new Blob(['hi']);\r\n    return a.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if Blob constructor supports ArrayBufferViews\r\n * Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n */\r\n\r\nvar blobSupportsArrayBufferView = blobSupported && (function() {\r\n  try {\r\n    var b = new Blob([new Uint8Array([1,2])]);\r\n    return b.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if BlobBuilder is supported\r\n */\r\n\r\nvar blobBuilderSupported = BlobBuilder\r\n  && BlobBuilder.prototype.append\r\n  && BlobBuilder.prototype.getBlob;\r\n\r\n/**\r\n * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n * Used by BlobBuilder constructor and old browsers that didn't\r\n * support it in the Blob constructor.\r\n */\r\n\r\nfunction mapArrayBufferViews(ary) {\r\n  return ary.map(function(chunk) {\r\n    if (chunk.buffer instanceof ArrayBuffer) {\r\n      var buf = chunk.buffer;\r\n\r\n      // if this is a subarray, make a copy so we only\r\n      // include the subarray region from the underlying buffer\r\n      if (chunk.byteLength !== buf.byteLength) {\r\n        var copy = new Uint8Array(chunk.byteLength);\r\n        copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\r\n        buf = copy.buffer;\r\n      }\r\n\r\n      return buf;\r\n    }\r\n\r\n    return chunk;\r\n  });\r\n}\r\n\r\nfunction BlobBuilderConstructor(ary, options) {\r\n  options = options || {};\r\n\r\n  var bb = new BlobBuilder();\r\n  mapArrayBufferViews(ary).forEach(function(part) {\r\n    bb.append(part);\r\n  });\r\n\r\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\r\n};\r\n\r\nfunction BlobConstructor(ary, options) {\r\n  return new Blob(mapArrayBufferViews(ary), options || {});\r\n};\r\n\r\nif (typeof Blob !== 'undefined') {\r\n  BlobBuilderConstructor.prototype = Blob.prototype;\r\n  BlobConstructor.prototype = Blob.prototype;\r\n}\r\n\r\nmodule.exports = (function() {\r\n  if (blobSupported) {\r\n    return blobSupportsArrayBufferView ? Blob : BlobConstructor;\r\n  } else if (blobBuilderSupported) {\r\n    return BlobBuilderConstructor;\r\n  } else {\r\n    return undefined;\r\n  }\r\n})();\r\n","/**\n * Module requirements.\n */\n\nvar Polling = require('./polling');\nvar inherit = require('component-inherit');\nvar globalThis = require('../globalThis');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    callbacks = globalThis.___eio = (globalThis.___eio || []);\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (typeof addEventListener === 'function') {\n    addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n  this.script = script;\n\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parser = require('engine.io-parser');\nvar parseqs = require('parseqs');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:websocket');\n\nvar BrowserWebSocket, NodeWebSocket;\n\nif (typeof WebSocket !== 'undefined') {\n  BrowserWebSocket = WebSocket;\n} else if (typeof self !== 'undefined') {\n  BrowserWebSocket = self.WebSocket || self.MozWebSocket;\n}\n\nif (typeof window === 'undefined') {\n  try {\n    NodeWebSocket = require('ws');\n  } catch (e) { }\n}\n\n/**\n * Get either the `WebSocket` or `MozWebSocket` globals\n * in the browser or try to resolve WebSocket-compatible\n * interface exposed by `ws` for Node-like environment.\n */\n\nvar WebSocketImpl = BrowserWebSocket || NodeWebSocket;\n\n/**\n * Module exports.\n */\n\nmodule.exports = WS;\n\n/**\n * WebSocket transport constructor.\n *\n * @api {Object} connection options\n * @api public\n */\n\nfunction WS (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (forceBase64) {\n    this.supportsBinary = false;\n  }\n  this.perMessageDeflate = opts.perMessageDeflate;\n  this.usingBrowserWebSocket = BrowserWebSocket && !opts.forceNode;\n  this.protocols = opts.protocols;\n  if (!this.usingBrowserWebSocket) {\n    WebSocketImpl = NodeWebSocket;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(WS, Transport);\n\n/**\n * Transport name.\n *\n * @api public\n */\n\nWS.prototype.name = 'websocket';\n\n/*\n * WebSockets support binary\n */\n\nWS.prototype.supportsBinary = true;\n\n/**\n * Opens socket.\n *\n * @api private\n */\n\nWS.prototype.doOpen = function () {\n  if (!this.check()) {\n    // let probe timeout\n    return;\n  }\n\n  var uri = this.uri();\n  var protocols = this.protocols;\n\n  var opts = {};\n\n  if (!this.isReactNative) {\n    opts.agent = this.agent;\n    opts.perMessageDeflate = this.perMessageDeflate;\n\n    // SSL options for Node.js client\n    opts.pfx = this.pfx;\n    opts.key = this.key;\n    opts.passphrase = this.passphrase;\n    opts.cert = this.cert;\n    opts.ca = this.ca;\n    opts.ciphers = this.ciphers;\n    opts.rejectUnauthorized = this.rejectUnauthorized;\n  }\n\n  if (this.extraHeaders) {\n    opts.headers = this.extraHeaders;\n  }\n  if (this.localAddress) {\n    opts.localAddress = this.localAddress;\n  }\n\n  try {\n    this.ws =\n      this.usingBrowserWebSocket && !this.isReactNative\n        ? protocols\n          ? new WebSocketImpl(uri, protocols)\n          : new WebSocketImpl(uri)\n        : new WebSocketImpl(uri, protocols, opts);\n  } catch (err) {\n    return this.emit('error', err);\n  }\n\n  if (this.ws.binaryType === undefined) {\n    this.supportsBinary = false;\n  }\n\n  if (this.ws.supports && this.ws.supports.binary) {\n    this.supportsBinary = true;\n    this.ws.binaryType = 'nodebuffer';\n  } else {\n    this.ws.binaryType = 'arraybuffer';\n  }\n\n  this.addEventListeners();\n};\n\n/**\n * Adds event listeners to the socket\n *\n * @api private\n */\n\nWS.prototype.addEventListeners = function () {\n  var self = this;\n\n  this.ws.onopen = function () {\n    self.onOpen();\n  };\n  this.ws.onclose = function () {\n    self.onClose();\n  };\n  this.ws.onmessage = function (ev) {\n    self.onData(ev.data);\n  };\n  this.ws.onerror = function (e) {\n    self.onError('websocket error', e);\n  };\n};\n\n/**\n * Writes data to socket.\n *\n * @param {Array} array of packets.\n * @api private\n */\n\nWS.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n\n  // encodePacket efficient as it uses WS framing\n  // no need for encodePayload\n  var total = packets.length;\n  for (var i = 0, l = total; i < l; i++) {\n    (function (packet) {\n      parser.encodePacket(packet, self.supportsBinary, function (data) {\n        if (!self.usingBrowserWebSocket) {\n          // always create a new object (GH-437)\n          var opts = {};\n          if (packet.options) {\n            opts.compress = packet.options.compress;\n          }\n\n          if (self.perMessageDeflate) {\n            var len = 'string' === typeof data ? Buffer.byteLength(data) : data.length;\n            if (len < self.perMessageDeflate.threshold) {\n              opts.compress = false;\n            }\n          }\n        }\n\n        // Sometimes the websocket has already been closed but the browser didn't\n        // have a chance of informing us about it yet, in that case send will\n        // throw an error\n        try {\n          if (self.usingBrowserWebSocket) {\n            // TypeError is thrown when passing the second argument on Safari\n            self.ws.send(data);\n          } else {\n            self.ws.send(data, opts);\n          }\n        } catch (e) {\n          debug('websocket closed before onclose event');\n        }\n\n        --total || done();\n      });\n    })(packets[i]);\n  }\n\n  function done () {\n    self.emit('flush');\n\n    // fake drain\n    // defer to next tick to allow Socket to clear writeBuffer\n    setTimeout(function () {\n      self.writable = true;\n      self.emit('drain');\n    }, 0);\n  }\n};\n\n/**\n * Called upon close\n *\n * @api private\n */\n\nWS.prototype.onClose = function () {\n  Transport.prototype.onClose.call(this);\n};\n\n/**\n * Closes socket.\n *\n * @api private\n */\n\nWS.prototype.doClose = function () {\n  if (typeof this.ws !== 'undefined') {\n    this.ws.close();\n  }\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nWS.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'wss' : 'ws';\n  var port = '';\n\n  // avoid port if default for schema\n  if (this.port && (('wss' === schema && Number(this.port) !== 443) ||\n    ('ws' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // append timestamp to URI\n  if (this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  // communicate binary support capabilities\n  if (!this.supportsBinary) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n\n/**\n * Feature detection for WebSocket.\n *\n * @return {Boolean} whether this transport is available.\n * @api public\n */\n\nWS.prototype.check = function () {\n  return !!WebSocketImpl && !('__initialize' in WebSocketImpl && this.name === WS.prototype.name);\n};\n","module.exports = toArray\n\nfunction toArray(list, index) {\n    var array = []\n\n    index = index || 0\n\n    for (var i = index || 0; i < list.length; i++) {\n        array[i - index] = list[i]\n    }\n\n    return array\n}\n","\n/**\n * Expose `Backoff`.\n */\n\nmodule.exports = Backoff;\n\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction Backoff(opts) {\n  opts = opts || {};\n  this.ms = opts.min || 100;\n  this.max = opts.max || 10000;\n  this.factor = opts.factor || 2;\n  this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n  this.attempts = 0;\n}\n\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\n\nBackoff.prototype.duration = function(){\n  var ms = this.ms * Math.pow(this.factor, this.attempts++);\n  if (this.jitter) {\n    var rand =  Math.random();\n    var deviation = Math.floor(rand * this.jitter * ms);\n    ms = (Math.floor(rand * 10) & 1) == 0  ? ms - deviation : ms + deviation;\n  }\n  return Math.min(ms, this.max) | 0;\n};\n\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\n\nBackoff.prototype.reset = function(){\n  this.attempts = 0;\n};\n\n/**\n * Set the minimum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMin = function(min){\n  this.ms = min;\n};\n\n/**\n * Set the maximum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMax = function(max){\n  this.max = max;\n};\n\n/**\n * Set the jitter\n *\n * @api public\n */\n\nBackoff.prototype.setJitter = function(jitter){\n  this.jitter = jitter;\n};\n\n","import assign from 'object-assign';\n\nimport { store } from './helpers';\n\nexport const MENU_SHOW = 'REACT_CONTEXTMENU_SHOW';\nexport const MENU_HIDE = 'REACT_CONTEXTMENU_HIDE';\n\n\nexport function dispatchGlobalEvent(eventName, opts, target = window) {\n  // Compatibale with IE\n  // @see http://stackoverflow.com/questions/26596123/internet-explorer-9-10-11-event-constructor-doesnt-work\n  let event;\n\n  if (typeof window.CustomEvent === 'function') {\n    event = new window.CustomEvent(eventName, { detail: opts });\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, false, true, opts);\n  }\n\n  if (target) {\n    target.dispatchEvent(event);\n    assign(store, opts);\n  }\n}\n\nexport function showMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_SHOW, assign({}, opts, { type: MENU_SHOW }), target);\n}\n\nexport function hideMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_HIDE, assign({}, opts, { type: MENU_HIDE }), target);\n}\n","export function callIfExists(func, ...args) {\n  return (typeof func === 'function') && func(...args);\n}\n\nexport function hasOwnProp(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function uniqueId() {\n  return Math.random().toString(36).substring(7);\n}\n\nexport const store = {};\n\nexport const canUseDOM = Boolean(\n  typeof window !== 'undefined' && window.document && window.document.createElement\n);\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n"],"sourceRoot":""}