(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[15],{1729:function(e,t,a){a(74),e.exports=a(1759)},1730:function(e,t,a){},1759:function(e,t,a){"use strict";a.r(t);var i=a(3),r=a(5),s=a(7),n=a(6),c=a(2),o=a.n(c),l=a(31),b=a.n(l),d=a(21),h=a(12),m=a.n(h),j=a(4),u=a(1),g=a(8),p=a(19),O=a(48),f=a(23),x=a(70),D=a(374),v=a(120),P=a(105),w=a(106),C=a(142),L=a(297),M=a(10),y=a(0),N=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).handleInputChange=function(e){r.setState({inputValue:e})},r.formSubmit=function(){var e=r.state.inputValue.map((function(e,t){return e.value})).join(","),t=r.props,a=t.repoID,i=t.commitID;r.setState({submitBtnDisabled:!0}),g.a.updateRepoCommitLabels(a,i,e).then((function(e){r.props.updateCommitLabels(e.data.revisionTags.map((function(e,t){return e.tag}))),r.props.toggleDialog(),M.a.success(Object(u.rb)("Successfully edited labels."))})).catch((function(e){var t=j.a.getErrorMsg(e);r.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},r.state={inputValue:r.props.commitLabels.map((function(e,t){return{label:e,value:e}})),submitBtnDisabled:!1},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.state.formErrorMsg;return Object(y.jsxs)(v.a,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[Object(y.jsx)(P.a,{toggle:this.props.toggleDialog,children:Object(u.rb)("Edit labels")}),Object(y.jsx)(w.a,{children:Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(L.a,{defaultValue:this.props.commitLabels.map((function(e,t){return{label:e,value:e}})),isMulti:!0,onChange:this.handleInputChange,placeholder:""}),e&&Object(y.jsx)("p",{className:"error m-0 mt-2",children:e})]})}),Object(y.jsx)(C.a,{children:Object(y.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:Object(u.rb)("Submit")})})]})}}]),a}(o.a.Component),S=(a(151),a(169),a(1730),window.app.pageOptions),k=S.repoID,I=S.repoName,_=S.userPerm,B=S.showLabel,E=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).getItems=function(e){g.a.getRepoHistory(k,e,r.state.perPage).then((function(t){r.setState({isLoading:!1,currentPage:e,items:t.data.data,hasNextPage:t.data.more})})).catch((function(e){r.setState({isLoading:!1,errorMsg:j.a.getErrorMsg(e,!0)})}))},r.resetPerPage=function(e){r.setState({perPage:e},(function(){r.getItems(1)}))},r.onSearchedClick=function(e){if(!0===e.is_dir){var t=u.rc+"library/"+e.repo_id+"/"+e.repo_name+e.path;Object(d.c)(t,{repalce:!0})}else{var a=u.rc+"lib/"+e.repo_id+"/file"+j.a.encodePath(e.path);window.open("about:blank").location.href=a}},r.goBack=function(e){e.preventDefault(),window.history.back()},r.state={isLoading:!0,errorMsg:"",currentPage:1,perPage:25,hasNextPage:!1,items:[]},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,a=this.state,i=a.currentPage,r=a.perPage;this.setState({perPage:parseInt(t.get("per_page")||r),currentPage:parseInt(t.get("page")||i)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){return Object(y.jsx)(o.a.Fragment,{children:Object(y.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(y.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(y.jsx)("a",{href:u.rc,children:Object(y.jsx)("img",{src:u.Pb+u.Kb,height:u.Jb,width:u.Lb,title:u.sc,alt:"logo"})}),Object(y.jsx)(x.a,{onSearchedClick:this.onSearchedClick})]}),Object(y.jsx)("div",{className:"flex-auto container-fluid pt-4 pb-6 o-auto",children:Object(y.jsx)("div",{className:"row",children:Object(y.jsxs)("div",{className:"col-md-10 offset-md-1",children:[Object(y.jsx)("h2",{children:j.a.generateDialogTitle(Object(u.rb)("{placeholder} Modification History"),I)}),Object(y.jsx)("a",{href:"#",className:"go-back",title:Object(u.rb)("Back"),onClick:this.goBack,role:"button","aria-label":Object(u.rb)("Back"),children:Object(y.jsx)("span",{className:"fas fa-chevron-left"})}),"rw"==_&&Object(y.jsx)("p",{className:"tip",children:Object(u.rb)("Tip: a snapshot will be generated after modification, which records the library state after the modification.")}),Object(y.jsx)(F,{isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItems})]})})})]})})}}]),a}(o.a.Component),F=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).getPreviousPage=function(){r.props.getListByPage(r.props.currentPage-1)},r.getNextPage=function(){r.props.getListByPage(r.props.currentPage+1)},r.theadData=B?[{width:"43%",text:Object(u.rb)("Description")},{width:"12%",text:Object(u.rb)("Time")},{width:"9%",text:Object(u.rb)("Modifier")},{width:"12%",text:"".concat(Object(u.rb)("Device")," / ").concat(Object(u.rb)("Version"))},{width:"12%",text:Object(u.rb)("Labels")},{width:"12%",text:""}]:[{width:"43%",text:Object(u.rb)("Description")},{width:"15%",text:Object(u.rb)("Time")},{width:"15%",text:Object(u.rb)("Modifier")},{width:"15%",text:"".concat(Object(u.rb)("Device")," / ").concat(Object(u.rb)("Version"))},{width:"12%",text:""}],r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.errorMsg,i=e.items,r=e.curPerPage,s=e.currentPage,n=e.hasNextPage;return t?Object(y.jsx)(p.a,{}):a?Object(y.jsx)("p",{className:"error mt-6 text-center",children:a}):Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsxs)("table",{className:"table-hover",children:[Object(y.jsx)("thead",{children:Object(y.jsx)("tr",{children:this.theadData.map((function(e,t){return Object(y.jsx)("th",{width:e.width,children:e.text},t)}))})}),Object(y.jsx)("tbody",{children:i.map((function(e,t){return e.isFirstCommit=1==s&&0==t,e.showDetails=n||t!=i.length-1,Object(y.jsx)(T,{item:e},t)}))})]}),Object(y.jsx)(O.a,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:n,curPerPage:r,resetPerPage:this.props.resetPerPage})]})}}]),a}(o.a.Component),T=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).handleMouseOver=function(){r.setState({isIconShown:!0})},r.handleMouseOut=function(){r.setState({isIconShown:!1})},r.showCommitDetails=function(e){e.preventDefault(),r.setState({isCommitDetailsDialogOpen:!r.state.isCommitDetailsDialogOpen})},r.toggleCommitDetailsDialog=function(){r.setState({isCommitDetailsDialogOpen:!r.state.isCommitDetailsDialogOpen})},r.editLabel=function(e){e.preventDefault(),r.setState({isCommitLabelUpdateDialogOpen:!r.state.isCommitLabelUpdateDialogOpen})},r.toggleLabelEditDialog=function(){r.setState({isCommitLabelUpdateDialogOpen:!r.state.isCommitLabelUpdateDialogOpen})},r.updateLabels=function(e){r.setState({labels:e})},r.state={labels:r.props.item.tags,isIconShown:!1,isCommitLabelUpdateDialogOpen:!1,isCommitDetailsDialogOpen:!1},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.item,t=this.state,a=t.isIconShown,i=t.isCommitLabelUpdateDialogOpen,r=t.isCommitDetailsDialogOpen,s=t.labels,n="";return n=e.email?e.second_parent_id?Object(u.rb)("None"):Object(y.jsx)("a",{href:"".concat(u.rc,"profile/").concat(encodeURIComponent(e.email),"/"),children:e.name}):Object(u.rb)("Unknown"),Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(y.jsxs)("td",{children:[e.description,e.showDetails&&Object(y.jsx)("a",{href:"#",className:"details",onClick:this.showCommitDetails,role:"button",children:Object(u.rb)("Details")})]}),Object(y.jsx)("td",{title:m()(e.time).format("LLLL"),children:m()(e.time).format("YYYY-MM-DD")}),Object(y.jsx)("td",{children:n}),Object(y.jsx)("td",{children:e.client_version?"".concat(e.device_name," / ").concat(e.client_version):"API / --"}),B&&Object(y.jsxs)("td",{children:[s.map((function(e,t){return Object(y.jsx)("span",{className:"commit-label",children:e},t)})),"rw"==_&&Object(y.jsx)("a",{href:"#",role:"button",className:"attr-action-icon fa fa-pencil-alt ".concat(a?"":"invisible"),title:Object(u.rb)("Edit"),"aria-label":Object(u.rb)("Edit"),onClick:this.editLabel})]}),Object(y.jsx)("td",{children:"rw"==_&&(e.isFirstCommit?Object(y.jsx)("span",{className:a?"":"invisible",children:Object(u.rb)("Current Version")}):Object(y.jsx)("a",{href:"".concat(u.rc,"repo/").concat(k,"/snapshot/?commit_id=").concat(e.commit_id),className:a?"":"invisible",children:Object(u.rb)("View Snapshot")}))})]}),r&&Object(y.jsx)(f.a,{children:Object(y.jsx)(D.a,{repoID:k,commitID:e.commit_id,commitTime:e.time,toggleDialog:this.toggleCommitDetailsDialog})}),i&&Object(y.jsx)(f.a,{children:Object(y.jsx)(N,{repoID:k,commitID:e.commit_id,commitLabels:s,updateCommitLabels:this.updateLabels,toggleDialog:this.toggleLabelEditDialog})})]})}}]),a}(o.a.Component);b.a.render(Object(y.jsx)(E,{}),document.getElementById("wrapper"))},374:function(e,t,a){"use strict";var i=a(3),r=a(5),s=a(7),n=a(6),c=a(2),o=a.n(c),l=a(120),b=a(105),d=a(106),h=a(12),m=a.n(h),j=a(1),u=a(8),g=a(4),p=a(19),O=(a(550),a(0)),f=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).state={isLoading:!0,errorMsg:""},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.repoID,i=t.commitID;u.a.getCommitDetails(a,i).then((function(t){e.setState({isLoading:!1,errorMsg:"",commitDetails:t.data})})).catch((function(t){var a=g.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:a})}))}},{key:"render",value:function(){var e=this.props,t=e.toggleDialog;e.commitTime;return Object(O.jsxs)(l.a,{isOpen:!0,centered:!0,toggle:t,children:[Object(O.jsx)(b.a,{toggle:t,children:Object(j.rb)("Modification Details")}),Object(O.jsxs)(d.a,{children:[Object(O.jsx)("p",{className:"small",children:m()(this.props.commitTime).format("YYYY-MM-DD HH:mm:ss")}),Object(O.jsx)(x,{data:this.state})]})]})}}]),a}(o.a.Component),x=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))).renderDetails=function(e){for(var t=[{type:"new",title:Object(j.rb)("New files")},{type:"removed",title:Object(j.rb)("Deleted files")},{type:"renamed",title:Object(j.rb)("Renamed or Moved files")},{type:"modified",title:Object(j.rb)("Modified files")},{type:"newdir",title:Object(j.rb)("New directories")},{type:"deldir",title:Object(j.rb)("Deleted directories")}],a=!0,i=0,r=t.length;i<r;i++)if(e[t[i].type].length){a=!1;break}return a?Object(O.jsx)("p",{children:e.cmt_desc}):Object(O.jsx)(o.a.Fragment,{children:t.map((function(t,a){if(e[t.type].length)return Object(O.jsxs)(o.a.Fragment,{children:[Object(O.jsx)("h6",{children:t.title}),Object(O.jsx)("ul",{children:e[t.type].map((function(e,t){return Object(O.jsx)("li",{dangerouslySetInnerHTML:{__html:e},className:"commit-detail-item"},t)}))})]},a)}))})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,a=e.errorMsg,i=e.commitDetails;return t?Object(O.jsx)(p.a,{}):a?Object(O.jsx)("p",{className:"error mt-4 text-center",children:a}):this.renderDetails(i)}}]),a}(o.a.Component);t.a=f},550:function(e,t,a){}},[[1729,1,0]]]);
//# sourceMappingURL=repoHistory.chunk.js.map