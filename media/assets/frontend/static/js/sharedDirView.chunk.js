(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[17],{149:function(e,t,i){"use strict";var a,n=i(6),o=i(7),s=i(9),r=i(8),l=i(2),c=i.n(l),d=i(4),h=i(1),u=i(10),p=i(5),m=i(16),b=i(0),f=function(e){Object(s.a)(i,e);var t=Object(r.a)(i);function i(e){var o;return Object(n.a)(this,i),(o=t.call(this,e)).queryZipProgress=function(){var e=o.state.zipToken;u.a.queryZipProgress(e).then((function(t){var i=t.data;1==i.failed?(clearInterval(a),o.setState({isLoading:!1,errorMsg:i.failed_reason})):(o.setState({zipProgress:0==i.total?"100%":(i.zipped/i.total*100).toFixed(2)+"%"}),i.total==i.zipped&&(clearInterval(a),o.props.toggleDialog(),location.href="".concat(h.ob,"zip/").concat(e)))})).catch((function(e){clearInterval(a);var t=p.a.getErrorMsg(e);o.setState({isLoading:!1,errorMsg:t})}))},o.cancelZipTask=function(){var e=o.state.zipToken;u.a.cancelZipTask(e).then((function(e){})).catch((function(e){}))},o.toggleDialog=function(){var e=o.state.zipProgress;e&&"100%"!=e&&(clearInterval(a),o.cancelZipTask()),o.props.toggleDialog()},o.state={isLoading:!0,errorMsg:"",zipProgress:null},o}return Object(o.a)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props,i=t.token,n=t.path,o=t.repoID,s=t.target;(i?s.length?u.a.getShareLinkDirentsZipTask(i,n,s):u.a.getShareLinkZipTask(i,n):u.a.zipDownload(o,n,s)).then((function(t){var i=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:i}),e.queryZipProgress(),a=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var i=p.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:i})}))}},{key:"render",value:function(){return Object(b.jsxs)(d.x,{isOpen:!0,toggle:this.toggleDialog,children:[Object(b.jsx)(d.A,{toggle:this.toggleDialog,children:Object(h.qb)("Download")}),Object(b.jsx)(d.y,{children:Object(b.jsx)(g,{data:this.state})})]})}}]),i}(c.a.Component),g=function(e){Object(s.a)(i,e);var t=Object(r.a)(i);function i(){return Object(n.a)(this,i),t.apply(this,arguments)}return Object(o.a)(i,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,i=e.errorMsg,a=e.zipProgress;return t?Object(b.jsx)(m.a,{}):i?Object(b.jsx)("p",{className:"error mt-4 text-center",children:i}):Object(b.jsx)("p",{className:"mt-4 text-center",children:"".concat(Object(h.qb)("Packaging...")," ").concat(a)})}}]),i}(c.a.Component);t.a=f},1516:function(e,t,i){i(55),e.exports=i(1701)},1517:function(e,t,i){},1701:function(e,t,i){"use strict";i.r(t);var a=i(120),n=i.n(a),o=i(173),s=i(6),r=i(7),l=i(27),c=i(9),d=i(8),h=i(2),u=i.n(h),p=i(24),m=i.n(p),b=i(4),f=i(13),g=i.n(f),v=i(68),j=i(1),O=i(5),y=i(10),x=i(16),S=i(11),k=i(20),w=i(149),C=i(171),I=i(72),M=i(254),P=i.n(M),D=i(157),_=i.n(D),F=i(0),N="uploading",L="error",E="isSaving",T="uploaded",U=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).onUploadCancel=function(e){e.preventDefault(),a.props.onUploadCancel(a.props.resumableFile)},a.onUploadRetry=function(e){e.preventDefault(),a.props.onUploadRetry(a.props.resumableFile)},a.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},a.state={uploadState:N},a}return Object(r.a)(i,[{key:"componentWillReceiveProps",value:function(e){var t=e.resumableFile,i=N;t.error?i=L:(0!==t.remainingTime||t.isSaved||(i=E),t.isSaved&&(i=T)),this.setState({uploadState:i})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),i=e.error,a=e.newFileName,n=this.formatFileSize(e.size);return Object(F.jsxs)("tr",{className:"file-upload-item",children:[Object(F.jsx)("td",{className:"upload-name",children:Object(F.jsx)("div",{className:"ellipsis",title:a,children:a})}),Object(F.jsx)("td",{className:"ellipsis",children:Object(F.jsx)("span",{className:"file-size",title:n,children:n})}),Object(F.jsxs)("td",{className:"upload-progress ellipsis",children:[(this.state.uploadState===N||this.state.uploadState===E)&&Object(F.jsxs)(h.Fragment,{children:[e.size>=1e8&&Object(F.jsxs)(h.Fragment,{children:[e.isUploading()&&Object(F.jsxs)("div",{className:"progress-container",children:[Object(F.jsx)("div",{className:"progress",children:Object(F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&Object(F.jsx)("div",{className:"progress-text",children:Object(j.qb)("Preparing to upload...")}),e.remainingTime>0&&Object(F.jsxs)("div",{className:"progress-text",children:[Object(j.qb)("Remaining")," ",O.a.formatTime(e.remainingTime)]}),0===e.remainingTime&&Object(F.jsx)("div",{className:"progress-text",children:Object(j.qb)("Indexing...")})]}),!e.isUploading()&&Object(F.jsx)("div",{className:"progress-container d-flex align-items-center",children:Object(F.jsx)("div",{className:"progress",children:Object(F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&Object(F.jsx)("div",{className:"progress-container d-flex align-items-center",children:Object(F.jsx)("div",{className:"progress",children:Object(F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),this.state.uploadState===L&&Object(F.jsx)("div",{className:"message err-message ml-0",dangerouslySetInnerHTML:{__html:i}})]}),Object(F.jsx)("td",{className:"upload-operation ellipsis",children:Object(F.jsxs)(h.Fragment,{children:[this.state.uploadState===N&&Object(F.jsx)("a",{href:"#",onClick:this.onUploadCancel,children:Object(j.qb)("Cancel")}),this.state.uploadState===L&&Object(F.jsx)("a",{href:"#",onClick:this.onUploadRetry,children:Object(j.qb)("Retry")}),this.state.uploadState===E&&Object(F.jsx)("span",{className:"saving",children:Object(j.qb)("Saving...")}),this.state.uploadState===T&&Object(F.jsx)("span",{className:"uploaded",children:Object(j.qb)("Uploaded")})]})})]})}}]),i}(u.a.Component),q=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(s.a)(this,i),t.apply(this,arguments)}return Object(r.a)(i,[{key:"render",value:function(){var e=this.props.file,t=Object(j.qb)("Please upload files less than {placeholder}M").replace("{placeholder}",j.Nb);return Object(F.jsxs)("tr",{className:"file-upload-item",children:[Object(F.jsx)("td",{className:"upload-name",children:Object(F.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),Object(F.jsx)("td",{colSpan:3,className:"error",children:t})]})}}]),i}(u.a.Component),z=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).onCancelAllUploading=function(){a.props.onCancelAllUploading()},a.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({isMinimized:!a.state.isMinimized})},a.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),a.props.onCloseUploadDialog()},a.state={isMinimized:!1},a}return Object(r.a)(i,[{key:"render",value:function(){var e=this,t=O.a.formatBitRate(this.props.uploadBitrate),i=Object(j.qb)("File Upload"),a=Object(j.qb)("File Uploading...")+" "+this.props.totalProgress+"% ("+t+")",n=Object(F.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),o=Object(F.jsxs)(h.Fragment,{children:[Object(F.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),Object(F.jsx)("span",{className:"sf2-icon-x1",onClick:this.onCloseUpload})]}),s=this.props,r=s.totalProgress,l=s.allFilesUploaded,c=s.retryFileList;return Object(F.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?"2.25rem":"20rem"},children:[Object(F.jsxs)("div",{className:"uploader-list-header",children:[Object(F.jsx)("div",{className:"title",children:100===r?i:a}),Object(F.jsx)("div",{className:"uploader-options",children:100===r||l?o:n})]}),Object(F.jsxs)("div",{className:"uploader-list-content",children:[Object(F.jsxs)("div",{className:"text-right mt-2",children:[c.length>0?Object(F.jsx)("span",{className:"cursor-pointer",onClick:this.props.onUploadRetryAll,children:Object(j.qb)("Retry All")}):Object(F.jsx)("span",{className:"cursor-pointer disabled-link",children:Object(j.qb)("Retry All")}),l?Object(F.jsx)("span",{className:"cursor-pointer ml-3 disabled-link",children:Object(j.qb)("Cancel All")}):Object(F.jsx)("span",{className:"cursor-pointer ml-3",onClick:this.onCancelAllUploading,children:Object(j.qb)("Cancel All")})]}),Object(F.jsxs)("table",{className:"table-thead-hidden",children:[Object(F.jsx)("thead",{children:Object(F.jsxs)("tr",{children:[Object(F.jsx)("th",{width:"30%",children:Object(j.qb)("name")}),Object(F.jsx)("th",{width:"20%",children:Object(j.qb)("size")}),Object(F.jsx)("th",{width:"30%",children:Object(j.qb)("progress")}),Object(F.jsx)("th",{width:"20%",children:Object(j.qb)("state")})]})}),Object(F.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return Object(F.jsx)(q,{file:e},t)})),this.props.uploadFileList.map((function(t,i){return Object(F.jsx)(U,{resumableFile:t,onUploadCancel:e.props.onUploadCancel,onUploadRetry:e.props.onUploadRetry},i)}))]})]})]})]})}}]),i}(u.a.Component),A=(i(505),function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).componentWillUnmount=function(){window.onbeforeunload=null,!0===a.props.dragAndDrop&&a.resumable.disableDropOnDocument()},a.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},a.bindCallbackHandler=function(){var e=a.props,t=e.minFileSizeErrorCallback,i=e.fileTypeErrorCallback;a.maxFilesErrorCallback&&(a.resumable.opts.maxFilesErrorCallback=a.maxFilesErrorCallback),t&&(a.resumable.opts.minFileSizeErrorCallback=a.props.minFileSizeErrorCallback),a.maxFileSizeErrorCallback&&(a.resumable.opts.maxFileSizeErrorCallback=a.maxFileSizeErrorCallback),i&&(a.resumable.opts.fileTypeErrorCallback=a.props.fileTypeErrorCallback)},a.bindEventHandler=function(){a.resumable.on("chunkingComplete",a.onChunkingComplete.bind(Object(l.a)(a))),a.resumable.on("fileAdded",a.onFileAdded.bind(Object(l.a)(a))),a.resumable.on("filesAddedComplete",a.filesAddedComplete.bind(Object(l.a)(a))),a.resumable.on("fileProgress",a.onFileProgress.bind(Object(l.a)(a))),a.resumable.on("fileSuccess",a.onFileUploadSuccess.bind(Object(l.a)(a))),a.resumable.on("progress",a.onProgress.bind(Object(l.a)(a))),a.resumable.on("complete",a.onComplete.bind(Object(l.a)(a))),a.resumable.on("pause",a.onPause.bind(Object(l.a)(a))),a.resumable.on("fileRetry",a.onFileRetry.bind(Object(l.a)(a))),a.resumable.on("fileError",a.onFileError.bind(Object(l.a)(a))),a.resumable.on("error",a.onError.bind(Object(l.a)(a))),a.resumable.on("beforeCancel",a.onBeforeCancel.bind(Object(l.a)(a))),a.resumable.on("cancel",a.onCancel.bind(Object(l.a)(a))),a.resumable.on("dragstart",a.onDragStart.bind(Object(l.a)(a)))},a.maxFilesErrorCallback=function(e,t){var i=j.Mb,a=Object(j.qb)("Please upload no more than {maxFiles} files at a time.");a=a.replace("{maxFiles}",i),S.a.danger(a)},a.maxFileSizeErrorCallback=function(e){var t=a.state.forbidUploadFileList;t.push(e),a.setState({forbidUploadFileList:t})},a.onChunkingComplete=function(e){!0===a.state.allFilesUploaded&&a.setState({allFilesUploaded:!1});var t="/"===a.props.path?"/":a.props.path+"/",i=e.fileName,n=e.relativePath,o=i===n;if(e.formData={},o)e.formData={parent_dir:t};else{var s=n.slice(0,n.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:s}}},a.onFileAdded=function(e,t){if(e.fileName===e.relativePath&&1===t.length){a.setUploadFileList(a.resumable.files);var i=a.props,n=i.token,o=i.relativePath;y.a.sharedLinkGetFileUploadUrl(n,o).then((function(t){a.resumable.opts.target=t.data.upload_link+"?ret-json=1",a.resumableUpload(e)})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))}else if(a.setUploadFileList(a.resumable.files),!a.isUploadLinkLoaded){a.isUploadLinkLoaded=!0;var s=a.props,r=s.token,l=s.relativePath;y.a.sharedLinkGetFileUploadUrl(r,l).then((function(e){a.resumable.opts.target=e.data.upload_link+"?ret-json=1",a.resumable.upload()})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))}},a.resumableUpload=function(e){var t=a.props,i=t.repoID,n=t.path;y.a.getFileUploadedBytes(i,n,e.fileName).then((function(t){var i=t.data.uploadedBytes,n=1024*parseInt(j.cc)*1024||1048576,o=Math.floor(i/n);e.markChunksCompleted(o),a.resumable.upload()})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},a.filesAddedComplete=function(e,t){a.state.forbidUploadFileList.length>0&&0===t.length&&a.setState({isUploadProgressDialogShow:!0,totalProgress:100})},a.setUploadFileList=function(){var e=a.resumable.files;a.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),O.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},a.onFileProgress=function(e){var t=a.getBitrate(),i=a.state.uploadFileList.map((function(i){if(i.uniqueIdentifier===e.uniqueIdentifier&&t){var a=8*(i.size-i.size*i.progress()),n=Math.floor(a/t);i.remainingTime=n}return i}));a.setState({uploadBitrate:t,uploadFileList:i})},a.getBitrate=function(){var e=0,t=0,i=(new Date).getTime();if(a.resumable.files.forEach((function(t){e+=t.progress()*t.size})),a.timestamp){var n=i-a.timestamp;if(n<a.bitrateInterval)return a.state.uploadBitrate;(e<a.loaded||0===a.loaded)&&(a.loaded=e),t=(e-a.loaded)*(1e3/n)*8}return a.timestamp=i,a.loaded=e,t},a.onProgress=function(){var e=Math.round(100*a.resumable.progress());a.setState({totalProgress:e}),O.a.registerGlobalVariable("uploader","totalProgress",e)},a.onFileUploadSuccess=function(e,t){var i=e.formData,n=(new Date).getTime()/1e3;t=i.replace?t:JSON.parse(t)[0],i.relative_path;var o={id:t.id,type:"file",name:t.name,size:t.size,mtime:n};a.props.onFileUploadSuccess(o);var s=a.state.uploadFileList.map((function(i){return i.uniqueIdentifier===e.uniqueIdentifier&&(i.newFileName=t.name,i.isSaved=!0),i}));a.setState({uploadFileList:s})},a.onFileError=function(e,t){var i="";if(t){var n=t.replace(/\n/g,"");n=JSON.parse(n),"File locked by others."===(i=n.error)&&(i=Object(j.qb)("File is locked by others.")),"Internal error."===i&&(i=Object(j.qb)("Internal Server Error"))}else i=Object(j.qb)("Network error");var o=a.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(a.state.retryFileList.push(t),t.error=i),t}));a.loaded=0,a.setState({retryFileList:a.state.retryFileList,uploadFileList:o})},a.onComplete=function(){a.notifiedFolders=[],a.isUploadLinkLoaded=!1,a.setState({allFilesUploaded:!0})},a.onPause=function(){},a.onError=function(e){a.isUploadLinkLoaded=!1,O.a.registerGlobalVariable("uploader","totalProgress",100)},a.onFileRetry=function(){},a.onBeforeCancel=function(){},a.onCancel=function(){},a.setHeaders=function(e,t){var i=t.offset,a=t.getOpt("chunkSize"),n=0===e.size?1:e.size,o=0!==i?i*a:0,s=Math.min(n,(i+1)*a)-1;return n-t.endByte<a&&!t.getOpt("forceChunkSize")&&(s=n),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+o+"-"+s+"/"+n}},a.setQuery=function(e){return e.formData},a.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return _()(t+new Date)+t},a.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},a.onFileUpload=function(){a.uploadInput.current.removeAttribute("webkitdirectory"),a.uploadInput.current.click()},a.onFolderUpload=function(){a.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),a.uploadInput.current.click()},a.onDragStart=function(){a.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},a.onCloseUploadDialog=function(){a.loaded=0,a.resumable.files=[],a.isUploadLinkLoaded=!1,a.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),O.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},a.onUploadCancel=function(e){var t=a.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));a.resumable.isUploading()||(a.setState({totalProgress:"100",allFilesUploaded:!0}),a.loaded=0),a.setState({uploadFileList:t})},a.onCancelAllUploading=function(){var e=a.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));a.loaded=0,a.setState({allFilesUploaded:!0,totalProgress:"100",uploadFileList:e}),a.isUploadLinkLoaded=!1},a.onUploadRetry=function(e){var t=a.props,i=t.token,n=t.relativePath;y.a.sharedLinkGetFileUploadUrl(i,n).then((function(t){a.resumable.opts.target=t.data.upload_link+"?ret-json=1";var i=a.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),n=a.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,a.retryUploadFile(t)),t}));a.setState({retryFileList:i,uploadFileList:n})})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},a.onUploadRetryAll=function(){var e=a.props,t=e.token,i=e.relativePath;y.a.sharedLinkGetFileUploadUrl(t,i).then((function(e){a.resumable.opts.target=e.data.upload_link+"?ret-json=1",a.state.retryFileList.forEach((function(e){e.error=!1,a.retryUploadFile(e)}));var t=a.state.uploadFileList.slice(0);a.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},a.retryUploadFile=function(e){var t=a.props,i=t.repoID,n=t.path,o=e.fileName;if(!(e.fileName===e.relativePath)){var s=e.formData.relative_path;o=("/"===n?n+s:n+"/"+s)+o}e.bootstrap();var r=!1;e.resumableObj.on("chunkingComplete",(function(){r||y.a.getFileUploadedBytes(i,n,o).then((function(t){var i=t.data.uploadedBytes,a=1024*parseInt(j.cc)*1024||1048576,n=Math.floor(i/a);e.markChunksCompleted(n),e.resumableObj.upload()})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)})),r=!0}))},a.uploadFile=function(){var e=a.resumable.files[a.resumable.files.length-1],t=a.props,i=t.token,n=t.relativePath;y.a.sharedLinkGetFileUploadUrl(i,n).then((function(t){a.resumable.opts.target=t.data.upload_link+"?ret-json=1",a.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat(Object(I.a)(a.state.uploadFileList),[e])},(function(){a.resumable.upload()})),O.a.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=O.a.getErrorMsg(e);S.a.danger(t)}))},a.cancelFileUpload=function(){a.resumable.files.pop(),a.setState({isUploadRemindDialogShow:!1})},a.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0,allFilesUploaded:!1},a.uploadInput=u.a.createRef(),a.notifiedFolders=[],a.timestamp=null,a.loaded=0,a.bitrateInterval=500,window.onbeforeunload=a.onbeforeunload,a.isUploadLinkLoaded=!1,a}return Object(r.a)(i,[{key:"componentDidMount",value:function(){this.resumable=new P.a({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:j.Mb||void 0,maxFileSize:1e3*j.Nb*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(j.cc)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return Object(F.jsxs)(h.Fragment,{children:[Object(F.jsx)("div",{className:"file-uploader-container",children:Object(F.jsx)("div",{className:"file-uploader",children:Object(F.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick})})}),this.state.isUploadProgressDialogShow&&Object(F.jsx)(z,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,allFilesUploaded:this.state.allFilesUploaded,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll})]})}}]),i}(u.a.Component)),R=i(90),B=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).onSaveSharedFile=function(){a.props.handleSaveSharedDir(a.state.repo.repo_id,a.state.selectedPath)},a.onDirentItemClick=function(e,t,i){"dir"===i.type?a.setState({repo:e,selectedPath:t}):a.setState({repo:null,selectedPath:""})},a.onRepoItemClick=function(e){a.setState({repo:e,selectedPath:"/"})},a.state={repo:null,selectedPath:"",errMessage:""},a}return Object(r.a)(i,[{key:"render",value:function(){return Object(F.jsxs)(b.x,{isOpen:!0,className:"sf-save-file",children:[Object(F.jsx)(b.A,{toggle:this.props.toggleCancel,children:Object(j.qb)("Save to:")}),Object(F.jsxs)(b.y,{children:[Object(F.jsx)(R.a,{isShowFile:!1,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"only_all_repos"}),this.state.errMessage&&Object(F.jsx)(b.a,{color:"danger",children:this.state.errMessage})]}),Object(F.jsxs)(b.z,{children:[Object(F.jsx)(b.c,{color:"secondary",onClick:this.props.toggleCancel,children:Object(j.qb)("Cancel")}),this.state.selectedPath?Object(F.jsx)(b.c,{color:"primary",onClick:this.onSaveSharedFile,children:Object(j.qb)("Submit")}):Object(F.jsx)(b.c,{color:"primary",disabled:!0,children:Object(j.qb)("Submit")})]})]})}}]),i}(u.a.Component),Y=i(320);i(1517),i(504);g.a.locale(window.app.config.lang);var X=window.app.pageOptions.name,Z=window.shared.pageOptions,W=Z.token,H=Z.dirName,K=Z.dirPath,G=Z.sharedBy,V=Z.repoID,J=Z.relativePath,Q=Z.mode,$=Z.thumbnailSize,ee=Z.zipped,te=Z.trafficOverLimit,ie=Z.canDownload,ae=Z.noQuota,ne=Z.canUpload,oe=Z.enableVideoThumbnail,se=!te&&ie,re=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).sortItems=function(e,t){a.setState({sortBy:e,sortOrder:t,items:O.a.sortDirentsInSharedDir(a.state.items,e,t)})},a.getThumbnails=function(){var e=a.state.items.filter((function(e){return!e.is_dir&&(O.a.imageCheck(e.file_name)||oe&&O.a.videoCheck(e.file_name))&&!e.encoded_thumbnail_src}));if(0!=e.length){var t=e.length,i=Object(l.a)(a);!function a(n){var o=e[n];y.a.getShareLinkThumbnail(W,o.file_path,$).then((function(e){o.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){n<t-1?a(++n):i.setState({items:i.state.items})}))}(0)}},a.renderPath=function(){return Object(F.jsxs)(u.a.Fragment,{children:[ee.map((function(e,t){if(t!=ee.length-1)return Object(F.jsxs)(u.a.Fragment,{children:[Object(F.jsx)("a",{href:"?p=".concat(encodeURIComponent(e.path),"&mode=").concat(Q),className:"mx-1 ellipsis",title:e.name,children:e.name}),Object(F.jsx)("span",{children:" / "})]},t)})),Object(F.jsx)("span",{className:"ml-1 ellipsis",title:ee[ee.length-1].name,children:ee[ee.length-1].name})]})},a.zipDownloadFolder=function(e){j.Ac?y.a.getShareLinkZipTask(W,e).then((function(e){var t=e.data.zip_token;location.href="".concat(j.ob,"zip/").concat(t)})).catch((function(e){var t=O.a.getErrorMsg(e);a.setState({isLoading:!1,errorMsg:t})})):a.setState({isZipDialogOpen:!0,zipFolderPath:e})},a.zipDownloadSelectedItems=function(){if(j.Ac){var e=a.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}));y.a.getShareLinkDirentsZipTask(W,J,e).then((function(e){var t=e.data.zip_token;location.href="".concat(j.ob,"zip/").concat(t)})).catch((function(e){var t=O.a.getErrorMsg(e);a.setState({isLoading:!1,errorMsg:t})}))}else a.setState({isZipDialogOpen:!0,zipFolderPath:J,selectedItems:a.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},a.saveSelectedItems=function(){a.setState({isSaveSharedDirDialogShow:!0,itemsForSave:a.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},a.saveAllItems=function(){a.setState({isSaveSharedDirDialogShow:!0,itemsForSave:a.state.items.map((function(e){return e.file_name||e.folder_name}))})},a.toggleSaveSharedDirCancel=function(){a.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[]})},a.handleSaveSharedDir=function(e,t){var i=a.state.itemsForSave;y.a.saveSharedDir(e,t,W,J,i).then((function(e){a.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[],isCopyMoveProgressDialogShow:!0,asyncCopyMoveTaskId:e.data.task_id,asyncOperatedFilesLength:i.length},(function(){a.getAsyncCopyMoveProgress()}))})).catch((function(e){var t=O.a.getErrorMsg(e);a.setState({errMessage:t})}))},a.onProgressDialogToggle=function(){if(100!==a.state.asyncOperationProgress){var e=a.state.asyncCopyMoveTaskId;y.a.cancelCopyMoveOperation(e)}a.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},a.closeZipDialog=function(){a.setState({isZipDialogOpen:!1,zipFolderPath:"",selectedItems:[]})},a.prepareImageItem=function(e){var t=e.file_name,i="gif"==t.substr(t.lastIndexOf(".")+1).toLowerCase(),a="".concat(j.qc,"d/").concat(W,"/files/?p=").concat(encodeURIComponent(e.file_path));return{name:t,url:a,src:i?"".concat(a,"&raw=1"):"".concat(j.qc,"thumbnail/").concat(W,"/").concat(j.vc).concat(O.a.encodePath(e.file_path))}},a.showImagePopup=function(e){var t=a.state.items.filter((function(e){return!e.is_dir&&O.a.imageCheck(e.file_name)})),i=t.map((function(e){return a.prepareImageItem(e)}));a.setState({isImagePopupOpen:!0,imageItems:i,imageIndex:t.indexOf(e)})},a.closeImagePopup=function(){a.setState({isImagePopupOpen:!1})},a.moveToPrevImage=function(){var e=a.state.imageItems.length;a.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},a.moveToNextImage=function(){var e=a.state.imageItems.length;a.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},a.toggleAllSelected=function(){a.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,items:a.state.items.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},a.toggleItemSelected=function(e,t){a.setState({items:a.state.items.map((function(i){return i===e&&(i.isSelected=t),i}))},(function(){a.setState({isAllItemsSelected:!a.state.items.some((function(e){return!e.isSelected}))})}))},a.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),a.uploader.onFileUpload()},a.onFileUploadSuccess=function(e){var t=e.name,i=e.size,n={isSelected:!1,file_name:t,file_path:O.a.joinPath(J,t),is_dir:!1,last_modified:g()().format(),size:i},o=a.state.items.filter((function(e){return e.is_dir})),s=Array.from(a.state.items);s.splice(o.length,0,n),a.setState({items:s}),y.a.shareLinksUploadDone(W,O.a.joinPath(K,t))},a.state={isLoading:!0,errorMsg:"",items:[],isAllItemsSelected:!1,selectedItems:[],sortBy:"name",sortOrder:"asc",isZipDialogOpen:!1,zipFolderPath:"",isSaveSharedDirDialogShow:!1,itemsForSave:[],asyncCopyMoveTaskId:"",asyncOperationProgress:0,asyncOperatedFilesLength:0,isCopyMoveProgressDialogShow:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0},a}return Object(r.a)(i,[{key:"componentDidMount",value:function(){var e=this;te&&S.a.danger(Object(j.qb)("File download is disabled: the share link traffic of owner is used up."),{duration:3}),y.a.listSharedDir(W,J,$).then((function(t){var i=t.data.dirent_list.map((function(e){return e.isSelected=!1,e}));e.setState({isLoading:!1,errorMsg:"",items:O.a.sortDirentsInSharedDir(i,e.state.sortBy,e.state.sortOrder)}),e.getThumbnails()})).catch((function(t){var i=O.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:i})}))}},{key:"getAsyncCopyMoveProgress",value:function(){var e=Object(o.a)(n.a.mark((function e(){var t,i,a,o,s,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.asyncCopyMoveTaskId,e.prev=1,e.next=4,y.a.queryAsyncOperationProgress(t);case 4:if(i=e.sent,!(a=i.data).failed){e.next=11;break}return o=Object(j.qb)("Failed to copy files to another library."),S.a.danger(o),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 11:if(!a.successful){e.next=16;break}return this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),s=Object(j.qb)("Successfully copied files to another library."),S.a.success(s),e.abrupt("return");case 16:r=a.total?parseInt((a.done/a.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:r}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=O.a.isDesktop(),i="btn btn-secondary btn-icon sf-view-mode-btn";return Object(F.jsxs)(u.a.Fragment,{children:[Object(F.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(F.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(F.jsx)("a",{href:j.qc,children:Object(F.jsx)("img",{src:j.Ob+j.Jb,height:j.Ib,width:j.Kb,title:j.rc,alt:"logo"})}),X&&Object(F.jsx)(v.a,{})]}),Object(F.jsx)("div",{className:"o-auto",children:Object(F.jsxs)("div",{className:"shared-dir-view-main",children:[Object(F.jsx)("h2",{className:"h3",children:H}),Object(F.jsxs)("p",{children:[Object(j.qb)("Shared by: "),G]}),Object(F.jsxs)("div",{className:"d-flex justify-content-between align-items-center op-bar",children:[Object(F.jsxs)("p",{className:"m-0 mr-4 ellipsis d-flex align-items-center",children:[Object(F.jsx)("span",{className:"flex-none",children:Object(j.qb)("Current path: ")}),this.renderPath()]}),Object(F.jsxs)("div",{className:"flex-none",children:[t&&Object(F.jsxs)("div",{className:"view-mode btn-group",children:[Object(F.jsx)("a",{href:"?p=".concat(encodeURIComponent(J),"&mode=list"),className:"".concat(i," sf2-icon-list-view ").concat("list"==Q?"current-mode":""),title:Object(j.qb)("List"),"aria-label":Object(j.qb)("List")}),Object(F.jsx)("a",{href:"?p=".concat(encodeURIComponent(J),"&mode=grid"),className:"".concat(i," sf2-icon-grid-view ").concat("grid"==Q?"current-mode":""),title:Object(j.qb)("Grid"),"aria-label":Object(j.qb)("Grid")})]}),ne&&Object(F.jsx)(b.c,{disabled:ae,title:ae?Object(j.qb)("The owner of this library has run out of space."):"",onClick:this.onUploadFile,className:"ml-2 shared-dir-op-btn shared-dir-upload-btn",children:Object(j.qb)("Upload")}),se&&Object(F.jsx)(h.Fragment,{children:this.state.items.some((function(e){return e.isSelected}))?Object(F.jsxs)(h.Fragment,{children:[Object(F.jsx)(b.c,{color:"success",onClick:this.zipDownloadSelectedItems,className:"ml-2 shared-dir-op-btn",children:Object(j.qb)("ZIP Selected Items")}),ie&&X&&X!==G&&Object(F.jsx)(b.c,{color:"success",onClick:this.saveSelectedItems,className:"ml-2 shared-dir-op-btn",children:Object(j.qb)("Save Selected Items")})]}):Object(F.jsxs)(h.Fragment,{children:[Object(F.jsx)(b.c,{color:"success",onClick:this.zipDownloadFolder.bind(this,J),className:"ml-2 shared-dir-op-btn",children:Object(j.qb)("ZIP")}),ie&&X&&X!==G&&Object(F.jsx)(b.c,{color:"success",onClick:this.saveAllItems,className:"ml-2 shared-dir-op-btn",children:Object(j.qb)("Save")})]})})]})]}),!ae&&ne&&Object(F.jsx)(A,{ref:function(t){return e.uploader=t},dragAndDrop:!1,token:W,path:"/"===K?K:K.replace(/\/+$/,""),relativePath:"/"===J?J:J.replace(/\/+$/,""),repoID:V,onFileUploadSuccess:this.onFileUploadSuccess}),Object(F.jsx)(le,{isDesktop:t,isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected,zipDownloadFolder:this.zipDownloadFolder,showImagePopup:this.showImagePopup})]})})]}),this.state.isZipDialogOpen&&Object(F.jsx)(k.a,{children:Object(F.jsx)(w.a,{token:W,path:this.state.zipFolderPath,target:this.state.selectedItems,toggleDialog:this.closeZipDialog})}),this.state.isSaveSharedDirDialogShow&&Object(F.jsx)(B,{sharedToken:W,parentDir:J,items:this.state.itemsForSave,toggleCancel:this.toggleSaveSharedDirCancel,handleSaveSharedDir:this.handleSaveSharedDir}),this.state.isCopyMoveProgressDialogShow&&Object(F.jsx)(Y.a,{type:"copy",asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onProgressDialogToggle}),this.state.isImagePopupOpen&&Object(F.jsx)(k.a,{children:Object(F.jsx)(C.a,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}]),i}(u.a.Component),le=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).sortByName=function(e){e.preventDefault();var t="asc"==a.props.sortOrder?"desc":"asc";a.props.sortItems("name",t)},a.sortByTime=function(e){e.preventDefault();var t="asc"==a.props.sortOrder?"desc":"asc";a.props.sortItems("time",t)},a.sortBySize=function(e){e.preventDefault();var t="asc"==a.props.sortOrder?"desc":"asc";a.props.sortItems("size",t)},a}return Object(r.a)(i,[{key:"render",value:function(){var e=this,t=this.props,i=t.isDesktop,a=t.isLoading,n=t.errorMsg,o=t.items,s=t.sortBy,r=t.sortOrder,l=t.isAllItemsSelected;if(a)return Object(F.jsx)(x.a,{});if(n)return Object(F.jsx)("p",{className:"error mt-6 text-center",children:n});var c=Object(F.jsx)("tbody",{children:o.map((function(t,a){return Object(F.jsx)(ce,{isDesktop:i,item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup,toggleItemSelected:e.props.toggleItemSelected},a)}))});if(!i)return Object(F.jsxs)("table",{className:"table-hover table-thead-hidden",children:[Object(F.jsx)("thead",{children:Object(F.jsxs)("tr",{children:[Object(F.jsx)("th",{width:"12%"}),Object(F.jsx)("th",{width:"80%"}),Object(F.jsx)("th",{width:"8%"})]})}),c]});var d=Object(F.jsx)("span",{className:"fas ".concat("asc"==r?"fa-caret-up":"fa-caret-down")});return"list"==Q?Object(F.jsxs)("table",{className:"table-hover",children:[Object(F.jsx)("thead",{children:Object(F.jsxs)("tr",{children:[se&&Object(F.jsx)("th",{width:"3%",className:"text-center",children:Object(F.jsx)("input",{type:"checkbox",checked:l,onChange:this.props.toggleAllSelected})}),Object(F.jsx)("th",{width:"5%"}),Object(F.jsx)("th",{width:se?"52%":"55%",children:Object(F.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[Object(j.qb)("Name")," ","name"==s&&d]})}),Object(F.jsx)("th",{width:"14%",children:Object(F.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[Object(j.qb)("Size")," ","size"==s&&d]})}),Object(F.jsx)("th",{width:"16%",children:Object(F.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[Object(j.qb)("Last Update")," ","time"==s&&d]})}),Object(F.jsx)("th",{width:"10%"})]})}),c]}):Object(F.jsx)("ul",{className:"grid-view",children:o.map((function(t,i){return Object(F.jsx)(de,{item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup},i)}))})}}]),i}(u.a.Component),ce=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).toggleOpMenu=function(){a.setState({isOpMenuOpen:!a.state.isOpMenuOpen})},a.handleMouseOver=function(){a.setState({isIconShown:!0})},a.handleMouseOut=function(){a.setState({isIconShown:!1})},a.zipDownloadFolder=function(e){e.preventDefault(),a.props.zipDownloadFolder.bind(Object(l.a)(a),a.props.item.folder_path)()},a.handleFileClick=function(e){var t=a.props.item;O.a.imageCheck(t.file_name)&&(e.preventDefault(),a.props.showImagePopup(t))},a.toggleItemSelected=function(e){a.props.toggleItemSelected(a.props.item,e.target.checked)},a.state={isIconShown:!1,isOpMenuOpen:!1},a}return Object(r.a)(i,[{key:"render",value:function(){var e=this.props,t=e.item,i=e.isDesktop,a=this.state.isIconShown;if(t.is_dir)return i?Object(F.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[se&&Object(F.jsx)("td",{className:"text-center",children:Object(F.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),Object(F.jsx)("td",{className:"text-center",children:Object(F.jsx)("img",{src:O.a.getFolderIconUrl(),alt:"",width:"24"})}),Object(F.jsx)("td",{children:Object(F.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(Q),children:t.folder_name})}),Object(F.jsx)("td",{}),Object(F.jsx)("td",{title:g()(t.last_modified).format("llll"),children:g()(t.last_modified).fromNow()}),Object(F.jsx)("td",{children:se&&Object(F.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(a?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:Object(j.qb)("Download"),"aria-label":Object(j.qb)("Download")})})]}):Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{className:"text-center",children:Object(F.jsx)("img",{src:O.a.getFolderIconUrl(),alt:"",width:"24"})}),Object(F.jsxs)("td",{children:[Object(F.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(Q),children:t.folder_name}),Object(F.jsx)("br",{}),Object(F.jsx)("span",{className:"item-meta-info",children:g()(t.last_modified).fromNow()})]}),Object(F.jsx)("td",{children:se&&Object(F.jsxs)(b.l,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[Object(F.jsx)(b.o,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:Object(j.qb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),Object(F.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[Object(F.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),Object(F.jsx)("div",{className:"mobile-operation-menu",children:Object(F.jsx)(b.m,{className:"mobile-menu-item",onClick:this.zipDownloadFolder,children:Object(j.qb)("Download")})})]})]})})]});var n="".concat(j.qc,"d/").concat(W,"/files/?p=").concat(encodeURIComponent(t.file_path)),o=t.encoded_thumbnail_src?"".concat(j.qc).concat(t.encoded_thumbnail_src):"";return i?Object(F.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[se&&Object(F.jsx)("td",{className:"text-center",children:Object(F.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),Object(F.jsx)("td",{className:"text-center",children:o?Object(F.jsx)("img",{className:"thumbnail",src:o,alt:""}):Object(F.jsx)("img",{src:O.a.getFileIconUrl(t.file_name),alt:"",width:"24"})}),Object(F.jsx)("td",{children:Object(F.jsx)("a",{href:n,onClick:this.handleFileClick,children:t.file_name})}),Object(F.jsx)("td",{children:O.a.bytesToSize(t.size)}),Object(F.jsx)("td",{title:g()(t.last_modified).format("llll"),children:g()(t.last_modified).fromNow()}),Object(F.jsx)("td",{children:se&&Object(F.jsx)("a",{className:"action-icon sf2-icon-download".concat(a?"":" invisible"),href:"".concat(n,"&dl=1"),title:Object(j.qb)("Download"),"aria-label":Object(j.qb)("Download")})})]}):Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{className:"text-center",children:o?Object(F.jsx)("img",{className:"thumbnail",src:o,alt:""}):Object(F.jsx)("img",{src:O.a.getFileIconUrl(t.file_name),alt:"",width:"24"})}),Object(F.jsxs)("td",{children:[Object(F.jsx)("a",{href:n,onClick:this.handleFileClick,children:t.file_name}),Object(F.jsx)("br",{}),Object(F.jsx)("span",{className:"item-meta-info",children:O.a.bytesToSize(t.size)}),Object(F.jsx)("span",{className:"item-meta-info",children:g()(t.last_modified).fromNow()})]}),Object(F.jsx)("td",{children:se&&Object(F.jsxs)(b.l,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[Object(F.jsx)(b.o,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:Object(j.qb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),Object(F.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[Object(F.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),Object(F.jsx)("div",{className:"mobile-operation-menu",children:Object(F.jsx)(b.m,{className:"mobile-menu-item",tag:"a",href:"".concat(n,"&dl=1"),children:Object(j.qb)("Download")})})]})]})})]})}}]),i}(u.a.Component),de=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var a;return Object(s.a)(this,i),(a=t.call(this,e)).handleMouseOver=function(){a.setState({isIconShown:!0})},a.handleMouseOut=function(){a.setState({isIconShown:!1})},a.zipDownloadFolder=function(e){e.preventDefault(),a.props.zipDownloadFolder.bind(Object(l.a)(a),a.props.item.folder_path)()},a.handleFileClick=function(e){var t=a.props.item;O.a.imageCheck(t.file_name)&&(e.preventDefault(),a.props.showImagePopup(t))},a.state={isIconShown:!1},a}return Object(r.a)(i,[{key:"render",value:function(){var e=this.props.item,t=this.state.isIconShown;if(e.is_dir){var i="?p=".concat(encodeURIComponent(e.folder_path.substr(0,e.folder_path.length-1)),"&mode=").concat(Q);return Object(F.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(F.jsx)("a",{href:i,className:"grid-file-img-link d-block",children:Object(F.jsx)("img",{src:O.a.getFolderIconUrl(!1,192),alt:"",width:"96",height:"96"})}),Object(F.jsx)("a",{href:i,className:"grid-file-name grid-file-name-link",children:e.folder_name}),se&&Object(F.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:Object(j.qb)("Download"),"aria-label":Object(j.qb)("Download")})]})}var a="".concat(j.qc,"d/").concat(W,"/files/?p=").concat(encodeURIComponent(e.file_path)),n=e.encoded_thumbnail_src?"".concat(j.qc).concat(e.encoded_thumbnail_src):"";return Object(F.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(F.jsx)("a",{href:a,className:"grid-file-img-link d-block",onClick:this.handleFileClick,children:n?Object(F.jsx)("img",{className:"thumbnail",src:n,alt:""}):Object(F.jsx)("img",{src:O.a.getFileIconUrl(e.file_name,192),alt:"",width:"96",height:"96"})}),Object(F.jsx)("a",{href:a,className:"grid-file-name grid-file-name-link",onClick:this.handleFileClick,children:e.file_name}),se&&Object(F.jsx)("a",{className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"".concat(a,"&dl=1"),title:Object(j.qb)("Download"),"aria-label":Object(j.qb)("Download")})]})}}]),i}(u.a.Component);m.a.render(Object(F.jsx)(re,{}),document.getElementById("wrapper"))},171:function(e,t,i){"use strict";var a=i(6),n=i(7),o=i(9),s=i(8),r=i(2),l=i.n(r),c=i(1),d=i(319),h=(i(503),i(0)),u=function(e){Object(o.a)(i,e);var t=Object(s.a)(i);function i(e){return Object(a.a)(this,i),t.call(this,e)}return Object(n.a)(i,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,i=e.length,a=i&&Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)("span",{children:Object(c.qb)("%curr% of %total%").replace("%curr%",t+1).replace("%total%",i)}),Object(h.jsx)("br",{}),Object(h.jsx)("a",{href:e[t].url,target:"_blank",children:Object(c.qb)("Open in New Tab")})]});return Object(h.jsx)(d.a,{mainSrc:e[t].src,imageTitle:e[t].name,imageCaption:a,nextSrc:e[(t+1)%i].src,prevSrc:e[(t+i-1)%i].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:Object(c.qb)("The image could not be loaded."),prevLabel:Object(c.qb)("Previous (Left arrow key)"),nextLabel:Object(c.qb)("Next (Right arrow key)"),closeLabel:Object(c.qb)("Close (Esc)"),zoomInLabel:Object(c.qb)("Zoom in"),zoomOutLabel:Object(c.qb)("Zoom out")})}}]),i}(l.a.Component);t.a=u},319:function(e,t,i){"use strict";(function(e){var a=i(2),n=i.n(a),o=i(3),s=i.n(o),r=i(247),l=i.n(r);function c(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),e}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e}).apply(this,arguments)}function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){h(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var i=[],a=!0,n=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(a=(s=r.next()).done)&&(i.push(s.value),!t||i.length!==t);a=!0);}catch(l){n=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(n)throw o}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function j(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var i=e;return t&&Object.keys(t).forEach((function(e){i=i.replace(e,t[e])})),i}function y(){return"undefined"!==typeof e.window?e.window.innerWidth:0}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.window.self,i=t.document.referrer;if(t===e.window.top||!i)return t;var a=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return a(t.location.href)===a(i)?x(t.parent):t}var S=300,k=27,w=37,C=39,I=function(t){function i(e){var t,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),a=this,t=!(o=b(i).call(this,e))||"object"!==typeof o&&"function"!==typeof o?g(a):o,h(g(t),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{}},t.outerEl=n.a.createRef(),t.zoomInBtn=n.a.createRef(),t.zoomOutBtn=n.a.createRef(),t.caption=n.a.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(g(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(g(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(g(t)),t.handleKeyInput=t.handleKeyInput.bind(g(t)),t.handleMouseUp=t.handleMouseUp.bind(g(t)),t.handleMouseDown=t.handleMouseDown.bind(g(t)),t.handleMouseMove=t.handleMouseMove.bind(g(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(g(t)),t.handleTouchStart=t.handleTouchStart.bind(g(t)),t.handleTouchMove=t.handleTouchMove.bind(g(t)),t.handleTouchEnd=t.handleTouchEnd.bind(g(t)),t.handlePointerEvent=t.handlePointerEvent.bind(g(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(g(t)),t.handleWindowResize=t.handleWindowResize.bind(g(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(g(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(g(t)),t.requestClose=t.requestClose.bind(g(t)),t.requestMoveNext=t.requestMoveNext.bind(g(t)),t.requestMovePrev=t.requestMovePrev.bind(g(t)),t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,t),d(i,null,[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,i=void 0===t?0:t,a=e.y,n=void 0===a?0:a,o=e.zoom,s=void 0===o?1:o,r=e.width,l=e.targetWidth,c=i,d=y();r>d&&(c+=(d-r)/2);var h=s*(l/r);return{transform:"translate3d(".concat(c,"px,").concat(n,"px,0) scale3d(").concat(h,",").concat(h,",1)")}}}]),d(i,[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=x(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,i=!1,a={},n={};this.getSrcTypes().forEach((function(o){t.props[o.name]!==e[o.name]&&(i=!0,a[t.props[o.name]]=!0,n[e[o.name]]=!0)})),(i||this.moveRequested)&&(Object.keys(a).forEach((function(e){!(e in n)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var i=this,a=setTimeout((function(){i.timeouts=i.timeouts.filter((function(e){return e!==a})),e()}),t);return this.timeouts.push(a),a}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],i={};if(this.isImageLoaded(t))i=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],i=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:i.height,targetWidth:i.width}}},{key:"getFitSizes",value:function(e,t,i){var a=this.getLightboxRect(),n=a.height-2*this.props.imagePadding,o=a.width-2*this.props.imagePadding;return i||(n=Math.min(n,t),o=Math.min(o,e)),o/n>e/t?{width:e*n/t,height:n}:{width:o,height:t*o/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var i=this.getLightboxRect(),a=this.getZoomMultiplier(e),n=0,o=0;return{maxX:n=a*t.width-i.width<0?(i.width-a*t.width)/2:(a*t.width-i.width)/2,maxY:o=a*t.height-i.height<0?(i.height-a*t.height)/2:(a*t.height-i.height)/2,minX:-1*n,minY:-1*o}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:y(),height:"undefined"!==typeof e.window?e.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,i){if(this.props.enableZoom){var a=Math.max(0,Math.min(S,e));if(a!==this.state.zoomLevel)if(0!==a){var n=this.getBestImageForType("mainSrc");if(null!==n){var o=this.getZoomMultiplier(),s=this.getZoomMultiplier(a),r=this.getLightboxRect(),l="undefined"!==typeof t?t-r.left:r.width/2,c="undefined"!==typeof i?i-r.top:r.height/2,d=(r.width-n.width*o)/2,h=(r.height-n.height*o)/2,u=l-(l-(d-this.state.offsetX))/o*s,p=c-(c-(h-this.state.offsetY))/o*s,m=(r.width-n.width*s)/2-u,b=(r.height-n.height*s)/2-p;if(3!==this.currentAction){var f=this.getMaxOffsets();this.state.zoomLevel>a&&(m=Math.max(f.minX,Math.min(f.maxX,m)),b=Math.max(f.minY,Math.min(f.maxY,b)))}this.setState({zoomLevel:a,offsetX:m,offsetY:b})}}else this.setState({zoomLevel:a,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,i=new Date;if(!(i.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==k))switch(this.lastKeyDownTime=i.getTime(),t){case k:e.preventDefault(),this.requestClose(e);break;case w:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case C:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;this.setState({offsetY:t})}else{var i=this.state.offsetX+e.deltaX;this.setState({offsetX:i})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0);default:return!1}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&i.isTargetMatchImage(e.target)&&(this.addPointer(i.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[i.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(i.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":i.isTargetMatchImage(e.target)&&(this.addPointer(i.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[i.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(i.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&i.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(i.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return i.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(i.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,i=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=i,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,i=e.y,a=this.moveStartX-t+this.moveStartOffsetX,n=this.moveStartY-i+this.moveStartOffsetY;this.state.offsetX===a&&this.state.offsetY===n||this.setState({offsetX:a,offsetY:n})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),i=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),a=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));i===this.state.offsetX&&a===this.state.offsetY||(this.setState({offsetX:i,offsetY:a,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,i=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=i,this.swipeEndX=t,this.swipeEndY=i}},{key:"handleSwipe",value:function(e){var t=e.x,i=e.y;this.swipeEndX=t,this.swipeEndY=i}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,i=Math.abs(t),a=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||i<1.5*a)){if(i<200)if(i<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=v(e,2),i=t[0],a=t[1];return Math.sqrt(Math.pow(i.x-a.x,2)+Math.pow(i.y-a.y,2))}},{key:"calculatePinchCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=v(e,2),i=t[0],a=t[1];return{x:i.x-(i.x-a.x)/2,y:i.y-(i.y-a.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var i=0;i<e.length;i+=1)if(e[i].id===t.id)return e[i];return t}));var t=this.calculatePinchDistance(),i=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var a=this.calculatePinchCenter(this.pinchTouchList),n=a.x,o=a.y;this.changeZoom(i,n,o)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===S&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,i=this.caption.current,a=i.scrollHeight,n=i.scrollTop;(e.deltaY>0&&t+n>=a||e.deltaY<0&&n<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(t,i,a){var n=this;if(this.isImageLoaded(i))this.setTimeout((function(){a()}),1);else{var o=new e.Image;this.props.imageCrossOrigin&&(o.crossOrigin=this.props.imageCrossOrigin),o.onerror=function(e){n.props.onImageLoadError(i,t,e),n.setState((function(e){return{loadErrorStatus:m({},e.loadErrorStatus,h({},t,!0))}})),a(e)},o.onload=function(){n.props.onImageLoad(i,t,o),n.imageCache[i]={loaded:!0,width:o.width,height:o.height},a()},o.src=i}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,i=function(t,i){return function(a){a||e.props[t]!==i||e.didUnmount||e.forceUpdate()}};this.getSrcTypes().forEach((function(a){var n=a.name;t[n]&&e.state.loadErrorStatus[n]&&e.setState((function(e){return{loadErrorStatus:m({},e.loadErrorStatus,h({},n,!1))}})),t[n]&&!e.isImageLoaded(t[n])&&e.loadImage(n,t[n],i(n,t[n]))}))}},{key:"requestClose",value:function(e){var t=this,i=function(){return t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?i():(this.setState({isClosing:!0}),this.setTimeout(i,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var i=this,a={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(a.shouldAnimate=!0,this.setTimeout((function(){return i.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,"prev"===e?(this.keyCounter-=1,this.setState(a),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(a),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"render",value:function(){var t=this,a=this.props,o=a.animationDisabled,s=a.animationDuration,r=a.clickOutsideToClose,c=a.discourageDownloads,d=a.enableZoom,h=a.imageTitle,p=a.nextSrc,b=a.prevSrc,f=a.toolbarButtons,g=a.reactModalStyle,v=a.onAfterOpen,y=a.imageCrossOrigin,x=a.reactModalProps,k=this.state,w=k.zoomLevel,C=k.offsetX,I=k.offsetY,M=k.isClosing,P=k.loadErrorStatus,D=this.getLightboxRect(),_={};!o&&this.isAnimating()&&(_=m({},_,{transition:"transform ".concat(s,"ms")}));var F={};this.getSrcTypes().forEach((function(e){var t=e.name,i=e.keyEnding;F[t]=i}));var N=[],L=function(e,a,o){if(t.props[e]){var s=t.getBestImageForType(e),r=m({},_,{},i.getTransform(m({},o,{},s)));w>0&&(r.cursor="move");var l;if(null===s&&(l=P,Object.keys(l).some((function(e){return l[e]}))))N.push(n.a.createElement("div",{className:"".concat(a," ril__image ril-errored"),style:r,key:t.props[e]+F[e]},n.a.createElement("div",{className:"ril__errorContainer"},t.props.imageLoadErrorMessage)));else if(null!==s){var d=s.src;c?(r.backgroundImage="url('".concat(d,"')"),N.push(n.a.createElement("div",{className:"".concat(a," ril__image ril__imageDiscourager"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,style:r,key:d+F[e]},n.a.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):N.push(n.a.createElement("img",u({},y?{crossOrigin:y}:{},{className:"".concat(a," ril__image"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:r,src:d,key:d+F[e],alt:"string"===typeof h?h:O("Image"),draggable:!1})))}else{var p=n.a.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},j(new Array(12)).map((function(e,t){return n.a.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));N.push(n.a.createElement("div",{className:"".concat(a," ril__image ril-not-loaded"),style:r,key:t.props[e]+F[e]},n.a.createElement("div",{className:"ril__loadingContainer"},p)))}}},E=this.getZoomMultiplier();L("nextSrc","ril-image-next ril__imageNext",{x:D.width}),L("mainSrc","ril-image-current",{x:-1*C,y:-1*I,zoom:E}),L("prevSrc","ril-image-prev ril__imagePrev",{x:-1*D.width});var T={overlay:m({zIndex:1e3,backgroundColor:"transparent"},g.overlay),content:m({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},g.content)};return n.a.createElement(l.a,u({isOpen:!0,onRequestClose:r?this.requestClose:void 0,onAfterOpen:function(){t.outerEl.current&&t.outerEl.current.focus(),v()},style:T,contentLabel:O("Lightbox"),appElement:"undefined"!==typeof e.window?e.window.document.body:void 0},x),n.a.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(M?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(s,"ms"),animationDuration:"".concat(s,"ms"),animationDirection:M?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},n.a.createElement("div",{className:"ril-inner ril__inner",onClick:r?this.closeIfClickInner:void 0},N),b&&n.a.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),p&&n.a.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),n.a.createElement("div",{className:"ril-toolbar ril__toolbar"},n.a.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},h))),n.a.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},f&&f.map((function(e,t){return n.a.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),d&&n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(j(w===S?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||w===S,onClick:this.isAnimating()||w===S?void 0:this.handleZoomInButtonClick})),d&&n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(j(0===w?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===w,onClick:this.isAnimating()||0===w?void 0:this.handleZoomOutButtonClick})),n.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},n.a.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),this.props.imageCaption&&n.a.createElement("div",{onWheel:this.handleCaptionMousewheel,onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption",ref:this.caption},n.a.createElement("div",{className:"ril-caption-content ril__captionContent"},this.props.imageCaption))))}}]),i}(a.Component);I.propTypes={mainSrc:s.a.string.isRequired,prevSrc:s.a.string,nextSrc:s.a.string,mainSrcThumbnail:s.a.string,prevSrcThumbnail:s.a.string,nextSrcThumbnail:s.a.string,onCloseRequest:s.a.func.isRequired,onMovePrevRequest:s.a.func,onMoveNextRequest:s.a.func,onImageLoadError:s.a.func,onImageLoad:s.a.func,onAfterOpen:s.a.func,discourageDownloads:s.a.bool,animationDisabled:s.a.bool,animationOnKeyInput:s.a.bool,animationDuration:s.a.number,keyRepeatLimit:s.a.number,keyRepeatKeyupBonus:s.a.number,imageTitle:s.a.node,imageCaption:s.a.node,imageCrossOrigin:s.a.string,reactModalStyle:s.a.object,imagePadding:s.a.number,wrapperClassName:s.a.string,toolbarButtons:s.a.arrayOf(s.a.node),clickOutsideToClose:s.a.bool,enableZoom:s.a.bool,reactModalProps:s.a.shape({}),nextLabel:s.a.string,prevLabel:s.a.string,zoomInLabel:s.a.string,zoomOutLabel:s.a.string,closeLabel:s.a.string,imageLoadErrorMessage:s.a.node},I.defaultProps={imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load"},t.a=I}).call(this,i(81))},320:function(e,t,i){"use strict";var a=i(6),n=i(7),o=i(9),s=i(8),r=i(2),l=i.n(r),c=i(4),d=i(1),h=i(0),u=function(e){Object(o.a)(i,e);var t=Object(s.a)(i);function i(){return Object(a.a)(this,i),t.apply(this,arguments)}return Object(n.a)(i,[{key:"render",value:function(){var e=this.props,t=e.type,i=e.asyncOperationProgress,a=e.asyncOperatedFilesLength,n="move"===t?Object(d.qb)("Move {num} items"):Object(d.qb)("Copy {num} items");n=n.replace("{num}",a);var o={width:i+"%",lineHeight:"40px",textAlign:"left"};return Object(h.jsxs)(c.x,{isOpen:!0,children:[Object(h.jsx)(c.A,{toggle:this.props.toggleDialog,children:n}),Object(h.jsx)(c.y,{style:{minHeight:"80px"},children:Object(h.jsx)("div",{className:"progress",style:{height:"40px"},children:Object(h.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:o,"aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100",children:i+"%"})})})]})}}]),i}(l.a.Component);t.a=u},503:function(e,t,i){},504:function(e,t,i){}},[[1516,1,0]]]);
//# sourceMappingURL=sharedDirView.chunk.js.map