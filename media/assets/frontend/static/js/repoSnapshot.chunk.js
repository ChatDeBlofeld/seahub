(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[16],{1731:function(e,t,r){r(74),e.exports=r(1760)},1732:function(e,t,r){},1760:function(e,t,r){"use strict";r.r(t);var n=r(3),c=r(5),a=r(32),o=r(7),s=r(6),i=r(2),l=r.n(i),d=r(31),h=r.n(d),j=r(21),b=r(4),O=r(1),u=r(8),m=r(19),p=r(23),f=r(10),x=r(70),g=r(120),v=r(105),k=r(106),w=r(142),y=r(82),N=r(0),C=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var c;return Object(n.a)(this,r),(c=t.call(this,e)).action=function(){c.setState({btnDisabled:!0}),c.props.restoreRepo()},c.state={btnDisabled:!1},c}return Object(c.a)(r,[{key:"render",value:function(){var e=this.props,t=(e.formActionURL,e.csrfToken,e.toggle);return Object(N.jsxs)(g.a,{centered:!0,isOpen:!0,toggle:t,children:[Object(N.jsx)(v.a,{toggle:t,children:Object(O.rb)("Restore Library")}),Object(N.jsx)(k.a,{children:Object(N.jsx)("p",{children:Object(O.rb)("Are you sure you want to restore this library?")})}),Object(N.jsxs)(w.a,{children:[Object(N.jsx)(y.a,{color:"secondary",onClick:t,children:Object(O.rb)("Cancel")}),Object(N.jsx)(y.a,{color:"primary",onClick:this.action,disabled:this.state.btnDisabled,children:Object(O.rb)("Restore")})]})]})}}]),r}(i.Component),D=(r(151),r(169),r(1732),window.app.pageOptions),F=D.repoID,I=D.repoName,P=D.canRestoreRepo,R=D.commitID,M=D.commitTime,S=D.commitDesc,_=D.commitRelativeTime,L=D.showAuthor,U=D.authorAvatarURL,T=D.authorName,B=D.authorNickName,A=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var c;return Object(n.a)(this,r),(c=t.call(this,e)).toggleDialog=function(){c.setState({isConfirmDialogOpen:!c.state.isConfirmDialogOpen})},c.onSearchedClick=function(e){if(!0===e.is_dir){var t=O.rc+"library/"+e.repo_id+"/"+e.repo_name+e.path;Object(j.c)(t,{repalce:!0})}else{var r=O.rc+"lib/"+e.repo_id+"/file"+b.a.encodePath(e.path);window.open("about:blank").location.href=r}},c.goBack=function(e){e.preventDefault(),window.history.back()},c.renderFolder=function(e){c.setState({folderPath:e,folderItems:[],isLoading:!0}),u.a.listCommitDir(F,R,e).then((function(e){c.setState({isLoading:!1,folderItems:e.data.dirent_list})})).catch((function(e){c.setState({isLoading:!1,errorMsg:b.a.getErrorMsg(e,!0)})}))},c.clickFolderPath=function(e,t){t.preventDefault(),c.renderFolder(e)},c.renderPath=function(){var e=c.state.folderPath,t=e.split("/");return"/"==e?I:Object(N.jsxs)(l.a.Fragment,{children:[Object(N.jsx)("a",{href:"#",onClick:c.clickFolderPath.bind(Object(a.a)(c),"/"),children:I}),Object(N.jsx)("span",{children:" / "}),t.map((function(e,r){if(r>0&&r!=t.length-1)return Object(N.jsxs)(l.a.Fragment,{children:[Object(N.jsx)("a",{href:"#",onClick:c.clickFolderPath.bind(Object(a.a)(c),t.slice(0,r+1).join("/")),children:t[r]}),Object(N.jsx)("span",{children:" / "})]},r)})),t[t.length-1]]})},c.restoreRepo=function(){u.a.revertRepo(F,R).then((function(e){c.toggleDialog(),f.a.success(Object(O.rb)("Successfully restored the library."))})).catch((function(e){var t=b.a.getErrorMsg(e);c.toggleDialog(),f.a.danger(t)}))},c.state={isLoading:!0,errorMsg:"",folderPath:"/",folderItems:[],isConfirmDialogOpen:!1},c}return Object(c.a)(r,[{key:"componentDidMount",value:function(){this.renderFolder(this.state.folderPath)}},{key:"render",value:function(){var e=this.state,t=e.isConfirmDialogOpen,r=e.folderPath;return Object(N.jsxs)(l.a.Fragment,{children:[Object(N.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(N.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(N.jsx)("a",{href:O.rc,children:Object(N.jsx)("img",{src:O.Pb+O.Kb,height:O.Jb,width:O.Lb,title:O.sc,alt:"logo"})}),Object(N.jsx)(x.a,{onSearchedClick:this.onSearchedClick})]}),Object(N.jsx)("div",{className:"flex-auto container-fluid pt-4 pb-6 o-auto",children:Object(N.jsx)("div",{className:"row",children:Object(N.jsxs)("div",{className:"col-md-10 offset-md-1",children:[Object(N.jsxs)("h2",{children:[Object(N.jsx)("span",{children:b.a.generateDialogTitle(Object(O.rb)("{placeholder} Snapshot"),I)}),Object(N.jsxs)("span",{className:"heading-commit-time ml-1",children:["(",M,")"]})]}),Object(N.jsx)("a",{href:"#",className:"go-back",title:Object(O.rb)("Back"),role:"button","aria-label":Object(O.rb)("Back"),onClick:this.goBack,children:Object(N.jsx)("span",{className:"fas fa-chevron-left"})}),"/"==r&&Object(N.jsxs)("div",{className:"d-flex mb-2 align-items-center",children:[Object(N.jsx)("p",{className:"m-0",children:S}),Object(N.jsxs)("div",{className:"ml-4 border-left pl-4 d-flex align-items-center",children:[L?Object(N.jsxs)(l.a.Fragment,{children:[Object(N.jsx)("img",{src:U,width:"20",height:"20",alt:"",className:"rounded mr-1"}),Object(N.jsx)("a",{href:"".concat(O.rc,"profile/").concat(encodeURIComponent(T),"/"),children:B})]}):Object(N.jsx)("span",{children:Object(O.rb)("Unknown")}),Object(N.jsx)("p",{className:"m-0 ml-2",dangerouslySetInnerHTML:{__html:_}})]})]}),Object(N.jsxs)("div",{className:"d-flex justify-content-between align-items-center op-bar",children:[Object(N.jsxs)("p",{className:"m-0",children:[Object(O.rb)("Current path: "),this.renderPath()]}),"/"==r&&P&&Object(N.jsx)("button",{className:"btn btn-secondary op-bar-btn",onClick:this.toggleDialog,children:Object(O.rb)("Restore")})]}),Object(N.jsx)(E,{data:this.state,renderFolder:this.renderFolder})]})})})]}),t&&Object(N.jsx)(p.a,{children:Object(N.jsx)(C,{restoreRepo:this.restoreRepo,toggle:this.toggleDialog})})]})}}]),r}(l.a.Component),E=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var c;return Object(n.a)(this,r),(c=t.call(this,e)).theadData=[{width:"5%",text:""},{width:"55%",text:Object(O.rb)("Name")},{width:"20%",text:Object(O.rb)("Size")},{width:"20%",text:""}],c}return Object(c.a)(r,[{key:"render",value:function(){var e=this,t=this.props.data,r=t.isLoading,n=t.errorMsg,c=t.folderPath,a=t.folderItems;return r?Object(N.jsx)(m.a,{}):n?Object(N.jsx)("p",{className:"error mt-6 text-center",children:n}):Object(N.jsxs)("table",{className:"table-hover",children:[Object(N.jsx)("thead",{children:Object(N.jsx)("tr",{children:this.theadData.map((function(e,t){return Object(N.jsx)("th",{width:e.width,children:e.text},t)}))})}),Object(N.jsx)("tbody",{children:a.map((function(t,r){return Object(N.jsx)(z,{item:t,folderPath:c,renderFolder:e.props.renderFolder},r)}))})]})}}]),r}(l.a.Component),z=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var c;return Object(n.a)(this,r),(c=t.call(this,e)).handleMouseOver=function(){c.setState({isIconShown:!0})},c.handleMouseOut=function(){c.setState({isIconShown:!1})},c.restoreItem=function(e){e.preventDefault();var t=c.props.item,r=b.a.joinPath(c.props.folderPath,t.name);("dir"==t.type?u.a.revertFolder(F,r,R):u.a.revertFile(F,r,R)).then((function(e){f.a.success(Object(O.rb)("Successfully restored 1 item."))})).catch((function(e){var t=b.a.getErrorMsg(e);f.a.danger(t)}))},c.renderFolder=function(e){e.preventDefault();var t=c.props.item,r=c.props.folderPath;c.props.renderFolder(b.a.joinPath(r,t.name))},c.state={isIconShown:!1},c}return Object(c.a)(r,[{key:"render",value:function(){var e=this.props.item,t=this.state.isIconShown,r=this.props.folderPath;return"dir"==e.type?Object(N.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(N.jsx)("td",{className:"text-center",children:Object(N.jsx)("img",{src:b.a.getFolderIconUrl(),alt:Object(O.rb)("Directory"),width:"24"})}),Object(N.jsx)("td",{children:Object(N.jsx)("a",{href:"#",onClick:this.renderFolder,children:e.name})}),Object(N.jsx)("td",{}),Object(N.jsx)("td",{children:Object(N.jsx)("a",{href:"#",className:"action-icon sf2-icon-reply ".concat(t?"":"invisible"),onClick:this.restoreItem,title:Object(O.rb)("Restore"),"aria-label":Object(O.rb)("Restore"),role:"button"})})]}):Object(N.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(N.jsx)("td",{className:"text-center",children:Object(N.jsx)("img",{src:b.a.getFileIconUrl(e.name),alt:Object(O.rb)("File"),width:"24"})}),Object(N.jsx)("td",{children:Object(N.jsx)("a",{href:"".concat(O.rc,"repo/").concat(F,"/snapshot/files/?obj_id=").concat(e.obj_id,"&commit_id=").concat(R,"&p=").concat(encodeURIComponent(b.a.joinPath(r,e.name))),target:"_blank",children:e.name})}),Object(N.jsx)("td",{children:b.a.bytesToSize(e.size)}),Object(N.jsxs)("td",{children:[Object(N.jsx)("a",{href:"#",className:"action-icon sf2-icon-reply ".concat(t?"":"invisible"),onClick:this.restoreItem,title:Object(O.rb)("Restore"),"aria-label":Object(O.rb)("Restore"),role:"button"}),Object(N.jsx)("a",{href:"".concat(O.rc,"repo/").concat(F,"/").concat(e.obj_id,"/download/?file_name=").concat(encodeURIComponent(e.name),"&p=").concat(encodeURIComponent(b.a.joinPath(r,e.name))),className:"action-icon sf2-icon-download ".concat(t?"":"invisible"),title:Object(O.rb)("Download")})]})]})}}]),r}(l.a.Component);h.a.render(Object(N.jsx)(A,{}),document.getElementById("wrapper"))}},[[1731,1,0]]]);
//# sourceMappingURL=repoSnapshot.chunk.js.map